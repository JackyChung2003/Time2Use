var RN=Object.defineProperty;var WN=(e,t,n)=>t in e?RN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ye=(e,t,n)=>WN(e,typeof t!="symbol"?t+"":t,n);function Tk(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in e)){const o=Object.getOwnPropertyDescriptor(i,r);o&&Object.defineProperty(e,r,o.get?o:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var xn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Es(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function kN(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var r=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return e[i]}})}),n}var jk={exports:{}},OC={},Uk={exports:{}},dt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zu=Symbol.for("react.element"),VN=Symbol.for("react.portal"),wN=Symbol.for("react.fragment"),xN=Symbol.for("react.strict_mode"),XN=Symbol.for("react.profiler"),JN=Symbol.for("react.provider"),YN=Symbol.for("react.context"),NN=Symbol.for("react.forward_ref"),HN=Symbol.for("react.suspense"),FN=Symbol.for("react.memo"),KN=Symbol.for("react.lazy"),sv=Symbol.iterator;function EN(e){return e===null||typeof e!="object"?null:(e=sv&&e[sv]||e["@@iterator"],typeof e=="function"?e:null)}var Qk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Pk=Object.assign,_k={};function Ms(e,t,n){this.props=e,this.context=t,this.refs=_k,this.updater=n||Qk}Ms.prototype.isReactComponent={};Ms.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ms.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ok(){}Ok.prototype=Ms.prototype;function m0(e,t,n){this.props=e,this.context=t,this.refs=_k,this.updater=n||Qk}var A0=m0.prototype=new Ok;A0.constructor=m0;Pk(A0,Ms.prototype);A0.isPureReactComponent=!0;var gv=Array.isArray,qk=Object.prototype.hasOwnProperty,f0={current:null},$k={key:!0,ref:!0,__self:!0,__source:!0};function eV(e,t,n){var i,r={},o=null,a=null;if(t!=null)for(i in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(o=""+t.key),t)qk.call(t,i)&&!$k.hasOwnProperty(i)&&(r[i]=t[i]);var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){for(var s=Array(l),g=0;g<l;g++)s[g]=arguments[g+2];r.children=s}if(e&&e.defaultProps)for(i in l=e.defaultProps,l)r[i]===void 0&&(r[i]=l[i]);return{$$typeof:Zu,type:e,key:o,ref:a,props:r,_owner:f0.current}}function MN(e,t){return{$$typeof:Zu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function p0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Zu}function zN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var cv=/\/+/g;function Mm(e,t){return typeof e=="object"&&e!==null&&e.key!=null?zN(""+e.key):t.toString(36)}function td(e,t,n,i,r){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Zu:case VN:a=!0}}if(a)return a=e,r=r(a),e=i===""?"."+Mm(a,0):i,gv(r)?(n="",e!=null&&(n=e.replace(cv,"$&/")+"/"),td(r,t,n,"",function(g){return g})):r!=null&&(p0(r)&&(r=MN(r,n+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(cv,"$&/")+"/")+e)),t.push(r)),1;if(a=0,i=i===""?".":i+":",gv(e))for(var l=0;l<e.length;l++){o=e[l];var s=i+Mm(o,l);a+=td(o,t,n,s,r)}else if(s=EN(e),typeof s=="function")for(e=s.call(e),l=0;!(o=e.next()).done;)o=o.value,s=i+Mm(o,l++),a+=td(o,t,n,s,r);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function eI(e,t,n){if(e==null)return e;var i=[],r=0;return td(e,i,"","",function(o){return t.call(n,o,r++)}),i}function LN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var si={current:null},nd={transition:null},DN={ReactCurrentDispatcher:si,ReactCurrentBatchConfig:nd,ReactCurrentOwner:f0};function tV(){throw Error("act(...) is not supported in production builds of React.")}dt.Children={map:eI,forEach:function(e,t,n){eI(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return eI(e,function(){t++}),t},toArray:function(e){return eI(e,function(t){return t})||[]},only:function(e){if(!p0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};dt.Component=Ms;dt.Fragment=wN;dt.Profiler=XN;dt.PureComponent=m0;dt.StrictMode=xN;dt.Suspense=HN;dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DN;dt.act=tV;dt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=Pk({},e.props),r=e.key,o=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,a=f0.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(s in t)qk.call(t,s)&&!$k.hasOwnProperty(s)&&(i[s]=t[s]===void 0&&l!==void 0?l[s]:t[s])}var s=arguments.length-2;if(s===1)i.children=n;else if(1<s){l=Array(s);for(var g=0;g<s;g++)l[g]=arguments[g+2];i.children=l}return{$$typeof:Zu,type:e.type,key:r,ref:o,props:i,_owner:a}};dt.createContext=function(e){return e={$$typeof:YN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:JN,_context:e},e.Consumer=e};dt.createElement=eV;dt.createFactory=function(e){var t=eV.bind(null,e);return t.type=e,t};dt.createRef=function(){return{current:null}};dt.forwardRef=function(e){return{$$typeof:NN,render:e}};dt.isValidElement=p0;dt.lazy=function(e){return{$$typeof:KN,_payload:{_status:-1,_result:e},_init:LN}};dt.memo=function(e,t){return{$$typeof:FN,type:e,compare:t===void 0?null:t}};dt.startTransition=function(e){var t=nd.transition;nd.transition={};try{e()}finally{nd.transition=t}};dt.unstable_act=tV;dt.useCallback=function(e,t){return si.current.useCallback(e,t)};dt.useContext=function(e){return si.current.useContext(e)};dt.useDebugValue=function(){};dt.useDeferredValue=function(e){return si.current.useDeferredValue(e)};dt.useEffect=function(e,t){return si.current.useEffect(e,t)};dt.useId=function(){return si.current.useId()};dt.useImperativeHandle=function(e,t,n){return si.current.useImperativeHandle(e,t,n)};dt.useInsertionEffect=function(e,t){return si.current.useInsertionEffect(e,t)};dt.useLayoutEffect=function(e,t){return si.current.useLayoutEffect(e,t)};dt.useMemo=function(e,t){return si.current.useMemo(e,t)};dt.useReducer=function(e,t,n){return si.current.useReducer(e,t,n)};dt.useRef=function(e){return si.current.useRef(e)};dt.useState=function(e){return si.current.useState(e)};dt.useSyncExternalStore=function(e,t,n){return si.current.useSyncExternalStore(e,t,n)};dt.useTransition=function(){return si.current.useTransition()};dt.version="18.3.1";Uk.exports=dt;var h=Uk.exports;const ce=Es(h),qC=Tk({__proto__:null,default:ce},[h]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TN=h,jN=Symbol.for("react.element"),UN=Symbol.for("react.fragment"),QN=Object.prototype.hasOwnProperty,PN=TN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_N={key:!0,ref:!0,__self:!0,__source:!0};function nV(e,t,n){var i,r={},o=null,a=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(a=t.ref);for(i in t)QN.call(t,i)&&!_N.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)r[i]===void 0&&(r[i]=t[i]);return{$$typeof:jN,type:e,key:o,ref:a,props:r,_owner:PN.current}}OC.Fragment=UN;OC.jsx=nV;OC.jsxs=nV;jk.exports=OC;var d=jk.exports,iV={exports:{}},Hi={},rV={exports:{}},oV={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(J,F){var S=J.length;J.push(F);e:for(;0<S;){var E=S-1>>>1,N=J[E];if(0<r(N,F))J[E]=F,J[S]=N,S=E;else break e}}function n(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var F=J[0],S=J.pop();if(S!==F){J[0]=S;e:for(var E=0,N=J.length,k=N>>>1;E<k;){var z=2*(E+1)-1,L=J[z],D=z+1,j=J[D];if(0>r(L,S))D<N&&0>r(j,L)?(J[E]=j,J[D]=S,E=D):(J[E]=L,J[z]=S,E=z);else if(D<N&&0>r(j,S))J[E]=j,J[D]=S,E=D;else break e}}return F}function r(J,F){var S=J.sortIndex-F.sortIndex;return S!==0?S:J.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var s=[],g=[],c=1,u=null,I=3,C=!1,m=!1,f=!1,b=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(J){for(var F=n(g);F!==null;){if(F.callback===null)i(g);else if(F.startTime<=J)i(g),F.sortIndex=F.expirationTime,t(s,F);else break;F=n(g)}}function Z(J){if(f=!1,y(J),!m)if(n(s)!==null)m=!0,w(G);else{var F=n(g);F!==null&&x(Z,F.startTime-J)}}function G(J,F){m=!1,f&&(f=!1,A(R),R=-1),C=!0;var S=I;try{for(y(F),u=n(s);u!==null&&(!(u.expirationTime>F)||J&&!V());){var E=u.callback;if(typeof E=="function"){u.callback=null,I=u.priorityLevel;var N=E(u.expirationTime<=F);F=e.unstable_now(),typeof N=="function"?u.callback=N:u===n(s)&&i(s),y(F)}else i(s);u=n(s)}if(u!==null)var k=!0;else{var z=n(g);z!==null&&x(Z,z.startTime-F),k=!1}return k}finally{u=null,I=S,C=!1}}var v=!1,B=null,R=-1,X=5,W=-1;function V(){return!(e.unstable_now()-W<X)}function Y(){if(B!==null){var J=e.unstable_now();W=J;var F=!0;try{F=B(!0,J)}finally{F?K():(v=!1,B=null)}}else v=!1}var K;if(typeof p=="function")K=function(){p(Y)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,H=M.port2;M.port1.onmessage=Y,K=function(){H.postMessage(null)}}else K=function(){b(Y,0)};function w(J){B=J,v||(v=!0,K())}function x(J,F){R=b(function(){J(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){m||C||(m=!0,w(G))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_getFirstCallbackNode=function(){return n(s)},e.unstable_next=function(J){switch(I){case 1:case 2:case 3:var F=3;break;default:F=I}var S=I;I=F;try{return J()}finally{I=S}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,F){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var S=I;I=J;try{return F()}finally{I=S}},e.unstable_scheduleCallback=function(J,F,S){var E=e.unstable_now();switch(typeof S=="object"&&S!==null?(S=S.delay,S=typeof S=="number"&&0<S?E+S:E):S=E,J){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=S+N,J={id:c++,callback:F,priorityLevel:J,startTime:S,expirationTime:N,sortIndex:-1},S>E?(J.sortIndex=S,t(g,J),n(s)===null&&J===n(g)&&(f?(A(R),R=-1):f=!0,x(Z,S-E))):(J.sortIndex=N,t(s,J),m||C||(m=!0,w(G))),J},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(J){var F=I;return function(){var S=I;I=F;try{return J.apply(this,arguments)}finally{I=S}}}})(oV);rV.exports=oV;var ON=rV.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qN=h,Ji=ON;function ue(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var aV=new Set,Rc={};function ul(e,t){ys(e,t),ys(e+"Capture",t)}function ys(e,t){for(Rc[e]=t,e=0;e<t.length;e++)aV.add(t[e])}var oo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wf=Object.prototype.hasOwnProperty,$N=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uv={},Iv={};function eH(e){return Wf.call(Iv,e)?!0:Wf.call(uv,e)?!1:$N.test(e)?Iv[e]=!0:(uv[e]=!0,!1)}function tH(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function nH(e,t,n,i){if(t===null||typeof t>"u"||tH(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function gi(e,t,n,i,r,o,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var zn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){zn[e]=new gi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];zn[t]=new gi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){zn[e]=new gi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){zn[e]=new gi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){zn[e]=new gi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){zn[e]=new gi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){zn[e]=new gi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){zn[e]=new gi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){zn[e]=new gi(e,5,!1,e.toLowerCase(),null,!1,!1)});var b0=/[\-:]([a-z])/g;function y0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(b0,y0);zn[t]=new gi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(b0,y0);zn[t]=new gi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(b0,y0);zn[t]=new gi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){zn[e]=new gi(e,1,!1,e.toLowerCase(),null,!1,!1)});zn.xlinkHref=new gi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){zn[e]=new gi(e,1,!1,e.toLowerCase(),null,!0,!0)});function Z0(e,t,n,i){var r=zn.hasOwnProperty(t)?zn[t]:null;(r!==null?r.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(nH(t,n,r,i)&&(n=null),i||r===null?eH(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=n===null?r.type===3?!1:"":n:(t=r.attributeName,i=r.attributeNamespace,n===null?e.removeAttribute(t):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var go=qN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tI=Symbol.for("react.element"),Dl=Symbol.for("react.portal"),Tl=Symbol.for("react.fragment"),v0=Symbol.for("react.strict_mode"),kf=Symbol.for("react.profiler"),lV=Symbol.for("react.provider"),sV=Symbol.for("react.context"),G0=Symbol.for("react.forward_ref"),Vf=Symbol.for("react.suspense"),wf=Symbol.for("react.suspense_list"),S0=Symbol.for("react.memo"),xo=Symbol.for("react.lazy"),gV=Symbol.for("react.offscreen"),dv=Symbol.iterator;function hg(e){return e===null||typeof e!="object"?null:(e=dv&&e[dv]||e["@@iterator"],typeof e=="function"?e:null)}var sn=Object.assign,zm;function Lg(e){if(zm===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);zm=t&&t[1]||""}return`
`+zm+e}var Lm=!1;function Dm(e,t){if(!e||Lm)return"";Lm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(g){var i=g}Reflect.construct(e,[],t)}else{try{t.call()}catch(g){i=g}e.call(t.prototype)}else{try{throw Error()}catch(g){i=g}e()}}catch(g){if(g&&i&&typeof g.stack=="string"){for(var r=g.stack.split(`
`),o=i.stack.split(`
`),a=r.length-1,l=o.length-1;1<=a&&0<=l&&r[a]!==o[l];)l--;for(;1<=a&&0<=l;a--,l--)if(r[a]!==o[l]){if(a!==1||l!==1)do if(a--,l--,0>l||r[a]!==o[l]){var s=`
`+r[a].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}while(1<=a&&0<=l);break}}}finally{Lm=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Lg(e):""}function iH(e){switch(e.tag){case 5:return Lg(e.type);case 16:return Lg("Lazy");case 13:return Lg("Suspense");case 19:return Lg("SuspenseList");case 0:case 2:case 15:return e=Dm(e.type,!1),e;case 11:return e=Dm(e.type.render,!1),e;case 1:return e=Dm(e.type,!0),e;default:return""}}function xf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Tl:return"Fragment";case Dl:return"Portal";case kf:return"Profiler";case v0:return"StrictMode";case Vf:return"Suspense";case wf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sV:return(e.displayName||"Context")+".Consumer";case lV:return(e._context.displayName||"Context")+".Provider";case G0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case S0:return t=e.displayName||null,t!==null?t:xf(e.type)||"Memo";case xo:t=e._payload,e=e._init;try{return xf(e(t))}catch{}}return null}function rH(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xf(t);case 8:return t===v0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function la(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function cV(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function oH(e){var t=cV(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,o.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function nI(e){e._valueTracker||(e._valueTracker=oH(e))}function uV(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=cV(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function Md(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Xf(e,t){var n=t.checked;return sn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Cv(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=la(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function IV(e,t){t=t.checked,t!=null&&Z0(e,"checked",t,!1)}function Jf(e,t){IV(e,t);var n=la(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Yf(e,t.type,n):t.hasOwnProperty("defaultValue")&&Yf(e,t.type,la(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function hv(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Yf(e,t,n){(t!=="number"||Md(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Dg=Array.isArray;function ss(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+la(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,i&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Nf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ue(91));return sn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function mv(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ue(92));if(Dg(n)){if(1<n.length)throw Error(ue(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:la(n)}}function dV(e,t){var n=la(t.value),i=la(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function Av(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function CV(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?CV(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var iI,hV=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,r){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(iI=iI||document.createElement("div"),iI.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=iI.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Wc(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var nc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aH=["Webkit","ms","Moz","O"];Object.keys(nc).forEach(function(e){aH.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),nc[t]=nc[e]})});function mV(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||nc.hasOwnProperty(e)&&nc[e]?(""+t).trim():t+"px"}function AV(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=mV(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}var lH=sn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ff(e,t){if(t){if(lH[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ue(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ue(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ue(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ue(62))}}function Kf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ef=null;function B0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Mf=null,gs=null,cs=null;function fv(e){if(e=Su(e)){if(typeof Mf!="function")throw Error(ue(280));var t=e.stateNode;t&&(t=ih(t),Mf(e.stateNode,e.type,t))}}function fV(e){gs?cs?cs.push(e):cs=[e]:gs=e}function pV(){if(gs){var e=gs,t=cs;if(cs=gs=null,fv(e),t)for(e=0;e<t.length;e++)fv(t[e])}}function bV(e,t){return e(t)}function yV(){}var Tm=!1;function ZV(e,t,n){if(Tm)return e(t,n);Tm=!0;try{return bV(e,t,n)}finally{Tm=!1,(gs!==null||cs!==null)&&(yV(),pV())}}function kc(e,t){var n=e.stateNode;if(n===null)return null;var i=ih(n);if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ue(231,t,typeof n));return n}var zf=!1;if(oo)try{var mg={};Object.defineProperty(mg,"passive",{get:function(){zf=!0}}),window.addEventListener("test",mg,mg),window.removeEventListener("test",mg,mg)}catch{zf=!1}function sH(e,t,n,i,r,o,a,l,s){var g=Array.prototype.slice.call(arguments,3);try{t.apply(n,g)}catch(c){this.onError(c)}}var ic=!1,zd=null,Ld=!1,Lf=null,gH={onError:function(e){ic=!0,zd=e}};function cH(e,t,n,i,r,o,a,l,s){ic=!1,zd=null,sH.apply(gH,arguments)}function uH(e,t,n,i,r,o,a,l,s){if(cH.apply(this,arguments),ic){if(ic){var g=zd;ic=!1,zd=null}else throw Error(ue(198));Ld||(Ld=!0,Lf=g)}}function Il(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function vV(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function pv(e){if(Il(e)!==e)throw Error(ue(188))}function IH(e){var t=e.alternate;if(!t){if(t=Il(e),t===null)throw Error(ue(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(r===null)break;var o=r.alternate;if(o===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return pv(r),e;if(o===i)return pv(r),t;o=o.sibling}throw Error(ue(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=o;break}if(l===i){a=!0,i=r,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,i=r;break}if(l===i){a=!0,i=o,n=r;break}l=l.sibling}if(!a)throw Error(ue(189))}}if(n.alternate!==i)throw Error(ue(190))}if(n.tag!==3)throw Error(ue(188));return n.stateNode.current===n?e:t}function GV(e){return e=IH(e),e!==null?SV(e):null}function SV(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=SV(e);if(t!==null)return t;e=e.sibling}return null}var BV=Ji.unstable_scheduleCallback,bv=Ji.unstable_cancelCallback,dH=Ji.unstable_shouldYield,CH=Ji.unstable_requestPaint,Cn=Ji.unstable_now,hH=Ji.unstable_getCurrentPriorityLevel,R0=Ji.unstable_ImmediatePriority,RV=Ji.unstable_UserBlockingPriority,Dd=Ji.unstable_NormalPriority,mH=Ji.unstable_LowPriority,WV=Ji.unstable_IdlePriority,$C=null,Nr=null;function AH(e){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot($C,e,void 0,(e.current.flags&128)===128)}catch{}}var dr=Math.clz32?Math.clz32:bH,fH=Math.log,pH=Math.LN2;function bH(e){return e>>>=0,e===0?32:31-(fH(e)/pH|0)|0}var rI=64,oI=4194304;function Tg(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Td(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,r=e.suspendedLanes,o=e.pingedLanes,a=n&268435455;if(a!==0){var l=a&~r;l!==0?i=Tg(l):(o&=a,o!==0&&(i=Tg(o)))}else a=n&~r,a!==0?i=Tg(a):o!==0&&(i=Tg(o));if(i===0)return 0;if(t!==0&&t!==i&&!(t&r)&&(r=i&-i,o=t&-t,r>=o||r===16&&(o&4194240)!==0))return t;if(i&4&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-dr(t),r=1<<n,i|=e[n],t&=~r;return i}function yH(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZH(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-dr(o),l=1<<a,s=r[a];s===-1?(!(l&n)||l&i)&&(r[a]=yH(l,t)):s<=t&&(e.expiredLanes|=l),o&=~l}}function Df(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function kV(){var e=rI;return rI<<=1,!(rI&4194240)&&(rI=64),e}function jm(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vu(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-dr(t),e[t]=n}function vH(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-dr(n),o=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~o}}function W0(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-dr(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var Vt=0;function VV(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var wV,k0,xV,XV,JV,Tf=!1,aI=[],_o=null,Oo=null,qo=null,Vc=new Map,wc=new Map,Ho=[],GH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yv(e,t){switch(e){case"focusin":case"focusout":_o=null;break;case"dragenter":case"dragleave":Oo=null;break;case"mouseover":case"mouseout":qo=null;break;case"pointerover":case"pointerout":Vc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":wc.delete(t.pointerId)}}function Ag(e,t,n,i,r,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},t!==null&&(t=Su(t),t!==null&&k0(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function SH(e,t,n,i,r){switch(t){case"focusin":return _o=Ag(_o,e,t,n,i,r),!0;case"dragenter":return Oo=Ag(Oo,e,t,n,i,r),!0;case"mouseover":return qo=Ag(qo,e,t,n,i,r),!0;case"pointerover":var o=r.pointerId;return Vc.set(o,Ag(Vc.get(o)||null,e,t,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,wc.set(o,Ag(wc.get(o)||null,e,t,n,i,r)),!0}return!1}function YV(e){var t=Da(e.target);if(t!==null){var n=Il(t);if(n!==null){if(t=n.tag,t===13){if(t=vV(n),t!==null){e.blockedOn=t,JV(e.priority,function(){xV(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function id(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=jf(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Ef=i,n.target.dispatchEvent(i),Ef=null}else return t=Su(n),t!==null&&k0(t),e.blockedOn=n,!1;t.shift()}return!0}function Zv(e,t,n){id(e)&&n.delete(t)}function BH(){Tf=!1,_o!==null&&id(_o)&&(_o=null),Oo!==null&&id(Oo)&&(Oo=null),qo!==null&&id(qo)&&(qo=null),Vc.forEach(Zv),wc.forEach(Zv)}function fg(e,t){e.blockedOn===t&&(e.blockedOn=null,Tf||(Tf=!0,Ji.unstable_scheduleCallback(Ji.unstable_NormalPriority,BH)))}function xc(e){function t(r){return fg(r,e)}if(0<aI.length){fg(aI[0],e);for(var n=1;n<aI.length;n++){var i=aI[n];i.blockedOn===e&&(i.blockedOn=null)}}for(_o!==null&&fg(_o,e),Oo!==null&&fg(Oo,e),qo!==null&&fg(qo,e),Vc.forEach(t),wc.forEach(t),n=0;n<Ho.length;n++)i=Ho[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<Ho.length&&(n=Ho[0],n.blockedOn===null);)YV(n),n.blockedOn===null&&Ho.shift()}var us=go.ReactCurrentBatchConfig,jd=!0;function RH(e,t,n,i){var r=Vt,o=us.transition;us.transition=null;try{Vt=1,V0(e,t,n,i)}finally{Vt=r,us.transition=o}}function WH(e,t,n,i){var r=Vt,o=us.transition;us.transition=null;try{Vt=4,V0(e,t,n,i)}finally{Vt=r,us.transition=o}}function V0(e,t,n,i){if(jd){var r=jf(e,t,n,i);if(r===null)nA(e,t,i,Ud,n),yv(e,i);else if(SH(r,e,t,n,i))i.stopPropagation();else if(yv(e,i),t&4&&-1<GH.indexOf(e)){for(;r!==null;){var o=Su(r);if(o!==null&&wV(o),o=jf(e,t,n,i),o===null&&nA(e,t,i,Ud,n),o===r)break;r=o}r!==null&&i.stopPropagation()}else nA(e,t,i,null,n)}}var Ud=null;function jf(e,t,n,i){if(Ud=null,e=B0(i),e=Da(e),e!==null)if(t=Il(e),t===null)e=null;else if(n=t.tag,n===13){if(e=vV(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ud=e,null}function NV(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hH()){case R0:return 1;case RV:return 4;case Dd:case mH:return 16;case WV:return 536870912;default:return 16}default:return 16}}var Eo=null,w0=null,rd=null;function HV(){if(rd)return rd;var e,t=w0,n=t.length,i,r="value"in Eo?Eo.value:Eo.textContent,o=r.length;for(e=0;e<n&&t[e]===r[e];e++);var a=n-e;for(i=1;i<=a&&t[n-i]===r[o-i];i++);return rd=r.slice(e,1<i?1-i:void 0)}function od(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function lI(){return!0}function vv(){return!1}function Fi(e){function t(n,i,r,o,a){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?lI:vv,this.isPropagationStopped=vv,this}return sn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=lI)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=lI)},persist:function(){},isPersistent:lI}),t}var zs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},x0=Fi(zs),Gu=sn({},zs,{view:0,detail:0}),kH=Fi(Gu),Um,Qm,pg,eh=sn({},Gu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:X0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pg&&(pg&&e.type==="mousemove"?(Um=e.screenX-pg.screenX,Qm=e.screenY-pg.screenY):Qm=Um=0,pg=e),Um)},movementY:function(e){return"movementY"in e?e.movementY:Qm}}),Gv=Fi(eh),VH=sn({},eh,{dataTransfer:0}),wH=Fi(VH),xH=sn({},Gu,{relatedTarget:0}),Pm=Fi(xH),XH=sn({},zs,{animationName:0,elapsedTime:0,pseudoElement:0}),JH=Fi(XH),YH=sn({},zs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),NH=Fi(YH),HH=sn({},zs,{data:0}),Sv=Fi(HH),FH={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},KH={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},EH={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function MH(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=EH[e])?!!t[e]:!1}function X0(){return MH}var zH=sn({},Gu,{key:function(e){if(e.key){var t=FH[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?KH[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:X0,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),LH=Fi(zH),DH=sn({},eh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bv=Fi(DH),TH=sn({},Gu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:X0}),jH=Fi(TH),UH=sn({},zs,{propertyName:0,elapsedTime:0,pseudoElement:0}),QH=Fi(UH),PH=sn({},eh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),_H=Fi(PH),OH=[9,13,27,32],J0=oo&&"CompositionEvent"in window,rc=null;oo&&"documentMode"in document&&(rc=document.documentMode);var qH=oo&&"TextEvent"in window&&!rc,FV=oo&&(!J0||rc&&8<rc&&11>=rc),Rv=" ",Wv=!1;function KV(e,t){switch(e){case"keyup":return OH.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function EV(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var jl=!1;function $H(e,t){switch(e){case"compositionend":return EV(t);case"keypress":return t.which!==32?null:(Wv=!0,Rv);case"textInput":return e=t.data,e===Rv&&Wv?null:e;default:return null}}function eF(e,t){if(jl)return e==="compositionend"||!J0&&KV(e,t)?(e=HV(),rd=w0=Eo=null,jl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return FV&&t.locale!=="ko"?null:t.data;default:return null}}var tF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!tF[e.type]:t==="textarea"}function MV(e,t,n,i){fV(i),t=Qd(t,"onChange"),0<t.length&&(n=new x0("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var oc=null,Xc=null;function nF(e){qV(e,0)}function th(e){var t=Pl(e);if(uV(t))return e}function iF(e,t){if(e==="change")return t}var zV=!1;if(oo){var _m;if(oo){var Om="oninput"in document;if(!Om){var Vv=document.createElement("div");Vv.setAttribute("oninput","return;"),Om=typeof Vv.oninput=="function"}_m=Om}else _m=!1;zV=_m&&(!document.documentMode||9<document.documentMode)}function wv(){oc&&(oc.detachEvent("onpropertychange",LV),Xc=oc=null)}function LV(e){if(e.propertyName==="value"&&th(Xc)){var t=[];MV(t,Xc,e,B0(e)),ZV(nF,t)}}function rF(e,t,n){e==="focusin"?(wv(),oc=t,Xc=n,oc.attachEvent("onpropertychange",LV)):e==="focusout"&&wv()}function oF(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return th(Xc)}function aF(e,t){if(e==="click")return th(t)}function lF(e,t){if(e==="input"||e==="change")return th(t)}function sF(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var pr=typeof Object.is=="function"?Object.is:sF;function Jc(e,t){if(pr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!Wf.call(t,r)||!pr(e[r],t[r]))return!1}return!0}function xv(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xv(e,t){var n=xv(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=xv(n)}}function DV(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?DV(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function TV(){for(var e=window,t=Md();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Md(e.document)}return t}function Y0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function gF(e){var t=TV(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&DV(n.ownerDocument.documentElement,n)){if(i!==null&&Y0(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=n.textContent.length,o=Math.min(i.start,r);i=i.end===void 0?o:Math.min(i.end,r),!e.extend&&o>i&&(r=i,i=o,o=r),r=Xv(n,o);var a=Xv(n,i);r&&a&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),o>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var cF=oo&&"documentMode"in document&&11>=document.documentMode,Ul=null,Uf=null,ac=null,Qf=!1;function Jv(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Qf||Ul==null||Ul!==Md(i)||(i=Ul,"selectionStart"in i&&Y0(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),ac&&Jc(ac,i)||(ac=i,i=Qd(Uf,"onSelect"),0<i.length&&(t=new x0("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=Ul)))}function sI(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ql={animationend:sI("Animation","AnimationEnd"),animationiteration:sI("Animation","AnimationIteration"),animationstart:sI("Animation","AnimationStart"),transitionend:sI("Transition","TransitionEnd")},qm={},jV={};oo&&(jV=document.createElement("div").style,"AnimationEvent"in window||(delete Ql.animationend.animation,delete Ql.animationiteration.animation,delete Ql.animationstart.animation),"TransitionEvent"in window||delete Ql.transitionend.transition);function nh(e){if(qm[e])return qm[e];if(!Ql[e])return e;var t=Ql[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in jV)return qm[e]=t[n];return e}var UV=nh("animationend"),QV=nh("animationiteration"),PV=nh("animationstart"),_V=nh("transitionend"),OV=new Map,Yv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ca(e,t){OV.set(e,t),ul(t,[e])}for(var $m=0;$m<Yv.length;$m++){var eA=Yv[$m],uF=eA.toLowerCase(),IF=eA[0].toUpperCase()+eA.slice(1);Ca(uF,"on"+IF)}Ca(UV,"onAnimationEnd");Ca(QV,"onAnimationIteration");Ca(PV,"onAnimationStart");Ca("dblclick","onDoubleClick");Ca("focusin","onFocus");Ca("focusout","onBlur");Ca(_V,"onTransitionEnd");ys("onMouseEnter",["mouseout","mouseover"]);ys("onMouseLeave",["mouseout","mouseover"]);ys("onPointerEnter",["pointerout","pointerover"]);ys("onPointerLeave",["pointerout","pointerover"]);ul("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ul("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ul("onBeforeInput",["compositionend","keypress","textInput","paste"]);ul("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ul("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ul("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dF=new Set("cancel close invalid load scroll toggle".split(" ").concat(jg));function Nv(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,uH(i,t,void 0,e),e.currentTarget=null}function qV(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var o=void 0;if(t)for(var a=i.length-1;0<=a;a--){var l=i[a],s=l.instance,g=l.currentTarget;if(l=l.listener,s!==o&&r.isPropagationStopped())break e;Nv(r,l,g),o=s}else for(a=0;a<i.length;a++){if(l=i[a],s=l.instance,g=l.currentTarget,l=l.listener,s!==o&&r.isPropagationStopped())break e;Nv(r,l,g),o=s}}}if(Ld)throw e=Lf,Ld=!1,Lf=null,e}function Tt(e,t){var n=t[$f];n===void 0&&(n=t[$f]=new Set);var i=e+"__bubble";n.has(i)||($V(t,e,2,!1),n.add(i))}function tA(e,t,n){var i=0;t&&(i|=4),$V(n,e,i,t)}var gI="_reactListening"+Math.random().toString(36).slice(2);function Yc(e){if(!e[gI]){e[gI]=!0,aV.forEach(function(n){n!=="selectionchange"&&(dF.has(n)||tA(n,!1,e),tA(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[gI]||(t[gI]=!0,tA("selectionchange",!1,t))}}function $V(e,t,n,i){switch(NV(t)){case 1:var r=RH;break;case 4:r=WH;break;default:r=V0}n=r.bind(null,t,n,e),r=void 0,!zf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),i?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function nA(e,t,n,i,r){var o=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var l=i.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(a===4)for(a=i.return;a!==null;){var s=a.tag;if((s===3||s===4)&&(s=a.stateNode.containerInfo,s===r||s.nodeType===8&&s.parentNode===r))return;a=a.return}for(;l!==null;){if(a=Da(l),a===null)return;if(s=a.tag,s===5||s===6){i=o=a;continue e}l=l.parentNode}}i=i.return}ZV(function(){var g=o,c=B0(n),u=[];e:{var I=OV.get(e);if(I!==void 0){var C=x0,m=e;switch(e){case"keypress":if(od(n)===0)break e;case"keydown":case"keyup":C=LH;break;case"focusin":m="focus",C=Pm;break;case"focusout":m="blur",C=Pm;break;case"beforeblur":case"afterblur":C=Pm;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=Gv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=wH;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=jH;break;case UV:case QV:case PV:C=JH;break;case _V:C=QH;break;case"scroll":C=kH;break;case"wheel":C=_H;break;case"copy":case"cut":case"paste":C=NH;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=Bv}var f=(t&4)!==0,b=!f&&e==="scroll",A=f?I!==null?I+"Capture":null:I;f=[];for(var p=g,y;p!==null;){y=p;var Z=y.stateNode;if(y.tag===5&&Z!==null&&(y=Z,A!==null&&(Z=kc(p,A),Z!=null&&f.push(Nc(p,Z,y)))),b)break;p=p.return}0<f.length&&(I=new C(I,m,null,n,c),u.push({event:I,listeners:f}))}}if(!(t&7)){e:{if(I=e==="mouseover"||e==="pointerover",C=e==="mouseout"||e==="pointerout",I&&n!==Ef&&(m=n.relatedTarget||n.fromElement)&&(Da(m)||m[ao]))break e;if((C||I)&&(I=c.window===c?c:(I=c.ownerDocument)?I.defaultView||I.parentWindow:window,C?(m=n.relatedTarget||n.toElement,C=g,m=m?Da(m):null,m!==null&&(b=Il(m),m!==b||m.tag!==5&&m.tag!==6)&&(m=null)):(C=null,m=g),C!==m)){if(f=Gv,Z="onMouseLeave",A="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(f=Bv,Z="onPointerLeave",A="onPointerEnter",p="pointer"),b=C==null?I:Pl(C),y=m==null?I:Pl(m),I=new f(Z,p+"leave",C,n,c),I.target=b,I.relatedTarget=y,Z=null,Da(c)===g&&(f=new f(A,p+"enter",m,n,c),f.target=y,f.relatedTarget=b,Z=f),b=Z,C&&m)t:{for(f=C,A=m,p=0,y=f;y;y=Rl(y))p++;for(y=0,Z=A;Z;Z=Rl(Z))y++;for(;0<p-y;)f=Rl(f),p--;for(;0<y-p;)A=Rl(A),y--;for(;p--;){if(f===A||A!==null&&f===A.alternate)break t;f=Rl(f),A=Rl(A)}f=null}else f=null;C!==null&&Hv(u,I,C,f,!1),m!==null&&b!==null&&Hv(u,b,m,f,!0)}}e:{if(I=g?Pl(g):window,C=I.nodeName&&I.nodeName.toLowerCase(),C==="select"||C==="input"&&I.type==="file")var G=iF;else if(kv(I))if(zV)G=lF;else{G=oF;var v=rF}else(C=I.nodeName)&&C.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(G=aF);if(G&&(G=G(e,g))){MV(u,G,n,c);break e}v&&v(e,I,g),e==="focusout"&&(v=I._wrapperState)&&v.controlled&&I.type==="number"&&Yf(I,"number",I.value)}switch(v=g?Pl(g):window,e){case"focusin":(kv(v)||v.contentEditable==="true")&&(Ul=v,Uf=g,ac=null);break;case"focusout":ac=Uf=Ul=null;break;case"mousedown":Qf=!0;break;case"contextmenu":case"mouseup":case"dragend":Qf=!1,Jv(u,n,c);break;case"selectionchange":if(cF)break;case"keydown":case"keyup":Jv(u,n,c)}var B;if(J0)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else jl?KV(e,n)&&(R="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(FV&&n.locale!=="ko"&&(jl||R!=="onCompositionStart"?R==="onCompositionEnd"&&jl&&(B=HV()):(Eo=c,w0="value"in Eo?Eo.value:Eo.textContent,jl=!0)),v=Qd(g,R),0<v.length&&(R=new Sv(R,e,null,n,c),u.push({event:R,listeners:v}),B?R.data=B:(B=EV(n),B!==null&&(R.data=B)))),(B=qH?$H(e,n):eF(e,n))&&(g=Qd(g,"onBeforeInput"),0<g.length&&(c=new Sv("onBeforeInput","beforeinput",null,n,c),u.push({event:c,listeners:g}),c.data=B))}qV(u,t)})}function Nc(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Qd(e,t){for(var n=t+"Capture",i=[];e!==null;){var r=e,o=r.stateNode;r.tag===5&&o!==null&&(r=o,o=kc(e,n),o!=null&&i.unshift(Nc(e,o,r)),o=kc(e,t),o!=null&&i.push(Nc(e,o,r))),e=e.return}return i}function Rl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Hv(e,t,n,i,r){for(var o=t._reactName,a=[];n!==null&&n!==i;){var l=n,s=l.alternate,g=l.stateNode;if(s!==null&&s===i)break;l.tag===5&&g!==null&&(l=g,r?(s=kc(n,o),s!=null&&a.unshift(Nc(n,s,l))):r||(s=kc(n,o),s!=null&&a.push(Nc(n,s,l)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var CF=/\r\n?/g,hF=/\u0000|\uFFFD/g;function Fv(e){return(typeof e=="string"?e:""+e).replace(CF,`
`).replace(hF,"")}function cI(e,t,n){if(t=Fv(t),Fv(e)!==t&&n)throw Error(ue(425))}function Pd(){}var Pf=null,_f=null;function Of(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var qf=typeof setTimeout=="function"?setTimeout:void 0,mF=typeof clearTimeout=="function"?clearTimeout:void 0,Kv=typeof Promise=="function"?Promise:void 0,AF=typeof queueMicrotask=="function"?queueMicrotask:typeof Kv<"u"?function(e){return Kv.resolve(null).then(e).catch(fF)}:qf;function fF(e){setTimeout(function(){throw e})}function iA(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){e.removeChild(r),xc(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);xc(t)}function $o(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ev(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ls=Math.random().toString(36).slice(2),Yr="__reactFiber$"+Ls,Hc="__reactProps$"+Ls,ao="__reactContainer$"+Ls,$f="__reactEvents$"+Ls,pF="__reactListeners$"+Ls,bF="__reactHandles$"+Ls;function Da(e){var t=e[Yr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ao]||n[Yr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Ev(e);e!==null;){if(n=e[Yr])return n;e=Ev(e)}return t}e=n,n=e.parentNode}return null}function Su(e){return e=e[Yr]||e[ao],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Pl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ue(33))}function ih(e){return e[Hc]||null}var ep=[],_l=-1;function ha(e){return{current:e}}function jt(e){0>_l||(e.current=ep[_l],ep[_l]=null,_l--)}function Lt(e,t){_l++,ep[_l]=e.current,e.current=t}var sa={},qn=ha(sa),fi=ha(!1),tl=sa;function Zs(e,t){var n=e.type.contextTypes;if(!n)return sa;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r={},o;for(o in n)r[o]=t[o];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function pi(e){return e=e.childContextTypes,e!=null}function _d(){jt(fi),jt(qn)}function Mv(e,t,n){if(qn.current!==sa)throw Error(ue(168));Lt(qn,t),Lt(fi,n)}function e2(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in t))throw Error(ue(108,rH(e)||"Unknown",r));return sn({},n,i)}function Od(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||sa,tl=qn.current,Lt(qn,e),Lt(fi,fi.current),!0}function zv(e,t,n){var i=e.stateNode;if(!i)throw Error(ue(169));n?(e=e2(e,t,tl),i.__reactInternalMemoizedMergedChildContext=e,jt(fi),jt(qn),Lt(qn,e)):jt(fi),Lt(fi,n)}var Ur=null,rh=!1,rA=!1;function t2(e){Ur===null?Ur=[e]:Ur.push(e)}function yF(e){rh=!0,t2(e)}function ma(){if(!rA&&Ur!==null){rA=!0;var e=0,t=Vt;try{var n=Ur;for(Vt=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}Ur=null,rh=!1}catch(r){throw Ur!==null&&(Ur=Ur.slice(e+1)),BV(R0,ma),r}finally{Vt=t,rA=!1}}return null}var Ol=[],ql=0,qd=null,$d=0,ji=[],Ui=0,nl=null,Pr=1,_r="";function Ya(e,t){Ol[ql++]=$d,Ol[ql++]=qd,qd=e,$d=t}function n2(e,t,n){ji[Ui++]=Pr,ji[Ui++]=_r,ji[Ui++]=nl,nl=e;var i=Pr;e=_r;var r=32-dr(i)-1;i&=~(1<<r),n+=1;var o=32-dr(t)+r;if(30<o){var a=r-r%5;o=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Pr=1<<32-dr(t)+r|n<<r|i,_r=o+e}else Pr=1<<o|n<<r|i,_r=e}function N0(e){e.return!==null&&(Ya(e,1),n2(e,1,0))}function H0(e){for(;e===qd;)qd=Ol[--ql],Ol[ql]=null,$d=Ol[--ql],Ol[ql]=null;for(;e===nl;)nl=ji[--Ui],ji[Ui]=null,_r=ji[--Ui],ji[Ui]=null,Pr=ji[--Ui],ji[Ui]=null}var xi=null,wi=null,$t=!1,cr=null;function i2(e,t){var n=Pi(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Lv(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,xi=e,wi=$o(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,xi=e,wi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=nl!==null?{id:Pr,overflow:_r}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Pi(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,xi=e,wi=null,!0):!1;default:return!1}}function tp(e){return(e.mode&1)!==0&&(e.flags&128)===0}function np(e){if($t){var t=wi;if(t){var n=t;if(!Lv(e,t)){if(tp(e))throw Error(ue(418));t=$o(n.nextSibling);var i=xi;t&&Lv(e,t)?i2(i,n):(e.flags=e.flags&-4097|2,$t=!1,xi=e)}}else{if(tp(e))throw Error(ue(418));e.flags=e.flags&-4097|2,$t=!1,xi=e}}}function Dv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xi=e}function uI(e){if(e!==xi)return!1;if(!$t)return Dv(e),$t=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Of(e.type,e.memoizedProps)),t&&(t=wi)){if(tp(e))throw r2(),Error(ue(418));for(;t;)i2(e,t),t=$o(t.nextSibling)}if(Dv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ue(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){wi=$o(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}wi=null}}else wi=xi?$o(e.stateNode.nextSibling):null;return!0}function r2(){for(var e=wi;e;)e=$o(e.nextSibling)}function vs(){wi=xi=null,$t=!1}function F0(e){cr===null?cr=[e]:cr.push(e)}var ZF=go.ReactCurrentBatchConfig;function bg(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ue(309));var i=n.stateNode}if(!i)throw Error(ue(147,e));var r=i,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(a){var l=r.refs;a===null?delete l[o]:l[o]=a},t._stringRef=o,t)}if(typeof e!="string")throw Error(ue(284));if(!n._owner)throw Error(ue(290,e))}return e}function II(e,t){throw e=Object.prototype.toString.call(t),Error(ue(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Tv(e){var t=e._init;return t(e._payload)}function o2(e){function t(A,p){if(e){var y=A.deletions;y===null?(A.deletions=[p],A.flags|=16):y.push(p)}}function n(A,p){if(!e)return null;for(;p!==null;)t(A,p),p=p.sibling;return null}function i(A,p){for(A=new Map;p!==null;)p.key!==null?A.set(p.key,p):A.set(p.index,p),p=p.sibling;return A}function r(A,p){return A=ia(A,p),A.index=0,A.sibling=null,A}function o(A,p,y){return A.index=y,e?(y=A.alternate,y!==null?(y=y.index,y<p?(A.flags|=2,p):y):(A.flags|=2,p)):(A.flags|=1048576,p)}function a(A){return e&&A.alternate===null&&(A.flags|=2),A}function l(A,p,y,Z){return p===null||p.tag!==6?(p=uA(y,A.mode,Z),p.return=A,p):(p=r(p,y),p.return=A,p)}function s(A,p,y,Z){var G=y.type;return G===Tl?c(A,p,y.props.children,Z,y.key):p!==null&&(p.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===xo&&Tv(G)===p.type)?(Z=r(p,y.props),Z.ref=bg(A,p,y),Z.return=A,Z):(Z=Id(y.type,y.key,y.props,null,A.mode,Z),Z.ref=bg(A,p,y),Z.return=A,Z)}function g(A,p,y,Z){return p===null||p.tag!==4||p.stateNode.containerInfo!==y.containerInfo||p.stateNode.implementation!==y.implementation?(p=IA(y,A.mode,Z),p.return=A,p):(p=r(p,y.children||[]),p.return=A,p)}function c(A,p,y,Z,G){return p===null||p.tag!==7?(p=Pa(y,A.mode,Z,G),p.return=A,p):(p=r(p,y),p.return=A,p)}function u(A,p,y){if(typeof p=="string"&&p!==""||typeof p=="number")return p=uA(""+p,A.mode,y),p.return=A,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case tI:return y=Id(p.type,p.key,p.props,null,A.mode,y),y.ref=bg(A,null,p),y.return=A,y;case Dl:return p=IA(p,A.mode,y),p.return=A,p;case xo:var Z=p._init;return u(A,Z(p._payload),y)}if(Dg(p)||hg(p))return p=Pa(p,A.mode,y,null),p.return=A,p;II(A,p)}return null}function I(A,p,y,Z){var G=p!==null?p.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return G!==null?null:l(A,p,""+y,Z);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case tI:return y.key===G?s(A,p,y,Z):null;case Dl:return y.key===G?g(A,p,y,Z):null;case xo:return G=y._init,I(A,p,G(y._payload),Z)}if(Dg(y)||hg(y))return G!==null?null:c(A,p,y,Z,null);II(A,y)}return null}function C(A,p,y,Z,G){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return A=A.get(y)||null,l(p,A,""+Z,G);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case tI:return A=A.get(Z.key===null?y:Z.key)||null,s(p,A,Z,G);case Dl:return A=A.get(Z.key===null?y:Z.key)||null,g(p,A,Z,G);case xo:var v=Z._init;return C(A,p,y,v(Z._payload),G)}if(Dg(Z)||hg(Z))return A=A.get(y)||null,c(p,A,Z,G,null);II(p,Z)}return null}function m(A,p,y,Z){for(var G=null,v=null,B=p,R=p=0,X=null;B!==null&&R<y.length;R++){B.index>R?(X=B,B=null):X=B.sibling;var W=I(A,B,y[R],Z);if(W===null){B===null&&(B=X);break}e&&B&&W.alternate===null&&t(A,B),p=o(W,p,R),v===null?G=W:v.sibling=W,v=W,B=X}if(R===y.length)return n(A,B),$t&&Ya(A,R),G;if(B===null){for(;R<y.length;R++)B=u(A,y[R],Z),B!==null&&(p=o(B,p,R),v===null?G=B:v.sibling=B,v=B);return $t&&Ya(A,R),G}for(B=i(A,B);R<y.length;R++)X=C(B,A,R,y[R],Z),X!==null&&(e&&X.alternate!==null&&B.delete(X.key===null?R:X.key),p=o(X,p,R),v===null?G=X:v.sibling=X,v=X);return e&&B.forEach(function(V){return t(A,V)}),$t&&Ya(A,R),G}function f(A,p,y,Z){var G=hg(y);if(typeof G!="function")throw Error(ue(150));if(y=G.call(y),y==null)throw Error(ue(151));for(var v=G=null,B=p,R=p=0,X=null,W=y.next();B!==null&&!W.done;R++,W=y.next()){B.index>R?(X=B,B=null):X=B.sibling;var V=I(A,B,W.value,Z);if(V===null){B===null&&(B=X);break}e&&B&&V.alternate===null&&t(A,B),p=o(V,p,R),v===null?G=V:v.sibling=V,v=V,B=X}if(W.done)return n(A,B),$t&&Ya(A,R),G;if(B===null){for(;!W.done;R++,W=y.next())W=u(A,W.value,Z),W!==null&&(p=o(W,p,R),v===null?G=W:v.sibling=W,v=W);return $t&&Ya(A,R),G}for(B=i(A,B);!W.done;R++,W=y.next())W=C(B,A,R,W.value,Z),W!==null&&(e&&W.alternate!==null&&B.delete(W.key===null?R:W.key),p=o(W,p,R),v===null?G=W:v.sibling=W,v=W);return e&&B.forEach(function(Y){return t(A,Y)}),$t&&Ya(A,R),G}function b(A,p,y,Z){if(typeof y=="object"&&y!==null&&y.type===Tl&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case tI:e:{for(var G=y.key,v=p;v!==null;){if(v.key===G){if(G=y.type,G===Tl){if(v.tag===7){n(A,v.sibling),p=r(v,y.props.children),p.return=A,A=p;break e}}else if(v.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===xo&&Tv(G)===v.type){n(A,v.sibling),p=r(v,y.props),p.ref=bg(A,v,y),p.return=A,A=p;break e}n(A,v);break}else t(A,v);v=v.sibling}y.type===Tl?(p=Pa(y.props.children,A.mode,Z,y.key),p.return=A,A=p):(Z=Id(y.type,y.key,y.props,null,A.mode,Z),Z.ref=bg(A,p,y),Z.return=A,A=Z)}return a(A);case Dl:e:{for(v=y.key;p!==null;){if(p.key===v)if(p.tag===4&&p.stateNode.containerInfo===y.containerInfo&&p.stateNode.implementation===y.implementation){n(A,p.sibling),p=r(p,y.children||[]),p.return=A,A=p;break e}else{n(A,p);break}else t(A,p);p=p.sibling}p=IA(y,A.mode,Z),p.return=A,A=p}return a(A);case xo:return v=y._init,b(A,p,v(y._payload),Z)}if(Dg(y))return m(A,p,y,Z);if(hg(y))return f(A,p,y,Z);II(A,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,p!==null&&p.tag===6?(n(A,p.sibling),p=r(p,y),p.return=A,A=p):(n(A,p),p=uA(y,A.mode,Z),p.return=A,A=p),a(A)):n(A,p)}return b}var Gs=o2(!0),a2=o2(!1),eC=ha(null),tC=null,$l=null,K0=null;function E0(){K0=$l=tC=null}function M0(e){var t=eC.current;jt(eC),e._currentValue=t}function ip(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Is(e,t){tC=e,K0=$l=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ai=!0),e.firstContext=null)}function qi(e){var t=e._currentValue;if(K0!==e)if(e={context:e,memoizedValue:t,next:null},$l===null){if(tC===null)throw Error(ue(308));$l=e,tC.dependencies={lanes:0,firstContext:e}}else $l=$l.next=e;return t}var Ta=null;function z0(e){Ta===null?Ta=[e]:Ta.push(e)}function l2(e,t,n,i){var r=t.interleaved;return r===null?(n.next=n,z0(t)):(n.next=r.next,r.next=n),t.interleaved=n,lo(e,i)}function lo(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Xo=!1;function L0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function s2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function to(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ea(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,pt&2){var r=i.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),i.pending=t,lo(e,n)}return r=i.interleaved,r===null?(t.next=t,z0(i)):(t.next=r.next,r.next=t),i.interleaved=t,lo(e,n)}function ad(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,W0(e,n)}}function jv(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?r=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?r=o=t:o=o.next=t}else r=o=t;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function nC(e,t,n,i){var r=e.updateQueue;Xo=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var s=l,g=s.next;s.next=null,a===null?o=g:a.next=g,a=s;var c=e.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==a&&(l===null?c.firstBaseUpdate=g:l.next=g,c.lastBaseUpdate=s))}if(o!==null){var u=r.baseState;a=0,c=g=s=null,l=o;do{var I=l.lane,C=l.eventTime;if((i&I)===I){c!==null&&(c=c.next={eventTime:C,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,f=l;switch(I=t,C=n,f.tag){case 1:if(m=f.payload,typeof m=="function"){u=m.call(C,u,I);break e}u=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=f.payload,I=typeof m=="function"?m.call(C,u,I):m,I==null)break e;u=sn({},u,I);break e;case 2:Xo=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,I=r.effects,I===null?r.effects=[l]:I.push(l))}else C={eventTime:C,lane:I,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(g=c=C,s=u):c=c.next=C,a|=I;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;I=l,l=I.next,I.next=null,r.lastBaseUpdate=I,r.shared.pending=null}}while(!0);if(c===null&&(s=u),r.baseState=s,r.firstBaseUpdate=g,r.lastBaseUpdate=c,t=r.shared.interleaved,t!==null){r=t;do a|=r.lane,r=r.next;while(r!==t)}else o===null&&(r.shared.lanes=0);rl|=a,e.lanes=a,e.memoizedState=u}}function Uv(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(ue(191,r));r.call(i)}}}var Bu={},Hr=ha(Bu),Fc=ha(Bu),Kc=ha(Bu);function ja(e){if(e===Bu)throw Error(ue(174));return e}function D0(e,t){switch(Lt(Kc,t),Lt(Fc,e),Lt(Hr,Bu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Hf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Hf(t,e)}jt(Hr),Lt(Hr,t)}function Ss(){jt(Hr),jt(Fc),jt(Kc)}function g2(e){ja(Kc.current);var t=ja(Hr.current),n=Hf(t,e.type);t!==n&&(Lt(Fc,e),Lt(Hr,n))}function T0(e){Fc.current===e&&(jt(Hr),jt(Fc))}var on=ha(0);function iC(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var oA=[];function j0(){for(var e=0;e<oA.length;e++)oA[e]._workInProgressVersionPrimary=null;oA.length=0}var ld=go.ReactCurrentDispatcher,aA=go.ReactCurrentBatchConfig,il=0,ln=null,Zn=null,Vn=null,rC=!1,lc=!1,Ec=0,vF=0;function Dn(){throw Error(ue(321))}function U0(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!pr(e[n],t[n]))return!1;return!0}function Q0(e,t,n,i,r,o){if(il=o,ln=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ld.current=e===null||e.memoizedState===null?RF:WF,e=n(i,r),lc){o=0;do{if(lc=!1,Ec=0,25<=o)throw Error(ue(301));o+=1,Vn=Zn=null,t.updateQueue=null,ld.current=kF,e=n(i,r)}while(lc)}if(ld.current=oC,t=Zn!==null&&Zn.next!==null,il=0,Vn=Zn=ln=null,rC=!1,t)throw Error(ue(300));return e}function P0(){var e=Ec!==0;return Ec=0,e}function wr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?ln.memoizedState=Vn=e:Vn=Vn.next=e,Vn}function $i(){if(Zn===null){var e=ln.alternate;e=e!==null?e.memoizedState:null}else e=Zn.next;var t=Vn===null?ln.memoizedState:Vn.next;if(t!==null)Vn=t,Zn=e;else{if(e===null)throw Error(ue(310));Zn=e,e={memoizedState:Zn.memoizedState,baseState:Zn.baseState,baseQueue:Zn.baseQueue,queue:Zn.queue,next:null},Vn===null?ln.memoizedState=Vn=e:Vn=Vn.next=e}return Vn}function Mc(e,t){return typeof t=="function"?t(e):t}function lA(e){var t=$i(),n=t.queue;if(n===null)throw Error(ue(311));n.lastRenderedReducer=e;var i=Zn,r=i.baseQueue,o=n.pending;if(o!==null){if(r!==null){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(r!==null){o=r.next,i=i.baseState;var l=a=null,s=null,g=o;do{var c=g.lane;if((il&c)===c)s!==null&&(s=s.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),i=g.hasEagerState?g.eagerState:e(i,g.action);else{var u={lane:c,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};s===null?(l=s=u,a=i):s=s.next=u,ln.lanes|=c,rl|=c}g=g.next}while(g!==null&&g!==o);s===null?a=i:s.next=l,pr(i,t.memoizedState)||(Ai=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=s,n.lastRenderedState=i}if(e=n.interleaved,e!==null){r=e;do o=r.lane,ln.lanes|=o,rl|=o,r=r.next;while(r!==e)}else r===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function sA(e){var t=$i(),n=t.queue;if(n===null)throw Error(ue(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do o=e(o,a.action),a=a.next;while(a!==r);pr(o,t.memoizedState)||(Ai=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function c2(){}function u2(e,t){var n=ln,i=$i(),r=t(),o=!pr(i.memoizedState,r);if(o&&(i.memoizedState=r,Ai=!0),i=i.queue,_0(C2.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||Vn!==null&&Vn.memoizedState.tag&1){if(n.flags|=2048,zc(9,d2.bind(null,n,i,r,t),void 0,null),Jn===null)throw Error(ue(349));il&30||I2(n,t,r)}return r}function I2(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ln.updateQueue,t===null?(t={lastEffect:null,stores:null},ln.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function d2(e,t,n,i){t.value=n,t.getSnapshot=i,h2(t)&&m2(e)}function C2(e,t,n){return n(function(){h2(t)&&m2(e)})}function h2(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!pr(e,n)}catch{return!0}}function m2(e){var t=lo(e,1);t!==null&&Cr(t,e,1,-1)}function Qv(e){var t=wr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mc,lastRenderedState:e},t.queue=e,e=e.dispatch=BF.bind(null,ln,e),[t.memoizedState,e]}function zc(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=ln.updateQueue,t===null?(t={lastEffect:null,stores:null},ln.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function A2(){return $i().memoizedState}function sd(e,t,n,i){var r=wr();ln.flags|=e,r.memoizedState=zc(1|t,n,void 0,i===void 0?null:i)}function oh(e,t,n,i){var r=$i();i=i===void 0?null:i;var o=void 0;if(Zn!==null){var a=Zn.memoizedState;if(o=a.destroy,i!==null&&U0(i,a.deps)){r.memoizedState=zc(t,n,o,i);return}}ln.flags|=e,r.memoizedState=zc(1|t,n,o,i)}function Pv(e,t){return sd(8390656,8,e,t)}function _0(e,t){return oh(2048,8,e,t)}function f2(e,t){return oh(4,2,e,t)}function p2(e,t){return oh(4,4,e,t)}function b2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function y2(e,t,n){return n=n!=null?n.concat([e]):null,oh(4,4,b2.bind(null,t,e),n)}function O0(){}function Z2(e,t){var n=$i();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&U0(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function v2(e,t){var n=$i();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&U0(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function G2(e,t,n){return il&21?(pr(n,t)||(n=kV(),ln.lanes|=n,rl|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ai=!0),e.memoizedState=n)}function GF(e,t){var n=Vt;Vt=n!==0&&4>n?n:4,e(!0);var i=aA.transition;aA.transition={};try{e(!1),t()}finally{Vt=n,aA.transition=i}}function S2(){return $i().memoizedState}function SF(e,t,n){var i=na(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},B2(e))R2(t,n);else if(n=l2(e,t,n,i),n!==null){var r=li();Cr(n,e,i,r),W2(n,t,i)}}function BF(e,t,n){var i=na(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(B2(e))R2(t,r);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var a=t.lastRenderedState,l=o(a,n);if(r.hasEagerState=!0,r.eagerState=l,pr(l,a)){var s=t.interleaved;s===null?(r.next=r,z0(t)):(r.next=s.next,s.next=r),t.interleaved=r;return}}catch{}finally{}n=l2(e,t,r,i),n!==null&&(r=li(),Cr(n,e,i,r),W2(n,t,i))}}function B2(e){var t=e.alternate;return e===ln||t!==null&&t===ln}function R2(e,t){lc=rC=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function W2(e,t,n){if(n&4194240){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,W0(e,n)}}var oC={readContext:qi,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useInsertionEffect:Dn,useLayoutEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useMutableSource:Dn,useSyncExternalStore:Dn,useId:Dn,unstable_isNewReconciler:!1},RF={readContext:qi,useCallback:function(e,t){return wr().memoizedState=[e,t===void 0?null:t],e},useContext:qi,useEffect:Pv,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,sd(4194308,4,b2.bind(null,t,e),n)},useLayoutEffect:function(e,t){return sd(4194308,4,e,t)},useInsertionEffect:function(e,t){return sd(4,2,e,t)},useMemo:function(e,t){var n=wr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=wr();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=SF.bind(null,ln,e),[i.memoizedState,e]},useRef:function(e){var t=wr();return e={current:e},t.memoizedState=e},useState:Qv,useDebugValue:O0,useDeferredValue:function(e){return wr().memoizedState=e},useTransition:function(){var e=Qv(!1),t=e[0];return e=GF.bind(null,e[1]),wr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=ln,r=wr();if($t){if(n===void 0)throw Error(ue(407));n=n()}else{if(n=t(),Jn===null)throw Error(ue(349));il&30||I2(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,Pv(C2.bind(null,i,o,e),[e]),i.flags|=2048,zc(9,d2.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=wr(),t=Jn.identifierPrefix;if($t){var n=_r,i=Pr;n=(i&~(1<<32-dr(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ec++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=vF++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},WF={readContext:qi,useCallback:Z2,useContext:qi,useEffect:_0,useImperativeHandle:y2,useInsertionEffect:f2,useLayoutEffect:p2,useMemo:v2,useReducer:lA,useRef:A2,useState:function(){return lA(Mc)},useDebugValue:O0,useDeferredValue:function(e){var t=$i();return G2(t,Zn.memoizedState,e)},useTransition:function(){var e=lA(Mc)[0],t=$i().memoizedState;return[e,t]},useMutableSource:c2,useSyncExternalStore:u2,useId:S2,unstable_isNewReconciler:!1},kF={readContext:qi,useCallback:Z2,useContext:qi,useEffect:_0,useImperativeHandle:y2,useInsertionEffect:f2,useLayoutEffect:p2,useMemo:v2,useReducer:sA,useRef:A2,useState:function(){return sA(Mc)},useDebugValue:O0,useDeferredValue:function(e){var t=$i();return Zn===null?t.memoizedState=e:G2(t,Zn.memoizedState,e)},useTransition:function(){var e=sA(Mc)[0],t=$i().memoizedState;return[e,t]},useMutableSource:c2,useSyncExternalStore:u2,useId:S2,unstable_isNewReconciler:!1};function ar(e,t){if(e&&e.defaultProps){t=sn({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function rp(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:sn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ah={isMounted:function(e){return(e=e._reactInternals)?Il(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=li(),r=na(e),o=to(i,r);o.payload=t,n!=null&&(o.callback=n),t=ea(e,o,r),t!==null&&(Cr(t,e,r,i),ad(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=li(),r=na(e),o=to(i,r);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=ea(e,o,r),t!==null&&(Cr(t,e,r,i),ad(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=li(),i=na(e),r=to(n,i);r.tag=2,t!=null&&(r.callback=t),t=ea(e,r,i),t!==null&&(Cr(t,e,i,n),ad(t,e,i))}};function _v(e,t,n,i,r,o,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,o,a):t.prototype&&t.prototype.isPureReactComponent?!Jc(n,i)||!Jc(r,o):!0}function k2(e,t,n){var i=!1,r=sa,o=t.contextType;return typeof o=="object"&&o!==null?o=qi(o):(r=pi(t)?tl:qn.current,i=t.contextTypes,o=(i=i!=null)?Zs(e,r):sa),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ah,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=o),t}function Ov(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&ah.enqueueReplaceState(t,t.state,null)}function op(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},L0(e);var o=t.contextType;typeof o=="object"&&o!==null?r.context=qi(o):(o=pi(t)?tl:qn.current,r.context=Zs(e,o)),r.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(rp(e,t,o,n),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&ah.enqueueReplaceState(r,r.state,null),nC(e,n,r,i),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Bs(e,t){try{var n="",i=t;do n+=iH(i),i=i.return;while(i);var r=n}catch(o){r=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:r,digest:null}}function gA(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ap(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var VF=typeof WeakMap=="function"?WeakMap:Map;function V2(e,t,n){n=to(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){lC||(lC=!0,mp=i),ap(e,t)},n}function w2(e,t,n){n=to(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){ap(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){ap(e,t),typeof i!="function"&&(ta===null?ta=new Set([this]):ta.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function qv(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new VF;var r=new Set;i.set(t,r)}else r=i.get(t),r===void 0&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=DF.bind(null,e,t,n),t.then(e,e))}function $v(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function eG(e,t,n,i,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=to(-1,1),t.tag=2,ea(n,t,1))),n.lanes|=1),e)}var wF=go.ReactCurrentOwner,Ai=!1;function ri(e,t,n,i){t.child=e===null?a2(t,null,n,i):Gs(t,e.child,n,i)}function tG(e,t,n,i,r){n=n.render;var o=t.ref;return Is(t,r),i=Q0(e,t,n,i,o,r),n=P0(),e!==null&&!Ai?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,so(e,t,r)):($t&&n&&N0(t),t.flags|=1,ri(e,t,i,r),t.child)}function nG(e,t,n,i,r){if(e===null){var o=n.type;return typeof o=="function"&&!oy(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,x2(e,t,o,i,r)):(e=Id(n.type,null,i,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&r)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:Jc,n(a,i)&&e.ref===t.ref)return so(e,t,r)}return t.flags|=1,e=ia(o,i),e.ref=t.ref,e.return=t,t.child=e}function x2(e,t,n,i,r){if(e!==null){var o=e.memoizedProps;if(Jc(o,i)&&e.ref===t.ref)if(Ai=!1,t.pendingProps=i=o,(e.lanes&r)!==0)e.flags&131072&&(Ai=!0);else return t.lanes=e.lanes,so(e,t,r)}return lp(e,t,n,i,r)}function X2(e,t,n){var i=t.pendingProps,r=i.children,o=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Lt(ts,ki),ki|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Lt(ts,ki),ki|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=o!==null?o.baseLanes:n,Lt(ts,ki),ki|=i}else o!==null?(i=o.baseLanes|n,t.memoizedState=null):i=n,Lt(ts,ki),ki|=i;return ri(e,t,r,n),t.child}function J2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function lp(e,t,n,i,r){var o=pi(n)?tl:qn.current;return o=Zs(t,o),Is(t,r),n=Q0(e,t,n,i,o,r),i=P0(),e!==null&&!Ai?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,so(e,t,r)):($t&&i&&N0(t),t.flags|=1,ri(e,t,n,r),t.child)}function iG(e,t,n,i,r){if(pi(n)){var o=!0;Od(t)}else o=!1;if(Is(t,r),t.stateNode===null)gd(e,t),k2(t,n,i),op(t,n,i,r),i=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var s=a.context,g=n.contextType;typeof g=="object"&&g!==null?g=qi(g):(g=pi(n)?tl:qn.current,g=Zs(t,g));var c=n.getDerivedStateFromProps,u=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";u||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==i||s!==g)&&Ov(t,a,i,g),Xo=!1;var I=t.memoizedState;a.state=I,nC(t,i,a,r),s=t.memoizedState,l!==i||I!==s||fi.current||Xo?(typeof c=="function"&&(rp(t,n,c,i),s=t.memoizedState),(l=Xo||_v(t,n,l,i,I,s,g))?(u||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=s),a.props=i,a.state=s,a.context=g,i=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,s2(e,t),l=t.memoizedProps,g=t.type===t.elementType?l:ar(t.type,l),a.props=g,u=t.pendingProps,I=a.context,s=n.contextType,typeof s=="object"&&s!==null?s=qi(s):(s=pi(n)?tl:qn.current,s=Zs(t,s));var C=n.getDerivedStateFromProps;(c=typeof C=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==u||I!==s)&&Ov(t,a,i,s),Xo=!1,I=t.memoizedState,a.state=I,nC(t,i,a,r);var m=t.memoizedState;l!==u||I!==m||fi.current||Xo?(typeof C=="function"&&(rp(t,n,C,i),m=t.memoizedState),(g=Xo||_v(t,n,g,i,I,m,s)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,m,s),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,m,s)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&I===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&I===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=m),a.props=i,a.state=m,a.context=s,i=g):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&I===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&I===e.memoizedState||(t.flags|=1024),i=!1)}return sp(e,t,n,i,o,r)}function sp(e,t,n,i,r,o){J2(e,t);var a=(t.flags&128)!==0;if(!i&&!a)return r&&zv(t,n,!1),so(e,t,o);i=t.stateNode,wF.current=t;var l=a&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&a?(t.child=Gs(t,e.child,null,o),t.child=Gs(t,null,l,o)):ri(e,t,l,o),t.memoizedState=i.state,r&&zv(t,n,!0),t.child}function Y2(e){var t=e.stateNode;t.pendingContext?Mv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Mv(e,t.context,!1),D0(e,t.containerInfo)}function rG(e,t,n,i,r){return vs(),F0(r),t.flags|=256,ri(e,t,n,i),t.child}var gp={dehydrated:null,treeContext:null,retryLane:0};function cp(e){return{baseLanes:e,cachePool:null,transitions:null}}function N2(e,t,n){var i=t.pendingProps,r=on.current,o=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(r&2)!==0),l?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),Lt(on,r&1),e===null)return np(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=i.children,e=i.fallback,o?(i=t.mode,o=t.child,a={mode:"hidden",children:a},!(i&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=gh(a,i,0,null),e=Pa(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=cp(n),t.memoizedState=gp,e):q0(t,a));if(r=e.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return xF(e,t,a,i,l,r,n);if(o){o=i.fallback,a=t.mode,r=e.child,l=r.sibling;var s={mode:"hidden",children:i.children};return!(a&1)&&t.child!==r?(i=t.child,i.childLanes=0,i.pendingProps=s,t.deletions=null):(i=ia(r,s),i.subtreeFlags=r.subtreeFlags&14680064),l!==null?o=ia(l,o):(o=Pa(o,a,n,null),o.flags|=2),o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,a=e.child.memoizedState,a=a===null?cp(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=e.childLanes&~n,t.memoizedState=gp,i}return o=e.child,e=o.sibling,i=ia(o,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function q0(e,t){return t=gh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function dI(e,t,n,i){return i!==null&&F0(i),Gs(t,e.child,null,n),e=q0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function xF(e,t,n,i,r,o,a){if(n)return t.flags&256?(t.flags&=-257,i=gA(Error(ue(422))),dI(e,t,a,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=i.fallback,r=t.mode,i=gh({mode:"visible",children:i.children},r,0,null),o=Pa(o,r,a,null),o.flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,t.mode&1&&Gs(t,e.child,null,a),t.child.memoizedState=cp(a),t.memoizedState=gp,o);if(!(t.mode&1))return dI(e,t,a,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var l=i.dgst;return i=l,o=Error(ue(419)),i=gA(o,i,void 0),dI(e,t,a,i)}if(l=(a&e.childLanes)!==0,Ai||l){if(i=Jn,i!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|a)?0:r,r!==0&&r!==o.retryLane&&(o.retryLane=r,lo(e,r),Cr(i,e,r,-1))}return ry(),i=gA(Error(ue(421))),dI(e,t,a,i)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=TF.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,wi=$o(r.nextSibling),xi=t,$t=!0,cr=null,e!==null&&(ji[Ui++]=Pr,ji[Ui++]=_r,ji[Ui++]=nl,Pr=e.id,_r=e.overflow,nl=t),t=q0(t,i.children),t.flags|=4096,t)}function oG(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),ip(e.return,t,n)}function cA(e,t,n,i,r){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r)}function H2(e,t,n){var i=t.pendingProps,r=i.revealOrder,o=i.tail;if(ri(e,t,i.children,n),i=on.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&oG(e,n,t);else if(e.tag===19)oG(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Lt(on,i),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&iC(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),cA(t,!1,r,n,o);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&iC(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}cA(t,!0,n,null,o);break;case"together":cA(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function gd(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function so(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),rl|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ue(153));if(t.child!==null){for(e=t.child,n=ia(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ia(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function XF(e,t,n){switch(t.tag){case 3:Y2(t),vs();break;case 5:g2(t);break;case 1:pi(t.type)&&Od(t);break;case 4:D0(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Lt(eC,i._currentValue),i._currentValue=r;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(Lt(on,on.current&1),t.flags|=128,null):n&t.child.childLanes?N2(e,t,n):(Lt(on,on.current&1),e=so(e,t,n),e!==null?e.sibling:null);Lt(on,on.current&1);break;case 19:if(i=(n&t.childLanes)!==0,e.flags&128){if(i)return H2(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Lt(on,on.current),i)break;return null;case 22:case 23:return t.lanes=0,X2(e,t,n)}return so(e,t,n)}var F2,up,K2,E2;F2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};up=function(){};K2=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,ja(Hr.current);var o=null;switch(n){case"input":r=Xf(e,r),i=Xf(e,i),o=[];break;case"select":r=sn({},r,{value:void 0}),i=sn({},i,{value:void 0}),o=[];break;case"textarea":r=Nf(e,r),i=Nf(e,i),o=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=Pd)}Ff(n,i);var a;n=null;for(g in r)if(!i.hasOwnProperty(g)&&r.hasOwnProperty(g)&&r[g]!=null)if(g==="style"){var l=r[g];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else g!=="dangerouslySetInnerHTML"&&g!=="children"&&g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(Rc.hasOwnProperty(g)?o||(o=[]):(o=o||[]).push(g,null));for(g in i){var s=i[g];if(l=r!=null?r[g]:void 0,i.hasOwnProperty(g)&&s!==l&&(s!=null||l!=null))if(g==="style")if(l){for(a in l)!l.hasOwnProperty(a)||s&&s.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in s)s.hasOwnProperty(a)&&l[a]!==s[a]&&(n||(n={}),n[a]=s[a])}else n||(o||(o=[]),o.push(g,n)),n=s;else g==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,l=l?l.__html:void 0,s!=null&&l!==s&&(o=o||[]).push(g,s)):g==="children"?typeof s!="string"&&typeof s!="number"||(o=o||[]).push(g,""+s):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&(Rc.hasOwnProperty(g)?(s!=null&&g==="onScroll"&&Tt("scroll",e),o||l===s||(o=[])):(o=o||[]).push(g,s))}n&&(o=o||[]).push("style",n);var g=o;(t.updateQueue=g)&&(t.flags|=4)}};E2=function(e,t,n,i){n!==i&&(t.flags|=4)};function yg(e,t){if(!$t)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Tn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function JF(e,t,n){var i=t.pendingProps;switch(H0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tn(t),null;case 1:return pi(t.type)&&_d(),Tn(t),null;case 3:return i=t.stateNode,Ss(),jt(fi),jt(qn),j0(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(uI(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,cr!==null&&(pp(cr),cr=null))),up(e,t),Tn(t),null;case 5:T0(t);var r=ja(Kc.current);if(n=t.type,e!==null&&t.stateNode!=null)K2(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(ue(166));return Tn(t),null}if(e=ja(Hr.current),uI(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[Yr]=t,i[Hc]=o,e=(t.mode&1)!==0,n){case"dialog":Tt("cancel",i),Tt("close",i);break;case"iframe":case"object":case"embed":Tt("load",i);break;case"video":case"audio":for(r=0;r<jg.length;r++)Tt(jg[r],i);break;case"source":Tt("error",i);break;case"img":case"image":case"link":Tt("error",i),Tt("load",i);break;case"details":Tt("toggle",i);break;case"input":Cv(i,o),Tt("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Tt("invalid",i);break;case"textarea":mv(i,o),Tt("invalid",i)}Ff(n,o),r=null;for(var a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="children"?typeof l=="string"?i.textContent!==l&&(o.suppressHydrationWarning!==!0&&cI(i.textContent,l,e),r=["children",l]):typeof l=="number"&&i.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&cI(i.textContent,l,e),r=["children",""+l]):Rc.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Tt("scroll",i)}switch(n){case"input":nI(i),hv(i,o,!0);break;case"textarea":nI(i),Av(i);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(i.onclick=Pd)}i=r,t.updateQueue=i,i!==null&&(t.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=CV(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=a.createElement(n,{is:i.is}):(e=a.createElement(n),n==="select"&&(a=e,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):e=a.createElementNS(e,n),e[Yr]=t,e[Hc]=i,F2(e,t,!1,!1),t.stateNode=e;e:{switch(a=Kf(n,i),n){case"dialog":Tt("cancel",e),Tt("close",e),r=i;break;case"iframe":case"object":case"embed":Tt("load",e),r=i;break;case"video":case"audio":for(r=0;r<jg.length;r++)Tt(jg[r],e);r=i;break;case"source":Tt("error",e),r=i;break;case"img":case"image":case"link":Tt("error",e),Tt("load",e),r=i;break;case"details":Tt("toggle",e),r=i;break;case"input":Cv(e,i),r=Xf(e,i),Tt("invalid",e);break;case"option":r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=sn({},i,{value:void 0}),Tt("invalid",e);break;case"textarea":mv(e,i),r=Nf(e,i),Tt("invalid",e);break;default:r=i}Ff(n,r),l=r;for(o in l)if(l.hasOwnProperty(o)){var s=l[o];o==="style"?AV(e,s):o==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,s!=null&&hV(e,s)):o==="children"?typeof s=="string"?(n!=="textarea"||s!=="")&&Wc(e,s):typeof s=="number"&&Wc(e,""+s):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Rc.hasOwnProperty(o)?s!=null&&o==="onScroll"&&Tt("scroll",e):s!=null&&Z0(e,o,s,a))}switch(n){case"input":nI(e),hv(e,i,!1);break;case"textarea":nI(e),Av(e);break;case"option":i.value!=null&&e.setAttribute("value",""+la(i.value));break;case"select":e.multiple=!!i.multiple,o=i.value,o!=null?ss(e,!!i.multiple,o,!1):i.defaultValue!=null&&ss(e,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=Pd)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Tn(t),null;case 6:if(e&&t.stateNode!=null)E2(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(ue(166));if(n=ja(Kc.current),ja(Hr.current),uI(t)){if(i=t.stateNode,n=t.memoizedProps,i[Yr]=t,(o=i.nodeValue!==n)&&(e=xi,e!==null))switch(e.tag){case 3:cI(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&cI(i.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Yr]=t,t.stateNode=i}return Tn(t),null;case 13:if(jt(on),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($t&&wi!==null&&t.mode&1&&!(t.flags&128))r2(),vs(),t.flags|=98560,o=!1;else if(o=uI(t),i!==null&&i.dehydrated!==null){if(e===null){if(!o)throw Error(ue(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ue(317));o[Yr]=t}else vs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Tn(t),o=!1}else cr!==null&&(pp(cr),cr=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||on.current&1?Gn===0&&(Gn=3):ry())),t.updateQueue!==null&&(t.flags|=4),Tn(t),null);case 4:return Ss(),up(e,t),e===null&&Yc(t.stateNode.containerInfo),Tn(t),null;case 10:return M0(t.type._context),Tn(t),null;case 17:return pi(t.type)&&_d(),Tn(t),null;case 19:if(jt(on),o=t.memoizedState,o===null)return Tn(t),null;if(i=(t.flags&128)!==0,a=o.rendering,a===null)if(i)yg(o,!1);else{if(Gn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=iC(e),a!==null){for(t.flags|=128,yg(o,!1),i=a.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)o=n,e=i,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,e=a.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Lt(on,on.current&1|2),t.child}e=e.sibling}o.tail!==null&&Cn()>Rs&&(t.flags|=128,i=!0,yg(o,!1),t.lanes=4194304)}else{if(!i)if(e=iC(a),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),yg(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!$t)return Tn(t),null}else 2*Cn()-o.renderingStartTime>Rs&&n!==1073741824&&(t.flags|=128,i=!0,yg(o,!1),t.lanes=4194304);o.isBackwards?(a.sibling=t.child,t.child=a):(n=o.last,n!==null?n.sibling=a:t.child=a,o.last=a)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Cn(),t.sibling=null,n=on.current,Lt(on,i?n&1|2:n&1),t):(Tn(t),null);case 22:case 23:return iy(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?ki&1073741824&&(Tn(t),t.subtreeFlags&6&&(t.flags|=8192)):Tn(t),null;case 24:return null;case 25:return null}throw Error(ue(156,t.tag))}function YF(e,t){switch(H0(t),t.tag){case 1:return pi(t.type)&&_d(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ss(),jt(fi),jt(qn),j0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return T0(t),null;case 13:if(jt(on),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ue(340));vs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return jt(on),null;case 4:return Ss(),null;case 10:return M0(t.type._context),null;case 22:case 23:return iy(),null;case 24:return null;default:return null}}var CI=!1,Qn=!1,NF=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function es(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){In(e,t,i)}else n.current=null}function Ip(e,t,n){try{n()}catch(i){In(e,t,i)}}var aG=!1;function HF(e,t){if(Pf=jd,e=TV(),Y0(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,l=-1,s=-1,g=0,c=0,u=e,I=null;t:for(;;){for(var C;u!==n||r!==0&&u.nodeType!==3||(l=a+r),u!==o||i!==0&&u.nodeType!==3||(s=a+i),u.nodeType===3&&(a+=u.nodeValue.length),(C=u.firstChild)!==null;)I=u,u=C;for(;;){if(u===e)break t;if(I===n&&++g===r&&(l=a),I===o&&++c===i&&(s=a),(C=u.nextSibling)!==null)break;u=I,I=u.parentNode}u=C}n=l===-1||s===-1?null:{start:l,end:s}}else n=null}n=n||{start:0,end:0}}else n=null;for(_f={focusedElem:e,selectionRange:n},jd=!1,Ne=t;Ne!==null;)if(t=Ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ne=e;else for(;Ne!==null;){t=Ne;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var f=m.memoizedProps,b=m.memoizedState,A=t.stateNode,p=A.getSnapshotBeforeUpdate(t.elementType===t.type?f:ar(t.type,f),b);A.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ue(163))}}catch(Z){In(t,t.return,Z)}if(e=t.sibling,e!==null){e.return=t.return,Ne=e;break}Ne=t.return}return m=aG,aG=!1,m}function sc(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&e)===e){var o=r.destroy;r.destroy=void 0,o!==void 0&&Ip(t,n,o)}r=r.next}while(r!==i)}}function lh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function dp(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function M2(e){var t=e.alternate;t!==null&&(e.alternate=null,M2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Yr],delete t[Hc],delete t[$f],delete t[pF],delete t[bF])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function z2(e){return e.tag===5||e.tag===3||e.tag===4}function lG(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||z2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Cp(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Pd));else if(i!==4&&(e=e.child,e!==null))for(Cp(e,t,n),e=e.sibling;e!==null;)Cp(e,t,n),e=e.sibling}function hp(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(hp(e,t,n),e=e.sibling;e!==null;)hp(e,t,n),e=e.sibling}var Fn=null,lr=!1;function vo(e,t,n){for(n=n.child;n!==null;)L2(e,t,n),n=n.sibling}function L2(e,t,n){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount($C,n)}catch{}switch(n.tag){case 5:Qn||es(n,t);case 6:var i=Fn,r=lr;Fn=null,vo(e,t,n),Fn=i,lr=r,Fn!==null&&(lr?(e=Fn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Fn.removeChild(n.stateNode));break;case 18:Fn!==null&&(lr?(e=Fn,n=n.stateNode,e.nodeType===8?iA(e.parentNode,n):e.nodeType===1&&iA(e,n),xc(e)):iA(Fn,n.stateNode));break;case 4:i=Fn,r=lr,Fn=n.stateNode.containerInfo,lr=!0,vo(e,t,n),Fn=i,lr=r;break;case 0:case 11:case 14:case 15:if(!Qn&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var o=r,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&Ip(n,t,a),r=r.next}while(r!==i)}vo(e,t,n);break;case 1:if(!Qn&&(es(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(l){In(n,t,l)}vo(e,t,n);break;case 21:vo(e,t,n);break;case 22:n.mode&1?(Qn=(i=Qn)||n.memoizedState!==null,vo(e,t,n),Qn=i):vo(e,t,n);break;default:vo(e,t,n)}}function sG(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new NF),t.forEach(function(i){var r=jF.bind(null,e,i);n.has(i)||(n.add(i),i.then(r,r))})}}function or(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var o=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:Fn=l.stateNode,lr=!1;break e;case 3:Fn=l.stateNode.containerInfo,lr=!0;break e;case 4:Fn=l.stateNode.containerInfo,lr=!0;break e}l=l.return}if(Fn===null)throw Error(ue(160));L2(o,a,r),Fn=null,lr=!1;var s=r.alternate;s!==null&&(s.return=null),r.return=null}catch(g){In(r,t,g)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)D2(t,e),t=t.sibling}function D2(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(or(t,e),Rr(e),i&4){try{sc(3,e,e.return),lh(3,e)}catch(f){In(e,e.return,f)}try{sc(5,e,e.return)}catch(f){In(e,e.return,f)}}break;case 1:or(t,e),Rr(e),i&512&&n!==null&&es(n,n.return);break;case 5:if(or(t,e),Rr(e),i&512&&n!==null&&es(n,n.return),e.flags&32){var r=e.stateNode;try{Wc(r,"")}catch(f){In(e,e.return,f)}}if(i&4&&(r=e.stateNode,r!=null)){var o=e.memoizedProps,a=n!==null?n.memoizedProps:o,l=e.type,s=e.updateQueue;if(e.updateQueue=null,s!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&IV(r,o),Kf(l,a);var g=Kf(l,o);for(a=0;a<s.length;a+=2){var c=s[a],u=s[a+1];c==="style"?AV(r,u):c==="dangerouslySetInnerHTML"?hV(r,u):c==="children"?Wc(r,u):Z0(r,c,u,g)}switch(l){case"input":Jf(r,o);break;case"textarea":dV(r,o);break;case"select":var I=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var C=o.value;C!=null?ss(r,!!o.multiple,C,!1):I!==!!o.multiple&&(o.defaultValue!=null?ss(r,!!o.multiple,o.defaultValue,!0):ss(r,!!o.multiple,o.multiple?[]:"",!1))}r[Hc]=o}catch(f){In(e,e.return,f)}}break;case 6:if(or(t,e),Rr(e),i&4){if(e.stateNode===null)throw Error(ue(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(f){In(e,e.return,f)}}break;case 3:if(or(t,e),Rr(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{xc(t.containerInfo)}catch(f){In(e,e.return,f)}break;case 4:or(t,e),Rr(e);break;case 13:or(t,e),Rr(e),r=e.child,r.flags&8192&&(o=r.memoizedState!==null,r.stateNode.isHidden=o,!o||r.alternate!==null&&r.alternate.memoizedState!==null||(ty=Cn())),i&4&&sG(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(Qn=(g=Qn)||c,or(t,e),Qn=g):or(t,e),Rr(e),i&8192){if(g=e.memoizedState!==null,(e.stateNode.isHidden=g)&&!c&&e.mode&1)for(Ne=e,c=e.child;c!==null;){for(u=Ne=c;Ne!==null;){switch(I=Ne,C=I.child,I.tag){case 0:case 11:case 14:case 15:sc(4,I,I.return);break;case 1:es(I,I.return);var m=I.stateNode;if(typeof m.componentWillUnmount=="function"){i=I,n=I.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(f){In(i,n,f)}}break;case 5:es(I,I.return);break;case 22:if(I.memoizedState!==null){cG(u);continue}}C!==null?(C.return=I,Ne=C):cG(u)}c=c.sibling}e:for(c=null,u=e;;){if(u.tag===5){if(c===null){c=u;try{r=u.stateNode,g?(o=r.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=u.stateNode,s=u.memoizedProps.style,a=s!=null&&s.hasOwnProperty("display")?s.display:null,l.style.display=mV("display",a))}catch(f){In(e,e.return,f)}}}else if(u.tag===6){if(c===null)try{u.stateNode.nodeValue=g?"":u.memoizedProps}catch(f){In(e,e.return,f)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;c===u&&(c=null),u=u.return}c===u&&(c=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:or(t,e),Rr(e),i&4&&sG(e);break;case 21:break;default:or(t,e),Rr(e)}}function Rr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(z2(n)){var i=n;break e}n=n.return}throw Error(ue(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Wc(r,""),i.flags&=-33);var o=lG(e);hp(e,o,r);break;case 3:case 4:var a=i.stateNode.containerInfo,l=lG(e);Cp(e,l,a);break;default:throw Error(ue(161))}}catch(s){In(e,e.return,s)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function FF(e,t,n){Ne=e,T2(e)}function T2(e,t,n){for(var i=(e.mode&1)!==0;Ne!==null;){var r=Ne,o=r.child;if(r.tag===22&&i){var a=r.memoizedState!==null||CI;if(!a){var l=r.alternate,s=l!==null&&l.memoizedState!==null||Qn;l=CI;var g=Qn;if(CI=a,(Qn=s)&&!g)for(Ne=r;Ne!==null;)a=Ne,s=a.child,a.tag===22&&a.memoizedState!==null?uG(r):s!==null?(s.return=a,Ne=s):uG(r);for(;o!==null;)Ne=o,T2(o),o=o.sibling;Ne=r,CI=l,Qn=g}gG(e)}else r.subtreeFlags&8772&&o!==null?(o.return=r,Ne=o):gG(e)}}function gG(e){for(;Ne!==null;){var t=Ne;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Qn||lh(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!Qn)if(n===null)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:ar(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&Uv(t,o,i);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Uv(t,a,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var s=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":s.autoFocus&&n.focus();break;case"img":s.src&&(n.src=s.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var g=t.alternate;if(g!==null){var c=g.memoizedState;if(c!==null){var u=c.dehydrated;u!==null&&xc(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ue(163))}Qn||t.flags&512&&dp(t)}catch(I){In(t,t.return,I)}}if(t===e){Ne=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ne=n;break}Ne=t.return}}function cG(e){for(;Ne!==null;){var t=Ne;if(t===e){Ne=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ne=n;break}Ne=t.return}}function uG(e){for(;Ne!==null;){var t=Ne;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{lh(4,t)}catch(s){In(t,n,s)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var r=t.return;try{i.componentDidMount()}catch(s){In(t,r,s)}}var o=t.return;try{dp(t)}catch(s){In(t,o,s)}break;case 5:var a=t.return;try{dp(t)}catch(s){In(t,a,s)}}}catch(s){In(t,t.return,s)}if(t===e){Ne=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Ne=l;break}Ne=t.return}}var KF=Math.ceil,aC=go.ReactCurrentDispatcher,$0=go.ReactCurrentOwner,Oi=go.ReactCurrentBatchConfig,pt=0,Jn=null,pn=null,Mn=0,ki=0,ts=ha(0),Gn=0,Lc=null,rl=0,sh=0,ey=0,gc=null,di=null,ty=0,Rs=1/0,Tr=null,lC=!1,mp=null,ta=null,hI=!1,Mo=null,sC=0,cc=0,Ap=null,cd=-1,ud=0;function li(){return pt&6?Cn():cd!==-1?cd:cd=Cn()}function na(e){return e.mode&1?pt&2&&Mn!==0?Mn&-Mn:ZF.transition!==null?(ud===0&&(ud=kV()),ud):(e=Vt,e!==0||(e=window.event,e=e===void 0?16:NV(e.type)),e):1}function Cr(e,t,n,i){if(50<cc)throw cc=0,Ap=null,Error(ue(185));vu(e,n,i),(!(pt&2)||e!==Jn)&&(e===Jn&&(!(pt&2)&&(sh|=n),Gn===4&&Fo(e,Mn)),bi(e,i),n===1&&pt===0&&!(t.mode&1)&&(Rs=Cn()+500,rh&&ma()))}function bi(e,t){var n=e.callbackNode;ZH(e,t);var i=Td(e,e===Jn?Mn:0);if(i===0)n!==null&&bv(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&bv(n),t===1)e.tag===0?yF(IG.bind(null,e)):t2(IG.bind(null,e)),AF(function(){!(pt&6)&&ma()}),n=null;else{switch(VV(i)){case 1:n=R0;break;case 4:n=RV;break;case 16:n=Dd;break;case 536870912:n=WV;break;default:n=Dd}n=$2(n,j2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function j2(e,t){if(cd=-1,ud=0,pt&6)throw Error(ue(327));var n=e.callbackNode;if(ds()&&e.callbackNode!==n)return null;var i=Td(e,e===Jn?Mn:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=gC(e,i);else{t=i;var r=pt;pt|=2;var o=Q2();(Jn!==e||Mn!==t)&&(Tr=null,Rs=Cn()+500,Qa(e,t));do try{zF();break}catch(l){U2(e,l)}while(!0);E0(),aC.current=o,pt=r,pn!==null?t=0:(Jn=null,Mn=0,t=Gn)}if(t!==0){if(t===2&&(r=Df(e),r!==0&&(i=r,t=fp(e,r))),t===1)throw n=Lc,Qa(e,0),Fo(e,i),bi(e,Cn()),n;if(t===6)Fo(e,i);else{if(r=e.current.alternate,!(i&30)&&!EF(r)&&(t=gC(e,i),t===2&&(o=Df(e),o!==0&&(i=o,t=fp(e,o))),t===1))throw n=Lc,Qa(e,0),Fo(e,i),bi(e,Cn()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(ue(345));case 2:Na(e,di,Tr);break;case 3:if(Fo(e,i),(i&130023424)===i&&(t=ty+500-Cn(),10<t)){if(Td(e,0)!==0)break;if(r=e.suspendedLanes,(r&i)!==i){li(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=qf(Na.bind(null,e,di,Tr),t);break}Na(e,di,Tr);break;case 4:if(Fo(e,i),(i&4194240)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-dr(i);o=1<<a,a=t[a],a>r&&(r=a),i&=~o}if(i=r,i=Cn()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*KF(i/1960))-i,10<i){e.timeoutHandle=qf(Na.bind(null,e,di,Tr),i);break}Na(e,di,Tr);break;case 5:Na(e,di,Tr);break;default:throw Error(ue(329))}}}return bi(e,Cn()),e.callbackNode===n?j2.bind(null,e):null}function fp(e,t){var n=gc;return e.current.memoizedState.isDehydrated&&(Qa(e,t).flags|=256),e=gC(e,t),e!==2&&(t=di,di=n,t!==null&&pp(t)),e}function pp(e){di===null?di=e:di.push.apply(di,e)}function EF(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!pr(o(),r))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Fo(e,t){for(t&=~ey,t&=~sh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-dr(t),i=1<<n;e[n]=-1,t&=~i}}function IG(e){if(pt&6)throw Error(ue(327));ds();var t=Td(e,0);if(!(t&1))return bi(e,Cn()),null;var n=gC(e,t);if(e.tag!==0&&n===2){var i=Df(e);i!==0&&(t=i,n=fp(e,i))}if(n===1)throw n=Lc,Qa(e,0),Fo(e,t),bi(e,Cn()),n;if(n===6)throw Error(ue(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Na(e,di,Tr),bi(e,Cn()),null}function ny(e,t){var n=pt;pt|=1;try{return e(t)}finally{pt=n,pt===0&&(Rs=Cn()+500,rh&&ma())}}function ol(e){Mo!==null&&Mo.tag===0&&!(pt&6)&&ds();var t=pt;pt|=1;var n=Oi.transition,i=Vt;try{if(Oi.transition=null,Vt=1,e)return e()}finally{Vt=i,Oi.transition=n,pt=t,!(pt&6)&&ma()}}function iy(){ki=ts.current,jt(ts)}function Qa(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,mF(n)),pn!==null)for(n=pn.return;n!==null;){var i=n;switch(H0(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&_d();break;case 3:Ss(),jt(fi),jt(qn),j0();break;case 5:T0(i);break;case 4:Ss();break;case 13:jt(on);break;case 19:jt(on);break;case 10:M0(i.type._context);break;case 22:case 23:iy()}n=n.return}if(Jn=e,pn=e=ia(e.current,null),Mn=ki=t,Gn=0,Lc=null,ey=sh=rl=0,di=gc=null,Ta!==null){for(t=0;t<Ta.length;t++)if(n=Ta[t],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,o=n.pending;if(o!==null){var a=o.next;o.next=r,i.next=a}n.pending=i}Ta=null}return e}function U2(e,t){do{var n=pn;try{if(E0(),ld.current=oC,rC){for(var i=ln.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}rC=!1}if(il=0,Vn=Zn=ln=null,lc=!1,Ec=0,$0.current=null,n===null||n.return===null){Gn=1,Lc=t,pn=null;break}e:{var o=e,a=n.return,l=n,s=t;if(t=Mn,l.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){var g=s,c=l,u=c.tag;if(!(c.mode&1)&&(u===0||u===11||u===15)){var I=c.alternate;I?(c.updateQueue=I.updateQueue,c.memoizedState=I.memoizedState,c.lanes=I.lanes):(c.updateQueue=null,c.memoizedState=null)}var C=$v(a);if(C!==null){C.flags&=-257,eG(C,a,l,o,t),C.mode&1&&qv(o,g,t),t=C,s=g;var m=t.updateQueue;if(m===null){var f=new Set;f.add(s),t.updateQueue=f}else m.add(s);break e}else{if(!(t&1)){qv(o,g,t),ry();break e}s=Error(ue(426))}}else if($t&&l.mode&1){var b=$v(a);if(b!==null){!(b.flags&65536)&&(b.flags|=256),eG(b,a,l,o,t),F0(Bs(s,l));break e}}o=s=Bs(s,l),Gn!==4&&(Gn=2),gc===null?gc=[o]:gc.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var A=V2(o,s,t);jv(o,A);break e;case 1:l=s;var p=o.type,y=o.stateNode;if(!(o.flags&128)&&(typeof p.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ta===null||!ta.has(y)))){o.flags|=65536,t&=-t,o.lanes|=t;var Z=w2(o,l,t);jv(o,Z);break e}}o=o.return}while(o!==null)}_2(n)}catch(G){t=G,pn===n&&n!==null&&(pn=n=n.return);continue}break}while(!0)}function Q2(){var e=aC.current;return aC.current=oC,e===null?oC:e}function ry(){(Gn===0||Gn===3||Gn===2)&&(Gn=4),Jn===null||!(rl&268435455)&&!(sh&268435455)||Fo(Jn,Mn)}function gC(e,t){var n=pt;pt|=2;var i=Q2();(Jn!==e||Mn!==t)&&(Tr=null,Qa(e,t));do try{MF();break}catch(r){U2(e,r)}while(!0);if(E0(),pt=n,aC.current=i,pn!==null)throw Error(ue(261));return Jn=null,Mn=0,Gn}function MF(){for(;pn!==null;)P2(pn)}function zF(){for(;pn!==null&&!dH();)P2(pn)}function P2(e){var t=q2(e.alternate,e,ki);e.memoizedProps=e.pendingProps,t===null?_2(e):pn=t,$0.current=null}function _2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=YF(n,t),n!==null){n.flags&=32767,pn=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Gn=6,pn=null;return}}else if(n=JF(n,t,ki),n!==null){pn=n;return}if(t=t.sibling,t!==null){pn=t;return}pn=t=e}while(t!==null);Gn===0&&(Gn=5)}function Na(e,t,n){var i=Vt,r=Oi.transition;try{Oi.transition=null,Vt=1,LF(e,t,n,i)}finally{Oi.transition=r,Vt=i}return null}function LF(e,t,n,i){do ds();while(Mo!==null);if(pt&6)throw Error(ue(327));n=e.finishedWork;var r=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ue(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(vH(e,o),e===Jn&&(pn=Jn=null,Mn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||hI||(hI=!0,$2(Dd,function(){return ds(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Oi.transition,Oi.transition=null;var a=Vt;Vt=1;var l=pt;pt|=4,$0.current=null,HF(e,n),D2(n,e),gF(_f),jd=!!Pf,_f=Pf=null,e.current=n,FF(n),CH(),pt=l,Vt=a,Oi.transition=o}else e.current=n;if(hI&&(hI=!1,Mo=e,sC=r),o=e.pendingLanes,o===0&&(ta=null),AH(n.stateNode),bi(e,Cn()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(lC)throw lC=!1,e=mp,mp=null,e;return sC&1&&e.tag!==0&&ds(),o=e.pendingLanes,o&1?e===Ap?cc++:(cc=0,Ap=e):cc=0,ma(),null}function ds(){if(Mo!==null){var e=VV(sC),t=Oi.transition,n=Vt;try{if(Oi.transition=null,Vt=16>e?16:e,Mo===null)var i=!1;else{if(e=Mo,Mo=null,sC=0,pt&6)throw Error(ue(331));var r=pt;for(pt|=4,Ne=e.current;Ne!==null;){var o=Ne,a=o.child;if(Ne.flags&16){var l=o.deletions;if(l!==null){for(var s=0;s<l.length;s++){var g=l[s];for(Ne=g;Ne!==null;){var c=Ne;switch(c.tag){case 0:case 11:case 15:sc(8,c,o)}var u=c.child;if(u!==null)u.return=c,Ne=u;else for(;Ne!==null;){c=Ne;var I=c.sibling,C=c.return;if(M2(c),c===g){Ne=null;break}if(I!==null){I.return=C,Ne=I;break}Ne=C}}}var m=o.alternate;if(m!==null){var f=m.child;if(f!==null){m.child=null;do{var b=f.sibling;f.sibling=null,f=b}while(f!==null)}}Ne=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,Ne=a;else e:for(;Ne!==null;){if(o=Ne,o.flags&2048)switch(o.tag){case 0:case 11:case 15:sc(9,o,o.return)}var A=o.sibling;if(A!==null){A.return=o.return,Ne=A;break e}Ne=o.return}}var p=e.current;for(Ne=p;Ne!==null;){a=Ne;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,Ne=y;else e:for(a=p;Ne!==null;){if(l=Ne,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:lh(9,l)}}catch(G){In(l,l.return,G)}if(l===a){Ne=null;break e}var Z=l.sibling;if(Z!==null){Z.return=l.return,Ne=Z;break e}Ne=l.return}}if(pt=r,ma(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot($C,e)}catch{}i=!0}return i}finally{Vt=n,Oi.transition=t}}return!1}function dG(e,t,n){t=Bs(n,t),t=V2(e,t,1),e=ea(e,t,1),t=li(),e!==null&&(vu(e,1,t),bi(e,t))}function In(e,t,n){if(e.tag===3)dG(e,e,n);else for(;t!==null;){if(t.tag===3){dG(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ta===null||!ta.has(i))){e=Bs(n,e),e=w2(t,e,1),t=ea(t,e,1),e=li(),t!==null&&(vu(t,1,e),bi(t,e));break}}t=t.return}}function DF(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=li(),e.pingedLanes|=e.suspendedLanes&n,Jn===e&&(Mn&n)===n&&(Gn===4||Gn===3&&(Mn&130023424)===Mn&&500>Cn()-ty?Qa(e,0):ey|=n),bi(e,t)}function O2(e,t){t===0&&(e.mode&1?(t=oI,oI<<=1,!(oI&130023424)&&(oI=4194304)):t=1);var n=li();e=lo(e,t),e!==null&&(vu(e,t,n),bi(e,n))}function TF(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),O2(e,n)}function jF(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(ue(314))}i!==null&&i.delete(t),O2(e,n)}var q2;q2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||fi.current)Ai=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Ai=!1,XF(e,t,n);Ai=!!(e.flags&131072)}else Ai=!1,$t&&t.flags&1048576&&n2(t,$d,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;gd(e,t),e=t.pendingProps;var r=Zs(t,qn.current);Is(t,n),r=Q0(null,t,i,e,r,n);var o=P0();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,pi(i)?(o=!0,Od(t)):o=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,L0(t),r.updater=ah,t.stateNode=r,r._reactInternals=t,op(t,i,e,n),t=sp(null,t,i,!0,o,n)):(t.tag=0,$t&&o&&N0(t),ri(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(gd(e,t),e=t.pendingProps,r=i._init,i=r(i._payload),t.type=i,r=t.tag=QF(i),e=ar(i,e),r){case 0:t=lp(null,t,i,e,n);break e;case 1:t=iG(null,t,i,e,n);break e;case 11:t=tG(null,t,i,e,n);break e;case 14:t=nG(null,t,i,ar(i.type,e),n);break e}throw Error(ue(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:ar(i,r),lp(e,t,i,r,n);case 1:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:ar(i,r),iG(e,t,i,r,n);case 3:e:{if(Y2(t),e===null)throw Error(ue(387));i=t.pendingProps,o=t.memoizedState,r=o.element,s2(e,t),nC(t,i,null,n);var a=t.memoizedState;if(i=a.element,o.isDehydrated)if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){r=Bs(Error(ue(423)),t),t=rG(e,t,i,n,r);break e}else if(i!==r){r=Bs(Error(ue(424)),t),t=rG(e,t,i,n,r);break e}else for(wi=$o(t.stateNode.containerInfo.firstChild),xi=t,$t=!0,cr=null,n=a2(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(vs(),i===r){t=so(e,t,n);break e}ri(e,t,i,n)}t=t.child}return t;case 5:return g2(t),e===null&&np(t),i=t.type,r=t.pendingProps,o=e!==null?e.memoizedProps:null,a=r.children,Of(i,r)?a=null:o!==null&&Of(i,o)&&(t.flags|=32),J2(e,t),ri(e,t,a,n),t.child;case 6:return e===null&&np(t),null;case 13:return N2(e,t,n);case 4:return D0(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Gs(t,null,i,n):ri(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:ar(i,r),tG(e,t,i,r,n);case 7:return ri(e,t,t.pendingProps,n),t.child;case 8:return ri(e,t,t.pendingProps.children,n),t.child;case 12:return ri(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,o=t.memoizedProps,a=r.value,Lt(eC,i._currentValue),i._currentValue=a,o!==null)if(pr(o.value,a)){if(o.children===r.children&&!fi.current){t=so(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var l=o.dependencies;if(l!==null){a=o.child;for(var s=l.firstContext;s!==null;){if(s.context===i){if(o.tag===1){s=to(-1,n&-n),s.tag=2;var g=o.updateQueue;if(g!==null){g=g.shared;var c=g.pending;c===null?s.next=s:(s.next=c.next,c.next=s),g.pending=s}}o.lanes|=n,s=o.alternate,s!==null&&(s.lanes|=n),ip(o.return,n,t),l.lanes|=n;break}s=s.next}}else if(o.tag===10)a=o.type===t.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(ue(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),ip(a,n,t),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===t){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}ri(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Is(t,n),r=qi(r),i=i(r),t.flags|=1,ri(e,t,i,n),t.child;case 14:return i=t.type,r=ar(i,t.pendingProps),r=ar(i.type,r),nG(e,t,i,r,n);case 15:return x2(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:ar(i,r),gd(e,t),t.tag=1,pi(i)?(e=!0,Od(t)):e=!1,Is(t,n),k2(t,i,r),op(t,i,r,n),sp(null,t,i,!0,e,n);case 19:return H2(e,t,n);case 22:return X2(e,t,n)}throw Error(ue(156,t.tag))};function $2(e,t){return BV(e,t)}function UF(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pi(e,t,n,i){return new UF(e,t,n,i)}function oy(e){return e=e.prototype,!(!e||!e.isReactComponent)}function QF(e){if(typeof e=="function")return oy(e)?1:0;if(e!=null){if(e=e.$$typeof,e===G0)return 11;if(e===S0)return 14}return 2}function ia(e,t){var n=e.alternate;return n===null?(n=Pi(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Id(e,t,n,i,r,o){var a=2;if(i=e,typeof e=="function")oy(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Tl:return Pa(n.children,r,o,t);case v0:a=8,r|=8;break;case kf:return e=Pi(12,n,t,r|2),e.elementType=kf,e.lanes=o,e;case Vf:return e=Pi(13,n,t,r),e.elementType=Vf,e.lanes=o,e;case wf:return e=Pi(19,n,t,r),e.elementType=wf,e.lanes=o,e;case gV:return gh(n,r,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case lV:a=10;break e;case sV:a=9;break e;case G0:a=11;break e;case S0:a=14;break e;case xo:a=16,i=null;break e}throw Error(ue(130,e==null?e:typeof e,""))}return t=Pi(a,n,t,r),t.elementType=e,t.type=i,t.lanes=o,t}function Pa(e,t,n,i){return e=Pi(7,e,i,t),e.lanes=n,e}function gh(e,t,n,i){return e=Pi(22,e,i,t),e.elementType=gV,e.lanes=n,e.stateNode={isHidden:!1},e}function uA(e,t,n){return e=Pi(6,e,null,t),e.lanes=n,e}function IA(e,t,n){return t=Pi(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function PF(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jm(0),this.expirationTimes=jm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jm(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function ay(e,t,n,i,r,o,a,l,s){return e=new PF(e,t,n,l,s),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Pi(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},L0(o),e}function _F(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Dl,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function ew(e){if(!e)return sa;e=e._reactInternals;e:{if(Il(e)!==e||e.tag!==1)throw Error(ue(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(pi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ue(171))}if(e.tag===1){var n=e.type;if(pi(n))return e2(e,n,t)}return t}function tw(e,t,n,i,r,o,a,l,s){return e=ay(n,i,!0,e,r,o,a,l,s),e.context=ew(null),n=e.current,i=li(),r=na(n),o=to(i,r),o.callback=t??null,ea(n,o,r),e.current.lanes=r,vu(e,r,i),bi(e,i),e}function ch(e,t,n,i){var r=t.current,o=li(),a=na(r);return n=ew(n),t.context===null?t.context=n:t.pendingContext=n,t=to(o,a),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=ea(r,t,a),e!==null&&(Cr(e,r,a,o),ad(e,r,a)),a}function cC(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function CG(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ly(e,t){CG(e,t),(e=e.alternate)&&CG(e,t)}function OF(){return null}var nw=typeof reportError=="function"?reportError:function(e){console.error(e)};function sy(e){this._internalRoot=e}uh.prototype.render=sy.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ue(409));ch(e,t,null,null)};uh.prototype.unmount=sy.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ol(function(){ch(null,e,null,null)}),t[ao]=null}};function uh(e){this._internalRoot=e}uh.prototype.unstable_scheduleHydration=function(e){if(e){var t=XV();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ho.length&&t!==0&&t<Ho[n].priority;n++);Ho.splice(n,0,e),n===0&&YV(e)}};function gy(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ih(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function hG(){}function qF(e,t,n,i,r){if(r){if(typeof i=="function"){var o=i;i=function(){var g=cC(a);o.call(g)}}var a=tw(t,i,e,0,null,!1,!1,"",hG);return e._reactRootContainer=a,e[ao]=a.current,Yc(e.nodeType===8?e.parentNode:e),ol(),a}for(;r=e.lastChild;)e.removeChild(r);if(typeof i=="function"){var l=i;i=function(){var g=cC(s);l.call(g)}}var s=ay(e,0,!1,null,null,!1,!1,"",hG);return e._reactRootContainer=s,e[ao]=s.current,Yc(e.nodeType===8?e.parentNode:e),ol(function(){ch(t,s,n,i)}),s}function dh(e,t,n,i,r){var o=n._reactRootContainer;if(o){var a=o;if(typeof r=="function"){var l=r;r=function(){var s=cC(a);l.call(s)}}ch(t,a,e,r)}else a=qF(n,t,e,r,i);return cC(a)}wV=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Tg(t.pendingLanes);n!==0&&(W0(t,n|1),bi(t,Cn()),!(pt&6)&&(Rs=Cn()+500,ma()))}break;case 13:ol(function(){var i=lo(e,1);if(i!==null){var r=li();Cr(i,e,1,r)}}),ly(e,1)}};k0=function(e){if(e.tag===13){var t=lo(e,134217728);if(t!==null){var n=li();Cr(t,e,134217728,n)}ly(e,134217728)}};xV=function(e){if(e.tag===13){var t=na(e),n=lo(e,t);if(n!==null){var i=li();Cr(n,e,t,i)}ly(e,t)}};XV=function(){return Vt};JV=function(e,t){var n=Vt;try{return Vt=e,t()}finally{Vt=n}};Mf=function(e,t,n){switch(t){case"input":if(Jf(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=ih(i);if(!r)throw Error(ue(90));uV(i),Jf(i,r)}}}break;case"textarea":dV(e,n);break;case"select":t=n.value,t!=null&&ss(e,!!n.multiple,t,!1)}};bV=ny;yV=ol;var $F={usingClientEntryPoint:!1,Events:[Su,Pl,ih,fV,pV,ny]},Zg={findFiberByHostInstance:Da,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},e9={bundleType:Zg.bundleType,version:Zg.version,rendererPackageName:Zg.rendererPackageName,rendererConfig:Zg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:go.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=GV(e),e===null?null:e.stateNode},findFiberByHostInstance:Zg.findFiberByHostInstance||OF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mI=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mI.isDisabled&&mI.supportsFiber)try{$C=mI.inject(e9),Nr=mI}catch{}}Hi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$F;Hi.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gy(t))throw Error(ue(200));return _F(e,t,null,n)};Hi.createRoot=function(e,t){if(!gy(e))throw Error(ue(299));var n=!1,i="",r=nw;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=ay(e,1,!1,null,null,n,!1,i,r),e[ao]=t.current,Yc(e.nodeType===8?e.parentNode:e),new sy(t)};Hi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ue(188)):(e=Object.keys(e).join(","),Error(ue(268,e)));return e=GV(t),e=e===null?null:e.stateNode,e};Hi.flushSync=function(e){return ol(e)};Hi.hydrate=function(e,t,n){if(!Ih(t))throw Error(ue(200));return dh(null,e,t,!0,n)};Hi.hydrateRoot=function(e,t,n){if(!gy(e))throw Error(ue(405));var i=n!=null&&n.hydratedSources||null,r=!1,o="",a=nw;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=tw(t,null,e,1,n??null,r,!1,o,a),e[ao]=t.current,Yc(e),i)for(e=0;e<i.length;e++)n=i[e],r=n._getVersion,r=r(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new uh(t)};Hi.render=function(e,t,n){if(!Ih(t))throw Error(ue(200));return dh(null,e,t,!1,n)};Hi.unmountComponentAtNode=function(e){if(!Ih(e))throw Error(ue(40));return e._reactRootContainer?(ol(function(){dh(null,null,e,!1,function(){e._reactRootContainer=null,e[ao]=null})}),!0):!1};Hi.unstable_batchedUpdates=ny;Hi.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Ih(n))throw Error(ue(200));if(e==null||e._reactInternals===void 0)throw Error(ue(38));return dh(e,t,n,!1,i)};Hi.version="18.3.1-next-f1338f8080-20240426";function iw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(iw)}catch(e){console.error(e)}}iw(),iV.exports=Hi;var _i=iV.exports;const bp=Es(_i),t9=Tk({__proto__:null,default:bp},[_i]);var rw,mG=_i;rw=mG.createRoot,mG.hydrateRoot;var cy={};Object.defineProperty(cy,"__esModule",{value:!0});cy.parse=s9;cy.serialize=g9;const n9=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,i9=/^[\u0021-\u003A\u003C-\u007E]*$/,r9=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,o9=/^[\u0020-\u003A\u003D-\u007E]*$/,a9=Object.prototype.toString,l9=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function s9(e,t){const n=new l9,i=e.length;if(i<2)return n;const r=(t==null?void 0:t.decode)||c9;let o=0;do{const a=e.indexOf("=",o);if(a===-1)break;const l=e.indexOf(";",o),s=l===-1?i:l;if(a>s){o=e.lastIndexOf(";",a-1)+1;continue}const g=AG(e,o,a),c=fG(e,a,g),u=e.slice(g,c);if(n[u]===void 0){let I=AG(e,a+1,s),C=fG(e,s,I);const m=r(e.slice(I,C));n[u]=m}o=s+1}while(o<i);return n}function AG(e,t,n){do{const i=e.charCodeAt(t);if(i!==32&&i!==9)return t}while(++t<n);return n}function fG(e,t,n){for(;t>n;){const i=e.charCodeAt(--t);if(i!==32&&i!==9)return t+1}return n}function g9(e,t,n){const i=(n==null?void 0:n.encode)||encodeURIComponent;if(!n9.test(e))throw new TypeError(`argument name is invalid: ${e}`);const r=i(t);if(!i9.test(r))throw new TypeError(`argument val is invalid: ${t}`);let o=e+"="+r;if(!n)return o;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);o+="; Max-Age="+n.maxAge}if(n.domain){if(!r9.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);o+="; Domain="+n.domain}if(n.path){if(!o9.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);o+="; Path="+n.path}if(n.expires){if(!u9(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);o+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.partitioned&&(o+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"none":o+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return o}function c9(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function u9(e){return a9.call(e)==="[object Date]"}/**
 * react-router v7.0.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var pG="popstate";function I9(e={}){function t(i,r){let{pathname:o,search:a,hash:l}=i.location;return yp("",{pathname:o,search:a,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:Dc(r)}return C9(t,n,null,e)}function nn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function co(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function d9(){return Math.random().toString(36).substring(2,10)}function bG(e,t){return{usr:e.state,key:e.key,idx:t}}function yp(e,t,n=null,i){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Ds(t):t,state:n,key:t&&t.key||i||d9()}}function Dc({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Ds(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function C9(e,t,n,i={}){let{window:r=document.defaultView,v5Compat:o=!1}=i,a=r.history,l="POP",s=null,g=c();g==null&&(g=0,a.replaceState({...a.state,idx:g},""));function c(){return(a.state||{idx:null}).idx}function u(){l="POP";let b=c(),A=b==null?null:b-g;g=b,s&&s({action:l,location:f.location,delta:A})}function I(b,A){l="PUSH";let p=yp(f.location,b,A);g=c()+1;let y=bG(p,g),Z=f.createHref(p);try{a.pushState(y,"",Z)}catch(G){if(G instanceof DOMException&&G.name==="DataCloneError")throw G;r.location.assign(Z)}o&&s&&s({action:l,location:f.location,delta:1})}function C(b,A){l="REPLACE";let p=yp(f.location,b,A);g=c();let y=bG(p,g),Z=f.createHref(p);a.replaceState(y,"",Z),o&&s&&s({action:l,location:f.location,delta:0})}function m(b){let A=r.location.origin!=="null"?r.location.origin:r.location.href,p=typeof b=="string"?b:Dc(b);return p=p.replace(/ $/,"%20"),nn(A,`No window.location.(origin|href) available to create URL for href: ${p}`),new URL(p,A)}let f={get action(){return l},get location(){return e(r,a)},listen(b){if(s)throw new Error("A history only accepts one active listener");return r.addEventListener(pG,u),s=b,()=>{r.removeEventListener(pG,u),s=null}},createHref(b){return t(r,b)},createURL:m,encodeLocation(b){let A=m(b);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:I,replace:C,go(b){return a.go(b)}};return f}function ow(e,t,n="/"){return h9(e,t,n,!1)}function h9(e,t,n,i){let r=typeof t=="string"?Ds(t):t,o=ga(r.pathname||"/",n);if(o==null)return null;let a=aw(e);m9(a);let l=null;for(let s=0;l==null&&s<a.length;++s){let g=R9(o);l=S9(a[s],g,i)}return l}function aw(e,t=[],n=[],i=""){let r=(o,a,l)=>{let s={relativePath:l===void 0?o.path||"":l,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};s.relativePath.startsWith("/")&&(nn(s.relativePath.startsWith(i),`Absolute route path "${s.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),s.relativePath=s.relativePath.slice(i.length));let g=no([i,s.relativePath]),c=n.concat(s);o.children&&o.children.length>0&&(nn(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),aw(o.children,t,c,g)),!(o.path==null&&!o.index)&&t.push({path:g,score:v9(g,o.index),routesMeta:c})};return e.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))r(o,a);else for(let s of lw(o.path))r(o,a,s)}),t}function lw(e){let t=e.split("/");if(t.length===0)return[];let[n,...i]=t,r=n.endsWith("?"),o=n.replace(/\?$/,"");if(i.length===0)return r?[o,""]:[o];let a=lw(i.join("/")),l=[];return l.push(...a.map(s=>s===""?o:[o,s].join("/"))),r&&l.push(...a),l.map(s=>e.startsWith("/")&&s===""?"/":s)}function m9(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:G9(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var A9=/^:[\w-]+$/,f9=3,p9=2,b9=1,y9=10,Z9=-2,yG=e=>e==="*";function v9(e,t){let n=e.split("/"),i=n.length;return n.some(yG)&&(i+=Z9),t&&(i+=p9),n.filter(r=>!yG(r)).reduce((r,o)=>r+(A9.test(o)?f9:o===""?b9:y9),i)}function G9(e,t){return e.length===t.length&&e.slice(0,-1).every((i,r)=>i===t[r])?e[e.length-1]-t[t.length-1]:0}function S9(e,t,n=!1){let{routesMeta:i}=e,r={},o="/",a=[];for(let l=0;l<i.length;++l){let s=i[l],g=l===i.length-1,c=o==="/"?t:t.slice(o.length)||"/",u=uC({path:s.relativePath,caseSensitive:s.caseSensitive,end:g},c),I=s.route;if(!u&&g&&n&&!i[i.length-1].route.index&&(u=uC({path:s.relativePath,caseSensitive:s.caseSensitive,end:!1},c)),!u)return null;Object.assign(r,u.params),a.push({params:r,pathname:no([o,u.pathname]),pathnameBase:w9(no([o,u.pathnameBase])),route:I}),u.pathnameBase!=="/"&&(o=no([o,u.pathnameBase]))}return a}function uC(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=B9(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let o=r[0],a=o.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:i.reduce((g,{paramName:c,isOptional:u},I)=>{if(c==="*"){let m=l[I]||"";a=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const C=l[I];return u&&!C?g[c]=void 0:g[c]=(C||"").replace(/%2F/g,"/"),g},{}),pathname:o,pathnameBase:a,pattern:e}}function B9(e,t=!1,n=!0){co(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,s)=>(i.push({paramName:l,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),r+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":e!==""&&e!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}function R9(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return co(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function ga(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&i!=="/"?null:e.slice(n)||"/"}function W9(e,t="/"){let{pathname:n,search:i="",hash:r=""}=typeof e=="string"?Ds(e):e;return{pathname:n?n.startsWith("/")?n:k9(n,t):t,search:x9(i),hash:X9(r)}}function k9(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function dA(e,t,n,i){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function V9(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function uy(e){let t=V9(e);return t.map((n,i)=>i===t.length-1?n.pathname:n.pathnameBase)}function Iy(e,t,n,i=!1){let r;typeof e=="string"?r=Ds(e):(r={...e},nn(!r.pathname||!r.pathname.includes("?"),dA("?","pathname","search",r)),nn(!r.pathname||!r.pathname.includes("#"),dA("#","pathname","hash",r)),nn(!r.search||!r.search.includes("#"),dA("#","search","hash",r)));let o=e===""||r.pathname==="",a=o?"/":r.pathname,l;if(a==null)l=n;else{let u=t.length-1;if(!i&&a.startsWith("..")){let I=a.split("/");for(;I[0]==="..";)I.shift(),u-=1;r.pathname=I.join("/")}l=u>=0?t[u]:"/"}let s=W9(r,l),g=a&&a!=="/"&&a.endsWith("/"),c=(o||a===".")&&n.endsWith("/");return!s.pathname.endsWith("/")&&(g||c)&&(s.pathname+="/"),s}var no=e=>e.join("/").replace(/\/\/+/g,"/"),w9=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),x9=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,X9=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function J9(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var sw=["POST","PUT","PATCH","DELETE"];new Set(sw);var Y9=["GET",...sw];new Set(Y9);var Ts=h.createContext(null);Ts.displayName="DataRouter";var Ch=h.createContext(null);Ch.displayName="DataRouterState";var gw=h.createContext({isTransitioning:!1});gw.displayName="ViewTransition";var N9=h.createContext(new Map);N9.displayName="Fetchers";var H9=h.createContext(null);H9.displayName="Await";var Zr=h.createContext(null);Zr.displayName="Navigation";var Ru=h.createContext(null);Ru.displayName="Location";var vr=h.createContext({outlet:null,matches:[],isDataRoute:!1});vr.displayName="Route";var dy=h.createContext(null);dy.displayName="RouteError";function F9(e,{relative:t}={}){nn(js(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=h.useContext(Zr),{hash:r,pathname:o,search:a}=Wu(e,{relative:t}),l=o;return n!=="/"&&(l=o==="/"?n:no([n,o])),i.createHref({pathname:l,search:a,hash:r})}function js(){return h.useContext(Ru)!=null}function yi(){return nn(js(),"useLocation() may be used only in the context of a <Router> component."),h.useContext(Ru).location}var cw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function uw(e){h.useContext(Zr).static||h.useLayoutEffect(e)}function Gt(){let{isDataRoute:e}=h.useContext(vr);return e?O9():K9()}function K9(){nn(js(),"useNavigate() may be used only in the context of a <Router> component.");let e=h.useContext(Ts),{basename:t,navigator:n}=h.useContext(Zr),{matches:i}=h.useContext(vr),{pathname:r}=yi(),o=JSON.stringify(uy(i)),a=h.useRef(!1);return uw(()=>{a.current=!0}),h.useCallback((s,g={})=>{if(co(a.current,cw),!a.current)return;if(typeof s=="number"){n.go(s);return}let c=Iy(s,JSON.parse(o),r,g.relative==="path");e==null&&t!=="/"&&(c.pathname=c.pathname==="/"?t:no([t,c.pathname])),(g.replace?n.replace:n.push)(c,g.state,g)},[t,n,o,r,e])}h.createContext(null);function Aa(){let{matches:e}=h.useContext(vr),t=e[e.length-1];return t?t.params:{}}function Wu(e,{relative:t}={}){let{matches:n}=h.useContext(vr),{pathname:i}=yi(),r=JSON.stringify(uy(n));return h.useMemo(()=>Iy(e,JSON.parse(r),i,t==="path"),[e,r,i,t])}function E9(e,t){return Iw(e,t)}function Iw(e,t,n,i){var f;nn(js(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=h.useContext(Zr),{matches:o}=h.useContext(vr),a=o[o.length-1],l=a?a.params:{};a&&a.pathname;let s=a?a.pathnameBase:"/";a&&a.route;let g=yi(),c;if(t){let b=typeof t=="string"?Ds(t):t;nn(s==="/"||((f=b.pathname)==null?void 0:f.startsWith(s)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${s}" but pathname "${b.pathname}" was given in the \`location\` prop.`),c=b}else c=g;let u=c.pathname||"/",I=u;if(s!=="/"){let b=s.replace(/^\//,"").split("/");I="/"+u.replace(/^\//,"").split("/").slice(b.length).join("/")}let C=ow(e,{pathname:I}),m=T9(C&&C.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:no([s,r.encodeLocation?r.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?s:no([s,r.encodeLocation?r.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),o,n,i);return t&&m?h.createElement(Ru.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...c},navigationType:"POP"}},m):m}function M9(){let e=_9(),t=J9(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return h.createElement(h.Fragment,null,h.createElement("h2",null,"Unexpected Application Error!"),h.createElement("h3",{style:{fontStyle:"italic"}},t),n?h.createElement("pre",{style:r},n):null,null)}var z9=h.createElement(M9,null),L9=class extends h.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?h.createElement(vr.Provider,{value:this.props.routeContext},h.createElement(dy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function D9({routeContext:e,match:t,children:n}){let i=h.useContext(Ts);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),h.createElement(vr.Provider,{value:e},n)}function T9(e,t=[],n=null,i=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let r=e,o=n==null?void 0:n.errors;if(o!=null){let s=r.findIndex(g=>g.route.id&&(o==null?void 0:o[g.route.id])!==void 0);nn(s>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),r=r.slice(0,Math.min(r.length,s+1))}let a=!1,l=-1;if(n)for(let s=0;s<r.length;s++){let g=r[s];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(l=s),g.route.id){let{loaderData:c,errors:u}=n,I=g.route.loader&&!c.hasOwnProperty(g.route.id)&&(!u||u[g.route.id]===void 0);if(g.route.lazy||I){a=!0,l>=0?r=r.slice(0,l+1):r=[r[0]];break}}}return r.reduceRight((s,g,c)=>{let u,I=!1,C=null,m=null;n&&(u=o&&g.route.id?o[g.route.id]:void 0,C=g.route.errorElement||z9,a&&(l<0&&c===0?(q9("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),I=!0,m=null):l===c&&(I=!0,m=g.route.hydrateFallbackElement||null)));let f=t.concat(r.slice(0,c+1)),b=()=>{let A;return u?A=C:I?A=m:g.route.Component?A=h.createElement(g.route.Component,null):g.route.element?A=g.route.element:A=s,h.createElement(D9,{match:g,routeContext:{outlet:s,matches:f,isDataRoute:n!=null},children:A})};return n&&(g.route.ErrorBoundary||g.route.errorElement||c===0)?h.createElement(L9,{location:n.location,revalidation:n.revalidation,component:C,error:u,children:b(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):b()},null)}function Cy(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function j9(e){let t=h.useContext(Ts);return nn(t,Cy(e)),t}function U9(e){let t=h.useContext(Ch);return nn(t,Cy(e)),t}function Q9(e){let t=h.useContext(vr);return nn(t,Cy(e)),t}function hy(e){let t=Q9(e),n=t.matches[t.matches.length-1];return nn(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function P9(){return hy("useRouteId")}function _9(){var i;let e=h.useContext(dy),t=U9("useRouteError"),n=hy("useRouteError");return e!==void 0?e:(i=t.errors)==null?void 0:i[n]}function O9(){let{router:e}=j9("useNavigate"),t=hy("useNavigate"),n=h.useRef(!1);return uw(()=>{n.current=!0}),h.useCallback(async(r,o={})=>{co(n.current,cw),n.current&&(typeof r=="number"?e.navigate(r):await e.navigate(r,{fromRouteId:t,...o}))},[e,t])}var ZG={};function q9(e,t,n){ZG[e]||(ZG[e]=!0,co(!1,n))}h.memo($9);function $9({routes:e,future:t,state:n}){return Iw(e,void 0,n,t)}function Or({to:e,replace:t,state:n,relative:i}){nn(js(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=h.useContext(Zr);co(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=h.useContext(vr),{pathname:a}=yi(),l=Gt(),s=Iy(e,uy(o),a,i==="path"),g=JSON.stringify(s);return h.useEffect(()=>{l(JSON.parse(g),{replace:t,state:n,relative:i})},[l,g,i,t,n]),null}function ut(e){nn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function e5({basename:e="/",children:t=null,location:n,navigationType:i="POP",navigator:r,static:o=!1}){nn(!js(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=e.replace(/^\/*/,"/"),l=h.useMemo(()=>({basename:a,navigator:r,static:o,future:{}}),[a,r,o]);typeof n=="string"&&(n=Ds(n));let{pathname:s="/",search:g="",hash:c="",state:u=null,key:I="default"}=n,C=h.useMemo(()=>{let m=ga(s,a);return m==null?null:{location:{pathname:m,search:g,hash:c,state:u,key:I},navigationType:i}},[a,s,g,c,u,I,i]);return co(C!=null,`<Router basename="${a}"> is not able to match the URL "${s}${g}${c}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:h.createElement(Zr.Provider,{value:l},h.createElement(Ru.Provider,{children:t,value:C}))}function my({children:e,location:t}){return E9(Zp(e),t)}function Zp(e,t=[]){let n=[];return h.Children.forEach(e,(i,r)=>{if(!h.isValidElement(i))return;let o=[...t,r];if(i.type===h.Fragment){n.push.apply(n,Zp(i.props.children,o));return}nn(i.type===ut,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),nn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let a={id:i.props.id||o.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=Zp(i.props.children,o)),n.push(a)}),n}var dd="get",Cd="application/x-www-form-urlencoded";function hh(e){return e!=null&&typeof e.tagName=="string"}function t5(e){return hh(e)&&e.tagName.toLowerCase()==="button"}function n5(e){return hh(e)&&e.tagName.toLowerCase()==="form"}function i5(e){return hh(e)&&e.tagName.toLowerCase()==="input"}function r5(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function o5(e,t){return e.button===0&&(!t||t==="_self")&&!r5(e)}var AI=null;function a5(){if(AI===null)try{new FormData(document.createElement("form"),0),AI=!1}catch{AI=!0}return AI}var l5=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function CA(e){return e!=null&&!l5.has(e)?(co(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Cd}"`),null):e}function s5(e,t){let n,i,r,o,a;if(n5(e)){let l=e.getAttribute("action");i=l?ga(l,t):null,n=e.getAttribute("method")||dd,r=CA(e.getAttribute("enctype"))||Cd,o=new FormData(e)}else if(t5(e)||i5(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||l.getAttribute("action");if(i=s?ga(s,t):null,n=e.getAttribute("formmethod")||l.getAttribute("method")||dd,r=CA(e.getAttribute("formenctype"))||CA(l.getAttribute("enctype"))||Cd,o=new FormData(l,e),!a5()){let{name:g,type:c,value:u}=e;if(c==="image"){let I=g?`${g}.`:"";o.append(`${I}x`,"0"),o.append(`${I}y`,"0")}else g&&o.append(g,u)}}else{if(hh(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=dd,i=null,r=Cd,a=e}return o&&r==="text/plain"&&(a=o,o=void 0),{action:i,method:n.toLowerCase(),encType:r,formData:o,body:a}}function Ay(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function g5(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function c5(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function u5(e,t,n){let i=await Promise.all(e.map(async r=>{let o=t.routes[r.route.id];if(o){let a=await g5(o,n);return a.links?a.links():[]}return[]}));return h5(i.flat(1).filter(c5).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function vG(e,t,n,i,r,o){let a=(s,g)=>n[g]?s.route.id!==n[g].route.id:!0,l=(s,g)=>{var c;return n[g].pathname!==s.pathname||((c=n[g].route.path)==null?void 0:c.endsWith("*"))&&n[g].params["*"]!==s.params["*"]};return o==="assets"?t.filter((s,g)=>a(s,g)||l(s,g)):o==="data"?t.filter((s,g)=>{var u;let c=i.routes[s.route.id];if(!c||!c.hasLoader)return!1;if(a(s,g)||l(s,g))return!0;if(s.route.shouldRevalidate){let I=s.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((u=n[0])==null?void 0:u.params)||{},nextUrl:new URL(e,window.origin),nextParams:s.params,defaultShouldRevalidate:!0});if(typeof I=="boolean")return I}return!0}):[]}function I5(e,t){return d5(e.map(n=>{let i=t.routes[n.route.id];if(!i)return[];let r=[i.module];return i.imports&&(r=r.concat(i.imports)),r}).flat(1))}function d5(e){return[...new Set(e)]}function C5(e){let t={},n=Object.keys(e).sort();for(let i of n)t[i]=e[i];return t}function h5(e,t){let n=new Set;return new Set(t),e.reduce((i,r)=>{let o=JSON.stringify(C5(r));return n.has(o)||(n.add(o),i.push({key:o,link:r})),i},[])}function m5(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function A5(){let e=h.useContext(Ts);return Ay(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function f5(){let e=h.useContext(Ch);return Ay(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var fy=h.createContext(void 0);fy.displayName="FrameworkContext";function dw(){let e=h.useContext(fy);return Ay(e,"You must render this element inside a <HydratedRouter> element"),e}function p5(e,t){let n=h.useContext(fy),[i,r]=h.useState(!1),[o,a]=h.useState(!1),{onFocus:l,onBlur:s,onMouseEnter:g,onMouseLeave:c,onTouchStart:u}=t,I=h.useRef(null);h.useEffect(()=>{if(e==="render"&&a(!0),e==="viewport"){let f=A=>{A.forEach(p=>{a(p.isIntersecting)})},b=new IntersectionObserver(f,{threshold:.5});return I.current&&b.observe(I.current),()=>{b.disconnect()}}},[e]),h.useEffect(()=>{if(i){let f=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(f)}}},[i]);let C=()=>{r(!0)},m=()=>{r(!1),a(!1)};return n?e!=="intent"?[o,I,{}]:[o,I,{onFocus:vg(l,C),onBlur:vg(s,m),onMouseEnter:vg(g,C),onMouseLeave:vg(c,m),onTouchStart:vg(u,C)}]:[!1,I,{}]}function vg(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function b5({page:e,...t}){let{router:n}=A5(),i=h.useMemo(()=>ow(n.routes,e,n.basename),[n.routes,e,n.basename]);return i?h.createElement(Z5,{page:e,matches:i,...t}):(console.warn(`Tried to prefetch ${e} but no routes matched.`),null)}function y5(e){let{manifest:t,routeModules:n}=dw(),[i,r]=h.useState([]);return h.useEffect(()=>{let o=!1;return u5(e,t,n).then(a=>{o||r(a)}),()=>{o=!0}},[e,t,n]),i}function Z5({page:e,matches:t,...n}){let i=yi(),{manifest:r,routeModules:o}=dw(),{loaderData:a,matches:l}=f5(),s=h.useMemo(()=>vG(e,t,l,r,i,"data"),[e,t,l,r,i]),g=h.useMemo(()=>vG(e,t,l,r,i,"assets"),[e,t,l,r,i]),c=h.useMemo(()=>{if(e===i.pathname+i.search+i.hash)return[];let C=new Set,m=!1;if(t.forEach(b=>{var p;let A=r.routes[b.route.id];!A||!A.hasLoader||(!s.some(y=>y.route.id===b.route.id)&&b.route.id in a&&((p=o[b.route.id])!=null&&p.shouldRevalidate)||A.hasClientLoader?m=!0:C.add(b.route.id))}),C.size===0)return[];let f=m5(e);return m&&C.size>0&&f.searchParams.set("_routes",t.filter(b=>C.has(b.route.id)).map(b=>b.route.id).join(",")),[f.pathname+f.search]},[a,i,r,s,t,e,o]),u=h.useMemo(()=>I5(g,r),[g,r]),I=y5(g);return h.createElement(h.Fragment,null,c.map(C=>h.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...n})),u.map(C=>h.createElement("link",{key:C,rel:"modulepreload",href:C,...n})),I.map(({key:C,link:m})=>h.createElement("link",{key:C,...m})))}function v5(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var Cw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Cw&&(window.__reactRouterVersion="7.0.1")}catch{}function G5({basename:e,children:t,window:n}){let i=h.useRef();i.current==null&&(i.current=I9({window:n,v5Compat:!0}));let r=i.current,[o,a]=h.useState({action:r.action,location:r.location}),l=h.useCallback(s=>{h.startTransition(()=>a(s))},[a]);return h.useLayoutEffect(()=>r.listen(l),[r,l]),h.createElement(e5,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:r})}var hw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Cs=h.forwardRef(function({onClick:t,discover:n="render",prefetch:i="none",relative:r,reloadDocument:o,replace:a,state:l,target:s,to:g,preventScrollReset:c,viewTransition:u,...I},C){let{basename:m}=h.useContext(Zr),f=typeof g=="string"&&hw.test(g),b,A=!1;if(typeof g=="string"&&f&&(b=g,Cw))try{let X=new URL(window.location.href),W=g.startsWith("//")?new URL(X.protocol+g):new URL(g),V=ga(W.pathname,m);W.origin===X.origin&&V!=null?g=V+W.search+W.hash:A=!0}catch{co(!1,`<Link to="${g}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let p=F9(g,{relative:r}),[y,Z,G]=p5(i,I),v=R5(g,{replace:a,state:l,target:s,preventScrollReset:c,relative:r,viewTransition:u});function B(X){t&&t(X),X.defaultPrevented||v(X)}let R=h.createElement("a",{...I,...G,href:b||p,onClick:A||o?t:B,ref:v5(C,Z),target:s,"data-discover":!f&&n==="render"?"true":void 0});return y&&!f?h.createElement(h.Fragment,null,R,h.createElement(b5,{page:p})):R});Cs.displayName="Link";var ns=h.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:i="",end:r=!1,style:o,to:a,viewTransition:l,children:s,...g},c){let u=Wu(a,{relative:g.relative}),I=yi(),C=h.useContext(Ch),{navigator:m,basename:f}=h.useContext(Zr),b=C!=null&&x5(u)&&l===!0,A=m.encodeLocation?m.encodeLocation(u).pathname:u.pathname,p=I.pathname,y=C&&C.navigation&&C.navigation.location?C.navigation.location.pathname:null;n||(p=p.toLowerCase(),y=y?y.toLowerCase():null,A=A.toLowerCase()),y&&f&&(y=ga(y,f)||y);const Z=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let G=p===A||!r&&p.startsWith(A)&&p.charAt(Z)==="/",v=y!=null&&(y===A||!r&&y.startsWith(A)&&y.charAt(A.length)==="/"),B={isActive:G,isPending:v,isTransitioning:b},R=G?t:void 0,X;typeof i=="function"?X=i(B):X=[i,G?"active":null,v?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let W=typeof o=="function"?o(B):o;return h.createElement(Cs,{...g,"aria-current":R,className:X,ref:c,style:W,to:a,viewTransition:l},typeof s=="function"?s(B):s)});ns.displayName="NavLink";var S5=h.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:i,replace:r,state:o,method:a=dd,action:l,onSubmit:s,relative:g,preventScrollReset:c,viewTransition:u,...I},C)=>{let m=V5(),f=w5(l,{relative:g}),b=a.toLowerCase()==="get"?"get":"post",A=typeof l=="string"&&hw.test(l),p=y=>{if(s&&s(y),y.defaultPrevented)return;y.preventDefault();let Z=y.nativeEvent.submitter,G=(Z==null?void 0:Z.getAttribute("formmethod"))||a;m(Z||y.currentTarget,{fetcherKey:t,method:G,navigate:n,replace:r,state:o,relative:g,preventScrollReset:c,viewTransition:u})};return h.createElement("form",{ref:C,method:b,action:f,onSubmit:i?s:p,...I,"data-discover":!A&&e==="render"?"true":void 0})});S5.displayName="Form";function B5(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function mw(e){let t=h.useContext(Ts);return nn(t,B5(e)),t}function R5(e,{target:t,replace:n,state:i,preventScrollReset:r,relative:o,viewTransition:a}={}){let l=Gt(),s=yi(),g=Wu(e,{relative:o});return h.useCallback(c=>{if(o5(c,t)){c.preventDefault();let u=n!==void 0?n:Dc(s)===Dc(g);l(e,{replace:u,state:i,preventScrollReset:r,relative:o,viewTransition:a})}},[s,l,g,n,i,t,e,r,o,a])}var W5=0,k5=()=>`__${String(++W5)}__`;function V5(){let{router:e}=mw("useSubmit"),{basename:t}=h.useContext(Zr),n=P9();return h.useCallback(async(i,r={})=>{let{action:o,method:a,encType:l,formData:s,body:g}=s5(i,t);if(r.navigate===!1){let c=r.fetcherKey||k5();await e.fetch(c,n,r.action||o,{preventScrollReset:r.preventScrollReset,formData:s,body:g,formMethod:r.method||a,formEncType:r.encType||l,flushSync:r.flushSync})}else await e.navigate(r.action||o,{preventScrollReset:r.preventScrollReset,formData:s,body:g,formMethod:r.method||a,formEncType:r.encType||l,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})},[e,t,n])}function w5(e,{relative:t}={}){let{basename:n}=h.useContext(Zr),i=h.useContext(vr);nn(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),o={...Wu(e||".",{relative:t})},a=yi();if(e==null){o.search=a.search;let l=new URLSearchParams(o.search),s=l.getAll("index");if(s.some(c=>c==="")){l.delete("index"),s.filter(u=>u).forEach(u=>l.append("index",u));let c=l.toString();o.search=c?`?${c}`:""}}return(!e||e===".")&&r.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:no([n,o.pathname])),Dc(o)}function x5(e,t={}){let n=h.useContext(gw);nn(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=mw("useViewTransitionState"),r=Wu(e,{relative:t.relative});if(!n.isTransitioning)return!1;let o=ga(n.currentLocation.pathname,i)||n.currentLocation.pathname,a=ga(n.nextLocation.pathname,i)||n.nextLocation.pathname;return uC(r.pathname,a)!=null||uC(r.pathname,o)!=null}new TextEncoder;const X5="modulepreload",J5=function(e){return"/Time2Use/"+e},GG={},Ws=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(n.map(s=>{if(s=J5(s),s in GG)return;GG[s]=!0;const g=s.endsWith(".css"),c=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${c}`))return;const u=document.createElement("link");if(u.rel=g?"stylesheet":X5,g||(u.as="script"),u.crossOrigin="",u.href=s,l&&u.setAttribute("nonce",l),document.head.appendChild(u),g)return new Promise((I,C)=>{u.addEventListener("load",I),u.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${s}`)))})}))}function o(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return r.then(a=>{for(const l of a||[])l.status==="rejected"&&o(l.reason);return t().catch(o)})},Y5=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Ws(async()=>{const{default:i}=await Promise.resolve().then(()=>Us);return{default:i}},[]).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)};class py extends Error{constructor(t,n="FunctionsError",i){super(t),this.name=n,this.context=i}}class N5 extends py{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class H5 extends py{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class F5 extends py{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var vp;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(vp||(vp={}));var K5=function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(c){try{g(i.next(c))}catch(u){a(u)}}function s(c){try{g(i.throw(c))}catch(u){a(u)}}function g(c){c.done?o(c.value):r(c.value).then(l,s)}g((i=i.apply(e,t||[])).next())})};class E5{constructor(t,{headers:n={},customFetch:i,region:r=vp.Any}={}){this.url=t,this.headers=n,this.region=r,this.fetch=Y5(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,n={}){var i;return K5(this,void 0,void 0,function*(){try{const{headers:r,method:o,body:a}=n;let l={},{region:s}=n;s||(s=this.region),s&&s!=="any"&&(l["x-region"]=s);let g;a&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",g=a):typeof a=="string"?(l["Content-Type"]="text/plain",g=a):typeof FormData<"u"&&a instanceof FormData?g=a:(l["Content-Type"]="application/json",g=JSON.stringify(a)));const c=yield this.fetch(`${this.url}/${t}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),r),body:g}).catch(m=>{throw new N5(m)}),u=c.headers.get("x-relay-error");if(u&&u==="true")throw new H5(c);if(!c.ok)throw new F5(c);let I=((i=c.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),C;return I==="application/json"?C=yield c.json():I==="application/octet-stream"?C=yield c.blob():I==="text/event-stream"?C=c:I==="multipart/form-data"?C=yield c.formData():C=yield c.text(),{data:C,error:null}}catch(r){return{data:null,error:r}}})}}var Ci={},by={},mh={},ku={},Ah={},fh={},M5=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ks=M5();const z5=ks.fetch,Aw=ks.fetch.bind(ks),fw=ks.Headers,L5=ks.Request,D5=ks.Response,Us=Object.freeze(Object.defineProperty({__proto__:null,Headers:fw,Request:L5,Response:D5,default:Aw,fetch:z5},Symbol.toStringTag,{value:"Module"})),T5=kN(Us);var ph={};Object.defineProperty(ph,"__esModule",{value:!0});class j5 extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}ph.default=j5;var pw=xn&&xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fh,"__esModule",{value:!0});const U5=pw(T5),Q5=pw(ph);let P5=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=U5.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,n){return this.headers=Object.assign({},this.headers),this.headers[t]=n,this}then(t,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const i=this.fetch;let r=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var a,l,s;let g=null,c=null,u=null,I=o.status,C=o.statusText;if(o.ok){if(this.method!=="HEAD"){const A=await o.text();A===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=A:c=JSON.parse(A))}const f=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),b=(l=o.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");f&&b&&b.length>1&&(u=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(g={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,u=null,I=406,C="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const f=await o.text();try{g=JSON.parse(f),Array.isArray(g)&&o.status===404&&(c=[],g=null,I=200,C="OK")}catch{o.status===404&&f===""?(I=204,C="No Content"):g={message:f}}if(g&&this.isMaybeSingle&&(!((s=g==null?void 0:g.details)===null||s===void 0)&&s.includes("0 rows"))&&(g=null,I=200,C="OK"),g&&this.shouldThrowOnError)throw new Q5.default(g)}return{error:g,data:c,count:u,status:I,statusText:C}});return this.shouldThrowOnError||(r=r.catch(o=>{var a,l,s;return{error:{message:`${(a=o==null?void 0:o.name)!==null&&a!==void 0?a:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(l=o==null?void 0:o.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(s=o==null?void 0:o.code)!==null&&s!==void 0?s:""}`},data:null,count:null,status:0,statusText:""}})),r.then(t,n)}};fh.default=P5;var _5=xn&&xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ah,"__esModule",{value:!0});const O5=_5(fh);let q5=class extends O5.default{select(t){let n=!1;const i=(t??"*").split("").map(r=>/\s/.test(r)&&!n?"":(r==='"'&&(n=!n),r)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:n=!0,nullsFirst:i,foreignTable:r,referencedTable:o=r}={}){const a=o?`${o}.order`:"order",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:""}${t}.${n?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:n,referencedTable:i=n}={}){const r=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,n,{foreignTable:i,referencedTable:r=i}={}){const o=typeof r>"u"?"offset":`${r}.offset`,a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(o,`${t}`),this.url.searchParams.set(a,`${n-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:n=!1,settings:i=!1,buffers:r=!1,wal:o=!1,format:a="text"}={}){var l;const s=[t?"analyze":null,n?"verbose":null,i?"settings":null,r?"buffers":null,o?"wal":null].filter(Boolean).join("|"),g=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${g}"; options=${s};`,a==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ah.default=q5;var $5=xn&&xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ku,"__esModule",{value:!0});const eK=$5(Ah);let tK=class extends eK.default{eq(t,n){return this.url.searchParams.append(t,`eq.${n}`),this}neq(t,n){return this.url.searchParams.append(t,`neq.${n}`),this}gt(t,n){return this.url.searchParams.append(t,`gt.${n}`),this}gte(t,n){return this.url.searchParams.append(t,`gte.${n}`),this}lt(t,n){return this.url.searchParams.append(t,`lt.${n}`),this}lte(t,n){return this.url.searchParams.append(t,`lte.${n}`),this}like(t,n){return this.url.searchParams.append(t,`like.${n}`),this}likeAllOf(t,n){return this.url.searchParams.append(t,`like(all).{${n.join(",")}}`),this}likeAnyOf(t,n){return this.url.searchParams.append(t,`like(any).{${n.join(",")}}`),this}ilike(t,n){return this.url.searchParams.append(t,`ilike.${n}`),this}ilikeAllOf(t,n){return this.url.searchParams.append(t,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(t,n){return this.url.searchParams.append(t,`ilike(any).{${n.join(",")}}`),this}is(t,n){return this.url.searchParams.append(t,`is.${n}`),this}in(t,n){const i=Array.from(new Set(n)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`in.(${i})`),this}contains(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cs.{${n.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(n)}`),this}containedBy(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cd.{${n.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(n)}`),this}rangeGt(t,n){return this.url.searchParams.append(t,`sr.${n}`),this}rangeGte(t,n){return this.url.searchParams.append(t,`nxl.${n}`),this}rangeLt(t,n){return this.url.searchParams.append(t,`sl.${n}`),this}rangeLte(t,n){return this.url.searchParams.append(t,`nxr.${n}`),this}rangeAdjacent(t,n){return this.url.searchParams.append(t,`adj.${n}`),this}overlaps(t,n){return typeof n=="string"?this.url.searchParams.append(t,`ov.${n}`):this.url.searchParams.append(t,`ov.{${n.join(",")}}`),this}textSearch(t,n,{config:i,type:r}={}){let o="";r==="plain"?o="pl":r==="phrase"?o="ph":r==="websearch"&&(o="w");const a=i===void 0?"":`(${i})`;return this.url.searchParams.append(t,`${o}fts${a}.${n}`),this}match(t){return Object.entries(t).forEach(([n,i])=>{this.url.searchParams.append(n,`eq.${i}`)}),this}not(t,n,i){return this.url.searchParams.append(t,`not.${n}.${i}`),this}or(t,{foreignTable:n,referencedTable:i=n}={}){const r=i?`${i}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,n,i){return this.url.searchParams.append(t,`${n}.${i}`),this}};ku.default=tK;var nK=xn&&xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(mh,"__esModule",{value:!0});const Gg=nK(ku);let iK=class{constructor(t,{headers:n={},schema:i,fetch:r}){this.url=t,this.headers=n,this.schema=i,this.fetch=r}select(t,{head:n=!1,count:i}={}){const r=n?"HEAD":"GET";let o=!1;const a=(t??"*").split("").map(l=>/\s/.test(l)&&!o?"":(l==='"'&&(o=!o),l)).join("");return this.url.searchParams.set("select",a),i&&(this.headers.Prefer=`count=${i}`),new Gg.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:n,defaultToNull:i=!0}={}){const r="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const a=t.reduce((l,s)=>l.concat(Object.keys(s)),[]);if(a.length>0){const l=[...new Set(a)].map(s=>`"${s}"`);this.url.searchParams.set("columns",l.join(","))}}return new Gg.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:n,ignoreDuplicates:i=!1,count:r,defaultToNull:o=!0}={}){const a="POST",l=[`resolution=${i?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),r&&l.push(`count=${r}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const s=t.reduce((g,c)=>g.concat(Object.keys(c)),[]);if(s.length>0){const g=[...new Set(s)].map(c=>`"${c}"`);this.url.searchParams.set("columns",g.join(","))}}return new Gg.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:n}={}){const i="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),this.headers.Prefer=r.join(","),new Gg.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const n="DELETE",i=[];return t&&i.push(`count=${t}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new Gg.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};mh.default=iK;var bh={},yh={};Object.defineProperty(yh,"__esModule",{value:!0});yh.version=void 0;yh.version="0.0.0-automated";Object.defineProperty(bh,"__esModule",{value:!0});bh.DEFAULT_HEADERS=void 0;const rK=yh;bh.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${rK.version}`};var bw=xn&&xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(by,"__esModule",{value:!0});const oK=bw(mh),aK=bw(ku),lK=bh;let sK=class yw{constructor(t,{headers:n={},schema:i,fetch:r}={}){this.url=t,this.headers=Object.assign(Object.assign({},lK.DEFAULT_HEADERS),n),this.schemaName=i,this.fetch=r}from(t){const n=new URL(`${this.url}/${t}`);return new oK.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new yw(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,n={},{head:i=!1,get:r=!1,count:o}={}){let a;const l=new URL(`${this.url}/rpc/${t}`);let s;i||r?(a=i?"HEAD":"GET",Object.entries(n).filter(([c,u])=>u!==void 0).map(([c,u])=>[c,Array.isArray(u)?`{${u.join(",")}}`:`${u}`]).forEach(([c,u])=>{l.searchParams.append(c,u)})):(a="POST",s=n);const g=Object.assign({},this.headers);return o&&(g.Prefer=`count=${o}`),new aK.default({method:a,url:l,headers:g,schema:this.schemaName,body:s,fetch:this.fetch,allowEmpty:!1})}};by.default=sK;var Qs=xn&&xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ci,"__esModule",{value:!0});Ci.PostgrestError=Ci.PostgrestBuilder=Ci.PostgrestTransformBuilder=Ci.PostgrestFilterBuilder=Ci.PostgrestQueryBuilder=Ci.PostgrestClient=void 0;const Zw=Qs(by);Ci.PostgrestClient=Zw.default;const vw=Qs(mh);Ci.PostgrestQueryBuilder=vw.default;const Gw=Qs(ku);Ci.PostgrestFilterBuilder=Gw.default;const Sw=Qs(Ah);Ci.PostgrestTransformBuilder=Sw.default;const Bw=Qs(fh);Ci.PostgrestBuilder=Bw.default;const Rw=Qs(ph);Ci.PostgrestError=Rw.default;var gK=Ci.default={PostgrestClient:Zw.default,PostgrestQueryBuilder:vw.default,PostgrestFilterBuilder:Gw.default,PostgrestTransformBuilder:Sw.default,PostgrestBuilder:Bw.default,PostgrestError:Rw.default};const{PostgrestClient:cK,PostgrestQueryBuilder:Ice,PostgrestFilterBuilder:dce,PostgrestTransformBuilder:Cce,PostgrestBuilder:hce}=gK,uK="2.11.2",IK={"X-Client-Info":`realtime-js/${uK}`},dK="1.0.0",Ww=1e4,CK=1e3;var hs;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(hs||(hs={}));var Ri;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ri||(Ri={}));var sr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(sr||(sr={}));var Gp;(function(e){e.websocket="websocket"})(Gp||(Gp={}));var Ma;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ma||(Ma={}));class hK{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,n,i)}_decodeBroadcast(t,n,i){const r=n.getUint8(1),o=n.getUint8(2);let a=this.HEADER_LENGTH+2;const l=i.decode(t.slice(a,a+r));a=a+r;const s=i.decode(t.slice(a,a+o));a=a+o;const g=JSON.parse(i.decode(t.slice(a,t.byteLength)));return{ref:null,topic:l,event:s,payload:g}}}class kw{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Et;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Et||(Et={}));const SG=(e,t,n={})=>{var i;const r=(i=n.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(t).reduce((o,a)=>(o[a]=mK(a,e,t,r),o),{})},mK=(e,t,n,i)=>{const r=t.find(l=>l.name===e),o=r==null?void 0:r.type,a=n[e];return o&&!i.includes(o)?Vw(o,a):Sp(a)},Vw=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return bK(t,n)}switch(e){case Et.bool:return AK(t);case Et.float4:case Et.float8:case Et.int2:case Et.int4:case Et.int8:case Et.numeric:case Et.oid:return fK(t);case Et.json:case Et.jsonb:return pK(t);case Et.timestamp:return yK(t);case Et.abstime:case Et.date:case Et.daterange:case Et.int4range:case Et.int8range:case Et.money:case Et.reltime:case Et.text:case Et.time:case Et.timestamptz:case Et.timetz:case Et.tsrange:case Et.tstzrange:return Sp(t);default:return Sp(t)}},Sp=e=>e,AK=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},fK=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},pK=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},bK=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,i=e[n];if(e[0]==="{"&&i==="}"){let o;const a=e.slice(1,n);try{o=JSON.parse("["+a+"]")}catch{o=a?a.split(","):[]}return o.map(l=>Vw(t,l))}return e},yK=e=>typeof e=="string"?e.replace(" ","T"):e,ww=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class hA{constructor(t,n,i={},r=Ww){this.channel=t,this.event=n,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var i;return this._hasReceived(t)&&n((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var BG;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(BG||(BG={}));class uc{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:o,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=uc.syncState(this.state,r,o,a),this.pendingDiffs.forEach(s=>{this.state=uc.syncDiff(this.state,s,o,a)}),this.pendingDiffs=[],l()}),this.channel._on(i.diff,{},r=>{const{onJoin:o,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=uc.syncDiff(this.state,r,o,a),l())}),this.onJoin((r,o,a)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:o,newPresences:a})}),this.onLeave((r,o,a)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:o,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,i,r){const o=this.cloneDeep(t),a=this.transformState(n),l={},s={};return this.map(o,(g,c)=>{a[g]||(s[g]=c)}),this.map(a,(g,c)=>{const u=o[g];if(u){const I=c.map(b=>b.presence_ref),C=u.map(b=>b.presence_ref),m=c.filter(b=>C.indexOf(b.presence_ref)<0),f=u.filter(b=>I.indexOf(b.presence_ref)<0);m.length>0&&(l[g]=m),f.length>0&&(s[g]=f)}else l[g]=c}),this.syncDiff(o,{joins:l,leaves:s},i,r)}static syncDiff(t,n,i,r){const{joins:o,leaves:a}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(o,(l,s)=>{var g;const c=(g=t[l])!==null&&g!==void 0?g:[];if(t[l]=this.cloneDeep(s),c.length>0){const u=t[l].map(C=>C.presence_ref),I=c.filter(C=>u.indexOf(C.presence_ref)<0);t[l].unshift(...I)}i(l,c,s)}),this.map(a,(l,s)=>{let g=t[l];if(!g)return;const c=s.map(u=>u.presence_ref);g=g.filter(u=>c.indexOf(u.presence_ref)<0),t[l]=g,r(l,g,s),g.length===0&&delete t[l]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(i=>n(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,i)=>{const r=t[i];return"metas"in r?n[i]=r.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):n[i]=r,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var RG;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(RG||(RG={}));var WG;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(WG||(WG={}));var jr;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(jr||(jr={}));class yy{constructor(t,n={config:{}},i){this.topic=t,this.params=n,this.socket=i,this.bindings={},this.state=Ri.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new hA(this,sr.join,this.params,this.timeout),this.rejoinTimer=new kw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ri.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ri.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=Ri.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ri.errored,this.rejoinTimer.scheduleTimeout())}),this._on(sr.reply,{},(r,o)=>{this._trigger(this._replyEventName(o),r)}),this.presence=new uc(this),this.broadcastEndpointURL=ww(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,n=this.timeout){var i,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:o,presence:a,private:l}}=this.params;this._onError(c=>t==null?void 0:t(jr.CHANNEL_ERROR,c)),this._onClose(()=>t==null?void 0:t(jr.CLOSED));const s={},g={broadcast:o,presence:a,postgres_changes:(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(c=>c.filter))!==null&&r!==void 0?r:[],private:l};this.socket.accessTokenValue&&(s.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:g},s)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:c})=>{var u;if(this.socket.setAuth(),c===void 0){t==null||t(jr.SUBSCRIBED);return}else{const I=this.bindings.postgres_changes,C=(u=I==null?void 0:I.length)!==null&&u!==void 0?u:0,m=[];for(let f=0;f<C;f++){const b=I[f],{filter:{event:A,schema:p,table:y,filter:Z}}=b,G=c&&c[f];if(G&&G.event===A&&G.schema===p&&G.table===y&&G.filter===Z)m.push(Object.assign(Object.assign({},b),{id:G.id}));else{this.unsubscribe(),t==null||t(jr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,t&&t(jr.SUBSCRIBED);return}}).receive("error",c=>{t==null||t(jr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(jr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,i){return this._on(t,n,i)}async send(t,n={}){var i,r;if(!this._canPush()&&t.type==="broadcast"){const{event:o,payload:a}=t,s={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:a,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,s,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);return await((r=g.body)===null||r===void 0?void 0:r.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var a,l,s;const g=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((s=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||s===void 0)&&s.ack)&&o("ok"),g.receive("ok",()=>o("ok")),g.receive("error",()=>o("error")),g.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ri.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(sr.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(i=>{const r=new hA(this,sr.leave,{},t);r.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}async _fetchWithTimeout(t,n,i){const r=new AbortController,o=setTimeout(()=>r.abort(),i),a=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(o),a}_push(t,n,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new hA(this,t,n,i);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(t,n,i){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,i){var r,o;const a=t.toLocaleLowerCase(),{close:l,error:s,leave:g,join:c}=sr;if(i&&[l,s,g,c].indexOf(a)>=0&&i!==this._joinRef())return;let I=this._onMessage(a,n,i);if(n&&!I)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(C=>{var m,f,b;return((m=C.filter)===null||m===void 0?void 0:m.event)==="*"||((b=(f=C.filter)===null||f===void 0?void 0:f.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===a}).map(C=>C.callback(I,i)):(o=this.bindings[a])===null||o===void 0||o.filter(C=>{var m,f,b,A,p,y;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in C){const Z=C.id,G=(m=C.filter)===null||m===void 0?void 0:m.event;return Z&&((f=n.ids)===null||f===void 0?void 0:f.includes(Z))&&(G==="*"||(G==null?void 0:G.toLocaleLowerCase())===((b=n.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const Z=(p=(A=C==null?void 0:C.filter)===null||A===void 0?void 0:A.event)===null||p===void 0?void 0:p.toLocaleLowerCase();return Z==="*"||Z===((y=n==null?void 0:n.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return C.type.toLocaleLowerCase()===a}).map(C=>{if(typeof I=="object"&&"ids"in I){const m=I.data,{schema:f,table:b,commit_timestamp:A,type:p,errors:y}=m;I=Object.assign(Object.assign({},{schema:f,table:b,commit_timestamp:A,eventType:p,new:{},old:{},errors:y}),this._getPayloadRecords(m))}C.callback(I,i)})}_isClosed(){return this.state===Ri.closed}_isJoined(){return this.state===Ri.joined}_isJoining(){return this.state===Ri.joining}_isLeaving(){return this.state===Ri.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,i){const r=t.toLocaleLowerCase(),o={type:r,filter:n,callback:i};return this.bindings[r]?this.bindings[r].push(o):this.bindings[r]=[o],this}_off(t,n){const i=t.toLocaleLowerCase();return this.bindings[i]=this.bindings[i].filter(r=>{var o;return!(((o=r.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===i&&yy.isEqual(r.filter,n))}),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const i in t)if(t[i]!==n[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(sr.close,{},t)}_onError(t){this._on(sr.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ri.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=SG(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=SG(t.columns,t.old_record)),n}}const ZK=()=>{},vK=typeof WebSocket<"u",GK=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class SK{constructor(t,n){var i;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=IK,this.params={},this.timeout=Ww,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=ZK,this.conn=null,this.sendBuffer=[],this.serializer=new hK,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=o=>{let a;return o?a=o:typeof fetch>"u"?a=(...l)=>Ws(async()=>{const{default:s}=await Promise.resolve().then(()=>Us);return{default:s}},void 0).then(({default:s})=>s(...l)):a=fetch,(...l)=>a(...l)},this.endPoint=`${t}/${Gp.websocket}`,this.httpEndpoint=ww(t),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const r=(i=n==null?void 0:n.params)===null||i===void 0?void 0:i.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(o,a)=>a(JSON.stringify(o)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new kw(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(vK){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new BK(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Ws(async()=>{const{default:t}=await import("./browser-D-boQeZY.js").then(n=>n.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:dK}))}disconnect(t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),t}log(t,n,i){this.logger(t,n,i)}connectionState(){switch(this.conn&&this.conn.readyState){case hs.connecting:return Ma.Connecting;case hs.open:return Ma.Open;case hs.closing:return Ma.Closing;default:return Ma.Closed}}isConnected(){return this.connectionState()===Ma.Open}channel(t,n={config:{}}){const i=new yy(`realtime:${t}`,n,this);return this.channels.push(i),i}push(t){const{topic:n,event:i,payload:r,ref:o}=t,a=()=>{this.encode(t,l=>{var s;(s=this.conn)===null||s===void 0||s.send(l)})};this.log("push",`${n} ${i} (${o})`,r),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){let n=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(n){let i=null;try{i=JSON.parse(atob(n.split(".")[1]))}catch{}if(i&&i.exp&&!(Math.floor(Date.now()/1e3)-i.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${i.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${i.exp}`);this.accessTokenValue=n,this.channels.forEach(r=>{n&&r.updateJoinPayload({access_token:n}),r.joinedOnce&&r._isJoined()&&r._push(sr.access_token,{access_token:n})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(CK,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,n=>{let{topic:i,event:r,payload:o,ref:a}=n;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${o.status||""} ${i} ${r} ${a&&"("+a+")"||""}`,o),this.channels.filter(l=>l._isMember(i)).forEach(l=>l._trigger(r,o,a)),this.stateChangeCallbacks.message.forEach(l=>l(n))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(sr.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const i=t.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${t}${i}${r}`}_workerObjectUrl(t){let n;if(t)n=t;else{const i=new Blob([GK],{type:"application/javascript"});n=URL.createObjectURL(i)}return n}}class BK{constructor(t,n,i){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=hs.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=i.close}}class Zy extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function kn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class RK extends Zy{constructor(t,n){super(t),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Bp extends Zy{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}var WK=function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(c){try{g(i.next(c))}catch(u){a(u)}}function s(c){try{g(i.throw(c))}catch(u){a(u)}}function g(c){c.done?o(c.value):r(c.value).then(l,s)}g((i=i.apply(e,t||[])).next())})};const xw=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Ws(async()=>{const{default:i}=await Promise.resolve().then(()=>Us);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},kK=()=>WK(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ws(()=>Promise.resolve().then(()=>Us),void 0)).Response:Response}),Rp=e=>{if(Array.isArray(e))return e.map(n=>Rp(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,i])=>{const r=n.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[r]=Rp(i)}),t};var dl=function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(c){try{g(i.next(c))}catch(u){a(u)}}function s(c){try{g(i.throw(c))}catch(u){a(u)}}function g(c){c.done?o(c.value):r(c.value).then(l,s)}g((i=i.apply(e,t||[])).next())})};const mA=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),VK=(e,t,n)=>dl(void 0,void 0,void 0,function*(){const i=yield kK();e instanceof i&&!(n!=null&&n.noResolveJson)?e.json().then(r=>{t(new RK(mA(r),e.status||500))}).catch(r=>{t(new Bp(mA(r),r))}):t(new Bp(mA(e),e))}),wK=(e,t,n,i)=>{const r={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i&&(r.body=JSON.stringify(i)),Object.assign(Object.assign({},r),n))};function Vu(e,t,n,i,r,o){return dl(this,void 0,void 0,function*(){return new Promise((a,l)=>{e(n,wK(t,i,r,o)).then(s=>{if(!s.ok)throw s;return i!=null&&i.noResolveJson?s:s.json()}).then(s=>a(s)).catch(s=>VK(s,l,i))})})}function IC(e,t,n,i){return dl(this,void 0,void 0,function*(){return Vu(e,"GET",t,n,i)})}function Jo(e,t,n,i,r){return dl(this,void 0,void 0,function*(){return Vu(e,"POST",t,i,r,n)})}function xK(e,t,n,i,r){return dl(this,void 0,void 0,function*(){return Vu(e,"PUT",t,i,r,n)})}function XK(e,t,n,i){return dl(this,void 0,void 0,function*(){return Vu(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),i)})}function Xw(e,t,n,i,r){return dl(this,void 0,void 0,function*(){return Vu(e,"DELETE",t,i,r,n)})}var ci=function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(c){try{g(i.next(c))}catch(u){a(u)}}function s(c){try{g(i.throw(c))}catch(u){a(u)}}function g(c){c.done?o(c.value):r(c.value).then(l,s)}g((i=i.apply(e,t||[])).next())})};const JK={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},kG={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class YK{constructor(t,n={},i,r){this.url=t,this.headers=n,this.bucketId=i,this.fetch=xw(r)}uploadOrUpdate(t,n,i,r){return ci(this,void 0,void 0,function*(){try{let o;const a=Object.assign(Object.assign({},kG),r);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const s=a.metadata;typeof Blob<"u"&&i instanceof Blob?(o=new FormData,o.append("cacheControl",a.cacheControl),s&&o.append("metadata",this.encodeMetadata(s)),o.append("",i)):typeof FormData<"u"&&i instanceof FormData?(o=i,o.append("cacheControl",a.cacheControl),s&&o.append("metadata",this.encodeMetadata(s))):(o=i,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,s&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(s)))),r!=null&&r.headers&&(l=Object.assign(Object.assign({},l),r.headers));const g=this._removeEmptyFolders(n),c=this._getFinalPath(g),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:t,body:o,headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{})),I=yield u.json();return u.ok?{data:{path:g,id:I.Id,fullPath:I.Key},error:null}:{data:null,error:I}}catch(o){if(kn(o))return{data:null,error:o};throw o}})}upload(t,n,i){return ci(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,i)})}uploadToSignedUrl(t,n,i,r){return ci(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(t),a=this._getFinalPath(o),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",n);try{let s;const g=Object.assign({upsert:kG.upsert},r),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(g.upsert)});typeof Blob<"u"&&i instanceof Blob?(s=new FormData,s.append("cacheControl",g.cacheControl),s.append("",i)):typeof FormData<"u"&&i instanceof FormData?(s=i,s.append("cacheControl",g.cacheControl)):(s=i,c["cache-control"]=`max-age=${g.cacheControl}`,c["content-type"]=g.contentType);const u=yield this.fetch(l.toString(),{method:"PUT",body:s,headers:c}),I=yield u.json();return u.ok?{data:{path:o,fullPath:I.Key},error:null}:{data:null,error:I}}catch(s){if(kn(s))return{data:null,error:s};throw s}})}createSignedUploadUrl(t,n){return ci(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t);const r=Object.assign({},this.headers);n!=null&&n.upsert&&(r["x-upsert"]="true");const o=yield Jo(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),a=new URL(this.url+o.url),l=a.searchParams.get("token");if(!l)throw new Zy("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:l},error:null}}catch(i){if(kn(i))return{data:null,error:i};throw i}})}update(t,n,i){return ci(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,i)})}move(t,n,i){return ci(this,void 0,void 0,function*(){try{return{data:yield Jo(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(kn(r))return{data:null,error:r};throw r}})}copy(t,n,i){return ci(this,void 0,void 0,function*(){try{return{data:{path:(yield Jo(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(kn(r))return{data:null,error:r};throw r}})}createSignedUrl(t,n,i){return ci(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),o=yield Jo(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const a=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${a}`)},{data:o,error:null}}catch(r){if(kn(r))return{data:null,error:r};throw r}})}createSignedUrls(t,n,i){return ci(this,void 0,void 0,function*(){try{const r=yield Jo(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),o=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${o}`):null})),error:null}}catch(r){if(kn(r))return{data:null,error:r};throw r}})}download(t,n){return ci(this,void 0,void 0,function*(){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),a=o?`?${o}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield IC(this.fetch,`${this.url}/${r}/${l}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(kn(l))return{data:null,error:l};throw l}})}info(t){return ci(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const i=yield IC(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Rp(i),error:null}}catch(i){if(kn(i))return{data:null,error:i};throw i}})}exists(t){return ci(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield XK(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(kn(i)&&i instanceof Bp){const r=i.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:i}}throw i}})}getPublicUrl(t,n){const i=this._getFinalPath(t),r=[],o=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";o!==""&&r.push(o);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});s!==""&&r.push(s);let g=r.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${i}${g}`)}}}remove(t){return ci(this,void 0,void 0,function*(){try{return{data:yield Xw(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(kn(n))return{data:null,error:n};throw n}})}list(t,n,i){return ci(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},JK),n),{prefix:t||""});return{data:yield Jo(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(kn(r))return{data:null,error:r};throw r}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const NK="2.7.1",HK={"X-Client-Info":`storage-js/${NK}`};var Wl=function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(c){try{g(i.next(c))}catch(u){a(u)}}function s(c){try{g(i.throw(c))}catch(u){a(u)}}function g(c){c.done?o(c.value):r(c.value).then(l,s)}g((i=i.apply(e,t||[])).next())})};class FK{constructor(t,n={},i){this.url=t,this.headers=Object.assign(Object.assign({},HK),n),this.fetch=xw(i)}listBuckets(){return Wl(this,void 0,void 0,function*(){try{return{data:yield IC(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(kn(t))return{data:null,error:t};throw t}})}getBucket(t){return Wl(this,void 0,void 0,function*(){try{return{data:yield IC(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(kn(n))return{data:null,error:n};throw n}})}createBucket(t,n={public:!1}){return Wl(this,void 0,void 0,function*(){try{return{data:yield Jo(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(kn(i))return{data:null,error:i};throw i}})}updateBucket(t,n){return Wl(this,void 0,void 0,function*(){try{return{data:yield xK(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(kn(i))return{data:null,error:i};throw i}})}emptyBucket(t){return Wl(this,void 0,void 0,function*(){try{return{data:yield Jo(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(kn(n))return{data:null,error:n};throw n}})}deleteBucket(t){return Wl(this,void 0,void 0,function*(){try{return{data:yield Xw(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(kn(n))return{data:null,error:n};throw n}})}}class KK extends FK{constructor(t,n={},i){super(t,n,i)}from(t){return new YK(this.url,this.headers,t,this.fetch)}}const EK="2.47.6";let Ug="";typeof Deno<"u"?Ug="deno":typeof document<"u"?Ug="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ug="react-native":Ug="node";const MK={"X-Client-Info":`supabase-js-${Ug}/${EK}`},zK={headers:MK},LK={schema:"public"},DK={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},TK={};var jK=function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(c){try{g(i.next(c))}catch(u){a(u)}}function s(c){try{g(i.throw(c))}catch(u){a(u)}}function g(c){c.done?o(c.value):r(c.value).then(l,s)}g((i=i.apply(e,t||[])).next())})};const UK=e=>{let t;return e?t=e:typeof fetch>"u"?t=Aw:t=fetch,(...n)=>t(...n)},QK=()=>typeof Headers>"u"?fw:Headers,PK=(e,t,n)=>{const i=UK(n),r=QK();return(o,a)=>jK(void 0,void 0,void 0,function*(){var l;const s=(l=yield t())!==null&&l!==void 0?l:e;let g=new r(a==null?void 0:a.headers);return g.has("apikey")||g.set("apikey",e),g.has("Authorization")||g.set("Authorization",`Bearer ${s}`),i(o,Object.assign(Object.assign({},a),{headers:g}))})};var _K=function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(c){try{g(i.next(c))}catch(u){a(u)}}function s(c){try{g(i.throw(c))}catch(u){a(u)}}function g(c){c.done?o(c.value):r(c.value).then(l,s)}g((i=i.apply(e,t||[])).next())})};function OK(e){return e.replace(/\/$/,"")}function qK(e,t){const{db:n,auth:i,realtime:r,global:o}=e,{db:a,auth:l,realtime:s,global:g}=t,c={db:Object.assign(Object.assign({},a),n),auth:Object.assign(Object.assign({},l),i),realtime:Object.assign(Object.assign({},s),r),global:Object.assign(Object.assign({},g),o),accessToken:()=>_K(this,void 0,void 0,function*(){return""})};return e.accessToken?c.accessToken=e.accessToken:delete c.accessToken,c}const Jw="2.67.0",$K="http://localhost:9999",eE="supabase.auth.token",tE={"X-Client-Info":`gotrue-js/${Jw}`},VG=10,Wp="X-Supabase-Api-Version",Yw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function nE(e){return Math.round(Date.now()/1e3)+e}function iE(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const kr=()=>typeof document<"u",Ra={tested:!1,writable:!1},Ic=()=>{if(!kr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ra.tested)return Ra.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ra.tested=!0,Ra.writable=!0}catch{Ra.tested=!0,Ra.writable=!1}return Ra.writable};function rE(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,o)=>{t[o]=r})}catch{}return n.searchParams.forEach((i,r)=>{t[r]=i}),t}const Nw=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Ws(async()=>{const{default:i}=await Promise.resolve().then(()=>Us);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},oE=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Hw=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},fI=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},pI=async(e,t)=>{await e.removeItem(t)};function aE(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",i,r,o,a,l,s,g,c=0;for(e=e.replace("-","+").replace("_","/");c<e.length;)a=t.indexOf(e.charAt(c++)),l=t.indexOf(e.charAt(c++)),s=t.indexOf(e.charAt(c++)),g=t.indexOf(e.charAt(c++)),i=a<<2|l>>4,r=(l&15)<<4|s>>2,o=(s&3)<<6|g,n=n+String.fromCharCode(i),s!=64&&r!=0&&(n=n+String.fromCharCode(r)),g!=64&&o!=0&&(n=n+String.fromCharCode(o));return n}class Zh{constructor(){this.promise=new Zh.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}Zh.promiseConstructor=Promise;function wG(e){const t=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=e.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!t.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const i=n[1];return JSON.parse(aE(i))}async function lE(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function sE(e,t){return new Promise((i,r)=>{(async()=>{for(let o=0;o<1/0;o++)try{const a=await e(o);if(!t(o,null,a)){i(a);return}}catch(a){if(!t(o,a)){r(a);return}}})()})}function gE(e){return("0"+e.toString(16)).substr(-2)}function cE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=n.length;let r="";for(let o=0;o<56;o++)r+=n.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(t),Array.from(t,gE).join("")}async function uE(e){const n=new TextEncoder().encode(e),i=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(i);return Array.from(r).map(o=>String.fromCharCode(o)).join("")}function IE(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function dE(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await uE(e);return IE(n)}async function kl(e,t,n=!1){const i=cE();let r=i;n&&(r+="/PASSWORD_RECOVERY"),await Hw(e,`${t}-code-verifier`,r);const o=await dE(i);return[o,i===o?"plain":"s256"]}const CE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function hE(e){const t=e.headers.get(Wp);if(!t||!t.match(CE))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}class vh extends Error{constructor(t,n,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=i}}function ot(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class mE extends vh{constructor(t,n,i){super(t,n,i),this.name="AuthApiError",this.status=n,this.code=i}}function AE(e){return ot(e)&&e.name==="AuthApiError"}class Fw extends vh{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class Cl extends vh{constructor(t,n,i,r){super(t,i,r),this.name=n,this.status=i}}class Wo extends Cl{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function fE(e){return ot(e)&&e.name==="AuthSessionMissingError"}class AA extends Cl{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class bI extends Cl{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class yI extends Cl{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function pE(e){return ot(e)&&e.name==="AuthImplicitGrantRedirectError"}class xG extends Cl{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class kp extends Cl{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function fA(e){return ot(e)&&e.name==="AuthRetryableFetchError"}class XG extends Cl{constructor(t,n,i){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=i}}var bE=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const Ha=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),yE=[502,503,504];async function JG(e){var t;if(!oE(e))throw new kp(Ha(e),0);if(yE.includes(e.status))throw new kp(Ha(e),e.status);let n;try{n=await e.json()}catch(o){throw new Fw(Ha(o),o)}let i;const r=hE(e);if(r&&r.getTime()>=Yw["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?i=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(i=n.error_code),i){if(i==="weak_password")throw new XG(Ha(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(i==="session_not_found")throw new Wo}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((o,a)=>o&&typeof a=="string",!0))throw new XG(Ha(n),e.status,n.weak_password.reasons);throw new mE(Ha(n),e.status||500,i)}const ZE=(e,t,n,i)=>{const r={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),n))};async function mt(e,t,n,i){var r;const o=Object.assign({},i==null?void 0:i.headers);o[Wp]||(o[Wp]=Yw["2024-01-01"].name),i!=null&&i.jwt&&(o.Authorization=`Bearer ${i.jwt}`);const a=(r=i==null?void 0:i.query)!==null&&r!==void 0?r:{};i!=null&&i.redirectTo&&(a.redirect_to=i.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",s=await vE(e,t,n+l,{headers:o,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(s):{data:Object.assign({},s),error:null}}async function vE(e,t,n,i,r,o){const a=ZE(t,i,r,o);let l;try{l=await e(n,Object.assign({},a))}catch(s){throw console.error(s),new kp(Ha(s),0)}if(l.ok||await JG(l),i!=null&&i.noResolveJson)return l;try{return await l.json()}catch(s){await JG(s)}}function ko(e){var t;let n=null;RE(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=nE(e.expires_in)));const i=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:i},error:null}}function YG(e){const t=ko(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,i)=>n&&typeof i=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ko(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function GE(e){return{data:e,error:null}}function SE(e){const{action_link:t,email_otp:n,hashed_token:i,redirect_to:r,verification_type:o}=e,a=bE(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:n,hashed_token:i,redirect_to:r,verification_type:o},s=Object.assign({},a);return{data:{properties:l,user:s},error:null}}function BE(e){return e}function RE(e){return e.access_token&&e.refresh_token&&e.expires_in}var WE=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class kE{constructor({url:t="",headers:n={},fetch:i}){this.url=t,this.headers=n,this.fetch=Nw(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,n="global"){try{return await mt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}}async inviteUserByEmail(t,n={}){try{return await mt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ko})}catch(i){if(ot(i))return{data:{user:null},error:i};throw i}}async generateLink(t){try{const{options:n}=t,i=WE(t,["options"]),r=Object.assign(Object.assign({},i),n);return"newEmail"in i&&(r.new_email=i==null?void 0:i.newEmail,delete r.newEmail),await mt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:SE,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ot(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await mt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ko})}catch(n){if(ot(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,i,r,o,a,l,s;try{const g={nextPage:null,lastPage:0,total:0},c=await mt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(o=(r=t==null?void 0:t.perPage)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:""},xform:BE});if(c.error)throw c.error;const u=await c.json(),I=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,C=(s=(l=c.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&s!==void 0?s:[];return C.length>0&&(C.forEach(m=>{const f=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(m.split(";")[1].split("=")[1]);g[`${b}Page`]=f}),g.total=parseInt(I)),{data:Object.assign(Object.assign({},u),g),error:null}}catch(g){if(ot(g))return{data:{users:[]},error:g};throw g}}async getUserById(t){try{return await mt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ko})}catch(n){if(ot(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){try{return await mt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:Ko})}catch(i){if(ot(i))return{data:{user:null},error:i};throw i}}async deleteUser(t,n=!1){try{return await mt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ko})}catch(i){if(ot(i))return{data:{user:null},error:i};throw i}}async _listFactors(t){try{const{data:n,error:i}=await mt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:i}}catch(n){if(ot(n))return{data:null,error:n};throw n}}async _deleteFactor(t){try{return{data:await mt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}}}const VE={getItem:e=>Ic()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Ic()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Ic()&&globalThis.localStorage.removeItem(e)}};function NG(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}function wE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Vl={debug:!!(globalThis&&Ic()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Kw extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class xE extends Kw{}async function XE(e,t,n){Vl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),Vl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async r=>{if(r){Vl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await n()}finally{Vl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}else{if(t===0)throw Vl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new xE(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Vl.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}wE();const JE={url:$K,storageKey:eE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:tE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Sg=30*1e3,HG=3;async function FG(e,t,n){return await n()}class Tc{constructor(t){var n,i;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Tc.nextInstanceID,Tc.nextInstanceID+=1,this.instanceID>0&&kr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},JE),t);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new kE({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Nw(r.fetch),this.lock=r.lock||FG,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:kr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=XE:this.lock=FG,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:Ic()?this.storage=VE:(this.memoryStorage={},this.storage=NG(this.memoryStorage)):(this.memoryStorage={},this.storage=NG(this.memoryStorage)),kr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Jw}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{if(kr()&&this.detectSessionInUrl){const{data:n,error:i}=await this._getSessionFromURL();if(i){if(this._debug("#_initialize()","error detecting session from URL",i),pE(i)){const a=(t=i.details)===null||t===void 0?void 0:t.code;if(a==="identity_already_exists"||a==="identity_not_found"||a==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:r,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",r,"redirect type",o),await this._saveSession(r),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ot(n)?{error:n}:{error:new Fw("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,i,r;try{const o=await mt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.captchaToken}},xform:ko}),{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};const s=a.session,g=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:g,session:s},error:null}}catch(o){if(ot(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(t){var n,i,r;try{let o;if("email"in t){const{email:c,password:u,options:I}=t;let C=null,m=null;this.flowType==="pkce"&&([C,m]=await kl(this.storage,this.storageKey)),o=await mt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:I==null?void 0:I.emailRedirectTo,body:{email:c,password:u,data:(n=I==null?void 0:I.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:I==null?void 0:I.captchaToken},code_challenge:C,code_challenge_method:m},xform:ko})}else if("phone"in t){const{phone:c,password:u,options:I}=t;o=await mt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:u,data:(i=I==null?void 0:I.data)!==null&&i!==void 0?i:{},channel:(r=I==null?void 0:I.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:I==null?void 0:I.captchaToken}},xform:ko})}else throw new bI("You must provide either an email or phone number and a password");const{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};const s=a.session,g=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:g,session:s},error:null}}catch(o){if(ot(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(t){try{let n;if("email"in t){const{email:o,password:a,options:l}=t;n=await mt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:YG})}else if("phone"in t){const{phone:o,password:a,options:l}=t;n=await mt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:YG})}else throw new bI("You must provide either an email or phone number and a password");const{data:i,error:r}=n;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new AA}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(n){if(ot(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,i,r,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=t.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const n=await fI(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(n??"").split("/");try{const{data:o,error:a}=await mt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:i},xform:ko});if(await pI(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new AA}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:r??null}),error:a})}catch(o){if(ot(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(t){try{const{options:n,provider:i,token:r,access_token:o,nonce:a}=t,l=await mt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:o,nonce:a,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:ko}),{data:s,error:g}=l;return g?{data:{user:null,session:null},error:g}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new AA}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:s,error:g})}catch(n){if(ot(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,i,r,o,a;try{if("email"in t){const{email:l,options:s}=t;let g=null,c=null;this.flowType==="pkce"&&([g,c]=await kl(this.storage,this.storageKey));const{error:u}=await mt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=s==null?void 0:s.data)!==null&&n!==void 0?n:{},create_user:(i=s==null?void 0:s.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken},code_challenge:g,code_challenge_method:c},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in t){const{phone:l,options:s}=t,{data:g,error:c}=await mt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(r=s==null?void 0:s.data)!==null&&r!==void 0?r:{},create_user:(o=s==null?void 0:s.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken},channel:(a=s==null?void 0:s.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:g==null?void 0:g.message_id},error:c}}throw new bI("You must provide either an email or phone number.")}catch(l){if(ot(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var n,i;try{let r,o;"options"in t&&(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo,o=(i=t.options)===null||i===void 0?void 0:i.captchaToken);const{data:a,error:l}=await mt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:r,xform:ko});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const s=a.session,g=a.user;return s!=null&&s.access_token&&(await this._saveSession(s),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",s)),{data:{user:g,session:s},error:null}}catch(r){if(ot(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(t){var n,i,r;try{let o=null,a=null;return this.flowType==="pkce"&&([o,a]=await kl(this.storage,this.storageKey)),await mt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(i=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=t==null?void 0:t.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:GE})}catch(o){if(ot(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;if(i)throw i;if(!n)throw new Wo;const{error:r}=await mt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(t){if(ot(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:i,type:r,options:o}=t,{error:a}=await mt(this.fetch,"POST",n,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:i,type:r,options:o}=t,{data:a,error:l}=await mt(this.fetch,"POST",n,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l}}throw new bI("You must provide either an email or phone number and a type")}catch(n){if(ot(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=n();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await fI(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const i=t.expires_at?t.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",t.expires_at),!i){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(s,g,c)=>(!a&&g==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(s,g,c))})}return{data:{session:t},error:null}}const{session:r,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{session:null},error:o}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await mt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ko}):await this._useSession(async n=>{var i,r,o;const{data:a,error:l}=n;if(l)throw l;return!(!((i=a.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Wo}:await mt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0,xform:Ko})})}catch(n){if(ot(n))return fE(n)&&(await this._removeSession(),await pI(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async i=>{const{data:r,error:o}=i;if(o)throw o;if(!r.session)throw new Wo;const a=r.session;let l=null,s=null;this.flowType==="pkce"&&t.email!=null&&([l,s]=await kl(this.storage,this.storageKey));const{data:g,error:c}=await mt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:s}),jwt:a.access_token,xform:Ko});if(c)throw c;return a.user=g.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(i){if(ot(i))return{data:{user:null},error:i};throw i}}_decodeJWT(t){return wG(t)}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Wo;const n=Date.now()/1e3;let i=n,r=!0,o=null;const a=wG(t.access_token);if(a.exp&&(i=a.exp,r=i<=n),r){const{session:l,error:s}=await this._callRefreshToken(t.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:s}=await this._getUser(t.access_token);if(s)throw s;o={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:i-n,expires_at:i},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(n){if(ot(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var i;if(!t){const{data:a,error:l}=n;if(l)throw l;t=(i=a.session)!==null&&i!==void 0?i:void 0}if(!(t!=null&&t.refresh_token))throw new Wo;const{session:r,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{user:null,session:null},error:o}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ot(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(){try{if(!kr())throw new yI("No browser detected.");const t=rE(window.location.href);if(t.error||t.error_description||t.error_code)throw new yI(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const n=this._isImplicitGrantFlow(t),i=await this._isPKCEFlow(t);if(!n&&!i)throw this.flowType==="implicit"?new yI("Not a valid implicit grant flow url."):this.flowType==="pkce"?new xG("Not a valid PKCE flow url."):new vh("Invalid flow type.");if(i){if(this._debug("#_initialize()","begin","is PKCE flow",i),!t.code)throw new xG("No code detected.");const{data:y,error:Z}=await this._exchangeCodeForSession(t.code);if(Z)throw Z;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:a,refresh_token:l,expires_in:s,expires_at:g,token_type:c}=t;if(!a||!s||!l||!c)throw new yI("No session defined in URL");const u=Math.round(Date.now()/1e3),I=parseInt(s);let C=u+I;g&&(C=parseInt(g));const m=C-u;m*1e3<=Sg&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${I}s`);const f=C-I;u-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,C,u):u-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,C,u);const{data:b,error:A}=await this._getUser(a);if(A)throw A;const p={provider_token:r,provider_refresh_token:o,access_token:a,expires_in:I,expires_at:C,refresh_token:l,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:t.type},error:null}}catch(t){if(ot(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(t){return!!((t.access_token||t.error_description)&&this.flowType==="implicit")}async _isPKCEFlow(t){const n=await fI(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n&&this.flowType==="pkce")}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var i;const{data:r,error:o}=n;if(o)return{error:o};const a=(i=r.session)===null||i===void 0?void 0:i.access_token;if(a){const{error:l}=await this.admin.signOut(a,t);if(l&&!(AE(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await pI(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=iE(),i={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:i}}}async _emitInitialSession(t){return await this._useSession(async n=>{var i,r;try{const{data:{session:o},error:a}=n;if(a)throw a;await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,n={}){let i=null,r=null;this.flowType==="pkce"&&([i,r]=await kl(this.storage,this.storageKey,!0));try{return await mt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(o){if(ot(o))return{data:null,error:o};throw o}}async getUserIdentities(){var t;try{const{data:n,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}}async linkIdentity(t){var n;try{const{data:i,error:r}=await this._useSession(async o=>{var a,l,s,g,c;const{data:u,error:I}=o;if(I)throw I;const C=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:!0});return await mt(this.fetch,"GET",C,{headers:this.headers,jwt:(c=(g=u.session)===null||g===void 0?void 0:g.access_token)!==null&&c!==void 0?c:void 0})});if(r)throw r;return kr()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:t.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(ot(i))return{data:{provider:t.provider,url:null},error:i};throw i}}async unlinkIdentity(t){try{return await this._useSession(async n=>{var i,r;const{data:o,error:a}=n;if(a)throw a;return await mt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(r=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(ot(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const i=Date.now();return await sE(async r=>(r>0&&await lE(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await mt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ko})),(r,o)=>{const a=200*Math.pow(2,r);return o&&fA(o)&&Date.now()+a-i<Sg})}catch(i){if(this._debug(n,"error",i),ot(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const i=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",i),kr()&&!n.skipBrowserRedirect&&window.location.assign(i),{data:{provider:t,url:i},error:null}}async _recoverAndRefresh(){var t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await fI(this.storage,this.storageKey);if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),o=((t=i.expires_at)!==null&&t!==void 0?t:1/0)<r+VG;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${VG}s`),o){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),fA(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var n,i;if(!t)throw new Wo;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Zh;const{data:o,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!o.session)throw new Wo;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={session:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(r,"error",o),ot(o)){const a={session:null,error:o};return fA(o)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(a),a}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(o),o}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(t,n,i=!0){const r=`#_notifyAllSubscribers(${t})`;this._debug(r,"begin",n,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:t,session:n});const o=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,n)}catch(s){o.push(s)}});if(await Promise.all(a),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(r,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Hw(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await pI(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&kr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Sg);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:i}}=n;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-t)/Sg);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Sg}ms, refresh threshold is ${HG} ticks`),r<=HG&&await this._callRefreshToken(i.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Kw)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!kr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,i){const r=[`provider=${encodeURIComponent(n)}`];if(i!=null&&i.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[o,a]=await kl(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});r.push(l.toString())}if(i!=null&&i.queryParams){const o=new URLSearchParams(i.queryParams);r.push(o.toString())}return i!=null&&i.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${t}?${r.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var i;const{data:r,error:o}=n;return o?{data:null,error:o}:await mt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(ot(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var i,r;const{data:o,error:a}=n;if(a)return{data:null,error:a};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:s,error:g}=await mt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(i=o==null?void 0:o.session)===null||i===void 0?void 0:i.access_token});return g?{data:null,error:g}:(t.factorType==="totp"&&(!((r=s==null?void 0:s.totp)===null||r===void 0)&&r.qr_code)&&(s.totp.qr_code=`data:image/svg+xml;utf-8,${s.totp.qr_code}`),{data:s,error:null})})}catch(n){if(ot(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:o}=n;if(o)return{data:null,error:o};const{data:a,error:l}=await mt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})})}catch(n){if(ot(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:o}=n;return o?{data:null,error:o}:await mt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(ot(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:i}=await this._challenge({factorId:t.factorId});return i?{data:null,error:i}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const i=(t==null?void 0:t.factors)||[],r=i.filter(a=>a.factor_type==="totp"&&a.status==="verified"),o=i.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:i,totp:r,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,i;const{data:{session:r},error:o}=t;if(o)return{data:null,error:o};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(r.access_token);let l=null;a.aal&&(l=a.aal);let s=l;((i=(n=r.user.factors)===null||n===void 0?void 0:n.filter(u=>u.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(s="aal2");const c=a.amr||[];return{data:{currentLevel:l,nextLevel:s,currentAuthenticationMethods:c},error:null}}))}}Tc.nextInstanceID=0;const YE=Tc;class NE extends YE{constructor(t){super(t)}}var HE=function(e,t,n,i){function r(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(c){try{g(i.next(c))}catch(u){a(u)}}function s(c){try{g(i.throw(c))}catch(u){a(u)}}function g(c){c.done?o(c.value):r(c.value).then(l,s)}g((i=i.apply(e,t||[])).next())})};class FE{constructor(t,n,i){var r,o,a;if(this.supabaseUrl=t,this.supabaseKey=n,!t)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=OK(t);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;const s=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,g={db:LK,realtime:TK,auth:Object.assign(Object.assign({},DK),{storageKey:s}),global:zK},c=qK(i??{},g);this.storageKey=(r=c.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(o=c.global.headers)!==null&&o!==void 0?o:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(u,I)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(I)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=c.auth)!==null&&a!==void 0?a:{},this.headers,c.global.fetch),this.fetch=PK(n,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new cK(`${l}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new E5(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new KK(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},i={}){return this.rest.rpc(t,n,i)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,n;return HE(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(n=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:r,storageKey:o,flowType:a,lock:l,debug:s},g,c){var u;const I={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new NE({url:this.authUrl,headers:Object.assign(Object.assign({},I),g),storageKey:o,autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:r,flowType:a,lock:l,debug:s,fetch:c,hasCustomAuthorizationHeader:(u="Authorization"in this.headers)!==null&&u!==void 0?u:!1})}_initRealtimeClient(t){return new SK(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,i)=>{this._handleTokenChanged(n,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(t,n,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const KE=(e,t,n)=>new FE(e,t,n),EE="https://wryzdgcrrejrwfqsdaog.supabase.co",ME="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndyeXpkZ2NycmVqcndmcXNkYW9nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzM3NjgzMDQsImV4cCI6MjA0OTM0NDMwNH0.p0dezgq_lSZ_NZhSqwMNyGf919X9vMtoHkGNgqTGDrw",_=KE(EE,ME,{auth:{persistSession:!0,autoRefreshToken:!0}}),Ew=h.createContext(),zE=({children:e})=>{const[t,n]=h.useState(localStorage.getItem("userRole"));h.useEffect(()=>{const{data:{subscription:r}}=_.auth.onAuthStateChange((o,a)=>{console.log("Auth event:",o),o==="SIGNED_OUT"&&(localStorage.removeItem("userRole"),n(null))});return()=>{r.unsubscribe()}},[]);const i=r=>{r?localStorage.setItem("userRole",r):localStorage.removeItem("userRole"),n(r)};return d.jsx(Ew.Provider,{value:{userRole:t,updateUserRole:i},children:e})},vy=()=>h.useContext(Ew),LE=()=>{const e=Gt(),{updateUserRole:t}=vy(),[n,i]=h.useState(""),[r,o]=h.useState(""),[a,l]=h.useState(null),[s,g]=h.useState(!1),c=async u=>{u.preventDefault(),g(!0);try{const{data:I,error:C}=await _.auth.signInWithPassword({email:n,password:r});if(C)throw C;const{data:m,error:f}=await _.from("user_roles").select("role_id").eq("user_id",I.user.id).single();if(f)throw console.error("Error fetching user_role:",f),f;const{data:b,error:A}=await _.from("roles").select("role_name").eq("id",m.role_id).single();if(A)throw console.error("Error fetching role_name:",A),A;const p=b.role_name.trim().toLowerCase();if(console.log("Role before storing:",p),sessionStorage.setItem("showNotification","true"),t(p),console.log("Role after storing:",p),p==="client"){const{data:y,error:Z}=await _.from("profile").select("username").eq("user",I.user.id).single();if(Z)throw console.error("Error fetching profile data:",Z),Z;y!=null&&y.username?(console.log("Navigating to client dashboard"),e("/dashboard")):(console.log("Navigating to profile to set username"),e("/profile"))}else if(p==="admin")console.log("Navigating to admin dashboard"),e("/admin/dashboard");else throw new Error(`Unknown role: ${p}`)}catch(I){console.error("Error:",I.message),l(I.message)}finally{g(!1)}};return d.jsxs("div",{className:"container",children:[d.jsx("h1",{className:"header",children:"Login"}),d.jsxs("form",{onSubmit:c,children:[d.jsx("input",{type:"email",placeholder:"Email",value:n,onChange:u=>i(u.target.value),required:!0}),d.jsx("input",{type:"password",placeholder:"Password",value:r,onChange:u=>o(u.target.value),required:!0}),d.jsx("button",{type:"submit",className:"login-button",disabled:s,children:s?"Logging in...":"Login"})]}),d.jsxs("p",{className:"footer",children:["Don't have an account?"," ",d.jsx("button",{className:"signup-link",onClick:()=>e("/signup"),children:"Sign Up"})]})]})},DE=()=>{const[e,t]=h.useState(""),[n,i]=h.useState(""),[r,o]=h.useState(!1),a=Gt(),l=async s=>{var g,c;s.preventDefault(),o(!0);try{const{data:u,error:I}=await _.auth.signUp({email:e,password:n,options:{data:{role:"client"}}});if(I)throw console.error("Signup error details:",{message:I.message,status:I==null?void 0:I.status,details:I==null?void 0:I.details}),I;u!=null&&u.user&&console.log("Signup successful:",{userId:u.user.id,email:u.user.email,metadata:u.user.user_metadata}),alert("Account created! Please verify your email."),a("/login")}catch(u){console.error("Full error object:",u);let I="Signup failed: ";u.message?I+=u.message:u.msg?I+=u.msg:u.error_description?I+=u.error_description:I+="Unknown error occurred",(g=u.message)!=null&&g.includes("duplicate")?I="This email is already registered. Please try logging in instead.":(c=u.message)!=null&&c.includes("password")&&(I="Password must be at least 6 characters long."),alert(I)}finally{o(!1)}};return d.jsxs("div",{className:"signup-container",children:[d.jsx("h1",{className:"signup-header",children:"Sign Up"}),d.jsxs("form",{onSubmit:l,children:[d.jsx("input",{type:"email",placeholder:"Email",value:e,onChange:s=>t(s.target.value),required:!0}),d.jsx("input",{type:"password",placeholder:"Password",value:n,onChange:s=>i(s.target.value),required:!0}),d.jsx("button",{type:"submit",className:"signup-button",disabled:r,children:r?"Signing Up...":"Sign Up"})]}),d.jsxs("p",{children:["Already have an account?"," ",d.jsx("button",{className:"login-link",onClick:()=>a("/login"),children:"Log in here"})]})]})},Bg=({children:e})=>{const[t,n]=h.useState(null);return h.useEffect(()=>{(async()=>{const{data:r,error:o}=await _.auth.getSession();o||!r.session?n(!1):n(!0)})()},[]),t===null?d.jsx("div",{children:"Loading..."}):t?e:d.jsx(Or,{to:"/login"})},TE="/Time2Use/assets/Time2Use-logo-CrJGXTXK.png";var Mw={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},KG=ce.createContext&&ce.createContext(Mw),jE=["attr","size","title"];function UE(e,t){if(e==null)return{};var n=QE(e,t),i,r;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function QE(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function dC(){return dC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},dC.apply(this,arguments)}function EG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function CC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?EG(Object(n),!0).forEach(function(i){PE(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EG(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function PE(e,t,n){return t=_E(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _E(e){var t=OE(e,"string");return typeof t=="symbol"?t:t+""}function OE(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zw(e){return e&&e.map((t,n)=>ce.createElement(t.tag,CC({key:n},t.attr),zw(t.child)))}function gn(e){return t=>ce.createElement(qE,dC({attr:CC({},e.attr)},t),zw(e.child))}function qE(e){var t=n=>{var{attr:i,size:r,title:o}=e,a=UE(e,jE),l=r||n.size||"1em",s;return n.className&&(s=n.className),e.className&&(s=(s?s+" ":"")+e.className),ce.createElement("svg",dC({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,i,a,{className:s,style:CC(CC({color:e.color||n.color},n.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&ce.createElement("title",null,o),e.children)};return KG!==void 0?ce.createElement(KG.Consumer,null,n=>t(n)):t(Mw)}function MG(e){return gn({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"},child:[]}]})(e)}function $E(e){return gn({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(e)}function e3(e){return gn({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(e)}function t3(e){return gn({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 384c-28.02 0-31.26-32-74.5-32-43.43 0-46.825 32-74.75 32-27.695 0-31.454-32-74.75-32-42.842 0-47.218 32-74.5 32-28.148 0-31.202-32-74.75-32-43.547 0-46.653 32-74.75 32v-80c0-26.5 21.5-48 48-48h16V112h64v144h64V112h64v144h64V112h64v144h16c26.5 0 48 21.5 48 48v80zm0 128H0v-96c43.356 0 46.767-32 74.75-32 27.951 0 31.253 32 74.75 32 42.843 0 47.217-32 74.5-32 28.148 0 31.201 32 74.75 32 43.357 0 46.767-32 74.75-32 27.488 0 31.252 32 74.5 32v96zM96 96c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40zm128 0c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40zm128 0c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40z"},child:[]}]})(e)}function n3(e){return gn({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"},child:[]}]})(e)}function zG(e){return gn({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},child:[]}]})(e)}function i3(e){return gn({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function r3(e){return gn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function o3(e){return gn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(e)}function a3(e){return gn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 480H48c-26.51 0-48-21.49-48-48V80c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v352c0 26.51-21.49 48-48 48zM128 120c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zm0 96c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zm0 96c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zm288-136v-32c0-6.627-5.373-12-12-12H204c-6.627 0-12 5.373-12 12v32c0 6.627 5.373 12 12 12h200c6.627 0 12-5.373 12-12zm0 96v-32c0-6.627-5.373-12-12-12H204c-6.627 0-12 5.373-12 12v32c0 6.627 5.373 12 12 12h200c6.627 0 12-5.373 12-12zm0 96v-32c0-6.627-5.373-12-12-12H204c-6.627 0-12 5.373-12 12v32c0 6.627 5.373 12 12 12h200c6.627 0 12-5.373 12-12z"},child:[]}]})(e)}function l3(e){return gn({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(e)}function LG(e){return gn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z"},child:[]}]})(e)}function ZI(e){return gn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"},child:[]}]})(e)}function s3(e){return gn({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"},child:[]}]})(e)}function g3(e){return gn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function Lw(e){return gn({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M288 32C128.94 32 0 160.94 0 320c0 52.8 14.25 102.26 39.06 144.8 5.61 9.62 16.3 15.2 27.44 15.2h443c11.14 0 21.83-5.58 27.44-15.2C561.75 422.26 576 372.8 576 320c0-159.06-128.94-288-288-288zm0 64c14.71 0 26.58 10.13 30.32 23.65-1.11 2.26-2.64 4.23-3.45 6.67l-9.22 27.67c-5.13 3.49-10.97 6.01-17.64 6.01-17.67 0-32-14.33-32-32S270.33 96 288 96zM96 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm48-160c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm246.77-72.41l-61.33 184C343.13 347.33 352 364.54 352 384c0 11.72-3.38 22.55-8.88 32H232.88c-5.5-9.45-8.88-20.28-8.88-32 0-33.94 26.5-61.43 59.9-63.59l61.34-184.01c4.17-12.56 17.73-19.45 30.36-15.17 12.57 4.19 19.35 17.79 15.17 30.36zm14.66 57.2l15.52-46.55c3.47-1.29 7.13-2.23 11.05-2.23 17.67 0 32 14.33 32 32s-14.33 32-32 32c-11.38-.01-20.89-6.28-26.57-15.22zM480 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z"},child:[]}]})(e)}function c3(e){return gn({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"},child:[]}]})(e)}function u3(e){return gn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M149.333 216v80c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24v-80c0-13.255 10.745-24 24-24h101.333c13.255 0 24 10.745 24 24zM0 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H24c-13.255 0-24 10.745-24 24zM125.333 32H24C10.745 32 0 42.745 0 56v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24zm80 448H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zm-24-424v80c0 13.255 10.745 24 24 24H488c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24zm24 264H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24z"},child:[]}]})(e)}function I3(e){return gn({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function d3(e){return gn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M501.1 395.7L384 278.6c-23.1-23.1-57.6-27.6-85.4-13.9L192 158.1V96L64 0 0 64l96 128h62.1l106.6 106.6c-13.6 27.8-9.2 62.3 13.9 85.4l117.1 117.1c14.6 14.6 38.2 14.6 52.7 0l52.7-52.7c14.5-14.6 14.5-38.2 0-52.7zM331.7 225c28.3 0 54.9 11 74.9 31l19.4 19.4c15.8-6.9 30.8-16.5 43.8-29.5 37.1-37.1 49.7-89.3 37.9-136.7-2.2-9-13.5-12.1-20.1-5.5l-74.4 74.4-67.9-11.3L334 98.9l74.4-74.4c6.6-6.6 3.4-17.9-5.7-20.2-47.4-11.7-99.6.9-136.6 37.9-28.5 28.5-41.9 66.1-41.2 103.6l82.1 82.1c8.1-1.9 16.5-2.9 24.7-2.9zm-103.9 82l-56.7-56.7L18.7 402.8c-25 25-25 65.5 0 90.5s65.5 25 90.5 0l123.6-123.6c-7.6-19.9-9.9-41.6-5-62.7zM64 472c-13.2 0-24-10.8-24-24 0-13.3 10.7-24 24-24s24 10.7 24 24c0 13.2-10.7 24-24 24z"},child:[]}]})(e)}function Gy(e){return gn({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}function C3(e){return gn({tag:"svg",attr:{viewBox:"0 0 416 512"},child:[{tag:"path",attr:{d:"M207.9 15.2c.8 4.7 16.1 94.5 16.1 128.8 0 52.3-27.8 89.6-68.9 104.6L168 486.7c.7 13.7-10.2 25.3-24 25.3H80c-13.7 0-24.7-11.5-24-25.3l12.9-238.1C27.7 233.6 0 196.2 0 144 0 109.6 15.3 19.9 16.1 15.2 19.3-5.1 61.4-5.4 64 16.3v141.2c1.3 3.4 15.1 3.2 16 0 1.4-25.3 7.9-139.2 8-141.8 3.3-20.8 44.7-20.8 47.9 0 .2 2.7 6.6 116.5 8 141.8.9 3.2 14.8 3.4 16 0V16.3c2.6-21.6 44.8-21.4 48-1.1zm119.2 285.7l-15 185.1c-1.2 14 9.9 26 23.9 26h56c13.3 0 24-10.7 24-24V24c0-13.2-10.7-24-24-24-82.5 0-221.4 178.5-64.9 300.9z"},child:[]}]})(e)}const Vp=[{title:"Dashboard",link:"/dashboard",icon:d.jsx(Lw,{})},{title:"Inventory",link:"/inventory",icon:d.jsx(i3,{})},{title:"Scan QR",link:"/scan",icon:d.jsx(s3,{})},{title:"Recipe",link:"/recipes",icon:d.jsx(n3,{})},{title:"Profile",link:"/profile",icon:d.jsx(Gy,{})}],h3=()=>d.jsxs("nav",{children:[d.jsxs(Cs,{to:"/",className:"link",children:[d.jsx("img",{src:TE,alt:"Time2Use Logo",className:"logo-icon"}),"Time2Use"]}),d.jsx("div",{className:"menu-items",children:Vp.map((e,t)=>d.jsx(ns,{className:({isActive:n})=>n?"link active":"link",to:e.link,children:e.title},t))}),d.jsx("div",{className:"login-button-mobile-hidden",children:d.jsx("div",{className:"icons",children:d.jsx("a",{href:"https://github.com/JackyChung2003/CAT304-G30",target:"_blank",rel:"noreferrer",children:d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"github-icon icon-tabler icon-tabler-brand-github",width:"30",height:"30",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"#000",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"})]})})})})]});function m3(e){return gn({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 7V5a2 2 0 0 1 2-2h2"},child:[]},{tag:"path",attr:{d:"M17 3h2a2 2 0 0 1 2 2v2"},child:[]},{tag:"path",attr:{d:"M21 17v2a2 2 0 0 1-2 2h-2"},child:[]},{tag:"path",attr:{d:"M7 21H5a2 2 0 0 1-2-2v-2"},child:[]}]})(e)}const A3=()=>{const e=yi();return d.jsx("div",{className:"bottom-nav-container",children:d.jsxs("div",{className:"bottom-nav-wrapper",children:[Vp.slice(0,3).map((t,n)=>d.jsx(Cs,{to:t.link,className:`bottom-nav-links ${e.pathname===t.link?"active":""}`,children:d.jsx("div",{className:"nav-item",children:d.jsx("span",{className:"nav-icon",children:t.icon})})},n)),d.jsx("div",{className:"scan-icon-container",children:d.jsx("div",{className:"scan-icon-wrapper",children:d.jsx(Cs,{to:"/scan",className:"scan-icon-link",children:d.jsx(m3,{className:"scan-icon"})})})}),Vp.slice(3,5).map((t,n)=>d.jsx(Cs,{to:t.link,className:`bottom-nav-links ${e.pathname===t.link?"active":""}`,children:d.jsx("div",{className:"nav-item",children:d.jsx("span",{className:"nav-icon",children:t.icon})})},n+3))]})})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function wu(e){return e+.5|0}const zo=(e,t,n)=>Math.max(Math.min(e,n),t);function Qg(e){return zo(wu(e*2.55),0,255)}function ra(e){return zo(wu(e*255),0,255)}function Qr(e){return zo(wu(e/2.55)/100,0,1)}function DG(e){return zo(wu(e*100),0,100)}const zi={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},wp=[..."0123456789ABCDEF"],f3=e=>wp[e&15],p3=e=>wp[(e&240)>>4]+wp[e&15],vI=e=>(e&240)>>4===(e&15),b3=e=>vI(e.r)&&vI(e.g)&&vI(e.b)&&vI(e.a);function y3(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&zi[e[1]]*17,g:255&zi[e[2]]*17,b:255&zi[e[3]]*17,a:t===5?zi[e[4]]*17:255}:(t===7||t===9)&&(n={r:zi[e[1]]<<4|zi[e[2]],g:zi[e[3]]<<4|zi[e[4]],b:zi[e[5]]<<4|zi[e[6]],a:t===9?zi[e[7]]<<4|zi[e[8]]:255})),n}const Z3=(e,t)=>e<255?t(e):"";function v3(e){var t=b3(e)?f3:p3;return e?"#"+t(e.r)+t(e.g)+t(e.b)+Z3(e.a,t):void 0}const G3=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Dw(e,t,n){const i=t*Math.min(n,1-n),r=(o,a=(o+e/30)%12)=>n-i*Math.max(Math.min(a-3,9-a,1),-1);return[r(0),r(8),r(4)]}function S3(e,t,n){const i=(r,o=(r+e/60)%6)=>n-n*t*Math.max(Math.min(o,4-o,1),0);return[i(5),i(3),i(1)]}function B3(e,t,n){const i=Dw(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)i[r]*=1-t-n,i[r]+=t;return i}function R3(e,t,n,i,r){return e===r?(t-n)/i+(t<n?6:0):t===r?(n-e)/i+2:(e-t)/i+4}function Sy(e){const n=e.r/255,i=e.g/255,r=e.b/255,o=Math.max(n,i,r),a=Math.min(n,i,r),l=(o+a)/2;let s,g,c;return o!==a&&(c=o-a,g=l>.5?c/(2-o-a):c/(o+a),s=R3(n,i,r,c,o),s=s*60+.5),[s|0,g||0,l]}function By(e,t,n,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,i)).map(ra)}function Ry(e,t,n){return By(Dw,e,t,n)}function W3(e,t,n){return By(B3,e,t,n)}function k3(e,t,n){return By(S3,e,t,n)}function Tw(e){return(e%360+360)%360}function V3(e){const t=G3.exec(e);let n=255,i;if(!t)return;t[5]!==i&&(n=t[6]?Qg(+t[5]):ra(+t[5]));const r=Tw(+t[2]),o=+t[3]/100,a=+t[4]/100;return t[1]==="hwb"?i=W3(r,o,a):t[1]==="hsv"?i=k3(r,o,a):i=Ry(r,o,a),{r:i[0],g:i[1],b:i[2],a:n}}function w3(e,t){var n=Sy(e);n[0]=Tw(n[0]+t),n=Ry(n),e.r=n[0],e.g=n[1],e.b=n[2]}function x3(e){if(!e)return;const t=Sy(e),n=t[0],i=DG(t[1]),r=DG(t[2]);return e.a<255?`hsla(${n}, ${i}%, ${r}%, ${Qr(e.a)})`:`hsl(${n}, ${i}%, ${r}%)`}const TG={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},jG={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function X3(){const e={},t=Object.keys(jG),n=Object.keys(TG);let i,r,o,a,l;for(i=0;i<t.length;i++){for(a=l=t[i],r=0;r<n.length;r++)o=n[r],l=l.replace(o,TG[o]);o=parseInt(jG[a],16),e[l]=[o>>16&255,o>>8&255,o&255]}return e}let GI;function J3(e){GI||(GI=X3(),GI.transparent=[0,0,0,0]);const t=GI[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const Y3=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function N3(e){const t=Y3.exec(e);let n=255,i,r,o;if(t){if(t[7]!==i){const a=+t[7];n=t[8]?Qg(a):zo(a*255,0,255)}return i=+t[1],r=+t[3],o=+t[5],i=255&(t[2]?Qg(i):zo(i,0,255)),r=255&(t[4]?Qg(r):zo(r,0,255)),o=255&(t[6]?Qg(o):zo(o,0,255)),{r:i,g:r,b:o,a:n}}}function H3(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Qr(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const pA=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,wl=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function F3(e,t,n){const i=wl(Qr(e.r)),r=wl(Qr(e.g)),o=wl(Qr(e.b));return{r:ra(pA(i+n*(wl(Qr(t.r))-i))),g:ra(pA(r+n*(wl(Qr(t.g))-r))),b:ra(pA(o+n*(wl(Qr(t.b))-o))),a:e.a+n*(t.a-e.a)}}function SI(e,t,n){if(e){let i=Sy(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*n,t===0?360:1)),i=Ry(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function jw(e,t){return e&&Object.assign(t||{},e)}function UG(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=ra(e[3]))):(t=jw(e,{r:0,g:0,b:0,a:1}),t.a=ra(t.a)),t}function K3(e){return e.charAt(0)==="r"?N3(e):V3(e)}let Uw=class xp{constructor(t){if(t instanceof xp)return t;const n=typeof t;let i;n==="object"?i=UG(t):n==="string"&&(i=y3(t)||J3(t)||K3(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=jw(this._rgb);return t&&(t.a=Qr(t.a)),t}set rgb(t){this._rgb=UG(t)}rgbString(){return this._valid?H3(this._rgb):void 0}hexString(){return this._valid?v3(this._rgb):void 0}hslString(){return this._valid?x3(this._rgb):void 0}mix(t,n){if(t){const i=this.rgb,r=t.rgb;let o;const a=n===o?.5:n,l=2*a-1,s=i.a-r.a,g=((l*s===-1?l:(l+s)/(1+l*s))+1)/2;o=1-g,i.r=255&g*i.r+o*r.r+.5,i.g=255&g*i.g+o*r.g+.5,i.b=255&g*i.b+o*r.b+.5,i.a=a*i.a+(1-a)*r.a,this.rgb=i}return this}interpolate(t,n){return t&&(this._rgb=F3(this._rgb,t._rgb,n)),this}clone(){return new xp(this.rgb)}alpha(t){return this._rgb.a=ra(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=wu(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return SI(this._rgb,2,t),this}darken(t){return SI(this._rgb,2,-t),this}saturate(t){return SI(this._rgb,1,t),this}desaturate(t){return SI(this._rgb,1,-t),this}rotate(t){return w3(this._rgb,t),this}};/*!
 * Chart.js v4.4.7
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */function zr(){}const E3=(()=>{let e=0;return()=>e++})();function bt(e){return e==null}function en(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function ht(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function dn(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function Wi(e,t){return dn(e)?e:t}function nt(e,t){return typeof e>"u"?t:e}const M3=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,Qw=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function zt(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function kt(e,t,n,i){let r,o,a;if(en(e))for(o=e.length,r=0;r<o;r++)t.call(n,e[r],r);else if(ht(e))for(a=Object.keys(e),o=a.length,r=0;r<o;r++)t.call(n,e[a[r]],a[r])}function hC(e,t){let n,i,r,o;if(!e||!t||e.length!==t.length)return!1;for(n=0,i=e.length;n<i;++n)if(r=e[n],o=t[n],r.datasetIndex!==o.datasetIndex||r.index!==o.index)return!1;return!0}function mC(e){if(en(e))return e.map(mC);if(ht(e)){const t=Object.create(null),n=Object.keys(e),i=n.length;let r=0;for(;r<i;++r)t[n[r]]=mC(e[n[r]]);return t}return e}function Pw(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function z3(e,t,n,i){if(!Pw(e))return;const r=t[e],o=n[e];ht(r)&&ht(o)?jc(r,o,i):t[e]=mC(o)}function jc(e,t,n){const i=en(t)?t:[t],r=i.length;if(!ht(e))return e;n=n||{};const o=n.merger||z3;let a;for(let l=0;l<r;++l){if(a=i[l],!ht(a))continue;const s=Object.keys(a);for(let g=0,c=s.length;g<c;++g)o(s[g],e,a,n)}return e}function dc(e,t){return jc(e,t,{merger:L3})}function L3(e,t,n){if(!Pw(e))return;const i=t[e],r=n[e];ht(i)&&ht(r)?dc(i,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=mC(r))}const QG={"":e=>e,x:e=>e.x,y:e=>e.y};function D3(e){const t=e.split("."),n=[];let i="";for(const r of t)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}function T3(e){const t=D3(e);return n=>{for(const i of t){if(i==="")break;n=n&&n[i]}return n}}function ca(e,t){return(QG[t]||(QG[t]=T3(t)))(e)}function Wy(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Uc=e=>typeof e<"u",ua=e=>typeof e=="function",PG=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function j3(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Qt=Math.PI,Ut=2*Qt,U3=Ut+Qt,AC=Number.POSITIVE_INFINITY,Q3=Qt/180,hn=Qt/2,Wa=Qt/4,_G=Qt*2/3,Lo=Math.log10,Fr=Math.sign;function Cc(e,t,n){return Math.abs(e-t)<n}function OG(e){const t=Math.round(e);e=Cc(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(Lo(e))),i=e/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function P3(e){const t=[],n=Math.sqrt(e);let i;for(i=1;i<n;i++)e%i===0&&(t.push(i),t.push(e/i));return n===(n|0)&&t.push(n),t.sort((r,o)=>r-o).pop(),t}function Vs(e){return!isNaN(parseFloat(e))&&isFinite(e)}function _3(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function _w(e,t,n){let i,r,o;for(i=0,r=e.length;i<r;i++)o=e[i][n],isNaN(o)||(t.min=Math.min(t.min,o),t.max=Math.max(t.max,o))}function ur(e){return e*(Qt/180)}function ky(e){return e*(180/Qt)}function qG(e){if(!dn(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function Ow(e,t){const n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);let o=Math.atan2(i,n);return o<-.5*Qt&&(o+=Ut),{angle:o,distance:r}}function Xp(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function O3(e,t){return(e-t+U3)%Ut-Qt}function Vi(e){return(e%Ut+Ut)%Ut}function Qc(e,t,n,i){const r=Vi(e),o=Vi(t),a=Vi(n),l=Vi(o-r),s=Vi(a-r),g=Vi(r-o),c=Vi(r-a);return r===o||r===a||i&&o===a||l>s&&g<c}function Xn(e,t,n){return Math.max(t,Math.min(n,e))}function q3(e){return Xn(e,-32768,32767)}function qr(e,t,n,i=1e-6){return e>=Math.min(t,n)-i&&e<=Math.max(t,n)+i}function Vy(e,t,n){n=n||(a=>e[a]<t);let i=e.length-1,r=0,o;for(;i-r>1;)o=r+i>>1,n(o)?r=o:i=o;return{lo:r,hi:i}}const $r=(e,t,n,i)=>Vy(e,n,i?r=>{const o=e[r][t];return o<n||o===n&&e[r+1][t]===n}:r=>e[r][t]<n),$3=(e,t,n)=>Vy(e,n,i=>e[i][t]>=n);function eM(e,t,n){let i=0,r=e.length;for(;i<r&&e[i]<t;)i++;for(;r>i&&e[r-1]>n;)r--;return i>0||r<e.length?e.slice(i,r):e}const qw=["push","pop","shift","splice","unshift"];function tM(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),qw.forEach(n=>{const i="_onData"+Wy(n),r=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...o){const a=r.apply(this,o);return e._chartjs.listeners.forEach(l=>{typeof l[i]=="function"&&l[i](...o)}),a}})})}function $G(e,t){const n=e._chartjs;if(!n)return;const i=n.listeners,r=i.indexOf(t);r!==-1&&i.splice(r,1),!(i.length>0)&&(qw.forEach(o=>{delete e[o]}),delete e._chartjs)}function $w(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const e1=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function t1(e,t){let n=[],i=!1;return function(...r){n=r,i||(i=!0,e1.call(window,()=>{i=!1,e.apply(t,n)}))}}function nM(e,t){let n;return function(...i){return t?(clearTimeout(n),n=setTimeout(e,t,i)):e.apply(this,i),t}}const wy=e=>e==="start"?"left":e==="end"?"right":"center",jn=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,iM=(e,t,n,i)=>e===(i?"left":"right")?n:e==="center"?(t+n)/2:t;function n1(e,t,n){const i=t.length;let r=0,o=i;if(e._sorted){const{iScale:a,_parsed:l}=e,s=a.axis,{min:g,max:c,minDefined:u,maxDefined:I}=a.getUserBounds();u&&(r=Xn(Math.min($r(l,s,g).lo,n?i:$r(t,s,a.getPixelForValue(g)).lo),0,i-1)),I?o=Xn(Math.max($r(l,a.axis,c,!0).hi+1,n?0:$r(t,s,a.getPixelForValue(c),!0).hi+1),r,i)-r:o=i-r}return{start:r,count:o}}function i1(e){const{xScale:t,yScale:n,_scaleRanges:i}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!i)return e._scaleRanges=r,!0;const o=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,r),o}const BI=e=>e===0||e===1,eS=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*Ut/n)),tS=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*Ut/n)+1,hc={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*hn)+1,easeOutSine:e=>Math.sin(e*hn),easeInOutSine:e=>-.5*(Math.cos(Qt*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>BI(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>BI(e)?e:eS(e,.075,.3),easeOutElastic:e=>BI(e)?e:tS(e,.075,.3),easeInOutElastic(e){return BI(e)?e:e<.5?.5*eS(e*2,.1125,.45):.5+.5*tS(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-hc.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?hc.easeInBounce(e*2)*.5:hc.easeOutBounce(e*2-1)*.5+.5};function xy(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function nS(e){return xy(e)?e:new Uw(e)}function bA(e){return xy(e)?e:new Uw(e).saturate(.5).darken(.1).hexString()}const rM=["x","y","borderWidth","radius","tension"],oM=["color","borderColor","backgroundColor"];function aM(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:oM},numbers:{type:"number",properties:rM}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function lM(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const iS=new Map;function sM(e,t){t=t||{};const n=e+JSON.stringify(t);let i=iS.get(n);return i||(i=new Intl.NumberFormat(e,t),iS.set(n,i)),i}function xu(e,t,n){return sM(t,n).format(e)}const r1={values(e){return en(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const i=this.chart.options.locale;let r,o=e;if(n.length>1){const g=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(g<1e-4||g>1e15)&&(r="scientific"),o=gM(e,n)}const a=Lo(Math.abs(o)),l=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),s={notation:r,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(s,this.options.ticks.format),xu(e,i,s)},logarithmic(e,t,n){if(e===0)return"0";const i=n[t].significand||e/Math.pow(10,Math.floor(Lo(e)));return[1,2,3,5,10,15].includes(i)||t>.8*n.length?r1.numeric.call(this,e,t,n):""}};function gM(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var Gh={formatters:r1};function cM(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Gh.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const al=Object.create(null),Jp=Object.create(null);function mc(e,t){if(!t)return e;const n=t.split(".");for(let i=0,r=n.length;i<r;++i){const o=n[i];e=e[o]||(e[o]=Object.create(null))}return e}function yA(e,t,n){return typeof t=="string"?jc(mc(e,t),n):jc(mc(e,""),t)}class uM{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>bA(r.backgroundColor),this.hoverBorderColor=(i,r)=>bA(r.borderColor),this.hoverColor=(i,r)=>bA(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return yA(this,t,n)}get(t){return mc(this,t)}describe(t,n){return yA(Jp,t,n)}override(t,n){return yA(al,t,n)}route(t,n,i,r){const o=mc(this,t),a=mc(this,i),l="_"+n;Object.defineProperties(o,{[l]:{value:o[n],writable:!0},[n]:{enumerable:!0,get(){const s=this[l],g=a[r];return ht(s)?Object.assign({},g,s):nt(s,g)},set(s){this[l]=s}}})}apply(t){t.forEach(n=>n(this))}}var tn=new uM({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[aM,lM,cM]);function IM(e){return!e||bt(e.size)||bt(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function fC(e,t,n,i,r){let o=t[r];return o||(o=t[r]=e.measureText(r).width,n.push(r)),o>i&&(i=o),i}function dM(e,t,n,i){i=i||{};let r=i.data=i.data||{},o=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(r=i.data={},o=i.garbageCollect=[],i.font=t),e.save(),e.font=t;let a=0;const l=n.length;let s,g,c,u,I;for(s=0;s<l;s++)if(u=n[s],u!=null&&!en(u))a=fC(e,r,o,a,u);else if(en(u))for(g=0,c=u.length;g<c;g++)I=u[g],I!=null&&!en(I)&&(a=fC(e,r,o,a,I));e.restore();const C=o.length/2;if(C>n.length){for(s=0;s<C;s++)delete r[o[s]];o.splice(0,C)}return a}function ka(e,t,n){const i=e.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((t-r)*i)/i+r}function rS(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Yp(e,t,n,i){o1(e,t,n,i,null)}function o1(e,t,n,i,r){let o,a,l,s,g,c,u,I;const C=t.pointStyle,m=t.rotation,f=t.radius;let b=(m||0)*Q3;if(C&&typeof C=="object"&&(o=C.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){e.save(),e.translate(n,i),e.rotate(b),e.drawImage(C,-C.width/2,-C.height/2,C.width,C.height),e.restore();return}if(!(isNaN(f)||f<=0)){switch(e.beginPath(),C){default:r?e.ellipse(n,i,r/2,f,0,0,Ut):e.arc(n,i,f,0,Ut),e.closePath();break;case"triangle":c=r?r/2:f,e.moveTo(n+Math.sin(b)*c,i-Math.cos(b)*f),b+=_G,e.lineTo(n+Math.sin(b)*c,i-Math.cos(b)*f),b+=_G,e.lineTo(n+Math.sin(b)*c,i-Math.cos(b)*f),e.closePath();break;case"rectRounded":g=f*.516,s=f-g,a=Math.cos(b+Wa)*s,u=Math.cos(b+Wa)*(r?r/2-g:s),l=Math.sin(b+Wa)*s,I=Math.sin(b+Wa)*(r?r/2-g:s),e.arc(n-u,i-l,g,b-Qt,b-hn),e.arc(n+I,i-a,g,b-hn,b),e.arc(n+u,i+l,g,b,b+hn),e.arc(n-I,i+a,g,b+hn,b+Qt),e.closePath();break;case"rect":if(!m){s=Math.SQRT1_2*f,c=r?r/2:s,e.rect(n-c,i-s,2*c,2*s);break}b+=Wa;case"rectRot":u=Math.cos(b)*(r?r/2:f),a=Math.cos(b)*f,l=Math.sin(b)*f,I=Math.sin(b)*(r?r/2:f),e.moveTo(n-u,i-l),e.lineTo(n+I,i-a),e.lineTo(n+u,i+l),e.lineTo(n-I,i+a),e.closePath();break;case"crossRot":b+=Wa;case"cross":u=Math.cos(b)*(r?r/2:f),a=Math.cos(b)*f,l=Math.sin(b)*f,I=Math.sin(b)*(r?r/2:f),e.moveTo(n-u,i-l),e.lineTo(n+u,i+l),e.moveTo(n+I,i-a),e.lineTo(n-I,i+a);break;case"star":u=Math.cos(b)*(r?r/2:f),a=Math.cos(b)*f,l=Math.sin(b)*f,I=Math.sin(b)*(r?r/2:f),e.moveTo(n-u,i-l),e.lineTo(n+u,i+l),e.moveTo(n+I,i-a),e.lineTo(n-I,i+a),b+=Wa,u=Math.cos(b)*(r?r/2:f),a=Math.cos(b)*f,l=Math.sin(b)*f,I=Math.sin(b)*(r?r/2:f),e.moveTo(n-u,i-l),e.lineTo(n+u,i+l),e.moveTo(n+I,i-a),e.lineTo(n-I,i+a);break;case"line":a=r?r/2:Math.cos(b)*f,l=Math.sin(b)*f,e.moveTo(n-a,i-l),e.lineTo(n+a,i+l);break;case"dash":e.moveTo(n,i),e.lineTo(n+Math.cos(b)*(r?r/2:f),i+Math.sin(b)*f);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function eo(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Sh(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Bh(e){e.restore()}function CM(e,t,n,i,r){if(!t)return e.lineTo(n.x,n.y);if(r==="middle"){const o=(t.x+n.x)/2;e.lineTo(o,t.y),e.lineTo(o,n.y)}else r==="after"!=!!i?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function hM(e,t,n,i){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function mM(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),bt(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function AM(e,t,n,i,r){if(r.strikethrough||r.underline){const o=e.measureText(i),a=t-o.actualBoundingBoxLeft,l=t+o.actualBoundingBoxRight,s=n-o.actualBoundingBoxAscent,g=n+o.actualBoundingBoxDescent,c=r.strikethrough?(s+g)/2:g;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(a,c),e.lineTo(l,c),e.stroke()}}function fM(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function ll(e,t,n,i,r,o={}){const a=en(t)?t:[t],l=o.strokeWidth>0&&o.strokeColor!=="";let s,g;for(e.save(),e.font=r.string,mM(e,o),s=0;s<a.length;++s)g=a[s],o.backdrop&&fM(e,o.backdrop),l&&(o.strokeColor&&(e.strokeStyle=o.strokeColor),bt(o.strokeWidth)||(e.lineWidth=o.strokeWidth),e.strokeText(g,n,i,o.maxWidth)),e.fillText(g,n,i,o.maxWidth),AM(e,n,i,g,o),i+=Number(r.lineHeight);e.restore()}function Pc(e,t){const{x:n,y:i,w:r,h:o,radius:a}=t;e.arc(n+a.topLeft,i+a.topLeft,a.topLeft,1.5*Qt,Qt,!0),e.lineTo(n,i+o-a.bottomLeft),e.arc(n+a.bottomLeft,i+o-a.bottomLeft,a.bottomLeft,Qt,hn,!0),e.lineTo(n+r-a.bottomRight,i+o),e.arc(n+r-a.bottomRight,i+o-a.bottomRight,a.bottomRight,hn,0,!0),e.lineTo(n+r,i+a.topRight),e.arc(n+r-a.topRight,i+a.topRight,a.topRight,0,-hn,!0),e.lineTo(n+a.topLeft,i)}const pM=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,bM=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function yM(e,t){const n=(""+e).match(pM);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const ZM=e=>+e||0;function Xy(e,t){const n={},i=ht(t),r=i?Object.keys(t):t,o=ht(e)?i?a=>nt(e[a],e[t[a]]):a=>e[a]:()=>e;for(const a of r)n[a]=ZM(o(a));return n}function a1(e){return Xy(e,{top:"y",right:"x",bottom:"y",left:"x"})}function _a(e){return Xy(e,["topLeft","topRight","bottomLeft","bottomRight"])}function $n(e){const t=a1(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Sn(e,t){e=e||{},t=t||tn.font;let n=nt(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let i=nt(e.style,t.style);i&&!(""+i).match(bM)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const r={family:nt(e.family,t.family),lineHeight:yM(nt(e.lineHeight,t.lineHeight),n),size:n,style:i,weight:nt(e.weight,t.weight),string:""};return r.string=IM(r),r}function Pg(e,t,n,i){let r,o,a;for(r=0,o=e.length;r<o;++r)if(a=e[r],a!==void 0&&a!==void 0)return a}function vM(e,t,n){const{min:i,max:r}=e,o=Qw(t,(r-i)/2),a=(l,s)=>n&&l===0?0:l+s;return{min:a(i,-Math.abs(o)),max:a(r,o)}}function fa(e,t){return Object.assign(Object.create(e),t)}function Jy(e,t=[""],n,i,r=()=>e[0]){const o=n||e;typeof i>"u"&&(i=c1("_fallback",e));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:o,_fallback:i,_getTarget:r,override:l=>Jy([l,...e],t,o,i)};return new Proxy(a,{deleteProperty(l,s){return delete l[s],delete l._keys,delete e[0][s],!0},get(l,s){return s1(l,s,()=>wM(s,t,e,l))},getOwnPropertyDescriptor(l,s){return Reflect.getOwnPropertyDescriptor(l._scopes[0],s)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(l,s){return aS(l).includes(s)},ownKeys(l){return aS(l)},set(l,s,g){const c=l._storage||(l._storage=r());return l[s]=c[s]=g,delete l._keys,!0}})}function ws(e,t,n,i){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:l1(e,i),setContext:o=>ws(e,o,n,i),override:o=>ws(e.override(o),t,n,i)};return new Proxy(r,{deleteProperty(o,a){return delete o[a],delete e[a],!0},get(o,a,l){return s1(o,a,()=>SM(o,a,l))},getOwnPropertyDescriptor(o,a){return o._descriptors.allKeys?Reflect.has(e,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,a)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(o,a){return Reflect.has(e,a)},ownKeys(){return Reflect.ownKeys(e)},set(o,a,l){return e[a]=l,delete o[a],!0}})}function l1(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:i=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:i,isScriptable:ua(n)?n:()=>n,isIndexable:ua(i)?i:()=>i}}const GM=(e,t)=>e?e+Wy(t):t,Yy=(e,t)=>ht(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function s1(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const i=n();return e[t]=i,i}function SM(e,t,n){const{_proxy:i,_context:r,_subProxy:o,_descriptors:a}=e;let l=i[t];return ua(l)&&a.isScriptable(t)&&(l=BM(t,l,e,n)),en(l)&&l.length&&(l=RM(t,l,e,a.isIndexable)),Yy(t,l)&&(l=ws(l,r,o&&o[t],a)),l}function BM(e,t,n,i){const{_proxy:r,_context:o,_subProxy:a,_stack:l}=n;if(l.has(e))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+e);l.add(e);let s=t(o,a||i);return l.delete(e),Yy(e,s)&&(s=Ny(r._scopes,r,e,s)),s}function RM(e,t,n,i){const{_proxy:r,_context:o,_subProxy:a,_descriptors:l}=n;if(typeof o.index<"u"&&i(e))return t[o.index%t.length];if(ht(t[0])){const s=t,g=r._scopes.filter(c=>c!==s);t=[];for(const c of s){const u=Ny(g,r,e,c);t.push(ws(u,o,a&&a[e],l))}}return t}function g1(e,t,n){return ua(e)?e(t,n):e}const WM=(e,t)=>e===!0?t:typeof e=="string"?ca(t,e):void 0;function kM(e,t,n,i,r){for(const o of t){const a=WM(n,o);if(a){e.add(a);const l=g1(a._fallback,n,r);if(typeof l<"u"&&l!==n&&l!==i)return l}else if(a===!1&&typeof i<"u"&&n!==i)return null}return!1}function Ny(e,t,n,i){const r=t._rootScopes,o=g1(t._fallback,n,i),a=[...e,...r],l=new Set;l.add(i);let s=oS(l,a,n,o||n,i);return s===null||typeof o<"u"&&o!==n&&(s=oS(l,a,o,s,i),s===null)?!1:Jy(Array.from(l),[""],r,o,()=>VM(t,n,i))}function oS(e,t,n,i,r){for(;n;)n=kM(e,t,n,i,r);return n}function VM(e,t,n){const i=e._getTarget();t in i||(i[t]={});const r=i[t];return en(r)&&ht(n)?n:r||{}}function wM(e,t,n,i){let r;for(const o of t)if(r=c1(GM(o,e),n),typeof r<"u")return Yy(e,r)?Ny(n,i,e,r):r}function c1(e,t){for(const n of t){if(!n)continue;const i=n[e];if(typeof i<"u")return i}}function aS(e){let t=e._keys;return t||(t=e._keys=xM(e._scopes)),t}function xM(e){const t=new Set;for(const n of e)for(const i of Object.keys(n).filter(r=>!r.startsWith("_")))t.add(i);return Array.from(t)}function u1(e,t,n,i){const{iScale:r}=e,{key:o="r"}=this._parsing,a=new Array(i);let l,s,g,c;for(l=0,s=i;l<s;++l)g=l+n,c=t[g],a[l]={r:r.parse(ca(c,o),g)};return a}const XM=Number.EPSILON||1e-14,xs=(e,t)=>t<e.length&&!e[t].skip&&e[t],I1=e=>e==="x"?"y":"x";function JM(e,t,n,i){const r=e.skip?t:e,o=t,a=n.skip?t:n,l=Xp(o,r),s=Xp(a,o);let g=l/(l+s),c=s/(l+s);g=isNaN(g)?0:g,c=isNaN(c)?0:c;const u=i*g,I=i*c;return{previous:{x:o.x-u*(a.x-r.x),y:o.y-u*(a.y-r.y)},next:{x:o.x+I*(a.x-r.x),y:o.y+I*(a.y-r.y)}}}function YM(e,t,n){const i=e.length;let r,o,a,l,s,g=xs(e,0);for(let c=0;c<i-1;++c)if(s=g,g=xs(e,c+1),!(!s||!g)){if(Cc(t[c],0,XM)){n[c]=n[c+1]=0;continue}r=n[c]/t[c],o=n[c+1]/t[c],l=Math.pow(r,2)+Math.pow(o,2),!(l<=9)&&(a=3/Math.sqrt(l),n[c]=r*a*t[c],n[c+1]=o*a*t[c])}}function NM(e,t,n="x"){const i=I1(n),r=e.length;let o,a,l,s=xs(e,0);for(let g=0;g<r;++g){if(a=l,l=s,s=xs(e,g+1),!l)continue;const c=l[n],u=l[i];a&&(o=(c-a[n])/3,l[`cp1${n}`]=c-o,l[`cp1${i}`]=u-o*t[g]),s&&(o=(s[n]-c)/3,l[`cp2${n}`]=c+o,l[`cp2${i}`]=u+o*t[g])}}function HM(e,t="x"){const n=I1(t),i=e.length,r=Array(i).fill(0),o=Array(i);let a,l,s,g=xs(e,0);for(a=0;a<i;++a)if(l=s,s=g,g=xs(e,a+1),!!s){if(g){const c=g[t]-s[t];r[a]=c!==0?(g[n]-s[n])/c:0}o[a]=l?g?Fr(r[a-1])!==Fr(r[a])?0:(r[a-1]+r[a])/2:r[a-1]:r[a]}YM(e,r,o),NM(e,o,t)}function RI(e,t,n){return Math.max(Math.min(e,n),t)}function FM(e,t){let n,i,r,o,a,l=eo(e[0],t);for(n=0,i=e.length;n<i;++n)a=o,o=l,l=n<i-1&&eo(e[n+1],t),o&&(r=e[n],a&&(r.cp1x=RI(r.cp1x,t.left,t.right),r.cp1y=RI(r.cp1y,t.top,t.bottom)),l&&(r.cp2x=RI(r.cp2x,t.left,t.right),r.cp2y=RI(r.cp2y,t.top,t.bottom)))}function KM(e,t,n,i,r){let o,a,l,s;if(t.spanGaps&&(e=e.filter(g=>!g.skip)),t.cubicInterpolationMode==="monotone")HM(e,r);else{let g=i?e[e.length-1]:e[0];for(o=0,a=e.length;o<a;++o)l=e[o],s=JM(g,l,e[Math.min(o+1,a-(i?0:1))%a],t.tension),l.cp1x=s.previous.x,l.cp1y=s.previous.y,l.cp2x=s.next.x,l.cp2y=s.next.y,g=l}t.capBezierPoints&&FM(e,n)}function Hy(){return typeof window<"u"&&typeof document<"u"}function Fy(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function pC(e,t,n){let i;return typeof e=="string"?(i=parseInt(e,10),e.indexOf("%")!==-1&&(i=i/100*t.parentNode[n])):i=e,i}const Rh=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function EM(e,t){return Rh(e).getPropertyValue(t)}const MM=["top","right","bottom","left"];function Oa(e,t,n){const i={};n=n?"-"+n:"";for(let r=0;r<4;r++){const o=MM[r];i[o]=parseFloat(e[t+"-"+o+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const zM=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function LM(e,t){const n=e.touches,i=n&&n.length?n[0]:e,{offsetX:r,offsetY:o}=i;let a=!1,l,s;if(zM(r,o,e.target))l=r,s=o;else{const g=t.getBoundingClientRect();l=i.clientX-g.left,s=i.clientY-g.top,a=!0}return{x:l,y:s,box:a}}function Fa(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:i}=t,r=Rh(n),o=r.boxSizing==="border-box",a=Oa(r,"padding"),l=Oa(r,"border","width"),{x:s,y:g,box:c}=LM(e,n),u=a.left+(c&&l.left),I=a.top+(c&&l.top);let{width:C,height:m}=t;return o&&(C-=a.width+l.width,m-=a.height+l.height),{x:Math.round((s-u)/C*n.width/i),y:Math.round((g-I)/m*n.height/i)}}function DM(e,t,n){let i,r;if(t===void 0||n===void 0){const o=e&&Fy(e);if(!o)t=e.clientWidth,n=e.clientHeight;else{const a=o.getBoundingClientRect(),l=Rh(o),s=Oa(l,"border","width"),g=Oa(l,"padding");t=a.width-g.width-s.width,n=a.height-g.height-s.height,i=pC(l.maxWidth,o,"clientWidth"),r=pC(l.maxHeight,o,"clientHeight")}}return{width:t,height:n,maxWidth:i||AC,maxHeight:r||AC}}const WI=e=>Math.round(e*10)/10;function TM(e,t,n,i){const r=Rh(e),o=Oa(r,"margin"),a=pC(r.maxWidth,e,"clientWidth")||AC,l=pC(r.maxHeight,e,"clientHeight")||AC,s=DM(e,t,n);let{width:g,height:c}=s;if(r.boxSizing==="content-box"){const I=Oa(r,"border","width"),C=Oa(r,"padding");g-=C.width+I.width,c-=C.height+I.height}return g=Math.max(0,g-o.width),c=Math.max(0,i?g/i:c-o.height),g=WI(Math.min(g,a,s.maxWidth)),c=WI(Math.min(c,l,s.maxHeight)),g&&!c&&(c=WI(g/2)),(t!==void 0||n!==void 0)&&i&&s.height&&c>s.height&&(c=s.height,g=WI(Math.floor(c*i))),{width:g,height:c}}function lS(e,t,n){const i=t||1,r=Math.floor(e.height*i),o=Math.floor(e.width*i);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const a=e.canvas;return a.style&&(n||!a.style.height&&!a.style.width)&&(a.style.height=`${e.height}px`,a.style.width=`${e.width}px`),e.currentDevicePixelRatio!==i||a.height!==r||a.width!==o?(e.currentDevicePixelRatio=i,a.height=r,a.width=o,e.ctx.setTransform(i,0,0,i,0,0),!0):!1}const jM=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Hy()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function sS(e,t){const n=EM(e,t),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Ka(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function UM(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:i==="middle"?n<.5?e.y:t.y:i==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function QM(e,t,n,i){const r={x:e.cp2x,y:e.cp2y},o={x:t.cp1x,y:t.cp1y},a=Ka(e,r,n),l=Ka(r,o,n),s=Ka(o,t,n),g=Ka(a,l,n),c=Ka(l,s,n);return Ka(g,c,n)}const PM=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,i){return n-i},leftForLtr(n,i){return n-i}}},_M=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function ms(e,t,n){return e?PM(t,n):_M()}function d1(e,t){let n,i;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=i)}function C1(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function h1(e){return e==="angle"?{between:Qc,compare:O3,normalize:Vi}:{between:qr,compare:(t,n)=>t-n,normalize:t=>t}}function gS({start:e,end:t,count:n,loop:i,style:r}){return{start:e%n,end:t%n,loop:i&&(t-e+1)%n===0,style:r}}function OM(e,t,n){const{property:i,start:r,end:o}=n,{between:a,normalize:l}=h1(i),s=t.length;let{start:g,end:c,loop:u}=e,I,C;if(u){for(g+=s,c+=s,I=0,C=s;I<C&&a(l(t[g%s][i]),r,o);++I)g--,c--;g%=s,c%=s}return c<g&&(c+=s),{start:g,end:c,loop:u,style:e.style}}function m1(e,t,n){if(!n)return[e];const{property:i,start:r,end:o}=n,a=t.length,{compare:l,between:s,normalize:g}=h1(i),{start:c,end:u,loop:I,style:C}=OM(e,t,n),m=[];let f=!1,b=null,A,p,y;const Z=()=>s(r,y,A)&&l(r,y)!==0,G=()=>l(o,A)===0||s(o,y,A),v=()=>f||Z(),B=()=>!f||G();for(let R=c,X=c;R<=u;++R)p=t[R%a],!p.skip&&(A=g(p[i]),A!==y&&(f=s(A,r,o),b===null&&v()&&(b=l(A,r)===0?R:X),b!==null&&B()&&(m.push(gS({start:b,end:R,loop:I,count:a,style:C})),b=null),X=R,y=A));return b!==null&&m.push(gS({start:b,end:u,loop:I,count:a,style:C})),m}function A1(e,t){const n=[],i=e.segments;for(let r=0;r<i.length;r++){const o=m1(i[r],e.points,t);o.length&&n.push(...o)}return n}function qM(e,t,n,i){let r=0,o=t-1;if(n&&!i)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(o+=r);o>r&&e[o%t].skip;)o--;return o%=t,{start:r,end:o}}function $M(e,t,n,i){const r=e.length,o=[];let a=t,l=e[t],s;for(s=t+1;s<=n;++s){const g=e[s%r];g.skip||g.stop?l.skip||(i=!1,o.push({start:t%r,end:(s-1)%r,loop:i}),t=a=g.stop?s:null):(a=s,l.skip&&(t=s)),l=g}return a!==null&&o.push({start:t%r,end:a%r,loop:i}),o}function ez(e,t){const n=e.points,i=e.options.spanGaps,r=n.length;if(!r)return[];const o=!!e._loop,{start:a,end:l}=qM(n,r,o,i);if(i===!0)return cS(e,[{start:a,end:l,loop:o}],n,t);const s=l<a?l+r:l,g=!!e._fullLoop&&a===0&&l===r-1;return cS(e,$M(n,a,s,g),n,t)}function cS(e,t,n,i){return!i||!i.setContext||!n?t:tz(e,t,n,i)}function tz(e,t,n,i){const r=e._chart.getContext(),o=uS(e.options),{_datasetIndex:a,options:{spanGaps:l}}=e,s=n.length,g=[];let c=o,u=t[0].start,I=u;function C(m,f,b,A){const p=l?-1:1;if(m!==f){for(m+=s;n[m%s].skip;)m-=p;for(;n[f%s].skip;)f+=p;m%s!==f%s&&(g.push({start:m%s,end:f%s,loop:b,style:A}),c=A,u=f%s)}}for(const m of t){u=l?u:m.start;let f=n[u%s],b;for(I=u+1;I<=m.end;I++){const A=n[I%s];b=uS(i.setContext(fa(r,{type:"segment",p0:f,p1:A,p0DataIndex:(I-1)%s,p1DataIndex:I%s,datasetIndex:a}))),nz(b,c)&&C(u,I-1,m.loop,c),f=A,c=b}u<I-1&&C(u,I-1,m.loop,c)}return g}function uS(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function nz(e,t){if(!t)return!1;const n=[],i=function(r,o){return xy(o)?(n.includes(o)||n.push(o),n.indexOf(o)):o};return JSON.stringify(e,i)!==JSON.stringify(t,i)}/*!
 * Chart.js v4.4.7
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */class iz{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,i,r){const o=n.listeners[r],a=n.duration;o.forEach(l=>l({chart:t,initial:n.initial,numSteps:a,currentStep:Math.min(i-n.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=e1.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const o=i.items;let a=o.length-1,l=!1,s;for(;a>=0;--a)s=o[a],s._active?(s._total>i.duration&&(i.duration=s._total),s.tick(t),l=!0):(o[a]=o[o.length-1],o.pop());l&&(r.draw(),this._notify(r,i,t,"progress")),o.length||(i.running=!1,this._notify(r,i,t,"complete"),i.initial=!1),n+=o.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let i=n.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,i)),i}listen(t,n,i){this._getAnims(t).listeners[n].push(i)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const i=n.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Lr=new iz;const IS="transparent",rz={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const i=nS(e||IS),r=i.valid&&nS(t||IS);return r&&r.valid?r.mix(i,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class oz{constructor(t,n,i,r){const o=n[i];r=Pg([t.to,r,o,t.from]);const a=Pg([t.from,o,r]);this._active=!0,this._fn=t.fn||rz[t.type||typeof a],this._easing=hc[t.easing]||hc.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=i,this._from=a,this._to=r,this._promises=void 0}active(){return this._active}update(t,n,i){if(this._active){this._notify(!1);const r=this._target[this._prop],o=i-this._start,a=this._duration-o;this._start=i,this._duration=Math.floor(Math.max(a,t.duration)),this._total+=o,this._loop=!!t.loop,this._to=Pg([t.to,n,r,t.from]),this._from=Pg([t.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,i=this._duration,r=this._prop,o=this._from,a=this._loop,l=this._to;let s;if(this._active=o!==l&&(a||n<i),!this._active){this._target[r]=l,this._notify(!0);return}if(n<0){this._target[r]=o;return}s=n/i%2,s=a&&s>1?2-s:s,s=this._easing(Math.min(1,Math.max(0,s))),this._target[r]=this._fn(o,l,s)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,i)=>{t.push({res:n,rej:i})})}_notify(t){const n=t?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][n]()}}class f1{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!ht(t))return;const n=Object.keys(tn.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{const o=t[r];if(!ht(o))return;const a={};for(const l of n)a[l]=o[l];(en(o.properties)&&o.properties||[r]).forEach(l=>{(l===r||!i.has(l))&&i.set(l,a)})})}_animateOptions(t,n){const i=n.options,r=lz(t,i);if(!r)return[];const o=this._createAnimations(r,i);return i.$shared&&az(t.options.$animations,i).then(()=>{t.options=i},()=>{}),o}_createAnimations(t,n){const i=this._properties,r=[],o=t.$animations||(t.$animations={}),a=Object.keys(n),l=Date.now();let s;for(s=a.length-1;s>=0;--s){const g=a[s];if(g.charAt(0)==="$")continue;if(g==="options"){r.push(...this._animateOptions(t,n));continue}const c=n[g];let u=o[g];const I=i.get(g);if(u)if(I&&u.active()){u.update(I,c,l);continue}else u.cancel();if(!I||!I.duration){t[g]=c;continue}o[g]=u=new oz(I,t,g,c),r.push(u)}return r}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const i=this._createAnimations(t,n);if(i.length)return Lr.add(this._chart,i),!0}}function az(e,t){const n=[],i=Object.keys(t);for(let r=0;r<i.length;r++){const o=e[i[r]];o&&o.active()&&n.push(o.wait())}return Promise.all(n)}function lz(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function dS(e,t){const n=e&&e.options||{},i=n.reverse,r=n.min===void 0?t:0,o=n.max===void 0?t:0;return{start:i?o:r,end:i?r:o}}function sz(e,t,n){if(n===!1)return!1;const i=dS(e,n),r=dS(t,n);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function gz(e){let t,n,i,r;return ht(e)?(t=e.top,n=e.right,i=e.bottom,r=e.left):t=n=i=r=e,{top:t,right:n,bottom:i,left:r,disabled:e===!1}}function p1(e,t){const n=[],i=e._getSortedDatasetMetas(t);let r,o;for(r=0,o=i.length;r<o;++r)n.push(i[r].index);return n}function CS(e,t,n,i={}){const r=e.keys,o=i.mode==="single";let a,l,s,g;if(t===null)return;let c=!1;for(a=0,l=r.length;a<l;++a){if(s=+r[a],s===n){if(c=!0,i.all)continue;break}g=e.values[s],dn(g)&&(o||t===0||Fr(t)===Fr(g))&&(t+=g)}return!c&&!i.all?0:t}function cz(e,t){const{iScale:n,vScale:i}=t,r=n.axis==="x"?"x":"y",o=i.axis==="x"?"x":"y",a=Object.keys(e),l=new Array(a.length);let s,g,c;for(s=0,g=a.length;s<g;++s)c=a[s],l[s]={[r]:c,[o]:e[c]};return l}function ZA(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function uz(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function Iz(e){const{min:t,max:n,minDefined:i,maxDefined:r}=e.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function dz(e,t,n){const i=e[t]||(e[t]={});return i[n]||(i[n]={})}function hS(e,t,n,i){for(const r of t.getMatchingVisibleMetas(i).reverse()){const o=e[r.index];if(n&&o>0||!n&&o<0)return r.index}return null}function mS(e,t){const{chart:n,_cachedMeta:i}=e,r=n._stacks||(n._stacks={}),{iScale:o,vScale:a,index:l}=i,s=o.axis,g=a.axis,c=uz(o,a,i),u=t.length;let I;for(let C=0;C<u;++C){const m=t[C],{[s]:f,[g]:b}=m,A=m._stacks||(m._stacks={});I=A[g]=dz(r,c,f),I[l]=b,I._top=hS(I,a,!0,i.type),I._bottom=hS(I,a,!1,i.type);const p=I._visualValues||(I._visualValues={});p[l]=b}}function vA(e,t){const n=e.scales;return Object.keys(n).filter(i=>n[i].axis===t).shift()}function Cz(e,t){return fa(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function hz(e,t,n){return fa(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function Rg(e,t){const n=e.controller.index,i=e.vScale&&e.vScale.axis;if(i){t=t||e._parsed;for(const r of t){const o=r._stacks;if(!o||o[i]===void 0||o[i][n]===void 0)return;delete o[i][n],o[i]._visualValues!==void 0&&o[i]._visualValues[n]!==void 0&&delete o[i]._visualValues[n]}}}const GA=e=>e==="reset"||e==="none",AS=(e,t)=>t?e:Object.assign({},e),mz=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:p1(n,!0),values:null};class hr{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=ZA(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Rg(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,i=this.getDataset(),r=(u,I,C,m)=>u==="x"?I:u==="r"?m:C,o=n.xAxisID=nt(i.xAxisID,vA(t,"x")),a=n.yAxisID=nt(i.yAxisID,vA(t,"y")),l=n.rAxisID=nt(i.rAxisID,vA(t,"r")),s=n.indexAxis,g=n.iAxisID=r(s,o,a,l),c=n.vAxisID=r(s,a,o,l);n.xScale=this.getScaleForId(o),n.yScale=this.getScaleForId(a),n.rScale=this.getScaleForId(l),n.iScale=this.getScaleForId(g),n.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&$G(this._data,this),t._stacked&&Rg(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),i=this._data;if(ht(n)){const r=this._cachedMeta;this._data=cz(n,r)}else if(i!==n){if(i){$G(i,this);const r=this._cachedMeta;Rg(r),r._parsed=[]}n&&Object.isExtensible(n)&&tM(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const o=n._stacked;n._stacked=ZA(n.vScale,n),n.stack!==i.stack&&(r=!0,Rg(n),n.stack=i.stack),this._resyncElements(t),(r||o!==n._stacked)&&(mS(this,n._parsed),n._stacked=ZA(n.vScale,n))}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:i,_data:r}=this,{iScale:o,_stacked:a}=i,l=o.axis;let s=t===0&&n===r.length?!0:i._sorted,g=t>0&&i._parsed[t-1],c,u,I;if(this._parsing===!1)i._parsed=r,i._sorted=!0,I=r;else{en(r[t])?I=this.parseArrayData(i,r,t,n):ht(r[t])?I=this.parseObjectData(i,r,t,n):I=this.parsePrimitiveData(i,r,t,n);const C=()=>u[l]===null||g&&u[l]<g[l];for(c=0;c<n;++c)i._parsed[c+t]=u=I[c],s&&(C()&&(s=!1),g=u);i._sorted=s}a&&mS(this,I)}parsePrimitiveData(t,n,i,r){const{iScale:o,vScale:a}=t,l=o.axis,s=a.axis,g=o.getLabels(),c=o===a,u=new Array(r);let I,C,m;for(I=0,C=r;I<C;++I)m=I+i,u[I]={[l]:c||o.parse(g[m],m),[s]:a.parse(n[m],m)};return u}parseArrayData(t,n,i,r){const{xScale:o,yScale:a}=t,l=new Array(r);let s,g,c,u;for(s=0,g=r;s<g;++s)c=s+i,u=n[c],l[s]={x:o.parse(u[0],c),y:a.parse(u[1],c)};return l}parseObjectData(t,n,i,r){const{xScale:o,yScale:a}=t,{xAxisKey:l="x",yAxisKey:s="y"}=this._parsing,g=new Array(r);let c,u,I,C;for(c=0,u=r;c<u;++c)I=c+i,C=n[I],g[c]={x:o.parse(ca(C,l),I),y:a.parse(ca(C,s),I)};return g}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,i){const r=this.chart,o=this._cachedMeta,a=n[t.axis],l={keys:p1(r,!0),values:n._stacks[t.axis]._visualValues};return CS(l,a,o.index,{mode:i})}updateRangeFromParsed(t,n,i,r){const o=i[n.axis];let a=o===null?NaN:o;const l=r&&i._stacks[n.axis];r&&l&&(r.values=l,a=CS(r,o,this._cachedMeta.index)),t.min=Math.min(t.min,a),t.max=Math.max(t.max,a)}getMinMax(t,n){const i=this._cachedMeta,r=i._parsed,o=i._sorted&&t===i.iScale,a=r.length,l=this._getOtherScale(t),s=mz(n,i,this.chart),g={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:u}=Iz(l);let I,C;function m(){C=r[I];const f=C[l.axis];return!dn(C[t.axis])||c>f||u<f}for(I=0;I<a&&!(!m()&&(this.updateRangeFromParsed(g,t,C,s),o));++I);if(o){for(I=a-1;I>=0;--I)if(!m()){this.updateRangeFromParsed(g,t,C,s);break}}return g}getAllParsedValues(t){const n=this._cachedMeta._parsed,i=[];let r,o,a;for(r=0,o=n.length;r<o;++r)a=n[r][t.axis],dn(a)&&i.push(a);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,i=n.iScale,r=n.vScale,o=this.getParsed(t);return{label:i?""+i.getLabelForValue(o[i.axis]):"",value:r?""+r.getLabelForValue(o[r.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=gz(nt(this.options.clip,sz(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,i=this._cachedMeta,r=i.data||[],o=n.chartArea,a=[],l=this._drawStart||0,s=this._drawCount||r.length-l,g=this.options.drawActiveElementsOnTop;let c;for(i.dataset&&i.dataset.draw(t,o,l,s),c=l;c<l+s;++c){const u=r[c];u.hidden||(u.active&&g?a.push(u):u.draw(t,o))}for(c=0;c<a.length;++c)a[c].draw(t,o)}getStyle(t,n){const i=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,n,i){const r=this.getDataset();let o;if(t>=0&&t<this._cachedMeta.data.length){const a=this._cachedMeta.data[t];o=a.$context||(a.$context=hz(this.getContext(),t,a)),o.parsed=this.getParsed(t),o.raw=r.data[t],o.index=o.dataIndex=t}else o=this.$context||(this.$context=Cz(this.chart.getContext(),this.index)),o.dataset=r,o.index=o.datasetIndex=this.index;return o.active=!!n,o.mode=i,o}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",i){const r=n==="active",o=this._cachedDataOpts,a=t+"-"+n,l=o[a],s=this.enableOptionSharing&&Uc(i);if(l)return AS(l,s);const g=this.chart.config,c=g.datasetElementScopeKeys(this._type,t),u=r?[`${t}Hover`,"hover",t,""]:[t,""],I=g.getOptionScopes(this.getDataset(),c),C=Object.keys(tn.elements[t]),m=()=>this.getContext(i,r,n),f=g.resolveNamedOptions(I,C,m,u);return f.$shared&&(f.$shared=s,o[a]=Object.freeze(AS(f,s))),f}_resolveAnimations(t,n,i){const r=this.chart,o=this._cachedDataOpts,a=`animation-${n}`,l=o[a];if(l)return l;let s;if(r.options.animation!==!1){const c=this.chart.config,u=c.datasetAnimationScopeKeys(this._type,n),I=c.getOptionScopes(this.getDataset(),u);s=c.createResolver(I,this.getContext(t,i,n))}const g=new f1(r,s&&s.animations);return s&&s._cacheable&&(o[a]=Object.freeze(g)),g}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||GA(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const i=this.resolveDataElementOptions(t,n),r=this._sharedOptions,o=this.getSharedOptions(i),a=this.includeOptions(n,o)||o!==r;return this.updateSharedOptions(o,n,i),{sharedOptions:o,includeOptions:a}}updateElement(t,n,i,r){GA(r)?Object.assign(t,i):this._resolveAnimations(n,r).update(t,i)}updateSharedOptions(t,n,i){t&&!GA(n)&&this._resolveAnimations(void 0,n).update(t,i)}_setStyle(t,n,i,r){t.active=r;const o=this.getStyle(n,r);this._resolveAnimations(n,i,r).update(t,{options:!r&&this.getSharedOptions(o)||o})}removeHoverStyle(t,n,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,n,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,i=this._cachedMeta.data;for(const[l,s,g]of this._syncList)this[l](s,g);this._syncList=[];const r=i.length,o=n.length,a=Math.min(o,r);a&&this.parse(0,a),o>r?this._insertElements(r,o-r,t):o<r&&this._removeElements(o,r-o)}_insertElements(t,n,i=!0){const r=this._cachedMeta,o=r.data,a=t+n;let l;const s=g=>{for(g.length+=n,l=g.length-1;l>=a;l--)g[l]=g[l-n]};for(s(o),l=t;l<a;++l)o[l]=new this.dataElementType;this._parsing&&s(r._parsed),this.parse(t,n),i&&this.updateElements(o,t,n,"reset")}updateElements(t,n,i,r){}_removeElements(t,n){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(t,n);i._stacked&&Rg(i,r)}i.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,i,r]=t;this[n](i,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}ye(hr,"defaults",{}),ye(hr,"datasetElementType",null),ye(hr,"dataElementType",null);function Az(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let i=[];for(let r=0,o=n.length;r<o;r++)i=i.concat(n[r].controller.getAllParsedValues(e));e._cache.$bar=$w(i.sort((r,o)=>r-o))}return e._cache.$bar}function fz(e){const t=e.iScale,n=Az(t,e.type);let i=t._length,r,o,a,l;const s=()=>{a===32767||a===-32768||(Uc(l)&&(i=Math.min(i,Math.abs(a-l)||i)),l=a)};for(r=0,o=n.length;r<o;++r)a=t.getPixelForValue(n[r]),s();for(l=void 0,r=0,o=t.ticks.length;r<o;++r)a=t.getPixelForTick(r),s();return i}function pz(e,t,n,i){const r=n.barThickness;let o,a;return bt(r)?(o=t.min*n.categoryPercentage,a=n.barPercentage):(o=r*i,a=1),{chunk:o/i,ratio:a,start:t.pixels[e]-o/2}}function bz(e,t,n,i){const r=t.pixels,o=r[e];let a=e>0?r[e-1]:null,l=e<r.length-1?r[e+1]:null;const s=n.categoryPercentage;a===null&&(a=o-(l===null?t.end-t.start:l-o)),l===null&&(l=o+o-a);const g=o-(o-Math.min(a,l))/2*s;return{chunk:Math.abs(l-a)/2*s/i,ratio:n.barPercentage,start:g}}function yz(e,t,n,i){const r=n.parse(e[0],i),o=n.parse(e[1],i),a=Math.min(r,o),l=Math.max(r,o);let s=a,g=l;Math.abs(a)>Math.abs(l)&&(s=l,g=a),t[n.axis]=g,t._custom={barStart:s,barEnd:g,start:r,end:o,min:a,max:l}}function b1(e,t,n,i){return en(e)?yz(e,t,n,i):t[n.axis]=n.parse(e,i),t}function fS(e,t,n,i){const r=e.iScale,o=e.vScale,a=r.getLabels(),l=r===o,s=[];let g,c,u,I;for(g=n,c=n+i;g<c;++g)I=t[g],u={},u[r.axis]=l||r.parse(a[g],g),s.push(b1(I,u,o,g));return s}function SA(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function Zz(e,t,n){return e!==0?Fr(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function vz(e){let t,n,i,r,o;return e.horizontal?(t=e.base>e.x,n="left",i="right"):(t=e.base<e.y,n="bottom",i="top"),t?(r="end",o="start"):(r="start",o="end"),{start:n,end:i,reverse:t,top:r,bottom:o}}function Gz(e,t,n,i){let r=t.borderSkipped;const o={};if(!r){e.borderSkipped=o;return}if(r===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:l,reverse:s,top:g,bottom:c}=vz(e);r==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===i?r=g:(n._bottom||0)===i?r=c:(o[pS(c,a,l,s)]=!0,r=g)),o[pS(r,a,l,s)]=!0,e.borderSkipped=o}function pS(e,t,n,i){return i?(e=Sz(e,t,n),e=bS(e,n,t)):e=bS(e,t,n),e}function Sz(e,t,n){return e===t?n:e===n?t:e}function bS(e,t,n){return e==="start"?t:e==="end"?n:e}function Bz(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class hd extends hr{parsePrimitiveData(t,n,i,r){return fS(t,n,i,r)}parseArrayData(t,n,i,r){return fS(t,n,i,r)}parseObjectData(t,n,i,r){const{iScale:o,vScale:a}=t,{xAxisKey:l="x",yAxisKey:s="y"}=this._parsing,g=o.axis==="x"?l:s,c=a.axis==="x"?l:s,u=[];let I,C,m,f;for(I=i,C=i+r;I<C;++I)f=n[I],m={},m[o.axis]=o.parse(ca(f,g),I),u.push(b1(ca(f,c),m,a,I));return u}updateRangeFromParsed(t,n,i,r){super.updateRangeFromParsed(t,n,i,r);const o=i._custom;o&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,o.min),t.max=Math.max(t.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:i,vScale:r}=n,o=this.getParsed(t),a=o._custom,l=SA(a)?"["+a.start+", "+a.end+"]":""+r.getLabelForValue(o[r.axis]);return{label:""+i.getLabelForValue(o[i.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,i,r){const o=r==="reset",{index:a,_cachedMeta:{vScale:l}}=this,s=l.getBasePixel(),g=l.isHorizontal(),c=this._getRuler(),{sharedOptions:u,includeOptions:I}=this._getSharedOptions(n,r);for(let C=n;C<n+i;C++){const m=this.getParsed(C),f=o||bt(m[l.axis])?{base:s,head:s}:this._calculateBarValuePixels(C),b=this._calculateBarIndexPixels(C,c),A=(m._stacks||{})[l.axis],p={horizontal:g,base:f.base,enableBorderRadius:!A||SA(m._custom)||a===A._top||a===A._bottom,x:g?f.head:b.center,y:g?b.center:f.head,height:g?b.size:Math.abs(f.size),width:g?Math.abs(f.size):b.size};I&&(p.options=u||this.resolveDataElementOptions(C,t[C].active?"active":r));const y=p.options||t[C].options;Gz(p,y,A,a),Bz(p,y,c.ratio),this.updateElement(t[C],C,p,r)}}_getStacks(t,n){const{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter(c=>c.controller.options.grouped),o=i.options.stacked,a=[],l=this._cachedMeta.controller.getParsed(n),s=l&&l[i.axis],g=c=>{const u=c._parsed.find(C=>C[i.axis]===s),I=u&&u[c.vScale.axis];if(bt(I)||isNaN(I))return!0};for(const c of r)if(!(n!==void 0&&g(c))&&((o===!1||a.indexOf(c.stack)===-1||o===void 0&&c.stack===void 0)&&a.push(c.stack),c.index===t))break;return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,n,i){const r=this._getStacks(t,i),o=n!==void 0?r.indexOf(n):-1;return o===-1?r.length-1:o}_getRuler(){const t=this.options,n=this._cachedMeta,i=n.iScale,r=[];let o,a;for(o=0,a=n.data.length;o<a;++o)r.push(i.getPixelForValue(this.getParsed(o)[i.axis],o));const l=t.barThickness;return{min:l||fz(n),pixels:r,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:l?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:i,index:r},options:{base:o,minBarLength:a}}=this,l=o||0,s=this.getParsed(t),g=s._custom,c=SA(g);let u=s[n.axis],I=0,C=i?this.applyStack(n,s,i):u,m,f;C!==u&&(I=C-u,C=u),c&&(u=g.barStart,C=g.barEnd-g.barStart,u!==0&&Fr(u)!==Fr(g.barEnd)&&(I=0),I+=u);const b=!bt(o)&&!c?o:I;let A=n.getPixelForValue(b);if(this.chart.getDataVisibility(t)?m=n.getPixelForValue(I+C):m=A,f=m-A,Math.abs(f)<a){f=Zz(f,n,l)*a,u===l&&(A-=f/2);const p=n.getPixelForDecimal(0),y=n.getPixelForDecimal(1),Z=Math.min(p,y),G=Math.max(p,y);A=Math.max(Math.min(A,G),Z),m=A+f,i&&!c&&(s._stacks[n.axis]._visualValues[r]=n.getValueForPixel(m)-n.getValueForPixel(A))}if(A===n.getPixelForValue(l)){const p=Fr(f)*n.getLineWidthForValue(l)/2;A+=p,f-=p}return{size:f,base:A,head:m,center:m+f/2}}_calculateBarIndexPixels(t,n){const i=n.scale,r=this.options,o=r.skipNull,a=nt(r.maxBarThickness,1/0);let l,s;if(n.grouped){const g=o?this._getStackCount(t):n.stackCount,c=r.barThickness==="flex"?bz(t,n,r,g):pz(t,n,r,g),u=this._getStackIndex(this.index,this._cachedMeta.stack,o?t:void 0);l=c.start+c.chunk*u+c.chunk/2,s=Math.min(a,c.chunk*c.ratio)}else l=i.getPixelForValue(this.getParsed(t)[i.axis],t),s=Math.min(a,n.min*n.ratio);return{base:l-s/2,head:l+s/2,center:l,size:s}}draw(){const t=this._cachedMeta,n=t.vScale,i=t.data,r=i.length;let o=0;for(;o<r;++o)this.getParsed(o)[n.axis]!==null&&!i[o].hidden&&i[o].draw(this._ctx)}}ye(hd,"id","bar"),ye(hd,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),ye(hd,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class md extends hr{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,n,i,r){const o=super.parsePrimitiveData(t,n,i,r);for(let a=0;a<o.length;a++)o[a]._custom=this.resolveDataElementOptions(a+i).radius;return o}parseArrayData(t,n,i,r){const o=super.parseArrayData(t,n,i,r);for(let a=0;a<o.length;a++){const l=n[i+a];o[a]._custom=nt(l[2],this.resolveDataElementOptions(a+i).radius)}return o}parseObjectData(t,n,i,r){const o=super.parseObjectData(t,n,i,r);for(let a=0;a<o.length;a++){const l=n[i+a];o[a]._custom=nt(l&&l.r&&+l.r,this.resolveDataElementOptions(a+i).radius)}return o}getMaxOverflow(){const t=this._cachedMeta.data;let n=0;for(let i=t.length-1;i>=0;--i)n=Math.max(n,t[i].size(this.resolveDataElementOptions(i))/2);return n>0&&n}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart.data.labels||[],{xScale:r,yScale:o}=n,a=this.getParsed(t),l=r.getLabelForValue(a.x),s=o.getLabelForValue(a.y),g=a._custom;return{label:i[t]||"",value:"("+l+", "+s+(g?", "+g:"")+")"}}update(t){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,t)}updateElements(t,n,i,r){const o=r==="reset",{iScale:a,vScale:l}=this._cachedMeta,{sharedOptions:s,includeOptions:g}=this._getSharedOptions(n,r),c=a.axis,u=l.axis;for(let I=n;I<n+i;I++){const C=t[I],m=!o&&this.getParsed(I),f={},b=f[c]=o?a.getPixelForDecimal(.5):a.getPixelForValue(m[c]),A=f[u]=o?l.getBasePixel():l.getPixelForValue(m[u]);f.skip=isNaN(b)||isNaN(A),g&&(f.options=s||this.resolveDataElementOptions(I,C.active?"active":r),o&&(f.options.radius=0)),this.updateElement(C,I,f,r)}}resolveDataElementOptions(t,n){const i=this.getParsed(t);let r=super.resolveDataElementOptions(t,n);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const o=r.radius;return n!=="active"&&(r.radius=0),r.radius+=nt(i&&i._custom,o),r}}ye(md,"id","bubble"),ye(md,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),ye(md,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function Rz(e,t,n){let i=1,r=1,o=0,a=0;if(t<Ut){const l=e,s=l+t,g=Math.cos(l),c=Math.sin(l),u=Math.cos(s),I=Math.sin(s),C=(y,Z,G)=>Qc(y,l,s,!0)?1:Math.max(Z,Z*n,G,G*n),m=(y,Z,G)=>Qc(y,l,s,!0)?-1:Math.min(Z,Z*n,G,G*n),f=C(0,g,u),b=C(hn,c,I),A=m(Qt,g,u),p=m(Qt+hn,c,I);i=(f-A)/2,r=(b-p)/2,o=-(f+A)/2,a=-(b+p)/2}return{ratioX:i,ratioY:r,offsetX:o,offsetY:a}}class Do extends hr{constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const i=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=i;else{let o=s=>+i[s];if(ht(i[t])){const{key:s="value"}=this._parsing;o=g=>+ca(i[g],s)}let a,l;for(a=t,l=t+n;a<l;++a)r._parsed[a]=o(a)}}_getRotation(){return ur(this.options.rotation-90)}_getCircumference(){return ur(this.options.circumference)}_getRotationExtents(){let t=Ut,n=-Ut;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const r=this.chart.getDatasetMeta(i).controller,o=r._getRotation(),a=r._getCircumference();t=Math.min(t,o),n=Math.max(n,o+a)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:i}=n,r=this._cachedMeta,o=r.data,a=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,l=Math.max((Math.min(i.width,i.height)-a)/2,0),s=Math.min(M3(this.options.cutout,l),1),g=this._getRingWeight(this.index),{circumference:c,rotation:u}=this._getRotationExtents(),{ratioX:I,ratioY:C,offsetX:m,offsetY:f}=Rz(u,c,s),b=(i.width-a)/I,A=(i.height-a)/C,p=Math.max(Math.min(b,A)/2,0),y=Qw(this.options.radius,p),Z=Math.max(y*s,0),G=(y-Z)/this._getVisibleDatasetWeightTotal();this.offsetX=m*y,this.offsetY=f*y,r.total=this.calculateTotal(),this.outerRadius=y-G*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-G*g,0),this.updateElements(o,0,o.length,t)}_circumference(t,n){const i=this.options,r=this._cachedMeta,o=this._getCircumference();return n&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||r._parsed[t]===null||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*o/Ut)}updateElements(t,n,i,r){const o=r==="reset",a=this.chart,l=a.chartArea,g=a.options.animation,c=(l.left+l.right)/2,u=(l.top+l.bottom)/2,I=o&&g.animateScale,C=I?0:this.innerRadius,m=I?0:this.outerRadius,{sharedOptions:f,includeOptions:b}=this._getSharedOptions(n,r);let A=this._getRotation(),p;for(p=0;p<n;++p)A+=this._circumference(p,o);for(p=n;p<n+i;++p){const y=this._circumference(p,o),Z=t[p],G={x:c+this.offsetX,y:u+this.offsetY,startAngle:A,endAngle:A+y,circumference:y,outerRadius:m,innerRadius:C};b&&(G.options=f||this.resolveDataElementOptions(p,Z.active?"active":r)),A+=y,this.updateElement(Z,p,G,r)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let i=0,r;for(r=0;r<n.length;r++){const o=t._parsed[r];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(i+=Math.abs(o))}return i}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?Ut*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart,r=i.data.labels||[],o=xu(n._parsed[t],i.options.locale);return{label:r[t]||"",value:o}}getMaxBorderWidth(t){let n=0;const i=this.chart;let r,o,a,l,s;if(!t){for(r=0,o=i.data.datasets.length;r<o;++r)if(i.isDatasetVisible(r)){a=i.getDatasetMeta(r),t=a.data,l=a.controller;break}}if(!t)return 0;for(r=0,o=t.length;r<o;++r)s=l.resolveDataElementOptions(r),s.borderAlign!=="inner"&&(n=Math.max(n,s.borderWidth||0,s.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let i=0,r=t.length;i<r;++i){const o=this.resolveDataElementOptions(i);n=Math.max(n,o.offset||0,o.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(n+=this._getRingWeight(i));return n}_getRingWeight(t){return Math.max(nt(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}ye(Do,"id","doughnut"),ye(Do,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),ye(Do,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),ye(Do,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:i,color:r}}=t.legend.options;return n.labels.map((o,a)=>{const s=t.getDatasetMeta(0).controller.getStyle(a);return{text:o,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:r,lineWidth:s.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(a),index:a}})}return[]}},onClick(t,n,i){i.chart.toggleDataVisibility(n.index),i.chart.update()}}}});class Ad extends hr{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:i,data:r=[],_dataset:o}=n,a=this.chart._animationsDisabled;let{start:l,count:s}=n1(n,r,a);this._drawStart=l,this._drawCount=s,i1(n)&&(l=0,s=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!o._decimated,i.points=r;const g=this.resolveDatasetElementOptions(t);this.options.showLine||(g.borderWidth=0),g.segment=this.options.segment,this.updateElement(i,void 0,{animated:!a,options:g},t),this.updateElements(r,l,s,t)}updateElements(t,n,i,r){const o=r==="reset",{iScale:a,vScale:l,_stacked:s,_dataset:g}=this._cachedMeta,{sharedOptions:c,includeOptions:u}=this._getSharedOptions(n,r),I=a.axis,C=l.axis,{spanGaps:m,segment:f}=this.options,b=Vs(m)?m:Number.POSITIVE_INFINITY,A=this.chart._animationsDisabled||o||r==="none",p=n+i,y=t.length;let Z=n>0&&this.getParsed(n-1);for(let G=0;G<y;++G){const v=t[G],B=A?v:{};if(G<n||G>=p){B.skip=!0;continue}const R=this.getParsed(G),X=bt(R[C]),W=B[I]=a.getPixelForValue(R[I],G),V=B[C]=o||X?l.getBasePixel():l.getPixelForValue(s?this.applyStack(l,R,s):R[C],G);B.skip=isNaN(W)||isNaN(V)||X,B.stop=G>0&&Math.abs(R[I]-Z[I])>b,f&&(B.parsed=R,B.raw=g.data[G]),u&&(B.options=c||this.resolveDataElementOptions(G,v.active?"active":r)),A||this.updateElement(v,G,B,r),Z=R}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,i=n.options&&n.options.borderWidth||0,r=t.data||[];if(!r.length)return i;const o=r[0].size(this.resolveDataElementOptions(0)),a=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(i,o,a)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}ye(Ad,"id","line"),ye(Ad,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),ye(Ad,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Ac extends hr{constructor(t,n){super(t,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart,r=i.data.labels||[],o=xu(n._parsed[t].r,i.options.locale);return{label:r[t]||"",value:o}}parseObjectData(t,n,i,r){return u1.bind(this)(t,n,i,r)}update(t){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,t)}getMinMax(){const t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((i,r)=>{const o=this.getParsed(r).r;!isNaN(o)&&this.chart.getDataVisibility(r)&&(o<n.min&&(n.min=o),o>n.max&&(n.max=o))}),n}_updateRadius(){const t=this.chart,n=t.chartArea,i=t.options,r=Math.min(n.right-n.left,n.bottom-n.top),o=Math.max(r/2,0),a=Math.max(i.cutoutPercentage?o/100*i.cutoutPercentage:1,0),l=(o-a)/t.getVisibleDatasetCount();this.outerRadius=o-l*this.index,this.innerRadius=this.outerRadius-l}updateElements(t,n,i,r){const o=r==="reset",a=this.chart,s=a.options.animation,g=this._cachedMeta.rScale,c=g.xCenter,u=g.yCenter,I=g.getIndexAngle(0)-.5*Qt;let C=I,m;const f=360/this.countVisibleElements();for(m=0;m<n;++m)C+=this._computeAngle(m,r,f);for(m=n;m<n+i;m++){const b=t[m];let A=C,p=C+this._computeAngle(m,r,f),y=a.getDataVisibility(m)?g.getDistanceFromCenterForValue(this.getParsed(m).r):0;C=p,o&&(s.animateScale&&(y=0),s.animateRotate&&(A=p=I));const Z={x:c,y:u,innerRadius:0,outerRadius:y,startAngle:A,endAngle:p,options:this.resolveDataElementOptions(m,b.active?"active":r)};this.updateElement(b,m,Z,r)}}countVisibleElements(){const t=this._cachedMeta;let n=0;return t.data.forEach((i,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&n++}),n}_computeAngle(t,n,i){return this.chart.getDataVisibility(t)?ur(this.resolveDataElementOptions(t,n).angle||i):0}}ye(Ac,"id","polarArea"),ye(Ac,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),ye(Ac,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:i,color:r}}=t.legend.options;return n.labels.map((o,a)=>{const s=t.getDatasetMeta(0).controller.getStyle(a);return{text:o,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:r,lineWidth:s.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(a),index:a}})}return[]}},onClick(t,n,i){i.chart.toggleDataVisibility(n.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class bC extends Do{}ye(bC,"id","pie"),ye(bC,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class fd extends hr{getLabelAndValue(t){const n=this._cachedMeta.vScale,i=this.getParsed(t);return{label:n.getLabels()[t],value:""+n.getLabelForValue(i[n.axis])}}parseObjectData(t,n,i,r){return u1.bind(this)(t,n,i,r)}update(t){const n=this._cachedMeta,i=n.dataset,r=n.data||[],o=n.iScale.getLabels();if(i.points=r,t!=="resize"){const a=this.resolveDatasetElementOptions(t);this.options.showLine||(a.borderWidth=0);const l={_loop:!0,_fullLoop:o.length===r.length,options:a};this.updateElement(i,void 0,l,t)}this.updateElements(r,0,r.length,t)}updateElements(t,n,i,r){const o=this._cachedMeta.rScale,a=r==="reset";for(let l=n;l<n+i;l++){const s=t[l],g=this.resolveDataElementOptions(l,s.active?"active":r),c=o.getPointPositionForValue(l,this.getParsed(l).r),u=a?o.xCenter:c.x,I=a?o.yCenter:c.y,C={x:u,y:I,angle:c.angle,skip:isNaN(u)||isNaN(I),options:g};this.updateElement(s,l,C,r)}}}ye(fd,"id","radar"),ye(fd,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),ye(fd,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class pd extends hr{getLabelAndValue(t){const n=this._cachedMeta,i=this.chart.data.labels||[],{xScale:r,yScale:o}=n,a=this.getParsed(t),l=r.getLabelForValue(a.x),s=o.getLabelForValue(a.y);return{label:i[t]||"",value:"("+l+", "+s+")"}}update(t){const n=this._cachedMeta,{data:i=[]}=n,r=this.chart._animationsDisabled;let{start:o,count:a}=n1(n,i,r);if(this._drawStart=o,this._drawCount=a,i1(n)&&(o=0,a=i.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:l,_dataset:s}=n;l._chart=this.chart,l._datasetIndex=this.index,l._decimated=!!s._decimated,l.points=i;const g=this.resolveDatasetElementOptions(t);g.segment=this.options.segment,this.updateElement(l,void 0,{animated:!r,options:g},t)}else this.datasetElementType&&(delete n.dataset,this.datasetElementType=!1);this.updateElements(i,o,a,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,n,i,r){const o=r==="reset",{iScale:a,vScale:l,_stacked:s,_dataset:g}=this._cachedMeta,c=this.resolveDataElementOptions(n,r),u=this.getSharedOptions(c),I=this.includeOptions(r,u),C=a.axis,m=l.axis,{spanGaps:f,segment:b}=this.options,A=Vs(f)?f:Number.POSITIVE_INFINITY,p=this.chart._animationsDisabled||o||r==="none";let y=n>0&&this.getParsed(n-1);for(let Z=n;Z<n+i;++Z){const G=t[Z],v=this.getParsed(Z),B=p?G:{},R=bt(v[m]),X=B[C]=a.getPixelForValue(v[C],Z),W=B[m]=o||R?l.getBasePixel():l.getPixelForValue(s?this.applyStack(l,v,s):v[m],Z);B.skip=isNaN(X)||isNaN(W)||R,B.stop=Z>0&&Math.abs(v[C]-y[C])>A,b&&(B.parsed=v,B.raw=g.data[Z]),I&&(B.options=u||this.resolveDataElementOptions(Z,G.active?"active":r)),p||this.updateElement(G,Z,B,r),y=v}this.updateSharedOptions(u,r,c)}getMaxOverflow(){const t=this._cachedMeta,n=t.data||[];if(!this.options.showLine){let l=0;for(let s=n.length-1;s>=0;--s)l=Math.max(l,n[s].size(this.resolveDataElementOptions(s))/2);return l>0&&l}const i=t.dataset,r=i.options&&i.options.borderWidth||0;if(!n.length)return r;const o=n[0].size(this.resolveDataElementOptions(0)),a=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(r,o,a)/2}}ye(pd,"id","scatter"),ye(pd,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),ye(pd,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var Wz=Object.freeze({__proto__:null,BarController:hd,BubbleController:md,DoughnutController:Do,LineController:Ad,PieController:bC,PolarAreaController:Ac,RadarController:fd,ScatterController:pd});function Va(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Ky{constructor(t){ye(this,"options");this.options=t||{}}static override(t){Object.assign(Ky.prototype,t)}init(){}formats(){return Va()}parse(){return Va()}format(){return Va()}add(){return Va()}diff(){return Va()}startOf(){return Va()}endOf(){return Va()}}var kz={_date:Ky};function Vz(e,t,n,i){const{controller:r,data:o,_sorted:a}=e,l=r._cachedMeta.iScale;if(l&&t===l.axis&&t!=="r"&&a&&o.length){const s=l._reversePixels?$3:$r;if(i){if(r._sharedOptions){const g=o[0],c=typeof g.getRange=="function"&&g.getRange(t);if(c){const u=s(o,t,n-c),I=s(o,t,n+c);return{lo:u.lo,hi:I.hi}}}}else return s(o,t,n)}return{lo:0,hi:o.length-1}}function Xu(e,t,n,i,r){const o=e.getSortedVisibleDatasetMetas(),a=n[t];for(let l=0,s=o.length;l<s;++l){const{index:g,data:c}=o[l],{lo:u,hi:I}=Vz(o[l],t,a,r);for(let C=u;C<=I;++C){const m=c[C];m.skip||i(m,g,C)}}}function wz(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(i,r){const o=t?Math.abs(i.x-r.x):0,a=n?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(a,2))}}function BA(e,t,n,i,r){const o=[];return!r&&!e.isPointInArea(t)||Xu(e,n,t,function(l,s,g){!r&&!eo(l,e.chartArea,0)||l.inRange(t.x,t.y,i)&&o.push({element:l,datasetIndex:s,index:g})},!0),o}function xz(e,t,n,i){let r=[];function o(a,l,s){const{startAngle:g,endAngle:c}=a.getProps(["startAngle","endAngle"],i),{angle:u}=Ow(a,{x:t.x,y:t.y});Qc(u,g,c)&&r.push({element:a,datasetIndex:l,index:s})}return Xu(e,n,t,o),r}function Xz(e,t,n,i,r,o){let a=[];const l=wz(n);let s=Number.POSITIVE_INFINITY;function g(c,u,I){const C=c.inRange(t.x,t.y,r);if(i&&!C)return;const m=c.getCenterPoint(r);if(!(!!o||e.isPointInArea(m))&&!C)return;const b=l(t,m);b<s?(a=[{element:c,datasetIndex:u,index:I}],s=b):b===s&&a.push({element:c,datasetIndex:u,index:I})}return Xu(e,n,t,g),a}function RA(e,t,n,i,r,o){return!o&&!e.isPointInArea(t)?[]:n==="r"&&!i?xz(e,t,n,r):Xz(e,t,n,i,r,o)}function yS(e,t,n,i,r){const o=[],a=n==="x"?"inXRange":"inYRange";let l=!1;return Xu(e,n,t,(s,g,c)=>{s[a]&&s[a](t[n],r)&&(o.push({element:s,datasetIndex:g,index:c}),l=l||s.inRange(t.x,t.y,r))}),i&&!l?[]:o}var Jz={evaluateInteractionItems:Xu,modes:{index(e,t,n,i){const r=Fa(t,e),o=n.axis||"x",a=n.includeInvisible||!1,l=n.intersect?BA(e,r,o,i,a):RA(e,r,o,!1,i,a),s=[];return l.length?(e.getSortedVisibleDatasetMetas().forEach(g=>{const c=l[0].index,u=g.data[c];u&&!u.skip&&s.push({element:u,datasetIndex:g.index,index:c})}),s):[]},dataset(e,t,n,i){const r=Fa(t,e),o=n.axis||"xy",a=n.includeInvisible||!1;let l=n.intersect?BA(e,r,o,i,a):RA(e,r,o,!1,i,a);if(l.length>0){const s=l[0].datasetIndex,g=e.getDatasetMeta(s).data;l=[];for(let c=0;c<g.length;++c)l.push({element:g[c],datasetIndex:s,index:c})}return l},point(e,t,n,i){const r=Fa(t,e),o=n.axis||"xy",a=n.includeInvisible||!1;return BA(e,r,o,i,a)},nearest(e,t,n,i){const r=Fa(t,e),o=n.axis||"xy",a=n.includeInvisible||!1;return RA(e,r,o,n.intersect,i,a)},x(e,t,n,i){const r=Fa(t,e);return yS(e,r,"x",n.intersect,i)},y(e,t,n,i){const r=Fa(t,e);return yS(e,r,"y",n.intersect,i)}}};const y1=["left","top","right","bottom"];function Wg(e,t){return e.filter(n=>n.pos===t)}function ZS(e,t){return e.filter(n=>y1.indexOf(n.pos)===-1&&n.box.axis===t)}function kg(e,t){return e.sort((n,i)=>{const r=t?i:n,o=t?n:i;return r.weight===o.weight?r.index-o.index:r.weight-o.weight})}function Yz(e){const t=[];let n,i,r,o,a,l;for(n=0,i=(e||[]).length;n<i;++n)r=e[n],{position:o,options:{stack:a,stackWeight:l=1}}=r,t.push({index:n,box:r,pos:o,horizontal:r.isHorizontal(),weight:r.weight,stack:a&&o+a,stackWeight:l});return t}function Nz(e){const t={};for(const n of e){const{stack:i,pos:r,stackWeight:o}=n;if(!i||!y1.includes(r))continue;const a=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=o}return t}function Hz(e,t){const n=Nz(e),{vBoxMaxWidth:i,hBoxMaxHeight:r}=t;let o,a,l;for(o=0,a=e.length;o<a;++o){l=e[o];const{fullSize:s}=l.box,g=n[l.stack],c=g&&l.stackWeight/g.weight;l.horizontal?(l.width=c?c*i:s&&t.availableWidth,l.height=r):(l.width=i,l.height=c?c*r:s&&t.availableHeight)}return n}function Fz(e){const t=Yz(e),n=kg(t.filter(g=>g.box.fullSize),!0),i=kg(Wg(t,"left"),!0),r=kg(Wg(t,"right")),o=kg(Wg(t,"top"),!0),a=kg(Wg(t,"bottom")),l=ZS(t,"x"),s=ZS(t,"y");return{fullSize:n,leftAndTop:i.concat(o),rightAndBottom:r.concat(s).concat(a).concat(l),chartArea:Wg(t,"chartArea"),vertical:i.concat(r).concat(s),horizontal:o.concat(a).concat(l)}}function vS(e,t,n,i){return Math.max(e[n],t[n])+Math.max(e[i],t[i])}function Z1(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Kz(e,t,n,i){const{pos:r,box:o}=n,a=e.maxPadding;if(!ht(r)){n.size&&(e[r]-=n.size);const u=i[n.stack]||{size:0,count:1};u.size=Math.max(u.size,n.horizontal?o.height:o.width),n.size=u.size/u.count,e[r]+=n.size}o.getPadding&&Z1(a,o.getPadding());const l=Math.max(0,t.outerWidth-vS(a,e,"left","right")),s=Math.max(0,t.outerHeight-vS(a,e,"top","bottom")),g=l!==e.w,c=s!==e.h;return e.w=l,e.h=s,n.horizontal?{same:g,other:c}:{same:c,other:g}}function Ez(e){const t=e.maxPadding;function n(i){const r=Math.max(t[i]-e[i],0);return e[i]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function Mz(e,t){const n=t.maxPadding;function i(r){const o={left:0,top:0,right:0,bottom:0};return r.forEach(a=>{o[a]=Math.max(t[a],n[a])}),o}return i(e?["left","right"]:["top","bottom"])}function _g(e,t,n,i){const r=[];let o,a,l,s,g,c;for(o=0,a=e.length,g=0;o<a;++o){l=e[o],s=l.box,s.update(l.width||t.w,l.height||t.h,Mz(l.horizontal,t));const{same:u,other:I}=Kz(t,n,l,i);g|=u&&r.length,c=c||I,s.fullSize||r.push(l)}return g&&_g(r,t,n,i)||c}function kI(e,t,n,i,r){e.top=n,e.left=t,e.right=t+i,e.bottom=n+r,e.width=i,e.height=r}function GS(e,t,n,i){const r=n.padding;let{x:o,y:a}=t;for(const l of e){const s=l.box,g=i[l.stack]||{count:1,placed:0,weight:1},c=l.stackWeight/g.weight||1;if(l.horizontal){const u=t.w*c,I=g.size||s.height;Uc(g.start)&&(a=g.start),s.fullSize?kI(s,r.left,a,n.outerWidth-r.right-r.left,I):kI(s,t.left+g.placed,a,u,I),g.start=a,g.placed+=u,a=s.bottom}else{const u=t.h*c,I=g.size||s.width;Uc(g.start)&&(o=g.start),s.fullSize?kI(s,o,r.top,I,n.outerHeight-r.bottom-r.top):kI(s,o,t.top+g.placed,I,u),g.start=o,g.placed+=u,o=s.right}}t.x=o,t.y=a}var Pn={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,i){if(!e)return;const r=$n(e.options.layout.padding),o=Math.max(t-r.width,0),a=Math.max(n-r.height,0),l=Fz(e.boxes),s=l.vertical,g=l.horizontal;kt(e.boxes,f=>{typeof f.beforeLayout=="function"&&f.beforeLayout()});const c=s.reduce((f,b)=>b.box.options&&b.box.options.display===!1?f:f+1,0)||1,u=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:o,availableHeight:a,vBoxMaxWidth:o/2/c,hBoxMaxHeight:a/2}),I=Object.assign({},r);Z1(I,$n(i));const C=Object.assign({maxPadding:I,w:o,h:a,x:r.left,y:r.top},r),m=Hz(s.concat(g),u);_g(l.fullSize,C,u,m),_g(s,C,u,m),_g(g,C,u,m)&&_g(s,C,u,m),Ez(C),GS(l.leftAndTop,C,u,m),C.x+=C.w,C.y+=C.h,GS(l.rightAndBottom,C,u,m),e.chartArea={left:C.left,top:C.top,right:C.left+C.w,bottom:C.top+C.h,height:C.h,width:C.w},kt(l.chartArea,f=>{const b=f.box;Object.assign(b,e.chartArea),b.update(C.w,C.h,{left:0,top:0,right:0,bottom:0})})}};class v1{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,i){}removeEventListener(t,n,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,i,r){return n=Math.max(0,n||t.width),i=i||t.height,{width:n,height:Math.max(0,r?Math.floor(n/r):i)}}isAttached(t){return!0}updateConfig(t){}}class zz extends v1{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const bd="$chartjs",Lz={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},SS=e=>e===null||e==="";function Dz(e,t){const n=e.style,i=e.getAttribute("height"),r=e.getAttribute("width");if(e[bd]={initial:{height:i,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",SS(r)){const o=sS(e,"width");o!==void 0&&(e.width=o)}if(SS(i))if(e.style.height==="")e.height=e.width/(t||2);else{const o=sS(e,"height");o!==void 0&&(e.height=o)}return e}const G1=jM?{passive:!0}:!1;function Tz(e,t,n){e&&e.addEventListener(t,n,G1)}function jz(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,G1)}function Uz(e,t){const n=Lz[e.type]||e.type,{x:i,y:r}=Fa(e,t);return{type:n,chart:t,native:e,x:i!==void 0?i:null,y:r!==void 0?r:null}}function yC(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function Qz(e,t,n){const i=e.canvas,r=new MutationObserver(o=>{let a=!1;for(const l of o)a=a||yC(l.addedNodes,i),a=a&&!yC(l.removedNodes,i);a&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function Pz(e,t,n){const i=e.canvas,r=new MutationObserver(o=>{let a=!1;for(const l of o)a=a||yC(l.removedNodes,i),a=a&&!yC(l.addedNodes,i);a&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const _c=new Map;let BS=0;function S1(){const e=window.devicePixelRatio;e!==BS&&(BS=e,_c.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function _z(e,t){_c.size||window.addEventListener("resize",S1),_c.set(e,t)}function Oz(e){_c.delete(e),_c.size||window.removeEventListener("resize",S1)}function qz(e,t,n){const i=e.canvas,r=i&&Fy(i);if(!r)return;const o=t1((l,s)=>{const g=r.clientWidth;n(l,s),g<r.clientWidth&&n()},window),a=new ResizeObserver(l=>{const s=l[0],g=s.contentRect.width,c=s.contentRect.height;g===0&&c===0||o(g,c)});return a.observe(r),_z(e,o),a}function WA(e,t,n){n&&n.disconnect(),t==="resize"&&Oz(e)}function $z(e,t,n){const i=e.canvas,r=t1(o=>{e.ctx!==null&&n(Uz(o,e))},e);return Tz(i,t,r),r}class eL extends v1{acquireContext(t,n){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(Dz(t,n),i):null}releaseContext(t){const n=t.canvas;if(!n[bd])return!1;const i=n[bd].initial;["height","width"].forEach(o=>{const a=i[o];bt(a)?n.removeAttribute(o):n.setAttribute(o,a)});const r=i.style||{};return Object.keys(r).forEach(o=>{n.style[o]=r[o]}),n.width=n.width,delete n[bd],!0}addEventListener(t,n,i){this.removeEventListener(t,n);const r=t.$proxies||(t.$proxies={}),a={attach:Qz,detach:Pz,resize:qz}[n]||$z;r[n]=a(t,n,i)}removeEventListener(t,n){const i=t.$proxies||(t.$proxies={}),r=i[n];if(!r)return;({attach:WA,detach:WA,resize:WA}[n]||jz)(t,n,r),i[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,i,r){return TM(t,n,i,r)}isAttached(t){const n=t&&Fy(t);return!!(n&&n.isConnected)}}function tL(e){return!Hy()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?zz:eL}var ed;let uo=(ed=class{constructor(){ye(this,"x");ye(this,"y");ye(this,"active",!1);ye(this,"options");ye(this,"$animations")}tooltipPosition(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}hasValue(){return Vs(this.x)&&Vs(this.y)}getProps(t,n){const i=this.$animations;if(!n||!i)return this;const r={};return t.forEach(o=>{r[o]=i[o]&&i[o].active()?i[o]._to:this[o]}),r}},ye(ed,"defaults",{}),ye(ed,"defaultRoutes"),ed);function nL(e,t){const n=e.options.ticks,i=iL(e),r=Math.min(n.maxTicksLimit||i,i),o=n.major.enabled?oL(t):[],a=o.length,l=o[0],s=o[a-1],g=[];if(a>r)return aL(t,g,o,a/r),g;const c=rL(o,t,r);if(a>0){let u,I;const C=a>1?Math.round((s-l)/(a-1)):null;for(VI(t,g,c,bt(C)?0:l-C,l),u=0,I=a-1;u<I;u++)VI(t,g,c,o[u],o[u+1]);return VI(t,g,c,s,bt(C)?t.length:s+C),g}return VI(t,g,c),g}function iL(e){const t=e.options.offset,n=e._tickSize(),i=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(i,r))}function rL(e,t,n){const i=lL(e),r=t.length/n;if(!i)return Math.max(r,1);const o=P3(i);for(let a=0,l=o.length-1;a<l;a++){const s=o[a];if(s>r)return s}return Math.max(r,1)}function oL(e){const t=[];let n,i;for(n=0,i=e.length;n<i;n++)e[n].major&&t.push(n);return t}function aL(e,t,n,i){let r=0,o=n[0],a;for(i=Math.ceil(i),a=0;a<e.length;a++)a===o&&(t.push(e[a]),r++,o=n[r*i])}function VI(e,t,n,i,r){const o=nt(i,0),a=Math.min(nt(r,e.length),e.length);let l=0,s,g,c;for(n=Math.ceil(n),r&&(s=r-i,n=s/Math.floor(s/n)),c=o;c<0;)l++,c=Math.round(o+l*n);for(g=Math.max(o,0);g<a;g++)g===c&&(t.push(e[g]),l++,c=Math.round(o+l*n))}function lL(e){const t=e.length;let n,i;if(t<2)return!1;for(i=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==i)return!1;return i}const sL=e=>e==="left"?"right":e==="right"?"left":e,RS=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,WS=(e,t)=>Math.min(t||e,e);function kS(e,t){const n=[],i=e.length/t,r=e.length;let o=0;for(;o<r;o+=i)n.push(e[Math.floor(o)]);return n}function gL(e,t,n){const i=e.ticks.length,r=Math.min(t,i-1),o=e._startPixel,a=e._endPixel,l=1e-6;let s=e.getPixelForTick(r),g;if(!(n&&(i===1?g=Math.max(s-o,a-s):t===0?g=(e.getPixelForTick(1)-s)/2:g=(s-e.getPixelForTick(r-1))/2,s+=r<t?g:-g,s<o-l||s>a+l)))return s}function cL(e,t){kt(e,n=>{const i=n.gc,r=i.length/2;let o;if(r>t){for(o=0;o<r;++o)delete n.data[i[o]];i.splice(0,r)}})}function Vg(e){return e.drawTicks?e.tickLength:0}function VS(e,t){if(!e.display)return 0;const n=Sn(e.font,t),i=$n(e.padding);return(en(e.text)?e.text.length:1)*n.lineHeight+i.height}function uL(e,t){return fa(e,{scale:t,type:"scale"})}function IL(e,t,n){return fa(e,{tick:n,index:t,type:"tick"})}function dL(e,t,n){let i=wy(e);return(n&&t!=="right"||!n&&t==="right")&&(i=sL(i)),i}function CL(e,t,n,i){const{top:r,left:o,bottom:a,right:l,chart:s}=e,{chartArea:g,scales:c}=s;let u=0,I,C,m;const f=a-r,b=l-o;if(e.isHorizontal()){if(C=jn(i,o,l),ht(n)){const A=Object.keys(n)[0],p=n[A];m=c[A].getPixelForValue(p)+f-t}else n==="center"?m=(g.bottom+g.top)/2+f-t:m=RS(e,n,t);I=l-o}else{if(ht(n)){const A=Object.keys(n)[0],p=n[A];C=c[A].getPixelForValue(p)-b+t}else n==="center"?C=(g.left+g.right)/2-b+t:C=RS(e,n,t);m=jn(i,a,r),u=n==="left"?-hn:hn}return{titleX:C,titleY:m,maxWidth:I,rotation:u}}class hl extends uo{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:i,_suggestedMax:r}=this;return t=Wi(t,Number.POSITIVE_INFINITY),n=Wi(n,Number.NEGATIVE_INFINITY),i=Wi(i,Number.POSITIVE_INFINITY),r=Wi(r,Number.NEGATIVE_INFINITY),{min:Wi(t,i),max:Wi(n,r),minDefined:dn(t),maxDefined:dn(n)}}getMinMax(t){let{min:n,max:i,minDefined:r,maxDefined:o}=this.getUserBounds(),a;if(r&&o)return{min:n,max:i};const l=this.getMatchingVisibleMetas();for(let s=0,g=l.length;s<g;++s)a=l[s].controller.getMinMax(this,t),r||(n=Math.min(n,a.min)),o||(i=Math.max(i,a.max));return n=o&&n>i?i:n,i=r&&n>i?n:i,{min:Wi(n,Wi(i,n)),max:Wi(i,Wi(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){zt(this.options.beforeUpdate,[this])}update(t,n,i){const{beginAtZero:r,grace:o,ticks:a}=this.options,l=a.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=vM(this,o,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const s=l<this.ticks.length;this._convertTicksToLabels(s?kS(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=nL(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),s&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,i;this.isHorizontal()?(n=this.left,i=this.right):(n=this.top,i=this.bottom,t=!t),this._startPixel=n,this._endPixel=i,this._reversePixels=t,this._length=i-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){zt(this.options.afterUpdate,[this])}beforeSetDimensions(){zt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){zt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),zt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){zt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let i,r,o;for(i=0,r=t.length;i<r;i++)o=t[i],o.label=zt(n.callback,[o.value,i,t],this)}afterTickToLabelConversion(){zt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){zt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,i=WS(this.ticks.length,t.ticks.maxTicksLimit),r=n.minRotation||0,o=n.maxRotation;let a=r,l,s,g;if(!this._isVisible()||!n.display||r>=o||i<=1||!this.isHorizontal()){this.labelRotation=r;return}const c=this._getLabelSizes(),u=c.widest.width,I=c.highest.height,C=Xn(this.chart.width-u,0,this.maxWidth);l=t.offset?this.maxWidth/i:C/(i-1),u+6>l&&(l=C/(i-(t.offset?.5:1)),s=this.maxHeight-Vg(t.grid)-n.padding-VS(t.title,this.chart.options.font),g=Math.sqrt(u*u+I*I),a=ky(Math.min(Math.asin(Xn((c.highest.height+6)/l,-1,1)),Math.asin(Xn(s/g,-1,1))-Math.asin(Xn(I/g,-1,1)))),a=Math.max(r,Math.min(o,a))),this.labelRotation=a}afterCalculateLabelRotation(){zt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){zt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:i,title:r,grid:o}}=this,a=this._isVisible(),l=this.isHorizontal();if(a){const s=VS(r,n.options.font);if(l?(t.width=this.maxWidth,t.height=Vg(o)+s):(t.height=this.maxHeight,t.width=Vg(o)+s),i.display&&this.ticks.length){const{first:g,last:c,widest:u,highest:I}=this._getLabelSizes(),C=i.padding*2,m=ur(this.labelRotation),f=Math.cos(m),b=Math.sin(m);if(l){const A=i.mirror?0:b*u.width+f*I.height;t.height=Math.min(this.maxHeight,t.height+A+C)}else{const A=i.mirror?0:f*u.width+b*I.height;t.width=Math.min(this.maxWidth,t.width+A+C)}this._calculatePadding(g,c,b,f)}}this._handleMargins(),l?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,i,r){const{ticks:{align:o,padding:a},position:l}=this.options,s=this.labelRotation!==0,g=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const c=this.getPixelForTick(0)-this.left,u=this.right-this.getPixelForTick(this.ticks.length-1);let I=0,C=0;s?g?(I=r*t.width,C=i*n.height):(I=i*t.height,C=r*n.width):o==="start"?C=n.width:o==="end"?I=t.width:o!=="inner"&&(I=t.width/2,C=n.width/2),this.paddingLeft=Math.max((I-c+a)*this.width/(this.width-c),0),this.paddingRight=Math.max((C-u+a)*this.width/(this.width-u),0)}else{let c=n.height/2,u=t.height/2;o==="start"?(c=0,u=t.height):o==="end"&&(c=n.height,u=0),this.paddingTop=c+a,this.paddingBottom=u+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){zt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,i;for(n=0,i=t.length;n<i;n++)bt(t[n].label)&&(t.splice(n,1),i--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let i=this.ticks;n<i.length&&(i=kS(i,n)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,i){const{ctx:r,_longestTextCache:o}=this,a=[],l=[],s=Math.floor(n/WS(n,i));let g=0,c=0,u,I,C,m,f,b,A,p,y,Z,G;for(u=0;u<n;u+=s){if(m=t[u].label,f=this._resolveTickFontOptions(u),r.font=b=f.string,A=o[b]=o[b]||{data:{},gc:[]},p=f.lineHeight,y=Z=0,!bt(m)&&!en(m))y=fC(r,A.data,A.gc,y,m),Z=p;else if(en(m))for(I=0,C=m.length;I<C;++I)G=m[I],!bt(G)&&!en(G)&&(y=fC(r,A.data,A.gc,y,G),Z+=p);a.push(y),l.push(Z),g=Math.max(y,g),c=Math.max(Z,c)}cL(o,n);const v=a.indexOf(g),B=l.indexOf(c),R=X=>({width:a[X]||0,height:l[X]||0});return{first:R(0),last:R(n-1),widest:R(v),highest:R(B),widths:a,heights:l}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return q3(this._alignToPixels?ka(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const i=n[t];return i.$context||(i.$context=IL(this.getContext(),t,i))}return this.$context||(this.$context=uL(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=ur(this.labelRotation),i=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),o=this._getLabelSizes(),a=t.autoSkipPadding||0,l=o?o.widest.width+a:0,s=o?o.highest.height+a:0;return this.isHorizontal()?s*i>l*r?l/i:s/r:s*r<l*i?s/i:l/r}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,i=this.chart,r=this.options,{grid:o,position:a,border:l}=r,s=o.offset,g=this.isHorizontal(),u=this.ticks.length+(s?1:0),I=Vg(o),C=[],m=l.setContext(this.getContext()),f=m.display?m.width:0,b=f/2,A=function(w){return ka(i,w,f)};let p,y,Z,G,v,B,R,X,W,V,Y,K;if(a==="top")p=A(this.bottom),B=this.bottom-I,X=p-b,V=A(t.top)+b,K=t.bottom;else if(a==="bottom")p=A(this.top),V=t.top,K=A(t.bottom)-b,B=p+b,X=this.top+I;else if(a==="left")p=A(this.right),v=this.right-I,R=p-b,W=A(t.left)+b,Y=t.right;else if(a==="right")p=A(this.left),W=t.left,Y=A(t.right)-b,v=p+b,R=this.left+I;else if(n==="x"){if(a==="center")p=A((t.top+t.bottom)/2+.5);else if(ht(a)){const w=Object.keys(a)[0],x=a[w];p=A(this.chart.scales[w].getPixelForValue(x))}V=t.top,K=t.bottom,B=p+b,X=B+I}else if(n==="y"){if(a==="center")p=A((t.left+t.right)/2);else if(ht(a)){const w=Object.keys(a)[0],x=a[w];p=A(this.chart.scales[w].getPixelForValue(x))}v=p-b,R=v-I,W=t.left,Y=t.right}const M=nt(r.ticks.maxTicksLimit,u),H=Math.max(1,Math.ceil(u/M));for(y=0;y<u;y+=H){const w=this.getContext(y),x=o.setContext(w),J=l.setContext(w),F=x.lineWidth,S=x.color,E=J.dash||[],N=J.dashOffset,k=x.tickWidth,z=x.tickColor,L=x.tickBorderDash||[],D=x.tickBorderDashOffset;Z=gL(this,y,s),Z!==void 0&&(G=ka(i,Z,F),g?v=R=W=Y=G:B=X=V=K=G,C.push({tx1:v,ty1:B,tx2:R,ty2:X,x1:W,y1:V,x2:Y,y2:K,width:F,color:S,borderDash:E,borderDashOffset:N,tickWidth:k,tickColor:z,tickBorderDash:L,tickBorderDashOffset:D}))}return this._ticksLength=u,this._borderValue=p,C}_computeLabelItems(t){const n=this.axis,i=this.options,{position:r,ticks:o}=i,a=this.isHorizontal(),l=this.ticks,{align:s,crossAlign:g,padding:c,mirror:u}=o,I=Vg(i.grid),C=I+c,m=u?-c:C,f=-ur(this.labelRotation),b=[];let A,p,y,Z,G,v,B,R,X,W,V,Y,K="middle";if(r==="top")v=this.bottom-m,B=this._getXAxisLabelAlignment();else if(r==="bottom")v=this.top+m,B=this._getXAxisLabelAlignment();else if(r==="left"){const H=this._getYAxisLabelAlignment(I);B=H.textAlign,G=H.x}else if(r==="right"){const H=this._getYAxisLabelAlignment(I);B=H.textAlign,G=H.x}else if(n==="x"){if(r==="center")v=(t.top+t.bottom)/2+C;else if(ht(r)){const H=Object.keys(r)[0],w=r[H];v=this.chart.scales[H].getPixelForValue(w)+C}B=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")G=(t.left+t.right)/2-C;else if(ht(r)){const H=Object.keys(r)[0],w=r[H];G=this.chart.scales[H].getPixelForValue(w)}B=this._getYAxisLabelAlignment(I).textAlign}n==="y"&&(s==="start"?K="top":s==="end"&&(K="bottom"));const M=this._getLabelSizes();for(A=0,p=l.length;A<p;++A){y=l[A],Z=y.label;const H=o.setContext(this.getContext(A));R=this.getPixelForTick(A)+o.labelOffset,X=this._resolveTickFontOptions(A),W=X.lineHeight,V=en(Z)?Z.length:1;const w=V/2,x=H.color,J=H.textStrokeColor,F=H.textStrokeWidth;let S=B;a?(G=R,B==="inner"&&(A===p-1?S=this.options.reverse?"left":"right":A===0?S=this.options.reverse?"right":"left":S="center"),r==="top"?g==="near"||f!==0?Y=-V*W+W/2:g==="center"?Y=-M.highest.height/2-w*W+W:Y=-M.highest.height+W/2:g==="near"||f!==0?Y=W/2:g==="center"?Y=M.highest.height/2-w*W:Y=M.highest.height-V*W,u&&(Y*=-1),f!==0&&!H.showLabelBackdrop&&(G+=W/2*Math.sin(f))):(v=R,Y=(1-V)*W/2);let E;if(H.showLabelBackdrop){const N=$n(H.backdropPadding),k=M.heights[A],z=M.widths[A];let L=Y-N.top,D=0-N.left;switch(K){case"middle":L-=k/2;break;case"bottom":L-=k;break}switch(B){case"center":D-=z/2;break;case"right":D-=z;break;case"inner":A===p-1?D-=z:A>0&&(D-=z/2);break}E={left:D,top:L,width:z+N.width,height:k+N.height,color:H.backdropColor}}b.push({label:Z,font:X,textOffset:Y,options:{rotation:f,color:x,strokeColor:J,strokeWidth:F,textAlign:S,textBaseline:K,translation:[G,v],backdrop:E}})}return b}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-ur(this.labelRotation))return t==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:i,mirror:r,padding:o}}=this.options,a=this._getLabelSizes(),l=t+o,s=a.widest.width;let g,c;return n==="left"?r?(c=this.right+o,i==="near"?g="left":i==="center"?(g="center",c+=s/2):(g="right",c+=s)):(c=this.right-l,i==="near"?g="right":i==="center"?(g="center",c-=s/2):(g="left",c=this.left)):n==="right"?r?(c=this.left+o,i==="near"?g="right":i==="center"?(g="center",c-=s/2):(g="left",c-=s)):(c=this.left+l,i==="near"?g="left":i==="center"?(g="center",c+=s/2):(g="right",c=this.right)):g="right",{textAlign:g,x:c}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:i,top:r,width:o,height:a}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(i,r,o,a),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(o=>o.value===t);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){const n=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let o,a;const l=(s,g,c)=>{!c.width||!c.color||(i.save(),i.lineWidth=c.width,i.strokeStyle=c.color,i.setLineDash(c.borderDash||[]),i.lineDashOffset=c.borderDashOffset,i.beginPath(),i.moveTo(s.x,s.y),i.lineTo(g.x,g.y),i.stroke(),i.restore())};if(n.display)for(o=0,a=r.length;o<a;++o){const s=r[o];n.drawOnChartArea&&l({x:s.x1,y:s.y1},{x:s.x2,y:s.y2},s),n.drawTicks&&l({x:s.tx1,y:s.ty1},{x:s.tx2,y:s.ty2},{color:s.tickColor,width:s.tickWidth,borderDash:s.tickBorderDash,borderDashOffset:s.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{border:i,grid:r}}=this,o=i.setContext(this.getContext()),a=i.display?o.width:0;if(!a)return;const l=r.setContext(this.getContext(0)).lineWidth,s=this._borderValue;let g,c,u,I;this.isHorizontal()?(g=ka(t,this.left,a)-a/2,c=ka(t,this.right,l)+l/2,u=I=s):(u=ka(t,this.top,a)-a/2,I=ka(t,this.bottom,l)+l/2,g=c=s),n.save(),n.lineWidth=o.width,n.strokeStyle=o.color,n.beginPath(),n.moveTo(g,u),n.lineTo(c,I),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,r=this._computeLabelArea();r&&Sh(i,r);const o=this.getLabelItems(t);for(const a of o){const l=a.options,s=a.font,g=a.label,c=a.textOffset;ll(i,g,0,c,s,l)}r&&Bh(i)}drawTitle(){const{ctx:t,options:{position:n,title:i,reverse:r}}=this;if(!i.display)return;const o=Sn(i.font),a=$n(i.padding),l=i.align;let s=o.lineHeight/2;n==="bottom"||n==="center"||ht(n)?(s+=a.bottom,en(i.text)&&(s+=o.lineHeight*(i.text.length-1))):s+=a.top;const{titleX:g,titleY:c,maxWidth:u,rotation:I}=CL(this,s,n,l);ll(t,i.text,0,0,o,{color:i.color,maxWidth:u,rotation:I,textAlign:dL(l,n,r),textBaseline:"middle",translation:[g,c]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,i=nt(t.grid&&t.grid.z,-1),r=nt(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==hl.prototype.draw?[{z:n,draw:o=>{this.draw(o)}}]:[{z:i,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[];let o,a;for(o=0,a=n.length;o<a;++o){const l=n[o];l[i]===this.id&&(!t||l.type===t)&&r.push(l)}return r}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return Sn(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class wI{constructor(t,n,i){this.type=t,this.scope=n,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let i;AL(n)&&(i=this.register(n));const r=this.items,o=t.id,a=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+t);return o in r||(r[o]=t,hL(t,a,i),this.override&&tn.override(t.id,t.overrides)),a}get(t){return this.items[t]}unregister(t){const n=this.items,i=t.id,r=this.scope;i in n&&delete n[i],r&&i in tn[r]&&(delete tn[r][i],this.override&&delete al[i])}}function hL(e,t,n){const i=jc(Object.create(null),[n?tn.get(n):{},tn.get(t),e.defaults]);tn.set(t,i),e.defaultRoutes&&mL(t,e.defaultRoutes),e.descriptors&&tn.describe(t,e.descriptors)}function mL(e,t){Object.keys(t).forEach(n=>{const i=n.split("."),r=i.pop(),o=[e].concat(i).join("."),a=t[n].split("."),l=a.pop(),s=a.join(".");tn.route(o,r,s,l)})}function AL(e){return"id"in e&&"defaults"in e}class fL{constructor(){this.controllers=new wI(hr,"datasets",!0),this.elements=new wI(uo,"elements"),this.plugins=new wI(Object,"plugins"),this.scales=new wI(hl,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,i){[...n].forEach(r=>{const o=i||this._getRegistryForType(r);i||o.isForType(r)||o===this.plugins&&r.id?this._exec(t,o,r):kt(r,a=>{const l=i||this._getRegistryForType(a);this._exec(t,l,a)})})}_exec(t,n,i){const r=Wy(t);zt(i["before"+r],[],i),n[t](i),zt(i["after"+r],[],i)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const i=this._typedRegistries[n];if(i.isForType(t))return i}return this.plugins}_get(t,n,i){const r=n.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return r}}var xr=new fL;class pL{constructor(){this._init=[]}notify(t,n,i,r){n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const o=r?this._descriptors(t).filter(r):this._descriptors(t),a=this._notify(o,t,n,i);return n==="afterDestroy"&&(this._notify(o,t,"stop"),this._notify(this._init,t,"uninstall")),a}_notify(t,n,i,r){r=r||{};for(const o of t){const a=o.plugin,l=a[i],s=[n,r,o.options];if(zt(l,s,a)===!1&&r.cancelable)return!1}return!0}invalidate(){bt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const i=t&&t.config,r=nt(i.options&&i.options.plugins,{}),o=bL(i);return r===!1&&!n?[]:ZL(t,o,r,n)}_notifyStateChanges(t){const n=this._oldCache||[],i=this._cache,r=(o,a)=>o.filter(l=>!a.some(s=>l.plugin.id===s.plugin.id));this._notify(r(n,i),t,"stop"),this._notify(r(i,n),t,"start")}}function bL(e){const t={},n=[],i=Object.keys(xr.plugins.items);for(let o=0;o<i.length;o++)n.push(xr.getPlugin(i[o]));const r=e.plugins||[];for(let o=0;o<r.length;o++){const a=r[o];n.indexOf(a)===-1&&(n.push(a),t[a.id]=!0)}return{plugins:n,localIds:t}}function yL(e,t){return!t&&e===!1?null:e===!0?{}:e}function ZL(e,{plugins:t,localIds:n},i,r){const o=[],a=e.getContext();for(const l of t){const s=l.id,g=yL(i[s],r);g!==null&&o.push({plugin:l,options:vL(e.config,{plugin:l,local:n[s]},g,a)})}return o}function vL(e,{plugin:t,local:n},i,r){const o=e.pluginScopeKeys(t),a=e.getOptionScopes(i,o);return n&&t.defaults&&a.push(t.defaults),e.createResolver(a,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Np(e,t){const n=tn.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function GL(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function SL(e,t){return e===t?"_index_":"_value_"}function wS(e){if(e==="x"||e==="y"||e==="r")return e}function BL(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function Hp(e,...t){if(wS(e))return e;for(const n of t){const i=n.axis||BL(n.position)||e.length>1&&wS(e[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function xS(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function RL(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(i=>i.xAxisID===e||i.yAxisID===e);if(n.length)return xS(e,"x",n[0])||xS(e,"y",n[0])}return{}}function WL(e,t){const n=al[e.type]||{scales:{}},i=t.scales||{},r=Np(e.type,t),o=Object.create(null);return Object.keys(i).forEach(a=>{const l=i[a];if(!ht(l))return console.error(`Invalid scale configuration for scale: ${a}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const s=Hp(a,l,RL(a,e),tn.scales[l.type]),g=SL(s,r),c=n.scales||{};o[a]=dc(Object.create(null),[{axis:s},l,c[s],c[g]])}),e.data.datasets.forEach(a=>{const l=a.type||e.type,s=a.indexAxis||Np(l,t),c=(al[l]||{}).scales||{};Object.keys(c).forEach(u=>{const I=GL(u,s),C=a[I+"AxisID"]||I;o[C]=o[C]||Object.create(null),dc(o[C],[{axis:I},i[C],c[u]])})}),Object.keys(o).forEach(a=>{const l=o[a];dc(l,[tn.scales[l.type],tn.scale])}),o}function B1(e){const t=e.options||(e.options={});t.plugins=nt(t.plugins,{}),t.scales=WL(e,t)}function R1(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function kL(e){return e=e||{},e.data=R1(e.data),B1(e),e}const XS=new Map,W1=new Set;function xI(e,t){let n=XS.get(e);return n||(n=t(),XS.set(e,n),W1.add(n)),n}const wg=(e,t,n)=>{const i=ca(t,n);i!==void 0&&e.add(i)};class VL{constructor(t){this._config=kL(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=R1(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),B1(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return xI(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return xI(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return xI(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,i=this.type;return xI(`${i}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const i=this._scopeCache;let r=i.get(t);return(!r||n)&&(r=new Map,i.set(t,r)),r}getOptionScopes(t,n,i){const{options:r,type:o}=this,a=this._cachedScopes(t,i),l=a.get(n);if(l)return l;const s=new Set;n.forEach(c=>{t&&(s.add(t),c.forEach(u=>wg(s,t,u))),c.forEach(u=>wg(s,r,u)),c.forEach(u=>wg(s,al[o]||{},u)),c.forEach(u=>wg(s,tn,u)),c.forEach(u=>wg(s,Jp,u))});const g=Array.from(s);return g.length===0&&g.push(Object.create(null)),W1.has(n)&&a.set(n,g),g}chartOptionScopes(){const{options:t,type:n}=this;return[t,al[n]||{},tn.datasets[n]||{},{type:n},tn,Jp]}resolveNamedOptions(t,n,i,r=[""]){const o={$shared:!0},{resolver:a,subPrefixes:l}=JS(this._resolverCache,t,r);let s=a;if(xL(a,n)){o.$shared=!1,i=ua(i)?i():i;const g=this.createResolver(t,i,l);s=ws(a,i,g)}for(const g of n)o[g]=s[g];return o}createResolver(t,n,i=[""],r){const{resolver:o}=JS(this._resolverCache,t,i);return ht(n)?ws(o,n,void 0,r):o}}function JS(e,t,n){let i=e.get(t);i||(i=new Map,e.set(t,i));const r=n.join();let o=i.get(r);return o||(o={resolver:Jy(t,n),subPrefixes:n.filter(l=>!l.toLowerCase().includes("hover"))},i.set(r,o)),o}const wL=e=>ht(e)&&Object.getOwnPropertyNames(e).some(t=>ua(e[t]));function xL(e,t){const{isScriptable:n,isIndexable:i}=l1(e);for(const r of t){const o=n(r),a=i(r),l=(a||o)&&e[r];if(o&&(ua(l)||wL(l))||a&&en(l))return!0}return!1}var XL="4.4.7";const JL=["top","bottom","left","right","chartArea"];function YS(e,t){return e==="top"||e==="bottom"||JL.indexOf(e)===-1&&t==="x"}function NS(e,t){return function(n,i){return n[e]===i[e]?n[t]-i[t]:n[e]-i[e]}}function HS(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),zt(n&&n.onComplete,[e],t)}function YL(e){const t=e.chart,n=t.options.animation;zt(n&&n.onProgress,[e],t)}function k1(e){return Hy()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const yd={},FS=e=>{const t=k1(e);return Object.values(yd).filter(n=>n.canvas===t).pop()};function NL(e,t,n){const i=Object.keys(e);for(const r of i){const o=+r;if(o>=t){const a=e[r];delete e[r],(n>0||o>t)&&(e[o+n]=a)}}}function HL(e,t,n,i){return!n||e.type==="mouseout"?null:i?t:e}function XI(e,t,n){return e.options.clip?e[n]:t[n]}function FL(e,t){const{xScale:n,yScale:i}=e;return n&&i?{left:XI(n,t,"left"),right:XI(n,t,"right"),top:XI(i,t,"top"),bottom:XI(i,t,"bottom")}:t}var Ro;let Wh=(Ro=class{static register(...t){xr.add(...t),KS()}static unregister(...t){xr.remove(...t),KS()}constructor(t,n){const i=this.config=new VL(n),r=k1(t),o=FS(r);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const a=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||tL(r)),this.platform.updateConfig(i);const l=this.platform.acquireContext(r,a.aspectRatio),s=l&&l.canvas,g=s&&s.height,c=s&&s.width;if(this.id=E3(),this.ctx=l,this.canvas=s,this.width=c,this.height=g,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new pL,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=nM(u=>this.update(u),a.resizeDelay||0),this._dataChanges=[],yd[this.id]=this,!l||!s){console.error("Failed to create chart: can't acquire context from the given item");return}Lr.listen(this,"complete",HS),Lr.listen(this,"progress",YL),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:i,height:r,_aspectRatio:o}=this;return bt(t)?n&&o?o:r?i/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return xr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():lS(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return rS(this.canvas,this.ctx),this}stop(){return Lr.stop(this),this}resize(t,n){Lr.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const i=this.options,r=this.canvas,o=i.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(r,t,n,o),l=i.devicePixelRatio||this.platform.getDevicePixelRatio(),s=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,lS(this,l,!0)&&(this.notifyPlugins("resize",{size:a}),zt(i.onResize,[this,a],this),this.attached&&this._doResize(s)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};kt(n,(i,r)=>{i.id=r})}buildOrUpdateScales(){const t=this.options,n=t.scales,i=this.scales,r=Object.keys(i).reduce((a,l)=>(a[l]=!1,a),{});let o=[];n&&(o=o.concat(Object.keys(n).map(a=>{const l=n[a],s=Hp(a,l),g=s==="r",c=s==="x";return{options:l,dposition:g?"chartArea":c?"bottom":"left",dtype:g?"radialLinear":c?"category":"linear"}}))),kt(o,a=>{const l=a.options,s=l.id,g=Hp(s,l),c=nt(l.type,a.dtype);(l.position===void 0||YS(l.position,g)!==YS(a.dposition))&&(l.position=a.dposition),r[s]=!0;let u=null;if(s in i&&i[s].type===c)u=i[s];else{const I=xr.getScale(c);u=new I({id:s,type:c,ctx:this.ctx,chart:this}),i[u.id]=u}u.init(l,t)}),kt(r,(a,l)=>{a||delete i[l]}),kt(i,a=>{Pn.configure(this,a,a.options),Pn.addBox(this,a)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,i=t.length;if(t.sort((r,o)=>r.index-o.index),i>n){for(let r=n;r<i;++r)this._destroyDatasetMeta(r);t.splice(n,i-n)}this._sortedMetasets=t.slice(0).sort(NS("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((i,r)=>{n.filter(o=>o===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=n.length;i<r;i++){const o=n[i];let a=this.getDatasetMeta(i);const l=o.type||this.config.type;if(a.type&&a.type!==l&&(this._destroyDatasetMeta(i),a=this.getDatasetMeta(i)),a.type=l,a.indexAxis=o.indexAxis||Np(l,this.options),a.order=o.order||0,a.index=i,a.label=""+o.label,a.visible=this.isDatasetVisible(i),a.controller)a.controller.updateIndex(i),a.controller.linkScales();else{const s=xr.getController(l),{datasetElementType:g,dataElementType:c}=tn.datasets[l];Object.assign(s,{dataElementType:xr.getElement(c),datasetElementType:g&&xr.getElement(g)}),a.controller=new s(this,i),t.push(a.controller)}}return this._updateMetasets(),t}_resetElements(){kt(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const i=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let g=0,c=this.data.datasets.length;g<c;g++){const{controller:u}=this.getDatasetMeta(g),I=!r&&o.indexOf(u)===-1;u.buildOrUpdateElements(I),a=Math.max(+u.getMaxOverflow(),a)}a=this._minPadding=i.layout.autoPadding?a:0,this._updateLayout(a),r||kt(o,g=>{g.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(NS("z","_idx"));const{_active:l,_lastEvent:s}=this;s?this._eventHandler(s,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){kt(this.scales,t=>{Pn.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),i=new Set(t.events);(!PG(n,i)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:o}of n){const a=i==="_removeElements"?-o:o;NL(t,r,a)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,i=o=>new Set(t.filter(a=>a[0]===o).map((a,l)=>l+","+a.splice(1).join(","))),r=i(0);for(let o=1;o<n;o++)if(!PG(r,i(o)))return;return Array.from(r).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Pn.update(this,this.width,this.height,t);const n=this.chartArea,i=n.width<=0||n.height<=0;this._layers=[],kt(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,o)=>{r._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,i=this.data.datasets.length;n<i;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,i=this.data.datasets.length;n<i;++n)this._updateDataset(n,ua(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const i=this.getDatasetMeta(t),r={meta:i,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Lr.has(this)?this.attached&&!Lr.running(this)&&Lr.start(this):(this.draw(),HS({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,i=[];let r,o;for(r=0,o=n.length;r<o;++r){const a=n[r];(!t||a.visible)&&i.push(a)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,i=t._clip,r=!i.disabled,o=FL(t,this.chartArea),a={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(r&&Sh(n,{left:i.left===!1?0:o.left-i.left,right:i.right===!1?this.width:o.right+i.right,top:i.top===!1?0:o.top-i.top,bottom:i.bottom===!1?this.height:o.bottom+i.bottom}),t.controller.draw(),r&&Bh(n),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(t){return eo(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,i,r){const o=Jz.modes[n];return typeof o=="function"?o(this,t,i,r):[]}getDatasetMeta(t){const n=this.data.datasets[t],i=this._metasets;let r=i.filter(o=>o&&o._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=fa(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const i=this.getDatasetMeta(t);return typeof i.hidden=="boolean"?!i.hidden:!n.hidden}setDatasetVisibility(t,n){const i=this.getDatasetMeta(t);i.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,i){const r=i?"show":"hide",o=this.getDatasetMeta(t),a=o.controller._resolveAnimations(void 0,r);Uc(n)?(o.data[n].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),a.update(o,{visible:i}),this.update(l=>l.datasetIndex===t?r:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),Lr.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),rS(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete yd[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,i=(o,a)=>{n.addEventListener(this,o,a),t[o]=a},r=(o,a,l)=>{o.offsetX=a,o.offsetY=l,this._eventHandler(o)};kt(this.options.events,o=>i(o,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,i=(s,g)=>{n.addEventListener(this,s,g),t[s]=g},r=(s,g)=>{t[s]&&(n.removeEventListener(this,s,g),delete t[s])},o=(s,g)=>{this.canvas&&this.resize(s,g)};let a;const l=()=>{r("attach",l),this.attached=!0,this.resize(),i("resize",o),i("detach",a)};a=()=>{this.attached=!1,r("resize",o),this._stop(),this._resize(0,0),i("attach",l)},n.isAttached(this.canvas)?l():a()}unbindEvents(){kt(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},kt(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,i){const r=i?"set":"remove";let o,a,l,s;for(n==="dataset"&&(o=this.getDatasetMeta(t[0].datasetIndex),o.controller["_"+r+"DatasetHoverStyle"]()),l=0,s=t.length;l<s;++l){a=t[l];const g=a&&this.getDatasetMeta(a.datasetIndex).controller;g&&g[r+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],i=t.map(({datasetIndex:o,index:a})=>{const l=this.getDatasetMeta(o);if(!l)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:l.data[a],index:a}});!hC(i,n)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,n))}notifyPlugins(t,n,i){return this._plugins.notify(this,t,n,i)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,i){const r=this.options.hover,o=(s,g)=>s.filter(c=>!g.some(u=>c.datasetIndex===u.datasetIndex&&c.index===u.index)),a=o(n,t),l=i?t:o(t,n);a.length&&this.updateHoverStyle(a,r.mode,!1),l.length&&r.mode&&this.updateHoverStyle(l,r.mode,!0)}_eventHandler(t,n){const i={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},r=a=>(a.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const o=this._handleEvent(t,n,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(o||i.changed)&&this.render(),this}_handleEvent(t,n,i){const{_active:r=[],options:o}=this,a=n,l=this._getActiveElements(t,r,i,a),s=j3(t),g=HL(t,this._lastEvent,i,s);i&&(this._lastEvent=null,zt(o.onHover,[t,l,this],this),s&&zt(o.onClick,[t,l,this],this));const c=!hC(l,r);return(c||n)&&(this._active=l,this._updateHoverStyles(l,r,n)),this._lastEvent=g,c}_getActiveElements(t,n,i,r){if(t.type==="mouseout")return[];if(!i)return n;const o=this.options.hover;return this.getElementsAtEventForMode(t,o.mode,o,r)}},ye(Ro,"defaults",tn),ye(Ro,"instances",yd),ye(Ro,"overrides",al),ye(Ro,"registry",xr),ye(Ro,"version",XL),ye(Ro,"getChart",FS),Ro);function KS(){return kt(Wh.instances,e=>e._plugins.invalidate())}function KL(e,t,n){const{startAngle:i,pixelMargin:r,x:o,y:a,outerRadius:l,innerRadius:s}=t;let g=r/l;e.beginPath(),e.arc(o,a,l,i-g,n+g),s>r?(g=r/s,e.arc(o,a,s,n+g,i-g,!0)):e.arc(o,a,r,n+hn,i-hn),e.closePath(),e.clip()}function EL(e){return Xy(e,["outerStart","outerEnd","innerStart","innerEnd"])}function ML(e,t,n,i){const r=EL(e.options.borderRadius),o=(n-t)/2,a=Math.min(o,i*t/2),l=s=>{const g=(n-Math.min(o,s))*i/2;return Xn(s,0,Math.min(o,g))};return{outerStart:l(r.outerStart),outerEnd:l(r.outerEnd),innerStart:Xn(r.innerStart,0,a),innerEnd:Xn(r.innerEnd,0,a)}}function xl(e,t,n,i){return{x:n+e*Math.cos(t),y:i+e*Math.sin(t)}}function ZC(e,t,n,i,r,o){const{x:a,y:l,startAngle:s,pixelMargin:g,innerRadius:c}=t,u=Math.max(t.outerRadius+i+n-g,0),I=c>0?c+i+n+g:0;let C=0;const m=r-s;if(i){const H=c>0?c-i:0,w=u>0?u-i:0,x=(H+w)/2,J=x!==0?m*x/(x+i):m;C=(m-J)/2}const f=Math.max(.001,m*u-n/Qt)/u,b=(m-f)/2,A=s+b+C,p=r-b-C,{outerStart:y,outerEnd:Z,innerStart:G,innerEnd:v}=ML(t,I,u,p-A),B=u-y,R=u-Z,X=A+y/B,W=p-Z/R,V=I+G,Y=I+v,K=A+G/V,M=p-v/Y;if(e.beginPath(),o){const H=(X+W)/2;if(e.arc(a,l,u,X,H),e.arc(a,l,u,H,W),Z>0){const F=xl(R,W,a,l);e.arc(F.x,F.y,Z,W,p+hn)}const w=xl(Y,p,a,l);if(e.lineTo(w.x,w.y),v>0){const F=xl(Y,M,a,l);e.arc(F.x,F.y,v,p+hn,M+Math.PI)}const x=(p-v/I+(A+G/I))/2;if(e.arc(a,l,I,p-v/I,x,!0),e.arc(a,l,I,x,A+G/I,!0),G>0){const F=xl(V,K,a,l);e.arc(F.x,F.y,G,K+Math.PI,A-hn)}const J=xl(B,A,a,l);if(e.lineTo(J.x,J.y),y>0){const F=xl(B,X,a,l);e.arc(F.x,F.y,y,A-hn,X)}}else{e.moveTo(a,l);const H=Math.cos(X)*u+a,w=Math.sin(X)*u+l;e.lineTo(H,w);const x=Math.cos(W)*u+a,J=Math.sin(W)*u+l;e.lineTo(x,J)}e.closePath()}function zL(e,t,n,i,r){const{fullCircles:o,startAngle:a,circumference:l}=t;let s=t.endAngle;if(o){ZC(e,t,n,i,s,r);for(let g=0;g<o;++g)e.fill();isNaN(l)||(s=a+(l%Ut||Ut))}return ZC(e,t,n,i,s,r),e.fill(),s}function LL(e,t,n,i,r){const{fullCircles:o,startAngle:a,circumference:l,options:s}=t,{borderWidth:g,borderJoinStyle:c,borderDash:u,borderDashOffset:I}=s,C=s.borderAlign==="inner";if(!g)return;e.setLineDash(u||[]),e.lineDashOffset=I,C?(e.lineWidth=g*2,e.lineJoin=c||"round"):(e.lineWidth=g,e.lineJoin=c||"bevel");let m=t.endAngle;if(o){ZC(e,t,n,i,m,r);for(let f=0;f<o;++f)e.stroke();isNaN(l)||(m=a+(l%Ut||Ut))}C&&KL(e,t,m),o||(ZC(e,t,n,i,m,r),e.stroke())}class Og extends uo{constructor(n){super();ye(this,"circumference");ye(this,"endAngle");ye(this,"fullCircles");ye(this,"innerRadius");ye(this,"outerRadius");ye(this,"pixelMargin");ye(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,i,r){const o=this.getProps(["x","y"],r),{angle:a,distance:l}=Ow(o,{x:n,y:i}),{startAngle:s,endAngle:g,innerRadius:c,outerRadius:u,circumference:I}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),C=(this.options.spacing+this.options.borderWidth)/2,m=nt(I,g-s),f=Qc(a,s,g)&&s!==g,b=m>=Ut||f,A=qr(l,c+C,u+C);return b&&A}getCenterPoint(n){const{x:i,y:r,startAngle:o,endAngle:a,innerRadius:l,outerRadius:s}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:g,spacing:c}=this.options,u=(o+a)/2,I=(l+s+c+g)/2;return{x:i+Math.cos(u)*I,y:r+Math.sin(u)*I}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:i,circumference:r}=this,o=(i.offset||0)/4,a=(i.spacing||0)/2,l=i.circular;if(this.pixelMargin=i.borderAlign==="inner"?.33:0,this.fullCircles=r>Ut?Math.floor(r/Ut):0,r===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const s=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(s)*o,Math.sin(s)*o);const g=1-Math.sin(Math.min(Qt,r||0)),c=o*g;n.fillStyle=i.backgroundColor,n.strokeStyle=i.borderColor,zL(n,this,c,a,l),LL(n,this,c,a,l),n.restore()}}ye(Og,"id","arc"),ye(Og,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),ye(Og,"defaultRoutes",{backgroundColor:"backgroundColor"}),ye(Og,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function V1(e,t,n=t){e.lineCap=nt(n.borderCapStyle,t.borderCapStyle),e.setLineDash(nt(n.borderDash,t.borderDash)),e.lineDashOffset=nt(n.borderDashOffset,t.borderDashOffset),e.lineJoin=nt(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=nt(n.borderWidth,t.borderWidth),e.strokeStyle=nt(n.borderColor,t.borderColor)}function DL(e,t,n){e.lineTo(n.x,n.y)}function TL(e){return e.stepped?CM:e.tension||e.cubicInterpolationMode==="monotone"?hM:DL}function w1(e,t,n={}){const i=e.length,{start:r=0,end:o=i-1}=n,{start:a,end:l}=t,s=Math.max(r,a),g=Math.min(o,l),c=r<a&&o<a||r>l&&o>l;return{count:i,start:s,loop:t.loop,ilen:g<s&&!c?i+g-s:g-s}}function jL(e,t,n,i){const{points:r,options:o}=t,{count:a,start:l,loop:s,ilen:g}=w1(r,n,i),c=TL(o);let{move:u=!0,reverse:I}=i||{},C,m,f;for(C=0;C<=g;++C)m=r[(l+(I?g-C:C))%a],!m.skip&&(u?(e.moveTo(m.x,m.y),u=!1):c(e,f,m,I,o.stepped),f=m);return s&&(m=r[(l+(I?g:0))%a],c(e,f,m,I,o.stepped)),!!s}function UL(e,t,n,i){const r=t.points,{count:o,start:a,ilen:l}=w1(r,n,i),{move:s=!0,reverse:g}=i||{};let c=0,u=0,I,C,m,f,b,A;const p=Z=>(a+(g?l-Z:Z))%o,y=()=>{f!==b&&(e.lineTo(c,b),e.lineTo(c,f),e.lineTo(c,A))};for(s&&(C=r[p(0)],e.moveTo(C.x,C.y)),I=0;I<=l;++I){if(C=r[p(I)],C.skip)continue;const Z=C.x,G=C.y,v=Z|0;v===m?(G<f?f=G:G>b&&(b=G),c=(u*c+Z)/++u):(y(),e.lineTo(Z,G),m=v,u=0,f=b=G),A=G}y()}function Fp(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?UL:jL}function QL(e){return e.stepped?UM:e.tension||e.cubicInterpolationMode==="monotone"?QM:Ka}function PL(e,t,n,i){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,i)&&r.closePath()),V1(e,t.options),e.stroke(r)}function _L(e,t,n,i){const{segments:r,options:o}=t,a=Fp(t);for(const l of r)V1(e,o,l.style),e.beginPath(),a(e,t,l,{start:n,end:n+i-1})&&e.closePath(),e.stroke()}const OL=typeof Path2D=="function";function qL(e,t,n,i){OL&&!t.options.segment?PL(e,t,n,i):_L(e,t,n,i)}class To extends uo{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const r=i.spanGaps?this._loop:this._fullLoop;KM(this._points,i,t,r,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=ez(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,i=t.length;return i&&n[t[i-1].end]}interpolate(t,n){const i=this.options,r=t[n],o=this.points,a=A1(this,{property:n,start:r,end:r});if(!a.length)return;const l=[],s=QL(i);let g,c;for(g=0,c=a.length;g<c;++g){const{start:u,end:I}=a[g],C=o[u],m=o[I];if(C===m){l.push(C);continue}const f=Math.abs((r-C[n])/(m[n]-C[n])),b=s(C,m,f,i.stepped);b[n]=t[n],l.push(b)}return l.length===1?l[0]:l}pathSegment(t,n,i){return Fp(this)(t,this,n,i)}path(t,n,i){const r=this.segments,o=Fp(this);let a=this._loop;n=n||0,i=i||this.points.length-n;for(const l of r)a&=o(t,this,l,{start:n,end:n+i-1});return!!a}draw(t,n,i,r){const o=this.options||{};(this.points||[]).length&&o.borderWidth&&(t.save(),qL(t,this,i,r),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}ye(To,"id","line"),ye(To,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),ye(To,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),ye(To,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function ES(e,t,n,i){const r=e.options,{[n]:o}=e.getProps([n],i);return Math.abs(t-o)<r.radius+r.hitRadius}class Zd extends uo{constructor(n){super();ye(this,"parsed");ye(this,"skip");ye(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,i,r){const o=this.options,{x:a,y:l}=this.getProps(["x","y"],r);return Math.pow(n-a,2)+Math.pow(i-l,2)<Math.pow(o.hitRadius+o.radius,2)}inXRange(n,i){return ES(this,n,"x",i)}inYRange(n,i){return ES(this,n,"y",i)}getCenterPoint(n){const{x:i,y:r}=this.getProps(["x","y"],n);return{x:i,y:r}}size(n){n=n||this.options||{};let i=n.radius||0;i=Math.max(i,i&&n.hoverRadius||0);const r=i&&n.borderWidth||0;return(i+r)*2}draw(n,i){const r=this.options;this.skip||r.radius<.1||!eo(this,i,this.size(r)/2)||(n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.fillStyle=r.backgroundColor,Yp(n,r,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}ye(Zd,"id","point"),ye(Zd,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),ye(Zd,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function x1(e,t){const{x:n,y:i,base:r,width:o,height:a}=e.getProps(["x","y","base","width","height"],t);let l,s,g,c,u;return e.horizontal?(u=a/2,l=Math.min(n,r),s=Math.max(n,r),g=i-u,c=i+u):(u=o/2,l=n-u,s=n+u,g=Math.min(i,r),c=Math.max(i,r)),{left:l,top:g,right:s,bottom:c}}function jo(e,t,n,i){return e?0:Xn(t,n,i)}function $L(e,t,n){const i=e.options.borderWidth,r=e.borderSkipped,o=a1(i);return{t:jo(r.top,o.top,0,n),r:jo(r.right,o.right,0,t),b:jo(r.bottom,o.bottom,0,n),l:jo(r.left,o.left,0,t)}}function eD(e,t,n){const{enableBorderRadius:i}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,o=_a(r),a=Math.min(t,n),l=e.borderSkipped,s=i||ht(r);return{topLeft:jo(!s||l.top||l.left,o.topLeft,0,a),topRight:jo(!s||l.top||l.right,o.topRight,0,a),bottomLeft:jo(!s||l.bottom||l.left,o.bottomLeft,0,a),bottomRight:jo(!s||l.bottom||l.right,o.bottomRight,0,a)}}function tD(e){const t=x1(e),n=t.right-t.left,i=t.bottom-t.top,r=$L(e,n/2,i/2),o=eD(e,n/2,i/2);return{outer:{x:t.left,y:t.top,w:n,h:i,radius:o},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,o.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(r.b,r.r))}}}}function kA(e,t,n,i){const r=t===null,o=n===null,l=e&&!(r&&o)&&x1(e,i);return l&&(r||qr(t,l.left,l.right))&&(o||qr(n,l.top,l.bottom))}function nD(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function iD(e,t){e.rect(t.x,t.y,t.w,t.h)}function VA(e,t,n={}){const i=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,o=(e.x+e.w!==n.x+n.w?t:0)-i,a=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+i,y:e.y+r,w:e.w+o,h:e.h+a,radius:e.radius}}class vd extends uo{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:i,backgroundColor:r}}=this,{inner:o,outer:a}=tD(this),l=nD(a.radius)?Pc:iD;t.save(),(a.w!==o.w||a.h!==o.h)&&(t.beginPath(),l(t,VA(a,n,o)),t.clip(),l(t,VA(o,-n,a)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),l(t,VA(o,n)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,n,i){return kA(this,t,n,i)}inXRange(t,n){return kA(this,t,null,n)}inYRange(t,n){return kA(this,null,t,n)}getCenterPoint(t){const{x:n,y:i,base:r,horizontal:o}=this.getProps(["x","y","base","horizontal"],t);return{x:o?(n+r)/2:n,y:o?i:(i+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}ye(vd,"id","bar"),ye(vd,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),ye(vd,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var rD=Object.freeze({__proto__:null,ArcElement:Og,BarElement:vd,LineElement:To,PointElement:Zd});const Kp=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],MS=Kp.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function X1(e){return Kp[e%Kp.length]}function J1(e){return MS[e%MS.length]}function oD(e,t){return e.borderColor=X1(t),e.backgroundColor=J1(t),++t}function aD(e,t){return e.backgroundColor=e.data.map(()=>X1(t++)),t}function lD(e,t){return e.backgroundColor=e.data.map(()=>J1(t++)),t}function sD(e){let t=0;return(n,i)=>{const r=e.getDatasetMeta(i).controller;r instanceof Do?t=aD(n,t):r instanceof Ac?t=lD(n,t):r&&(t=oD(n,t))}}function zS(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}function gD(e){return e&&(e.borderColor||e.backgroundColor)}function cD(){return tn.borderColor!=="rgba(0,0,0,0.1)"||tn.backgroundColor!=="rgba(0,0,0,0.1)"}var uD={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,n){if(!n.enabled)return;const{data:{datasets:i},options:r}=e.config,{elements:o}=r,a=zS(i)||gD(r)||o&&zS(o)||cD();if(!n.forceOverride&&a)return;const l=sD(e);i.forEach(l)}};function ID(e,t,n,i,r){const o=r.samples||i;if(o>=n)return e.slice(t,t+n);const a=[],l=(n-2)/(o-2);let s=0;const g=t+n-1;let c=t,u,I,C,m,f;for(a[s++]=e[c],u=0;u<o-2;u++){let b=0,A=0,p;const y=Math.floor((u+1)*l)+1+t,Z=Math.min(Math.floor((u+2)*l)+1,n)+t,G=Z-y;for(p=y;p<Z;p++)b+=e[p].x,A+=e[p].y;b/=G,A/=G;const v=Math.floor(u*l)+1+t,B=Math.min(Math.floor((u+1)*l)+1,n)+t,{x:R,y:X}=e[c];for(C=m=-1,p=v;p<B;p++)m=.5*Math.abs((R-b)*(e[p].y-X)-(R-e[p].x)*(A-X)),m>C&&(C=m,I=e[p],f=p);a[s++]=I,c=f}return a[s++]=e[g],a}function dD(e,t,n,i){let r=0,o=0,a,l,s,g,c,u,I,C,m,f;const b=[],A=t+n-1,p=e[t].x,Z=e[A].x-p;for(a=t;a<t+n;++a){l=e[a],s=(l.x-p)/Z*i,g=l.y;const G=s|0;if(G===c)g<m?(m=g,u=a):g>f&&(f=g,I=a),r=(o*r+l.x)/++o;else{const v=a-1;if(!bt(u)&&!bt(I)){const B=Math.min(u,I),R=Math.max(u,I);B!==C&&B!==v&&b.push({...e[B],x:r}),R!==C&&R!==v&&b.push({...e[R],x:r})}a>0&&v!==C&&b.push(e[v]),b.push(l),c=G,o=0,m=f=g,u=I=C=a}}return b}function Y1(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function LS(e){e.data.datasets.forEach(t=>{Y1(t)})}function CD(e,t){const n=t.length;let i=0,r;const{iScale:o}=e,{min:a,max:l,minDefined:s,maxDefined:g}=o.getUserBounds();return s&&(i=Xn($r(t,o.axis,a).lo,0,n-1)),g?r=Xn($r(t,o.axis,l).hi+1,i,n)-i:r=n-i,{start:i,count:r}}var hD={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled){LS(e);return}const i=e.width;e.data.datasets.forEach((r,o)=>{const{_data:a,indexAxis:l}=r,s=e.getDatasetMeta(o),g=a||r.data;if(Pg([l,e.options.indexAxis])==="y"||!s.controller.supportsDecimation)return;const c=e.scales[s.xAxisID];if(c.type!=="linear"&&c.type!=="time"||e.options.parsing)return;let{start:u,count:I}=CD(s,g);const C=n.threshold||4*i;if(I<=C){Y1(r);return}bt(a)&&(r._data=g,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(f){this._data=f}}));let m;switch(n.algorithm){case"lttb":m=ID(g,u,I,i,n);break;case"min-max":m=dD(g,u,I,i);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}r._decimated=m})},destroy(e){LS(e)}};function mD(e,t,n){const i=e.segments,r=e.points,o=t.points,a=[];for(const l of i){let{start:s,end:g}=l;g=Ey(s,g,r);const c=Ep(n,r[s],r[g],l.loop);if(!t.segments){a.push({source:l,target:c,start:r[s],end:r[g]});continue}const u=A1(t,c);for(const I of u){const C=Ep(n,o[I.start],o[I.end],I.loop),m=m1(l,r,C);for(const f of m)a.push({source:f,target:I,start:{[n]:DS(c,C,"start",Math.max)},end:{[n]:DS(c,C,"end",Math.min)}})}}return a}function Ep(e,t,n,i){if(i)return;let r=t[e],o=n[e];return e==="angle"&&(r=Vi(r),o=Vi(o)),{property:e,start:r,end:o}}function AD(e,t){const{x:n=null,y:i=null}=e||{},r=t.points,o=[];return t.segments.forEach(({start:a,end:l})=>{l=Ey(a,l,r);const s=r[a],g=r[l];i!==null?(o.push({x:s.x,y:i}),o.push({x:g.x,y:i})):n!==null&&(o.push({x:n,y:s.y}),o.push({x:n,y:g.y}))}),o}function Ey(e,t,n){for(;t>e;t--){const i=n[t];if(!isNaN(i.x)&&!isNaN(i.y))break}return t}function DS(e,t,n,i){return e&&t?i(e[n],t[n]):e?e[n]:t?t[n]:0}function N1(e,t){let n=[],i=!1;return en(e)?(i=!0,n=e):n=AD(e,t),n.length?new To({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function TS(e){return e&&e.fill!==!1}function fD(e,t,n){let r=e[t].fill;const o=[t];let a;if(!n)return r;for(;r!==!1&&o.indexOf(r)===-1;){if(!dn(r))return r;if(a=e[r],!a)return!1;if(a.visible)return r;o.push(r),r=a.fill}return!1}function pD(e,t,n){const i=vD(e);if(ht(i))return isNaN(i.value)?!1:i;let r=parseFloat(i);return dn(r)&&Math.floor(r)===r?bD(i[0],t,r,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function bD(e,t,n,i){return(e==="-"||e==="+")&&(n=t+n),n===t||n<0||n>=i?!1:n}function yD(e,t){let n=null;return e==="start"?n=t.bottom:e==="end"?n=t.top:ht(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}function ZD(e,t,n){let i;return e==="start"?i=n:e==="end"?i=t.options.reverse?t.min:t.max:ht(e)?i=e.value:i=t.getBaseValue(),i}function vD(e){const t=e.options,n=t.fill;let i=nt(n&&n.target,n);return i===void 0&&(i=!!t.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function GD(e){const{scale:t,index:n,line:i}=e,r=[],o=i.segments,a=i.points,l=SD(t,n);l.push(N1({x:null,y:t.bottom},i));for(let s=0;s<o.length;s++){const g=o[s];for(let c=g.start;c<=g.end;c++)BD(r,a[c],l)}return new To({points:r,options:{}})}function SD(e,t){const n=[],i=e.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){const o=i[r];if(o.index===t)break;o.hidden||n.unshift(o.dataset)}return n}function BD(e,t,n){const i=[];for(let r=0;r<n.length;r++){const o=n[r],{first:a,last:l,point:s}=RD(o,t,"x");if(!(!s||a&&l)){if(a)i.unshift(s);else if(e.push(s),!l)break}}e.push(...i)}function RD(e,t,n){const i=e.interpolate(t,n);if(!i)return{};const r=i[n],o=e.segments,a=e.points;let l=!1,s=!1;for(let g=0;g<o.length;g++){const c=o[g],u=a[c.start][n],I=a[c.end][n];if(qr(r,u,I)){l=r===u,s=r===I;break}}return{first:l,last:s,point:i}}class H1{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,n,i){const{x:r,y:o,radius:a}=this;return n=n||{start:0,end:Ut},t.arc(r,o,a,n.end,n.start,!0),!i.bounds}interpolate(t){const{x:n,y:i,radius:r}=this,o=t.angle;return{x:n+Math.cos(o)*r,y:i+Math.sin(o)*r,angle:o}}}function WD(e){const{chart:t,fill:n,line:i}=e;if(dn(n))return kD(t,n);if(n==="stack")return GD(e);if(n==="shape")return!0;const r=VD(e);return r instanceof H1?r:N1(r,i)}function kD(e,t){const n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}function VD(e){return(e.scale||{}).getPointPositionForValue?xD(e):wD(e)}function wD(e){const{scale:t={},fill:n}=e,i=yD(n,t);if(dn(i)){const r=t.isHorizontal();return{x:r?i:null,y:r?null:i}}return null}function xD(e){const{scale:t,fill:n}=e,i=t.options,r=t.getLabels().length,o=i.reverse?t.max:t.min,a=ZD(n,t,o),l=[];if(i.grid.circular){const s=t.getPointPositionForValue(0,o);return new H1({x:s.x,y:s.y,radius:t.getDistanceFromCenterForValue(a)})}for(let s=0;s<r;++s)l.push(t.getPointPositionForValue(s,a));return l}function wA(e,t,n){const i=WD(t),{line:r,scale:o,axis:a}=t,l=r.options,s=l.fill,g=l.backgroundColor,{above:c=g,below:u=g}=s||{};i&&r.points.length&&(Sh(e,n),XD(e,{line:r,target:i,above:c,below:u,area:n,scale:o,axis:a}),Bh(e))}function XD(e,t){const{line:n,target:i,above:r,below:o,area:a,scale:l}=t,s=n._loop?"angle":t.axis;e.save(),s==="x"&&o!==r&&(jS(e,i,a.top),US(e,{line:n,target:i,color:r,scale:l,property:s}),e.restore(),e.save(),jS(e,i,a.bottom)),US(e,{line:n,target:i,color:o,scale:l,property:s}),e.restore()}function jS(e,t,n){const{segments:i,points:r}=t;let o=!0,a=!1;e.beginPath();for(const l of i){const{start:s,end:g}=l,c=r[s],u=r[Ey(s,g,r)];o?(e.moveTo(c.x,c.y),o=!1):(e.lineTo(c.x,n),e.lineTo(c.x,c.y)),a=!!t.pathSegment(e,l,{move:a}),a?e.closePath():e.lineTo(u.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function US(e,t){const{line:n,target:i,property:r,color:o,scale:a}=t,l=mD(n,i,r);for(const{source:s,target:g,start:c,end:u}of l){const{style:{backgroundColor:I=o}={}}=s,C=i!==!0;e.save(),e.fillStyle=I,JD(e,a,C&&Ep(r,c,u)),e.beginPath();const m=!!n.pathSegment(e,s);let f;if(C){m?e.closePath():QS(e,i,u,r);const b=!!i.pathSegment(e,g,{move:m,reverse:!0});f=m&&b,f||QS(e,i,c,r)}e.closePath(),e.fill(f?"evenodd":"nonzero"),e.restore()}}function JD(e,t,n){const{top:i,bottom:r}=t.chart.chartArea,{property:o,start:a,end:l}=n||{};o==="x"&&(e.beginPath(),e.rect(a,i,l-a,r-i),e.clip())}function QS(e,t,n,i){const r=t.interpolate(n,i);r&&e.lineTo(r.x,r.y)}var YD={id:"filler",afterDatasetsUpdate(e,t,n){const i=(e.data.datasets||[]).length,r=[];let o,a,l,s;for(a=0;a<i;++a)o=e.getDatasetMeta(a),l=o.dataset,s=null,l&&l.options&&l instanceof To&&(s={visible:e.isDatasetVisible(a),index:a,fill:pD(l,a,i),chart:e,axis:o.controller.options.indexAxis,scale:o.vScale,line:l}),o.$filler=s,r.push(s);for(a=0;a<i;++a)s=r[a],!(!s||s.fill===!1)&&(s.fill=fD(r,a,n.propagate))},beforeDraw(e,t,n){const i=n.drawTime==="beforeDraw",r=e.getSortedVisibleDatasetMetas(),o=e.chartArea;for(let a=r.length-1;a>=0;--a){const l=r[a].$filler;l&&(l.line.updateControlPoints(o,l.axis),i&&l.fill&&wA(e.ctx,l,o))}},beforeDatasetsDraw(e,t,n){if(n.drawTime!=="beforeDatasetsDraw")return;const i=e.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){const o=i[r].$filler;TS(o)&&wA(e.ctx,o,e.chartArea)}},beforeDatasetDraw(e,t,n){const i=t.meta.$filler;!TS(i)||n.drawTime!=="beforeDatasetDraw"||wA(e.ctx,i,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const PS=(e,t)=>{let{boxHeight:n=t,boxWidth:i=t}=e;return e.usePointStyle&&(n=Math.min(n,t),i=e.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(t,n)}},ND=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class _S extends uo{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,i){this.maxWidth=t,this.maxHeight=n,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=zt(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(i=>t.filter(i,this.chart.data))),t.sort&&(n=n.sort((i,r)=>t.sort(i,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const i=t.labels,r=Sn(i.font),o=r.size,a=this._computeTitleHeight(),{boxWidth:l,itemHeight:s}=PS(i,o);let g,c;n.font=r.string,this.isHorizontal()?(g=this.maxWidth,c=this._fitRows(a,o,l,s)+10):(c=this.maxHeight,g=this._fitCols(a,r,l,s)+10),this.width=Math.min(g,t.maxWidth||this.maxWidth),this.height=Math.min(c,t.maxHeight||this.maxHeight)}_fitRows(t,n,i,r){const{ctx:o,maxWidth:a,options:{labels:{padding:l}}}=this,s=this.legendHitBoxes=[],g=this.lineWidths=[0],c=r+l;let u=t;o.textAlign="left",o.textBaseline="middle";let I=-1,C=-c;return this.legendItems.forEach((m,f)=>{const b=i+n/2+o.measureText(m.text).width;(f===0||g[g.length-1]+b+2*l>a)&&(u+=c,g[g.length-(f>0?0:1)]=0,C+=c,I++),s[f]={left:0,top:C,row:I,width:b,height:r},g[g.length-1]+=b+l}),u}_fitCols(t,n,i,r){const{ctx:o,maxHeight:a,options:{labels:{padding:l}}}=this,s=this.legendHitBoxes=[],g=this.columnSizes=[],c=a-t;let u=l,I=0,C=0,m=0,f=0;return this.legendItems.forEach((b,A)=>{const{itemWidth:p,itemHeight:y}=HD(i,n,o,b,r);A>0&&C+y+2*l>c&&(u+=I+l,g.push({width:I,height:C}),m+=I+l,f++,I=C=0),s[A]={left:m,top:C,col:f,width:p,height:y},I=Math.max(I,p),C+=y+l}),u+=I,g.push({width:I,height:C}),u}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:i,labels:{padding:r},rtl:o}}=this,a=ms(o,this.left,this.width);if(this.isHorizontal()){let l=0,s=jn(i,this.left+r,this.right-this.lineWidths[l]);for(const g of n)l!==g.row&&(l=g.row,s=jn(i,this.left+r,this.right-this.lineWidths[l])),g.top+=this.top+t+r,g.left=a.leftForLtr(a.x(s),g.width),s+=g.width+r}else{let l=0,s=jn(i,this.top+t+r,this.bottom-this.columnSizes[l].height);for(const g of n)g.col!==l&&(l=g.col,s=jn(i,this.top+t+r,this.bottom-this.columnSizes[l].height)),g.top=s,g.left+=this.left+r,g.left=a.leftForLtr(a.x(g.left),g.width),s+=g.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Sh(t,this),this._draw(),Bh(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:i,ctx:r}=this,{align:o,labels:a}=t,l=tn.color,s=ms(t.rtl,this.left,this.width),g=Sn(a.font),{padding:c}=a,u=g.size,I=u/2;let C;this.drawTitle(),r.textAlign=s.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=g.string;const{boxWidth:m,boxHeight:f,itemHeight:b}=PS(a,u),A=function(v,B,R){if(isNaN(m)||m<=0||isNaN(f)||f<0)return;r.save();const X=nt(R.lineWidth,1);if(r.fillStyle=nt(R.fillStyle,l),r.lineCap=nt(R.lineCap,"butt"),r.lineDashOffset=nt(R.lineDashOffset,0),r.lineJoin=nt(R.lineJoin,"miter"),r.lineWidth=X,r.strokeStyle=nt(R.strokeStyle,l),r.setLineDash(nt(R.lineDash,[])),a.usePointStyle){const W={radius:f*Math.SQRT2/2,pointStyle:R.pointStyle,rotation:R.rotation,borderWidth:X},V=s.xPlus(v,m/2),Y=B+I;o1(r,W,V,Y,a.pointStyleWidth&&m)}else{const W=B+Math.max((u-f)/2,0),V=s.leftForLtr(v,m),Y=_a(R.borderRadius);r.beginPath(),Object.values(Y).some(K=>K!==0)?Pc(r,{x:V,y:W,w:m,h:f,radius:Y}):r.rect(V,W,m,f),r.fill(),X!==0&&r.stroke()}r.restore()},p=function(v,B,R){ll(r,R.text,v,B+b/2,g,{strikethrough:R.hidden,textAlign:s.textAlign(R.textAlign)})},y=this.isHorizontal(),Z=this._computeTitleHeight();y?C={x:jn(o,this.left+c,this.right-i[0]),y:this.top+c+Z,line:0}:C={x:this.left+c,y:jn(o,this.top+Z+c,this.bottom-n[0].height),line:0},d1(this.ctx,t.textDirection);const G=b+c;this.legendItems.forEach((v,B)=>{r.strokeStyle=v.fontColor,r.fillStyle=v.fontColor;const R=r.measureText(v.text).width,X=s.textAlign(v.textAlign||(v.textAlign=a.textAlign)),W=m+I+R;let V=C.x,Y=C.y;s.setWidth(this.width),y?B>0&&V+W+c>this.right&&(Y=C.y+=G,C.line++,V=C.x=jn(o,this.left+c,this.right-i[C.line])):B>0&&Y+G>this.bottom&&(V=C.x=V+n[C.line].width+c,C.line++,Y=C.y=jn(o,this.top+Z+c,this.bottom-n[C.line].height));const K=s.x(V);if(A(K,Y,v),V=iM(X,V+m+I,y?V+W:this.right,t.rtl),p(s.x(V),Y,v),y)C.x+=W+c;else if(typeof v.text!="string"){const M=g.lineHeight;C.y+=F1(v,M)+c}else C.y+=G}),C1(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,i=Sn(n.font),r=$n(n.padding);if(!n.display)return;const o=ms(t.rtl,this.left,this.width),a=this.ctx,l=n.position,s=i.size/2,g=r.top+s;let c,u=this.left,I=this.width;if(this.isHorizontal())I=Math.max(...this.lineWidths),c=this.top+g,u=jn(t.align,u,this.right-I);else{const m=this.columnSizes.reduce((f,b)=>Math.max(f,b.height),0);c=g+jn(t.align,this.top,this.bottom-m-t.labels.padding-this._computeTitleHeight())}const C=jn(l,u,u+I);a.textAlign=o.textAlign(wy(l)),a.textBaseline="middle",a.strokeStyle=n.color,a.fillStyle=n.color,a.font=i.string,ll(a,n.text,C,c,i)}_computeTitleHeight(){const t=this.options.title,n=Sn(t.font),i=$n(t.padding);return t.display?n.lineHeight+i.height:0}_getLegendItemAt(t,n){let i,r,o;if(qr(t,this.left,this.right)&&qr(n,this.top,this.bottom)){for(o=this.legendHitBoxes,i=0;i<o.length;++i)if(r=o[i],qr(t,r.left,r.left+r.width)&&qr(n,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(t){const n=this.options;if(!ED(t.type,n))return;const i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const r=this._hoveredItem,o=ND(r,i);r&&!o&&zt(n.onLeave,[t,r,this],this),this._hoveredItem=i,i&&!o&&zt(n.onHover,[t,i,this],this)}else i&&zt(n.onClick,[t,i,this],this)}}function HD(e,t,n,i,r){const o=FD(i,e,t,n),a=KD(r,i,t.lineHeight);return{itemWidth:o,itemHeight:a}}function FD(e,t,n,i){let r=e.text;return r&&typeof r!="string"&&(r=r.reduce((o,a)=>o.length>a.length?o:a)),t+n.size/2+i.measureText(r).width}function KD(e,t,n){let i=e;return typeof t.text!="string"&&(i=F1(t,n)),i}function F1(e,t){const n=e.text?e.text.length:0;return t*n}function ED(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var MD={id:"legend",_element:_S,start(e,t,n){const i=e.legend=new _S({ctx:e.ctx,options:n,chart:e});Pn.configure(e,i,n),Pn.addBox(e,i)},stop(e){Pn.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const i=e.legend;Pn.configure(e,i,n),i.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const i=t.datasetIndex,r=n.chart;r.isDatasetVisible(i)?(r.hide(i),t.hidden=!0):(r.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:r,color:o,useBorderRadius:a,borderRadius:l}}=e.legend.options;return e._getSortedDatasetMetas().map(s=>{const g=s.controller.getStyle(n?0:void 0),c=$n(g.borderWidth);return{text:t[s.index].label,fillStyle:g.backgroundColor,fontColor:o,hidden:!s.visible,lineCap:g.borderCapStyle,lineDash:g.borderDash,lineDashOffset:g.borderDashOffset,lineJoin:g.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:g.borderColor,pointStyle:i||g.pointStyle,rotation:g.rotation,textAlign:r||g.textAlign,borderRadius:a&&(l||g.borderRadius),datasetIndex:s.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};let My=class extends uo{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const r=en(i.text)?i.text.length:1;this._padding=$n(i.padding);const o=r*Sn(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:i,bottom:r,right:o,options:a}=this,l=a.align;let s=0,g,c,u;return this.isHorizontal()?(c=jn(l,i,o),u=n+t,g=o-i):(a.position==="left"?(c=i+t,u=jn(l,r,n),s=Qt*-.5):(c=o-t,u=jn(l,n,r),s=Qt*.5),g=r-n),{titleX:c,titleY:u,maxWidth:g,rotation:s}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const i=Sn(n.font),o=i.lineHeight/2+this._padding.top,{titleX:a,titleY:l,maxWidth:s,rotation:g}=this._drawArgs(o);ll(t,n.text,0,0,i,{color:n.color,maxWidth:s,rotation:g,textAlign:wy(n.align),textBaseline:"middle",translation:[a,l]})}};function zD(e,t){const n=new My({ctx:e.ctx,options:t,chart:e});Pn.configure(e,n,t),Pn.addBox(e,n),e.titleBlock=n}var LD={id:"title",_element:My,start(e,t,n){zD(e,n)},stop(e){const t=e.titleBlock;Pn.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const i=e.titleBlock;Pn.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const JI=new WeakMap;var DD={id:"subtitle",start(e,t,n){const i=new My({ctx:e.ctx,options:n,chart:e});Pn.configure(e,i,n),Pn.addBox(e,i),JI.set(e,i)},stop(e){Pn.removeBox(e,JI.get(e)),JI.delete(e)},beforeUpdate(e,t,n){const i=JI.get(e);Pn.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const qg={average(e){if(!e.length)return!1;let t,n,i=new Set,r=0,o=0;for(t=0,n=e.length;t<n;++t){const l=e[t].element;if(l&&l.hasValue()){const s=l.tooltipPosition();i.add(s.x),r+=s.y,++o}}return o===0||i.size===0?!1:{x:[...i].reduce((l,s)=>l+s)/i.size,y:r/o}},nearest(e,t){if(!e.length)return!1;let n=t.x,i=t.y,r=Number.POSITIVE_INFINITY,o,a,l;for(o=0,a=e.length;o<a;++o){const s=e[o].element;if(s&&s.hasValue()){const g=s.getCenterPoint(),c=Xp(t,g);c<r&&(r=c,l=s)}}if(l){const s=l.tooltipPosition();n=s.x,i=s.y}return{x:n,y:i}}};function Vr(e,t){return t&&(en(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Dr(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function TD(e,t){const{element:n,datasetIndex:i,index:r}=t,o=e.getDatasetMeta(i).controller,{label:a,value:l}=o.getLabelAndValue(r);return{chart:e,label:a,parsed:o.getParsed(r),raw:e.data.datasets[i].data[r],formattedValue:l,dataset:o.getDataset(),dataIndex:r,datasetIndex:i,element:n}}function OS(e,t){const n=e.chart.ctx,{body:i,footer:r,title:o}=e,{boxWidth:a,boxHeight:l}=t,s=Sn(t.bodyFont),g=Sn(t.titleFont),c=Sn(t.footerFont),u=o.length,I=r.length,C=i.length,m=$n(t.padding);let f=m.height,b=0,A=i.reduce((Z,G)=>Z+G.before.length+G.lines.length+G.after.length,0);if(A+=e.beforeBody.length+e.afterBody.length,u&&(f+=u*g.lineHeight+(u-1)*t.titleSpacing+t.titleMarginBottom),A){const Z=t.displayColors?Math.max(l,s.lineHeight):s.lineHeight;f+=C*Z+(A-C)*s.lineHeight+(A-1)*t.bodySpacing}I&&(f+=t.footerMarginTop+I*c.lineHeight+(I-1)*t.footerSpacing);let p=0;const y=function(Z){b=Math.max(b,n.measureText(Z).width+p)};return n.save(),n.font=g.string,kt(e.title,y),n.font=s.string,kt(e.beforeBody.concat(e.afterBody),y),p=t.displayColors?a+2+t.boxPadding:0,kt(i,Z=>{kt(Z.before,y),kt(Z.lines,y),kt(Z.after,y)}),p=0,n.font=c.string,kt(e.footer,y),n.restore(),b+=m.width,{width:b,height:f}}function jD(e,t){const{y:n,height:i}=t;return n<i/2?"top":n>e.height-i/2?"bottom":"center"}function UD(e,t,n,i){const{x:r,width:o}=i,a=n.caretSize+n.caretPadding;if(e==="left"&&r+o+a>t.width||e==="right"&&r-o-a<0)return!0}function QD(e,t,n,i){const{x:r,width:o}=n,{width:a,chartArea:{left:l,right:s}}=e;let g="center";return i==="center"?g=r<=(l+s)/2?"left":"right":r<=o/2?g="left":r>=a-o/2&&(g="right"),UD(g,e,t,n)&&(g="center"),g}function qS(e,t,n){const i=n.yAlign||t.yAlign||jD(e,n);return{xAlign:n.xAlign||t.xAlign||QD(e,t,n,i),yAlign:i}}function PD(e,t){let{x:n,width:i}=e;return t==="right"?n-=i:t==="center"&&(n-=i/2),n}function _D(e,t,n){let{y:i,height:r}=e;return t==="top"?i+=n:t==="bottom"?i-=r+n:i-=r/2,i}function $S(e,t,n,i){const{caretSize:r,caretPadding:o,cornerRadius:a}=e,{xAlign:l,yAlign:s}=n,g=r+o,{topLeft:c,topRight:u,bottomLeft:I,bottomRight:C}=_a(a);let m=PD(t,l);const f=_D(t,s,g);return s==="center"?l==="left"?m+=g:l==="right"&&(m-=g):l==="left"?m-=Math.max(c,I)+r:l==="right"&&(m+=Math.max(u,C)+r),{x:Xn(m,0,i.width-t.width),y:Xn(f,0,i.height-t.height)}}function YI(e,t,n){const i=$n(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-i.right:e.x+i.left}function eB(e){return Vr([],Dr(e))}function OD(e,t,n){return fa(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function tB(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const K1={beforeTitle:zr,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,i=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return n[t.dataIndex]}return""},afterTitle:zr,beforeBody:zr,beforeLabel:zr,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return bt(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:zr,afterBody:zr,beforeFooter:zr,footer:zr,afterFooter:zr};function ui(e,t,n,i){const r=e[t].call(n,i);return typeof r>"u"?K1[t].call(n,i):r}class Mp extends uo{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,i=this.options.setContext(this.getContext()),r=i.enabled&&n.options.animation&&i.animations,o=new f1(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=OD(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:i}=n,r=ui(i,"beforeTitle",this,t),o=ui(i,"title",this,t),a=ui(i,"afterTitle",this,t);let l=[];return l=Vr(l,Dr(r)),l=Vr(l,Dr(o)),l=Vr(l,Dr(a)),l}getBeforeBody(t,n){return eB(ui(n.callbacks,"beforeBody",this,t))}getBody(t,n){const{callbacks:i}=n,r=[];return kt(t,o=>{const a={before:[],lines:[],after:[]},l=tB(i,o);Vr(a.before,Dr(ui(l,"beforeLabel",this,o))),Vr(a.lines,ui(l,"label",this,o)),Vr(a.after,Dr(ui(l,"afterLabel",this,o))),r.push(a)}),r}getAfterBody(t,n){return eB(ui(n.callbacks,"afterBody",this,t))}getFooter(t,n){const{callbacks:i}=n,r=ui(i,"beforeFooter",this,t),o=ui(i,"footer",this,t),a=ui(i,"afterFooter",this,t);let l=[];return l=Vr(l,Dr(r)),l=Vr(l,Dr(o)),l=Vr(l,Dr(a)),l}_createItems(t){const n=this._active,i=this.chart.data,r=[],o=[],a=[];let l=[],s,g;for(s=0,g=n.length;s<g;++s)l.push(TD(this.chart,n[s]));return t.filter&&(l=l.filter((c,u,I)=>t.filter(c,u,I,i))),t.itemSort&&(l=l.sort((c,u)=>t.itemSort(c,u,i))),kt(l,c=>{const u=tB(t.callbacks,c);r.push(ui(u,"labelColor",this,c)),o.push(ui(u,"labelPointStyle",this,c)),a.push(ui(u,"labelTextColor",this,c))}),this.labelColors=r,this.labelPointStyles=o,this.labelTextColors=a,this.dataPoints=l,l}update(t,n){const i=this.options.setContext(this.getContext()),r=this._active;let o,a=[];if(!r.length)this.opacity!==0&&(o={opacity:0});else{const l=qg[i.position].call(this,r,this._eventPosition);a=this._createItems(i),this.title=this.getTitle(a,i),this.beforeBody=this.getBeforeBody(a,i),this.body=this.getBody(a,i),this.afterBody=this.getAfterBody(a,i),this.footer=this.getFooter(a,i);const s=this._size=OS(this,i),g=Object.assign({},l,s),c=qS(this.chart,i,g),u=$S(i,g,c,this.chart);this.xAlign=c.xAlign,this.yAlign=c.yAlign,o={opacity:1,x:u.x,y:u.y,width:s.width,height:s.height,caretX:l.x,caretY:l.y}}this._tooltipItems=a,this.$context=void 0,o&&this._resolveAnimations().update(this,o),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,i,r){const o=this.getCaretPosition(t,i,r);n.lineTo(o.x1,o.y1),n.lineTo(o.x2,o.y2),n.lineTo(o.x3,o.y3)}getCaretPosition(t,n,i){const{xAlign:r,yAlign:o}=this,{caretSize:a,cornerRadius:l}=i,{topLeft:s,topRight:g,bottomLeft:c,bottomRight:u}=_a(l),{x:I,y:C}=t,{width:m,height:f}=n;let b,A,p,y,Z,G;return o==="center"?(Z=C+f/2,r==="left"?(b=I,A=b-a,y=Z+a,G=Z-a):(b=I+m,A=b+a,y=Z-a,G=Z+a),p=b):(r==="left"?A=I+Math.max(s,c)+a:r==="right"?A=I+m-Math.max(g,u)-a:A=this.caretX,o==="top"?(y=C,Z=y-a,b=A-a,p=A+a):(y=C+f,Z=y+a,b=A+a,p=A-a),G=y),{x1:b,x2:A,x3:p,y1:y,y2:Z,y3:G}}drawTitle(t,n,i){const r=this.title,o=r.length;let a,l,s;if(o){const g=ms(i.rtl,this.x,this.width);for(t.x=YI(this,i.titleAlign,i),n.textAlign=g.textAlign(i.titleAlign),n.textBaseline="middle",a=Sn(i.titleFont),l=i.titleSpacing,n.fillStyle=i.titleColor,n.font=a.string,s=0;s<o;++s)n.fillText(r[s],g.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+l,s+1===o&&(t.y+=i.titleMarginBottom-l)}}_drawColorBox(t,n,i,r,o){const a=this.labelColors[i],l=this.labelPointStyles[i],{boxHeight:s,boxWidth:g}=o,c=Sn(o.bodyFont),u=YI(this,"left",o),I=r.x(u),C=s<c.lineHeight?(c.lineHeight-s)/2:0,m=n.y+C;if(o.usePointStyle){const f={radius:Math.min(g,s)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},b=r.leftForLtr(I,g)+g/2,A=m+s/2;t.strokeStyle=o.multiKeyBackground,t.fillStyle=o.multiKeyBackground,Yp(t,f,b,A),t.strokeStyle=a.borderColor,t.fillStyle=a.backgroundColor,Yp(t,f,b,A)}else{t.lineWidth=ht(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,t.strokeStyle=a.borderColor,t.setLineDash(a.borderDash||[]),t.lineDashOffset=a.borderDashOffset||0;const f=r.leftForLtr(I,g),b=r.leftForLtr(r.xPlus(I,1),g-2),A=_a(a.borderRadius);Object.values(A).some(p=>p!==0)?(t.beginPath(),t.fillStyle=o.multiKeyBackground,Pc(t,{x:f,y:m,w:g,h:s,radius:A}),t.fill(),t.stroke(),t.fillStyle=a.backgroundColor,t.beginPath(),Pc(t,{x:b,y:m+1,w:g-2,h:s-2,radius:A}),t.fill()):(t.fillStyle=o.multiKeyBackground,t.fillRect(f,m,g,s),t.strokeRect(f,m,g,s),t.fillStyle=a.backgroundColor,t.fillRect(b,m+1,g-2,s-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,n,i){const{body:r}=this,{bodySpacing:o,bodyAlign:a,displayColors:l,boxHeight:s,boxWidth:g,boxPadding:c}=i,u=Sn(i.bodyFont);let I=u.lineHeight,C=0;const m=ms(i.rtl,this.x,this.width),f=function(R){n.fillText(R,m.x(t.x+C),t.y+I/2),t.y+=I+o},b=m.textAlign(a);let A,p,y,Z,G,v,B;for(n.textAlign=a,n.textBaseline="middle",n.font=u.string,t.x=YI(this,b,i),n.fillStyle=i.bodyColor,kt(this.beforeBody,f),C=l&&b!=="right"?a==="center"?g/2+c:g+2+c:0,Z=0,v=r.length;Z<v;++Z){for(A=r[Z],p=this.labelTextColors[Z],n.fillStyle=p,kt(A.before,f),y=A.lines,l&&y.length&&(this._drawColorBox(n,t,Z,m,i),I=Math.max(u.lineHeight,s)),G=0,B=y.length;G<B;++G)f(y[G]),I=u.lineHeight;kt(A.after,f)}C=0,I=u.lineHeight,kt(this.afterBody,f),t.y-=o}drawFooter(t,n,i){const r=this.footer,o=r.length;let a,l;if(o){const s=ms(i.rtl,this.x,this.width);for(t.x=YI(this,i.footerAlign,i),t.y+=i.footerMarginTop,n.textAlign=s.textAlign(i.footerAlign),n.textBaseline="middle",a=Sn(i.footerFont),n.fillStyle=i.footerColor,n.font=a.string,l=0;l<o;++l)n.fillText(r[l],s.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+i.footerSpacing}}drawBackground(t,n,i,r){const{xAlign:o,yAlign:a}=this,{x:l,y:s}=t,{width:g,height:c}=i,{topLeft:u,topRight:I,bottomLeft:C,bottomRight:m}=_a(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(l+u,s),a==="top"&&this.drawCaret(t,n,i,r),n.lineTo(l+g-I,s),n.quadraticCurveTo(l+g,s,l+g,s+I),a==="center"&&o==="right"&&this.drawCaret(t,n,i,r),n.lineTo(l+g,s+c-m),n.quadraticCurveTo(l+g,s+c,l+g-m,s+c),a==="bottom"&&this.drawCaret(t,n,i,r),n.lineTo(l+C,s+c),n.quadraticCurveTo(l,s+c,l,s+c-C),a==="center"&&o==="left"&&this.drawCaret(t,n,i,r),n.lineTo(l,s+u),n.quadraticCurveTo(l,s,l+u,s),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,i=this.$animations,r=i&&i.x,o=i&&i.y;if(r||o){const a=qg[t.position].call(this,this._active,this._eventPosition);if(!a)return;const l=this._size=OS(this,t),s=Object.assign({},a,this._size),g=qS(n,t,s),c=$S(t,s,g,n);(r._to!==c.x||o._to!==c.y)&&(this.xAlign=g.xAlign,this.yAlign=g.yAlign,this.width=l.width,this.height=l.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,c))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},o={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const a=$n(n.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&l&&(t.save(),t.globalAlpha=i,this.drawBackground(o,t,r,n),d1(t,n.textDirection),o.y+=a.top,this.drawTitle(o,t,n),this.drawBody(o,t,n),this.drawFooter(o,t,n),C1(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const i=this._active,r=t.map(({datasetIndex:l,index:s})=>{const g=this.chart.getDatasetMeta(l);if(!g)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:g.data[s],index:s}}),o=!hC(i,r),a=this._positionChanged(r,n);(o||a)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,i=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,o=this._active||[],a=this._getActiveElements(t,o,n,i),l=this._positionChanged(a,t),s=n||!hC(a,o)||l;return s&&(this._active=a,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),s}_getActiveElements(t,n,i,r){const o=this.options;if(t.type==="mouseout")return[];if(!r)return n.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const a=this.chart.getElementsAtEventForMode(t,o.mode,o,i);return o.reverse&&a.reverse(),a}_positionChanged(t,n){const{caretX:i,caretY:r,options:o}=this,a=qg[o.position].call(this,t,n);return a!==!1&&(i!==a.x||r!==a.y)}}ye(Mp,"positioners",qg);var qD={id:"tooltip",_element:Mp,positioners:qg,afterInit(e,t,n){n&&(e.tooltip=new Mp({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:K1},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},$D=Object.freeze({__proto__:null,Colors:uD,Decimation:hD,Filler:YD,Legend:MD,SubTitle:DD,Title:LD,Tooltip:qD});const eT=(e,t,n,i)=>(typeof t=="string"?(n=e.push(t)-1,i.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function tT(e,t,n,i){const r=e.indexOf(t);if(r===-1)return eT(e,t,n,i);const o=e.lastIndexOf(t);return r!==o?n:r}const nT=(e,t)=>e===null?null:Xn(Math.round(e),0,t);function nB(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class zp extends hl{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const i=this.getLabels();for(const{index:r,label:o}of n)i[r]===o&&i.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(bt(t))return null;const i=this.getLabels();return n=isFinite(n)&&i[n]===t?n:tT(i,t,nt(n,t),this._addedLabels),nT(n,i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:i,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(i=0),n||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){const t=this.min,n=this.max,i=this.options.offset,r=[];let o=this.getLabels();o=t===0&&n===o.length-1?o:o.slice(t,n+1),this._valueRange=Math.max(o.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let a=t;a<=n;a++)r.push({value:a});return r}getLabelForValue(t){return nB.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}ye(zp,"id","category"),ye(zp,"defaults",{ticks:{callback:nB}});function iT(e,t){const n=[],{bounds:r,step:o,min:a,max:l,precision:s,count:g,maxTicks:c,maxDigits:u,includeBounds:I}=e,C=o||1,m=c-1,{min:f,max:b}=t,A=!bt(a),p=!bt(l),y=!bt(g),Z=(b-f)/(u+1);let G=OG((b-f)/m/C)*C,v,B,R,X;if(G<1e-14&&!A&&!p)return[{value:f},{value:b}];X=Math.ceil(b/G)-Math.floor(f/G),X>m&&(G=OG(X*G/m/C)*C),bt(s)||(v=Math.pow(10,s),G=Math.ceil(G*v)/v),r==="ticks"?(B=Math.floor(f/G)*G,R=Math.ceil(b/G)*G):(B=f,R=b),A&&p&&o&&_3((l-a)/o,G/1e3)?(X=Math.round(Math.min((l-a)/G,c)),G=(l-a)/X,B=a,R=l):y?(B=A?a:B,R=p?l:R,X=g-1,G=(R-B)/X):(X=(R-B)/G,Cc(X,Math.round(X),G/1e3)?X=Math.round(X):X=Math.ceil(X));const W=Math.max(qG(G),qG(B));v=Math.pow(10,bt(s)?W:s),B=Math.round(B*v)/v,R=Math.round(R*v)/v;let V=0;for(A&&(I&&B!==a?(n.push({value:a}),B<a&&V++,Cc(Math.round((B+V*G)*v)/v,a,iB(a,Z,e))&&V++):B<a&&V++);V<X;++V){const Y=Math.round((B+V*G)*v)/v;if(p&&Y>l)break;n.push({value:Y})}return p&&I&&R!==l?n.length&&Cc(n[n.length-1].value,l,iB(l,Z,e))?n[n.length-1].value=l:n.push({value:l}):(!p||R===l)&&n.push({value:R}),n}function iB(e,t,{horizontal:n,minRotation:i}){const r=ur(i),o=(n?Math.sin(r):Math.cos(r))||.001,a=.75*t*(""+e).length;return Math.min(t/o,a)}class vC extends hl{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return bt(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:i}=this.getUserBounds();let{min:r,max:o}=this;const a=s=>r=n?r:s,l=s=>o=i?o:s;if(t){const s=Fr(r),g=Fr(o);s<0&&g<0?l(0):s>0&&g>0&&a(0)}if(r===o){let s=o===0?1:Math.abs(o*.05);l(o+s),t||a(r-s)}this.min=r,this.max=o}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:i}=t,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},o=this._range||this,a=iT(r,o);return t.bounds==="ticks"&&_w(a,this,"value"),t.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const t=this.ticks;let n=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const r=(i-n)/Math.max(t.length-1,1)/2;n-=r,i+=r}this._startValue=n,this._endValue=i,this._valueRange=i-n}getLabelForValue(t){return xu(t,this.chart.options.locale,this.options.ticks.format)}}class Lp extends vC{determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=dn(t)?t:0,this.max=dn(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,i=ur(this.options.ticks.minRotation),r=(t?Math.sin(i):Math.cos(i))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,o.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}ye(Lp,"id","linear"),ye(Lp,"defaults",{ticks:{callback:Gh.formatters.numeric}});const Oc=e=>Math.floor(Lo(e)),wa=(e,t)=>Math.pow(10,Oc(e)+t);function rB(e){return e/Math.pow(10,Oc(e))===1}function oB(e,t,n){const i=Math.pow(10,n),r=Math.floor(e/i);return Math.ceil(t/i)-r}function rT(e,t){const n=t-e;let i=Oc(n);for(;oB(e,t,i)>10;)i++;for(;oB(e,t,i)<10;)i--;return Math.min(i,Oc(e))}function oT(e,{min:t,max:n}){t=Wi(e.min,t);const i=[],r=Oc(t);let o=rT(t,n),a=o<0?Math.pow(10,Math.abs(o)):1;const l=Math.pow(10,o),s=r>o?Math.pow(10,r):0,g=Math.round((t-s)*a)/a,c=Math.floor((t-s)/l/10)*l*10;let u=Math.floor((g-c)/Math.pow(10,o)),I=Wi(e.min,Math.round((s+c+u*Math.pow(10,o))*a)/a);for(;I<n;)i.push({value:I,major:rB(I),significand:u}),u>=10?u=u<15?15:20:u++,u>=20&&(o++,u=2,a=o>=0?1:a),I=Math.round((s+c+u*Math.pow(10,o))*a)/a;const C=Wi(e.max,I);return i.push({value:C,major:rB(C),significand:u}),i}class Dp extends hl{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,n){const i=vC.prototype.parse.apply(this,[t,n]);if(i===0){this._zero=!0;return}return dn(i)&&i>0?i:null}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=dn(t)?Math.max(0,t):null,this.max=dn(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!dn(this._userMin)&&(this.min=t===wa(this.min,0)?wa(this.min,-1):wa(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let i=this.min,r=this.max;const o=l=>i=t?i:l,a=l=>r=n?r:l;i===r&&(i<=0?(o(1),a(10)):(o(wa(i,-1)),a(wa(r,1)))),i<=0&&o(wa(r,-1)),r<=0&&a(wa(i,1)),this.min=i,this.max=r}buildTicks(){const t=this.options,n={min:this._userMin,max:this._userMax},i=oT(n,this);return t.bounds==="ticks"&&_w(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(t){return t===void 0?"0":xu(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=Lo(t),this._valueRange=Lo(this.max)-Lo(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(Lo(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const n=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+n*this._valueRange)}}ye(Dp,"id","logarithmic"),ye(Dp,"defaults",{ticks:{callback:Gh.formatters.logarithmic,major:{enabled:!0}}});function Tp(e){const t=e.ticks;if(t.display&&e.display){const n=$n(t.backdropPadding);return nt(t.font&&t.font.size,tn.font.size)+n.height}return 0}function aT(e,t,n){return n=en(n)?n:[n],{w:dM(e,t.string,n),h:n.length*t.lineHeight}}function aB(e,t,n,i,r){return e===i||e===r?{start:t-n/2,end:t+n/2}:e<i||e>r?{start:t-n,end:t}:{start:t,end:t+n}}function lT(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),i=[],r=[],o=e._pointLabels.length,a=e.options.pointLabels,l=a.centerPointLabels?Qt/o:0;for(let s=0;s<o;s++){const g=a.setContext(e.getPointLabelContext(s));r[s]=g.padding;const c=e.getPointPosition(s,e.drawingArea+r[s],l),u=Sn(g.font),I=aT(e.ctx,u,e._pointLabels[s]);i[s]=I;const C=Vi(e.getIndexAngle(s)+l),m=Math.round(ky(C)),f=aB(m,c.x,I.w,0,180),b=aB(m,c.y,I.h,90,270);sT(n,t,C,f,b)}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=uT(e,i,r)}function sT(e,t,n,i,r){const o=Math.abs(Math.sin(n)),a=Math.abs(Math.cos(n));let l=0,s=0;i.start<t.l?(l=(t.l-i.start)/o,e.l=Math.min(e.l,t.l-l)):i.end>t.r&&(l=(i.end-t.r)/o,e.r=Math.max(e.r,t.r+l)),r.start<t.t?(s=(t.t-r.start)/a,e.t=Math.min(e.t,t.t-s)):r.end>t.b&&(s=(r.end-t.b)/a,e.b=Math.max(e.b,t.b+s))}function gT(e,t,n){const i=e.drawingArea,{extra:r,additionalAngle:o,padding:a,size:l}=n,s=e.getPointPosition(t,i+r+a,o),g=Math.round(ky(Vi(s.angle+hn))),c=CT(s.y,l.h,g),u=IT(g),I=dT(s.x,l.w,u);return{visible:!0,x:s.x,y:c,textAlign:u,left:I,top:c,right:I+l.w,bottom:c+l.h}}function cT(e,t){if(!t)return!0;const{left:n,top:i,right:r,bottom:o}=e;return!(eo({x:n,y:i},t)||eo({x:n,y:o},t)||eo({x:r,y:i},t)||eo({x:r,y:o},t))}function uT(e,t,n){const i=[],r=e._pointLabels.length,o=e.options,{centerPointLabels:a,display:l}=o.pointLabels,s={extra:Tp(o)/2,additionalAngle:a?Qt/r:0};let g;for(let c=0;c<r;c++){s.padding=n[c],s.size=t[c];const u=gT(e,c,s);i.push(u),l==="auto"&&(u.visible=cT(u,g),u.visible&&(g=u))}return i}function IT(e){return e===0||e===180?"center":e<180?"left":"right"}function dT(e,t,n){return n==="right"?e-=t:n==="center"&&(e-=t/2),e}function CT(e,t,n){return n===90||n===270?e-=t/2:(n>270||n<90)&&(e-=t),e}function hT(e,t,n){const{left:i,top:r,right:o,bottom:a}=n,{backdropColor:l}=t;if(!bt(l)){const s=_a(t.borderRadius),g=$n(t.backdropPadding);e.fillStyle=l;const c=i-g.left,u=r-g.top,I=o-i+g.width,C=a-r+g.height;Object.values(s).some(m=>m!==0)?(e.beginPath(),Pc(e,{x:c,y:u,w:I,h:C,radius:s}),e.fill()):e.fillRect(c,u,I,C)}}function mT(e,t){const{ctx:n,options:{pointLabels:i}}=e;for(let r=t-1;r>=0;r--){const o=e._pointLabelItems[r];if(!o.visible)continue;const a=i.setContext(e.getPointLabelContext(r));hT(n,a,o);const l=Sn(a.font),{x:s,y:g,textAlign:c}=o;ll(n,e._pointLabels[r],s,g+l.lineHeight/2,l,{color:a.color,textAlign:c,textBaseline:"middle"})}}function E1(e,t,n,i){const{ctx:r}=e;if(n)r.arc(e.xCenter,e.yCenter,t,0,Ut);else{let o=e.getPointPosition(0,t);r.moveTo(o.x,o.y);for(let a=1;a<i;a++)o=e.getPointPosition(a,t),r.lineTo(o.x,o.y)}}function AT(e,t,n,i,r){const o=e.ctx,a=t.circular,{color:l,lineWidth:s}=t;!a&&!i||!l||!s||n<0||(o.save(),o.strokeStyle=l,o.lineWidth=s,o.setLineDash(r.dash||[]),o.lineDashOffset=r.dashOffset,o.beginPath(),E1(e,n,a,i),o.closePath(),o.stroke(),o.restore())}function fT(e,t,n){return fa(e,{label:n,index:t,type:"pointLabel"})}class $g extends vC{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=$n(Tp(this.options)/2),n=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+n/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(n,i)/2)}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!1);this.min=dn(t)&&!isNaN(t)?t:0,this.max=dn(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Tp(this.options))}generateTickLabels(t){vC.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((n,i)=>{const r=zt(this.options.pointLabels.callback,[n,i],this);return r||r===0?r:""}).filter((n,i)=>this.chart.getDataVisibility(i))}fit(){const t=this.options;t.display&&t.pointLabels.display?lT(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,n,i,r){this.xCenter+=Math.floor((t-n)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,n,i,r))}getIndexAngle(t){const n=Ut/(this._pointLabels.length||1),i=this.options.startAngle||0;return Vi(t*n+ur(i))}getDistanceFromCenterForValue(t){if(bt(t))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*n:(t-this.min)*n}getValueForDistanceFromCenter(t){if(bt(t))return NaN;const n=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(t){const n=this._pointLabels||[];if(t>=0&&t<n.length){const i=n[t];return fT(this.getContext(),t,i)}}getPointPosition(t,n,i=0){const r=this.getIndexAngle(t)-hn+i;return{x:Math.cos(r)*n+this.xCenter,y:Math.sin(r)*n+this.yCenter,angle:r}}getPointPositionForValue(t,n){return this.getPointPosition(t,this.getDistanceFromCenterForValue(n))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:n,top:i,right:r,bottom:o}=this._pointLabelItems[t];return{left:n,top:i,right:r,bottom:o}}drawBackground(){const{backgroundColor:t,grid:{circular:n}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),E1(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,n=this.options,{angleLines:i,grid:r,border:o}=n,a=this._pointLabels.length;let l,s,g;if(n.pointLabels.display&&mT(this,a),r.display&&this.ticks.forEach((c,u)=>{if(u!==0||u===0&&this.min<0){s=this.getDistanceFromCenterForValue(c.value);const I=this.getContext(u),C=r.setContext(I),m=o.setContext(I);AT(this,C,s,a,m)}}),i.display){for(t.save(),l=a-1;l>=0;l--){const c=i.setContext(this.getPointLabelContext(l)),{color:u,lineWidth:I}=c;!I||!u||(t.lineWidth=I,t.strokeStyle=u,t.setLineDash(c.borderDash),t.lineDashOffset=c.borderDashOffset,s=this.getDistanceFromCenterForValue(n.reverse?this.min:this.max),g=this.getPointPosition(l,s),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(g.x,g.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,n=this.options,i=n.ticks;if(!i.display)return;const r=this.getIndexAngle(0);let o,a;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((l,s)=>{if(s===0&&this.min>=0&&!n.reverse)return;const g=i.setContext(this.getContext(s)),c=Sn(g.font);if(o=this.getDistanceFromCenterForValue(this.ticks[s].value),g.showLabelBackdrop){t.font=c.string,a=t.measureText(l.label).width,t.fillStyle=g.backdropColor;const u=$n(g.backdropPadding);t.fillRect(-a/2-u.left,-o-c.size/2-u.top,a+u.width,c.size+u.height)}ll(t,l.label,0,-o,c,{color:g.color,strokeColor:g.textStrokeColor,strokeWidth:g.textStrokeWidth})}),t.restore()}drawTitle(){}}ye($g,"id","radialLinear"),ye($g,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Gh.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),ye($g,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),ye($g,"descriptors",{angleLines:{_fallback:"grid"}});const kh={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},hi=Object.keys(kh);function lB(e,t){return e-t}function sB(e,t){if(bt(t))return null;const n=e._adapter,{parser:i,round:r,isoWeekday:o}=e._parseOpts;let a=t;return typeof i=="function"&&(a=i(a)),dn(a)||(a=typeof i=="string"?n.parse(a,i):n.parse(a)),a===null?null:(r&&(a=r==="week"&&(Vs(o)||o===!0)?n.startOf(a,"isoWeek",o):n.startOf(a,r)),+a)}function gB(e,t,n,i){const r=hi.length;for(let o=hi.indexOf(e);o<r-1;++o){const a=kh[hi[o]],l=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((n-t)/(l*a.size))<=i)return hi[o]}return hi[r-1]}function pT(e,t,n,i,r){for(let o=hi.length-1;o>=hi.indexOf(n);o--){const a=hi[o];if(kh[a].common&&e._adapter.diff(r,i,a)>=t-1)return a}return hi[n?hi.indexOf(n):0]}function bT(e){for(let t=hi.indexOf(e)+1,n=hi.length;t<n;++t)if(kh[hi[t]].common)return hi[t]}function cB(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:i,hi:r}=Vy(n,t),o=n[i]>=t?n[i]:n[r];e[o]=!0}}function yT(e,t,n,i){const r=e._adapter,o=+r.startOf(t[0].value,i),a=t[t.length-1].value;let l,s;for(l=o;l<=a;l=+r.add(l,1,i))s=n[l],s>=0&&(t[s].major=!0);return t}function uB(e,t,n){const i=[],r={},o=t.length;let a,l;for(a=0;a<o;++a)l=t[a],r[l]=a,i.push({value:l,major:!1});return o===0||!n?i:yT(e,i,r,n)}class qc extends hl{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){const i=t.time||(t.time={}),r=this._adapter=new kz._date(t.adapters.date);r.init(n),dc(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:sB(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,i=t.time.unit||"day";let{min:r,max:o,minDefined:a,maxDefined:l}=this.getUserBounds();function s(g){!a&&!isNaN(g.min)&&(r=Math.min(r,g.min)),!l&&!isNaN(g.max)&&(o=Math.max(o,g.max))}(!a||!l)&&(s(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&s(this.getMinMax(!1))),r=dn(r)&&!isNaN(r)?r:+n.startOf(Date.now(),i),o=dn(o)&&!isNaN(o)?o:+n.endOf(Date.now(),i)+1,this.min=Math.min(r,o-1),this.max=Math.max(r+1,o)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],i=t[t.length-1]),{min:n,max:i}}buildTicks(){const t=this.options,n=t.time,i=t.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const o=this.min,a=this.max,l=eM(r,o,a);return this._unit=n.unit||(i.autoSkip?gB(n.minUnit,this.min,this.max,this._getLabelCapacity(o)):pT(this,l.length,n.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:bT(this._unit),this.initOffsets(r),t.reverse&&l.reverse(),uB(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,i=0,r,o;this.options.offset&&t.length&&(r=this.getDecimalForValue(t[0]),t.length===1?n=1-r:n=(this.getDecimalForValue(t[1])-r)/2,o=this.getDecimalForValue(t[t.length-1]),t.length===1?i=o:i=(o-this.getDecimalForValue(t[t.length-2]))/2);const a=t.length<3?.5:.25;n=Xn(n,0,a),i=Xn(i,0,a),this._offsets={start:n,end:i,factor:1/(n+1+i)}}_generate(){const t=this._adapter,n=this.min,i=this.max,r=this.options,o=r.time,a=o.unit||gB(o.minUnit,n,i,this._getLabelCapacity(n)),l=nt(r.ticks.stepSize,1),s=a==="week"?o.isoWeekday:!1,g=Vs(s)||s===!0,c={};let u=n,I,C;if(g&&(u=+t.startOf(u,"isoWeek",s)),u=+t.startOf(u,g?"day":a),t.diff(i,n,a)>1e5*l)throw new Error(n+" and "+i+" are too far apart with stepSize of "+l+" "+a);const m=r.ticks.source==="data"&&this.getDataTimestamps();for(I=u,C=0;I<i;I=+t.add(I,l,a),C++)cB(c,I,m);return(I===i||r.bounds==="ticks"||C===1)&&cB(c,I,m),Object.keys(c).sort(lB).map(f=>+f)}getLabelForValue(t){const n=this._adapter,i=this.options.time;return i.tooltipFormat?n.format(t,i.tooltipFormat):n.format(t,i.displayFormats.datetime)}format(t,n){const r=this.options.time.displayFormats,o=this._unit,a=n||r[o];return this._adapter.format(t,a)}_tickFormatFunction(t,n,i,r){const o=this.options,a=o.ticks.callback;if(a)return zt(a,[t,n,i],this);const l=o.time.displayFormats,s=this._unit,g=this._majorUnit,c=s&&l[s],u=g&&l[g],I=i[n],C=g&&u&&I&&I.major;return this._adapter.format(t,r||(C?u:c))}generateTickLabels(t){let n,i,r;for(n=0,i=t.length;n<i;++n)r=t[n],r.label=this._tickFormatFunction(r.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+i)*n.factor)}getValueForPixel(t){const n=this._offsets,i=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,i=this.ctx.measureText(t).width,r=ur(this.isHorizontal()?n.maxRotation:n.minRotation),o=Math.cos(r),a=Math.sin(r),l=this._resolveTickFontOptions(0).size;return{w:i*o+l*a,h:i*a+l*o}}_getLabelCapacity(t){const n=this.options.time,i=n.displayFormats,r=i[n.unit]||i.millisecond,o=this._tickFormatFunction(t,0,uB(this,[t],this._majorUnit),r),a=this._getLabelSize(o),l=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return l>0?l:1}getDataTimestamps(){let t=this._cache.data||[],n,i;if(t.length)return t;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,i=r.length;n<i;++n)t=t.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,i;if(t.length)return t;const r=this.getLabels();for(n=0,i=r.length;n<i;++n)t.push(sB(this,r[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return $w(t.sort(lB))}}ye(qc,"id","time"),ye(qc,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function NI(e,t,n){let i=0,r=e.length-1,o,a,l,s;n?(t>=e[i].pos&&t<=e[r].pos&&({lo:i,hi:r}=$r(e,"pos",t)),{pos:o,time:l}=e[i],{pos:a,time:s}=e[r]):(t>=e[i].time&&t<=e[r].time&&({lo:i,hi:r}=$r(e,"time",t)),{time:o,pos:l}=e[i],{time:a,pos:s}=e[r]);const g=a-o;return g?l+(s-l)*(t-o)/g:l}class jp extends qc{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=NI(n,this.min),this._tableRange=NI(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:i}=this,r=[],o=[];let a,l,s,g,c;for(a=0,l=t.length;a<l;++a)g=t[a],g>=n&&g<=i&&r.push(g);if(r.length<2)return[{time:n,pos:0},{time:i,pos:1}];for(a=0,l=r.length;a<l;++a)c=r[a+1],s=r[a-1],g=r[a],Math.round((c+s)/2)!==g&&o.push({time:g,pos:a/(l-1)});return o}_generate(){const t=this.min,n=this.max;let i=super.getDataTimestamps();return(!i.includes(t)||!i.length)&&i.splice(0,0,t),(!i.includes(n)||i.length===1)&&i.push(n),i.sort((r,o)=>r-o)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),i=this.getLabelTimestamps();return n.length&&i.length?t=this.normalize(n.concat(i)):t=n.length?n:i,t=this._cache.all=t,t}getDecimalForValue(t){return(NI(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,i=this.getDecimalForPixel(t)/n.factor-n.end;return NI(this._table,i*this._tableRange+this._minPos,!0)}}ye(jp,"id","timeseries"),ye(jp,"defaults",qc.defaults);var ZT=Object.freeze({__proto__:null,CategoryScale:zp,LinearScale:Lp,LogarithmicScale:Dp,RadialLinearScale:$g,TimeScale:qc,TimeSeriesScale:jp});const vT=[Wz,rD,$D,ZT],M1="label";function IB(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function GT(e,t){const n=e.options;n&&t&&Object.assign(n,t)}function z1(e,t){e.labels=t}function L1(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:M1;const i=[];e.datasets=t.map(r=>{const o=e.datasets.find(a=>a[n]===r[n]);return!o||!r.data||i.includes(o)?{...r}:(i.push(o),Object.assign(o,r),o)})}function ST(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:M1;const n={labels:[],datasets:[]};return z1(n,e.labels),L1(n,e.datasets,t),n}function BT(e,t){const{height:n=150,width:i=300,redraw:r=!1,datasetIdKey:o,type:a,data:l,options:s,plugins:g=[],fallbackContent:c,updateMode:u,...I}=e,C=h.useRef(null),m=h.useRef(),f=()=>{C.current&&(m.current=new Wh(C.current,{type:a,data:ST(l,o),options:s&&{...s},plugins:g}),IB(t,m.current))},b=()=>{IB(t,null),m.current&&(m.current.destroy(),m.current=null)};return h.useEffect(()=>{!r&&m.current&&s&&GT(m.current,s)},[r,s]),h.useEffect(()=>{!r&&m.current&&z1(m.current.config.data,l.labels)},[r,l.labels]),h.useEffect(()=>{!r&&m.current&&l.datasets&&L1(m.current.config.data,l.datasets,o)},[r,l.datasets]),h.useEffect(()=>{m.current&&(r?(b(),setTimeout(f)):m.current.update(u))},[r,s,l.labels,l.datasets,u]),h.useEffect(()=>{m.current&&(b(),setTimeout(f))},[a]),h.useEffect(()=>(f(),()=>b()),[]),ce.createElement("canvas",Object.assign({ref:C,role:"img",height:n,width:i},I),c)}const RT=h.forwardRef(BT);function D1(e,t){return Wh.register(t),h.forwardRef((n,i)=>ce.createElement(RT,Object.assign({},n,{ref:i,type:e})))}const WT=D1("doughnut",Do),kT=D1("pie",bC),dB=({title:e,messages:t,type:n,onClose:i})=>d.jsx("div",{className:`notification-popup ${n}`,children:d.jsxs("div",{className:"notification-content",children:[d.jsx("button",{className:"close-button",onClick:i,children:"✕"}),d.jsx("h3",{children:e}),d.jsx("div",{className:"notification-list",children:t.length===0?d.jsx("p",{children:"No items."}):t.map((r,o)=>d.jsx("p",{children:r},o))})]})}),VT=()=>{const[e,t]=h.useState([]),[n,i]=h.useState([]),[r,o]=h.useState(!1),[a,l]=h.useState(!1);h.useEffect(()=>{(async()=>{try{const{data:{user:u},error:I}=await _.auth.getUser();if(I||!u){console.error("Error fetching user or user is not logged in:",I==null?void 0:I.message);return}const{data:C,error:m}=await _.from("profile").select("notification_day").eq("user",u.id).single();if(m||!C){console.error("Error fetching profile data:",m==null?void 0:m.message);return}const f=C.notification_day;if(!f){console.error("No notification day configured for this user.");return}const{data:b,error:A}=await _.from("inventory").select("days_left, ingredients(name)").eq("user_id",u.id).lte("days_left",f).eq("condition_id",1);if(A){console.error("Error fetching inventory items:",A.message);return}const p=[],y=[];b==null||b.forEach(Z=>{var G,v;Z.days_left<0?y.push(`Oops! Your ${(G=Z.ingredients)==null?void 0:G.name} has expired.`):p.push(`Get Cooking! Your ${(v=Z.ingredients)==null?void 0:v.name} is expiring soon.`)}),p.length>0&&(t(p),o(!0)),y.length>0&&(i(y),l(!0))}catch(u){console.error("Error fetching notification data:",u.message)}})()},[]);const s=()=>o(!1),g=()=>l(!1);return d.jsxs(d.Fragment,{children:[r&&d.jsx(dB,{title:"Soon to Expire",messages:e,type:"soon-expire",onClose:s}),a&&d.jsx(dB,{title:"Expired Items",messages:n,type:"expired",onClose:g})]})};Wh.register(...vT);const wT=()=>{const[e,t]=h.useState(null),[n,i]=h.useState(""),[r,o]=h.useState([]),[a,l]=h.useState([]),[s,g]=h.useState([]),[c,u]=h.useState({}),[I,C]=h.useState(!0),[m,f]=h.useState(!1),b=Gt();if(h.useEffect(()=>{sessionStorage.getItem("showNotification")&&(f(!0),sessionStorage.removeItem("showNotification"))},[]),h.useEffect(()=>{(async()=>{var G;const{data:y,error:Z}=await _.auth.getSession();Z?(console.error("Error fetching user session:",Z.message),b("/login")):t(((G=y==null?void 0:y.session)==null?void 0:G.user)||null)})()},[b]),h.useEffect(()=>{e&&(async()=>{if(!e)return;const{data:y,error:Z}=await _.from("profile").select("username").eq("user",e.id).single();Z?console.error("Error fetching username:",Z.message):i((y==null?void 0:y.username)||"User")})()},[e]),h.useEffect(()=>{e&&(async()=>{if(e){C(!0);try{const{data:y,error:Z}=await _.from("inventory").select("ingredient_id, ingredients(name, ingredients_category(category_name))").eq("user_id",e.id).eq("condition_id",1);if(Z)console.error("Error fetching inventory:",Z.message);else{const V=y.reduce((Y,K)=>{var H,w;const M=((w=(H=K.ingredients)==null?void 0:H.ingredients_category)==null?void 0:w.category_name)||"Unknown";return Y[M]=(Y[M]||0)+1,Y},{});o(Object.entries(V).map(([Y,K])=>({category_name:Y,total:K})))}const{data:G,error:v}=await _.from("inventory").select("ingredients(nutritional_info)").eq("user_id",e.id).eq("condition_id",1);if(v)console.error("Error fetching nutritional info:",v.message);else{const V=G.reduce((Y,K)=>{var M,H,w;try{const x=typeof((M=K.ingredients)==null?void 0:M.nutritional_info)=="string"?JSON.parse(K.ingredients.nutritional_info):(H=K.ingredients)==null?void 0:H.nutritional_info;if(x&&typeof x=="object")for(const[J,F]of Object.entries(x)){const S=parseFloat(F);isNaN(S)||(Y[J]=(Y[J]||0)+S)}}catch(x){console.error("Error parsing nutritional_info:",(w=K.ingredients)==null?void 0:w.nutritional_info,x.message)}return Y},{});u(V)}const{data:B,error:R}=await _.from("inventory").select("days_left, ingredients(name)").eq("user_id",e==null?void 0:e.id).eq("condition_id",1).gt("days_left",0).lte("days_left",5);if(R)throw R;l(B.sort((V,Y)=>Y.days_left-V.days_left));const{data:X,error:W}=await _.from("inventory").select("days_left, ingredients(name)").eq("user_id",e==null?void 0:e.id).eq("condition_id",1).lte("days_left",0);if(W)throw W;g(X.sort((V,Y)=>V.days_left-Y.days_left))}catch(y){console.error("Error fetching data:",y.message)}finally{C(!1)}}})()},[e]),I)return d.jsx("div",{children:"Loading..."});const A=r.length===0&&a.length===0&&s.length===0;return d.jsxs("div",{children:[m&&d.jsx(VT,{}),d.jsxs("div",{className:"dashboard-container",children:[d.jsx("div",{className:"dashboard-header",children:n&&d.jsxs("h1",{children:["Welcome, ",n,"!"]})}),A?d.jsx("div",{className:"empty-state",children:d.jsx("p",{children:"To get started, scan a receipt to load your inventory and explore insights about your kitchen."})}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"chart-container",children:[d.jsxs("div",{className:"chart-card",children:[d.jsx("h2",{children:"Total Ingredients in Your Inventory"}),d.jsx(kT,{data:{labels:r.map(p=>p.category_name),datasets:[{data:r.map(p=>p.total),backgroundColor:["#84e2ca","#caabd5","#fbdd94","#f58a78","#f2cec2"]}]}})]}),d.jsxs("div",{className:"chart-card",children:[d.jsx("h2",{className:"chart-title",children:"Nutritional Overview"}),d.jsx(WT,{data:{labels:Object.keys(c),datasets:[{label:"Nutritional Values",data:Object.values(c),backgroundColor:["#ffc98b","#e79796","#f5cec7","#b6dce7","#a5cf8c","#faae83"]}]},options:{plugins:{title:{display:!1}}}})]})]}),d.jsxs("div",{className:"table-container",children:[d.jsxs("div",{className:"table-card",children:[d.jsx("h2",{children:"Expiring Ingredients"}),d.jsxs("table",{className:"expiring-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Ingredient"}),d.jsx("th",{children:"Status"})]})}),d.jsx("tbody",{children:a.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:"2",children:"No ingredients are expiring soon"})}):a.map((p,y)=>d.jsxs("tr",{children:[d.jsx("td",{children:p.ingredients.name}),d.jsx("td",{children:`${Math.abs(p.days_left)} days left`})]},y))})]})]}),d.jsxs("div",{className:"table-card",children:[d.jsx("h2",{children:"Expired Ingredients"}),d.jsxs("table",{className:"expiring-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Ingredient"}),d.jsx("th",{children:"Status"})]})}),d.jsx("tbody",{children:s.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:"2",children:"No ingredients are expired"})}):s.map((p,y)=>d.jsxs("tr",{children:[d.jsx("td",{children:p.ingredients.name}),d.jsx("td",{children:`Expired ${Math.abs(p.days_left)} days ago`})]},y))})]})]})]})]})]})]})},xT="Left",XT="Right",JT="Up",YT="Down",is={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},Up={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},CB="mousemove",hB="mouseup",NT="touchend",HT="touchmove",FT="touchstart";function KT(e,t,n,i){return e>t?n>0?XT:xT:i>0?YT:JT}function mB(e,t){if(t===0)return e;const n=Math.PI/180*t,i=e[0]*Math.cos(n)+e[1]*Math.sin(n),r=e[1]*Math.cos(n)-e[0]*Math.sin(n);return[i,r]}function ET(e,t){const n=c=>{const u="touches"in c;u&&c.touches.length>1||e((I,C)=>{C.trackMouse&&!u&&(document.addEventListener(CB,i),document.addEventListener(hB,a));const{clientX:m,clientY:f}=u?c.touches[0]:c,b=mB([m,f],C.rotationAngle);return C.onTouchStartOrOnMouseDown&&C.onTouchStartOrOnMouseDown({event:c}),Object.assign(Object.assign(Object.assign({},I),Up),{initial:b.slice(),xy:b,start:c.timeStamp||0})})},i=c=>{e((u,I)=>{const C="touches"in c;if(C&&c.touches.length>1)return u;if(c.timeStamp-u.start>I.swipeDuration)return u.swiping?Object.assign(Object.assign({},u),{swiping:!1}):u;const{clientX:m,clientY:f}=C?c.touches[0]:c,[b,A]=mB([m,f],I.rotationAngle),p=b-u.xy[0],y=A-u.xy[1],Z=Math.abs(p),G=Math.abs(y),v=(c.timeStamp||0)-u.start,B=Math.sqrt(Z*Z+G*G)/(v||1),R=[p/(v||1),y/(v||1)],X=KT(Z,G,p,y),W=typeof I.delta=="number"?I.delta:I.delta[X.toLowerCase()]||is.delta;if(Z<W&&G<W&&!u.swiping)return u;const V={absX:Z,absY:G,deltaX:p,deltaY:y,dir:X,event:c,first:u.first,initial:u.initial,velocity:B,vxvy:R};V.first&&I.onSwipeStart&&I.onSwipeStart(V),I.onSwiping&&I.onSwiping(V);let Y=!1;return(I.onSwiping||I.onSwiped||I[`onSwiped${X}`])&&(Y=!0),Y&&I.preventScrollOnSwipe&&I.trackTouch&&c.cancelable&&c.preventDefault(),Object.assign(Object.assign({},u),{first:!1,eventData:V,swiping:!0})})},r=c=>{e((u,I)=>{let C;if(u.swiping&&u.eventData){if(c.timeStamp-u.start<I.swipeDuration){C=Object.assign(Object.assign({},u.eventData),{event:c}),I.onSwiped&&I.onSwiped(C);const m=I[`onSwiped${C.dir}`];m&&m(C)}}else I.onTap&&I.onTap({event:c});return I.onTouchEndOrOnMouseUp&&I.onTouchEndOrOnMouseUp({event:c}),Object.assign(Object.assign(Object.assign({},u),Up),{eventData:C})})},o=()=>{document.removeEventListener(CB,i),document.removeEventListener(hB,a)},a=c=>{o(),r(c)},l=(c,u)=>{let I=()=>{};if(c&&c.addEventListener){const C=Object.assign(Object.assign({},is.touchEventOptions),u.touchEventOptions),m=[[FT,n,C],[HT,i,Object.assign(Object.assign({},C),u.preventScrollOnSwipe?{passive:!1}:{})],[NT,r,C]];m.forEach(([f,b,A])=>c.addEventListener(f,b,A)),I=()=>m.forEach(([f,b])=>c.removeEventListener(f,b))}return I},g={ref:c=>{c!==null&&e((u,I)=>{if(u.el===c)return u;const C={};return u.el&&u.el!==c&&u.cleanUpTouch&&(u.cleanUpTouch(),C.cleanUpTouch=void 0),I.trackTouch&&c&&(C.cleanUpTouch=l(c,I)),Object.assign(Object.assign(Object.assign({},u),{el:c}),C)})}};return t.trackMouse&&(g.onMouseDown=n),[g,l]}function MT(e,t,n,i){return!t.trackTouch||!e.el?(e.cleanUpTouch&&e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:void 0})):e.cleanUpTouch?t.preventScrollOnSwipe!==n.preventScrollOnSwipe||t.touchEventOptions.passive!==n.touchEventOptions.passive?(e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:i(e.el,t)})):e:Object.assign(Object.assign({},e),{cleanUpTouch:i(e.el,t)})}function zT(e){const{trackMouse:t}=e,n=h.useRef(Object.assign({},Up)),i=h.useRef(Object.assign({},is)),r=h.useRef(Object.assign({},i.current));r.current=Object.assign({},i.current),i.current=Object.assign(Object.assign({},is),e);let o;for(o in is)i.current[o]===void 0&&(i.current[o]=is[o]);const[a,l]=h.useMemo(()=>ET(s=>n.current=s(n.current,i.current),{trackMouse:t}),[t]);return n.current=MT(n.current,i.current,r.current,l),a}const LT=async e=>{var t,n,i,r,o,a,l,s,g,c,u,I;try{const{data:C,error:m}=await _.from("inventory").select(`
        id:ingredient_id,
        daysLeft:days_left,
        quantity,
        
        freshness_status_id,
        created_at,
        condition_id,
        expiry_date_id,
        expiry_date:expiry_date (date),
        ingredients (
          name,
          icon_path,
          nutritional_info,
          storage_tips,
          pred_shelf_life,
          quantity_unitInv_id,
          ingredients_category (
            category_tag
          ),
          unitInv:unitInv (unitInv_tag)
        ),
        freshness_status (
          status_color
        ),
        condition:condition (condition)
      `).eq("user_id",e);if(m)throw m;console.log("Fetched raw data from Supabase:",C);const f="https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/",b=[];for(const A of C){const p=(n=(t=A.ingredients)==null?void 0:t.ingredients_category)==null?void 0:n.category_tag,y=((i=A.freshness_status)==null?void 0:i.status_color)||"green",Z=(r=A.ingredients)!=null&&r.icon_path?`${f}${A.ingredients.icon_path}`:"";let G=A.daysLeft;if(A.daysLeft===null&&((o=A.ingredients)!=null&&o.pred_shelf_life)&&(G=DT(A.ingredients.pred_shelf_life)),G!==null&&A.daysLeft===null)try{console.log(`Item ID: ${A.id}, Original Days Left: ${A.daysLeft}, Calculated Days Left: ${G}`);const{error:v}=await _.from("inventory").update({days_left:G}).eq("ingredient_id",A.id).eq("user_id",e);v?console.error(`Error updating item with id ${A.id}:`,v):console.log(`Successfully updated item with id ${A.id}`)}catch(v){console.error(`Exception while updating item with id ${A.id}:`,v)}b.push({id:A.id,name:((a=A.ingredients)==null?void 0:a.name)||"Unknown",daysLeft:G,imageUrl:Z,category:p,pred_shelf_life:((l=A.ingredients)==null?void 0:l.pred_shelf_life)||"No prediction available",quantity:A.quantity,quantity_unit:(g=(s=A.ingredients)==null?void 0:s.unitInv)==null?void 0:g.unitInv_tag,statusColor:y,nutritionalInfo:((c=A.ingredients)==null?void 0:c.nutritional_info)||"No information available",storageTips:((u=A.ingredients)==null?void 0:u.storage_tips)||"No tips available",condition_id:A.condition_id,created_at:A.created_at,expiryDate:(I=A.expiry_date)==null?void 0:I.date})}return b}catch(C){return console.error("Error fetching items:",C),[]}},DT=e=>{const t=/(\d+)-(\d+)\s*(months?|days?|years?)/i,n=e.match(t);if(n){const l=parseInt(n[1]),s=parseInt(n[2]),g=n[3].toLowerCase();let c;return g.includes("month")?c=(l+s)/2*30:g.includes("year")?c=(l+s)/2*365:c=(l+s)/2,Math.round(c)}const i=/(\d+)-(\d+)\s*(months?|days?|years?)/g;let r=0,o=0,a;for(;(a=i.exec(e))!==null;){const l=parseInt(a[1]),s=parseInt(a[2]),g=a[3].toLowerCase();let c;g.includes("month")?c=(l+s)/2*30:g.includes("year")?c=(l+s)/2*365:c=(l+s)/2,r+=c,o++}return o>0?Math.round(r/o):null},zy=async(e,t)=>{try{const{data:n,error:i}=await _.from("inventory").update({quantity:t,updated_at:new Date().toISOString()}).match({ingredient_id:e});if(i)throw i;console.log("Quantity and updated_at timestamp updated:",n)}catch(n){console.error("Error updating quantity:",n)}},TT=async(e,t)=>{try{console.log("Item before update:",e),console.log("Portion to deduct:",t);let n=e.quantity-t;return n=parseFloat(n.toFixed(2)),console.log("New quantity:",n),await zy(e.id,n),n}catch(n){throw console.error("Error handling portion click:",n),n}},jT=async(e,t,n)=>{const i=parseFloat(t);if(!isNaN(i)&&i>=0)try{await zy(e.id,i),n(r=>r.map(o=>o.id===e.id?{...o,quantity:i}:o))}catch(r){console.error("Error handling quantity change:",r)}},UT=async(e,t)=>{console.log("Attempting to update item condition..."),console.log("Item ID:",e),console.log("Condition ID:",t);try{const n=await _.from("inventory").update({condition_id:t}).eq("ingredient_id",e).select("*",{count:"exact"});if(n.error)throw new Error(n.error.message);return{data:n.data,error:null,count:n.count}}catch(n){return console.error("Error updating condition:",n.message),{data:null,error:n.message,count:0}}},HI={fetchItems:LT,updateQuantityInDatabase:zy,handlePortionClick:TT,handleQuantityChange:jT,updateItemCondition:UT},QT=()=>{const[e,t]=h.useState(null),n=Gt(),[i,r]=h.useState(!0),[o,a]=h.useState(""),[l,s]=h.useState(null),[g,c]=h.useState([]),[u,I]=h.useState({}),[C,m]=h.useState(null),[f,b]=h.useState(!1),[A,p]=h.useState({}),[y,Z]=h.useState(null),[G,v]=h.useState(!1);if(h.useEffect(()=>{(async()=>{var E;r(!0);const{data:F,error:S}=await _.auth.getSession();if(S)console.error("Error fetching user session:",S.message),n("/login");else{const N=((E=F==null?void 0:F.session)==null?void 0:E.user)||null;if(t(N),N){const k=await HI.fetchItems(N.id);c(k)}}r(!1)})()},[n]),h.useEffect(()=>{y&&w()},[y]),i)return d.jsx("div",{children:"Loading..."});const B=g.filter(J=>J.condition_id===1).filter(J=>J.name.toLowerCase().includes(o.toLowerCase())).sort((J,F)=>C==="days_left"?(J.daysLeft||1/0)-(F.daysLeft||1/0):C==="category"?J.category.localeCompare(F.category):0),R=()=>{b(J=>!J)},X=J=>{m(J),b(!1)},W=J=>{I(F=>({...F,[J]:!F[J]}))},V=J=>{s(F=>F===J?null:J)},Y=J=>{const F=parseFloat(A[J.id]||0);if(F>0&&F<=J.quantity){const S=J.quantity-F;M(J,S),p({...A,[J.id]:""})}else alert("Please enter a valid amount within the range!")},K=async(J,F)=>{try{const S=await HI.handlePortionClick(J,F);c(E=>E.map(N=>N.id===J.id?{...N,quantity:S}:N))}catch(S){console.error("Error handling portion click:",S)}},M=async(J,F)=>{try{await HI.handleQuantityChange(J,F,c)}catch(S){console.error("Error handling quantity change:",S)}},H=J=>{c(F=>F.filter(S=>S.id!==J))},w=async()=>{if(y&&!G){v(!0);const{id:J,action:F}=y,S=F==="discard"?3:2;try{const{data:E,error:N,count:k}=await HI.updateItemCondition(J,S);if(N){console.error("Error updating item condition:",N);return}if(k===0){console.warn("No matching rows found to update.");return}H(J)}catch(E){console.error("Error during action confirmation:",E.message)}finally{v(!1),Z(null)}}},x=(J,F)=>{Z({id:J.id,action:F})};return d.jsxs("div",{className:"inventory-container",children:[d.jsx("input",{type:"text",placeholder:"Search for items...",className:"search-bar",value:o,onChange:J=>a(J.target.value)}),d.jsxs("div",{className:"tracker-header",children:[d.jsx("img",{src:"src/assets/images/filter-icon.png",alt:"Filter Icon",className:"filter-icon",onClick:R}),d.jsx("div",{className:"tracker-title",children:"Tracker"})]}),f&&d.jsxs("div",{className:"filter-menu",children:[d.jsx("button",{onClick:()=>X("days_left"),children:"Sort by Days Left"}),d.jsx("button",{onClick:()=>X("category"),children:"Sort by Food Category"})]}),B.length===0?d.jsx("div",{className:"empty-inventory-message",children:"Oops, your inventory is empty..."}):d.jsxs("div",{className:"item-sections",children:[d.jsxs("div",{className:"expired-section",children:[d.jsx("h2",{className:"section-title",children:"Expired Food"}),d.jsx("div",{className:"item-list",children:B.filter(J=>J.daysLeft!==null&&J.daysLeft<=0).map((J,F)=>d.jsx(AB,{item:J,setItems:c,handleClick:W,expandedItems:u,setExpandedItems:I,usedAmount:A,setUsedAmount:p,handleQuantityChange:M,handlePortionClickWithState:K,handleDoneClick:Y,activeDropdown:l,toggleDropdown:V,handleSwipeAction:x},`${J.id}-${F}`))})]}),d.jsxs("div",{className:"fresh-section",children:[d.jsx("h2",{className:"section-title",children:"Fresh & Good"}),d.jsx("div",{className:"item-list",children:B.filter(J=>J.daysLeft>0||J.daysLeft===null).map((J,F)=>d.jsx(AB,{item:J,setItems:c,handleClick:W,expandedItems:u,setExpandedItems:I,usedAmount:A,setUsedAmount:p,handleQuantityChange:M,handlePortionClickWithState:K,handleDoneClick:Y,activeDropdown:l,toggleDropdown:V,handleSwipeAction:x},`${J.id}-${F}`))})]})]})]})},AB=({item:e,setItems:t,handleClick:n,expandedItems:i,setExpandedItems:r,usedAmount:o,setUsedAmount:a,handleQuantityChange:l,handlePortionClickWithState:s,handleDoneClick:g,activeDropdown:c,toggleDropdown:u,handleSwipeAction:I})=>{const[C,m]=h.useState(!1),[f,b]=h.useState(!1),A=zT({onSwipedLeft:()=>m(!0),onSwipedRight:()=>m(!1),preventDefaultTouchmoveEvent:!0,trackMouse:!0}),p=Z=>{f||(b(!0),m(!1),I(e,Z))},y=e.daysLeft!==null&&e.daysLeft<=0;return d.jsxs("div",{className:"item-container",...A,children:[d.jsx("div",{className:"swipeable-item",style:{transform:C?"translateX(-50%)":"translateX(0)"}}),d.jsxs("div",{className:"item",children:[C&&d.jsxs("div",{className:"action-buttons",children:[!y&&d.jsxs(d.Fragment,{children:[d.jsx("button",{className:"used-button",onClick:()=>p("used"),children:"Used"}),d.jsx("button",{className:"discard-button",onClick:()=>p("discard"),children:"Discard"})]}),y&&d.jsx("button",{className:"discard-button",onClick:()=>p("discard"),children:"Discard"})]}),d.jsxs("div",{className:"left-section",children:[d.jsx("div",{className:`green-dot ${e.statusColor}`}),d.jsx("div",{className:"circle-image",children:d.jsx("img",{src:e.imageUrl,alt:e.name})}),d.jsxs("div",{className:"text-section",children:[d.jsx("div",{className:"item-name",children:e.name}),d.jsx("div",{className:"item-days",children:e.expiryDate==null?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:`shelf-life ${i[e.id]?"full-text":""}`,onClick:()=>n(e.id),children:i[e.id]?e.pred_shelf_life:`${e.pred_shelf_life.slice(0,20)}`}),e.daysLeft!=null&&d.jsxs("div",{className:"days-left",children:["Predicted ",e.daysLeft,"d left"]})]}):d.jsxs("div",{className:"days-left",children:[e.daysLeft,"d left"]})})]})]}),d.jsxs("div",{className:"right-section",children:[d.jsxs("span",{className:"item-quantity",children:[e.quantity," ",e.quantity_unit]}),d.jsx("span",{className:"tag",children:e.category}),d.jsx("span",{className:"dropdown-icon",onClick:()=>u(e.id),children:"▼"})]})]}),c===e.id&&d.jsxs("div",{className:"dropdown-box",children:[d.jsxs("div",{className:"date-purchased",children:[d.jsx("img",{src:"src/assets/images/date-icon.png",alt:"Calendar Icon",className:"date-icon"}),"Date Purchased: ",new Date(e.created_at).toISOString().split("T")[0]]}),!y&&d.jsx(d.Fragment,{children:["unit","pcs","can","box"].includes(e.quantity_unit)?d.jsxs("div",{className:"unit-controls",children:[d.jsx("button",{onClick:()=>s(e,1),className:"quantity-button",children:"-"}),d.jsx("div",{className:"quantity-container",children:d.jsx("div",{className:"quantity-box",children:e.quantity})}),d.jsx("button",{onClick:()=>s(e,-1),className:"quantity-button",children:"+"})]}):d.jsxs("div",{className:"portion-section",children:[d.jsxs("div",{className:"quantity-container",children:[d.jsx("input",{type:"number",value:e.quantity===null||e.quantity===void 0?"":e.quantity,onChange:Z=>l(e,Z.target.value===""?"":parseFloat(Z.target.value)),className:"quantity-box",min:"0"}),d.jsxs("div",{className:"quantity-unit",children:["(",e.quantity_unit,")"]})]}),d.jsxs("div",{className:"used-amount-container",children:[d.jsx("label",{htmlFor:`used-amount-${e.id}`,children:"Used amount:"}),d.jsx("input",{type:"number",id:`used-amount-${e.id}`,className:"used-amount-input",value:o[e.id]||"",onChange:Z=>a({...o,[e.id]:Z.target.value})}),d.jsxs("div",{className:"quantity-unit",children:["(",e.quantity_unit,")"]}),d.jsx("img",{src:"src/assets/images/tick-icon.png",alt:"Confirm",className:"done-icon",onClick:()=>g(e)})]}),d.jsx("p",{children:"or"}),d.jsxs("div",{className:"portion-row",children:[d.jsx("p",{children:"Used portion:"}),d.jsxs("div",{className:"portion-buttons",children:[d.jsx("button",{onClick:()=>s(e,e.quantity*.2),children:"1/5"}),d.jsx("button",{onClick:()=>s(e,e.quantity*.4),children:"2/5"}),d.jsx("button",{onClick:()=>s(e,e.quantity*.6),children:"3/5"}),d.jsx("button",{onClick:()=>s(e,e.quantity*.8),children:"4/5"})]})]})]})}),d.jsxs("div",{className:"nutritional-facts",children:[d.jsxs("h4",{children:["Nutritional Facts",d.jsx("img",{src:"src/assets/images/nutrition-facts-icon.png",alt:"Nutrition Icon",className:"nutrition-icon"})]}),d.jsxs("div",{className:"nutrition-details",children:[d.jsxs("p",{children:[d.jsx("span",{children:"Fat"}),d.jsx("span",{className:"dots",children:"..............................."}),d.jsx("span",{children:e.nutritionalInfo.fat})]}),d.jsxs("p",{children:[d.jsx("span",{children:"Protein"}),d.jsx("span",{className:"dots",children:".............................."}),d.jsx("span",{children:e.nutritionalInfo.protein})]}),d.jsxs("p",{children:[d.jsx("span",{children:"Calories"}),d.jsx("span",{className:"dots",children:"........................"}),d.jsxs("span",{children:[e.nutritionalInfo.calories,"kcal"]})]}),d.jsxs("p",{children:[d.jsx("span",{children:"Carbohydrate"}),d.jsx("span",{className:"dots",children:"......................."}),d.jsx("span",{children:e.nutritionalInfo.carbohydrate})]})]})]}),d.jsxs("div",{className:"storage-tips",children:[d.jsxs("h4",{children:["Storage Tips",d.jsx("img",{src:"src/assets/images/yellow-bulb-icon.png",alt:"Bulb Icon",className:"bulb-icon"})]}),d.jsx("p",{children:e.storageTips})]})]})]})};function Qe(){return Qe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Qe.apply(null,arguments)}function gt(e){"@babel/helpers - typeof";return gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(e)}function PT(e,t){if(gt(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t||"default");if(gt(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T1(e){var t=PT(e,"string");return gt(t)=="symbol"?t:t+""}function se(e,t,n){return(t=T1(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j1(e){if(Array.isArray(e))return e}function _T(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,r,o,a,l=[],s=!0,g=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;s=!1}else for(;!(s=(i=o.call(n)).done)&&(l.push(i.value),l.length!==t);s=!0);}catch(c){g=!0,r=c}finally{try{if(!s&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(g)throw r}}return l}}function Qp(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function Ly(e,t){if(e){if(typeof e=="string")return Qp(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qp(e,t):void 0}}function U1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $(e,t){return j1(e)||_T(e,t)||Ly(e,t)||U1()}function OT(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.includes(i))continue;n[i]=e[i]}return n}function Zt(e,t){if(e==null)return{};var n,i,r=OT(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Q1={exports:{}},Nt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yn=typeof Symbol=="function"&&Symbol.for,Dy=Yn?Symbol.for("react.element"):60103,Ty=Yn?Symbol.for("react.portal"):60106,Vh=Yn?Symbol.for("react.fragment"):60107,wh=Yn?Symbol.for("react.strict_mode"):60108,xh=Yn?Symbol.for("react.profiler"):60114,Xh=Yn?Symbol.for("react.provider"):60109,Jh=Yn?Symbol.for("react.context"):60110,jy=Yn?Symbol.for("react.async_mode"):60111,Yh=Yn?Symbol.for("react.concurrent_mode"):60111,Nh=Yn?Symbol.for("react.forward_ref"):60112,Hh=Yn?Symbol.for("react.suspense"):60113,qT=Yn?Symbol.for("react.suspense_list"):60120,Fh=Yn?Symbol.for("react.memo"):60115,Kh=Yn?Symbol.for("react.lazy"):60116,$T=Yn?Symbol.for("react.block"):60121,ej=Yn?Symbol.for("react.fundamental"):60117,tj=Yn?Symbol.for("react.responder"):60118,nj=Yn?Symbol.for("react.scope"):60119;function Ki(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Dy:switch(e=e.type,e){case jy:case Yh:case Vh:case xh:case wh:case Hh:return e;default:switch(e=e&&e.$$typeof,e){case Jh:case Nh:case Kh:case Fh:case Xh:return e;default:return t}}case Ty:return t}}}function P1(e){return Ki(e)===Yh}Nt.AsyncMode=jy;Nt.ConcurrentMode=Yh;Nt.ContextConsumer=Jh;Nt.ContextProvider=Xh;Nt.Element=Dy;Nt.ForwardRef=Nh;Nt.Fragment=Vh;Nt.Lazy=Kh;Nt.Memo=Fh;Nt.Portal=Ty;Nt.Profiler=xh;Nt.StrictMode=wh;Nt.Suspense=Hh;Nt.isAsyncMode=function(e){return P1(e)||Ki(e)===jy};Nt.isConcurrentMode=P1;Nt.isContextConsumer=function(e){return Ki(e)===Jh};Nt.isContextProvider=function(e){return Ki(e)===Xh};Nt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Dy};Nt.isForwardRef=function(e){return Ki(e)===Nh};Nt.isFragment=function(e){return Ki(e)===Vh};Nt.isLazy=function(e){return Ki(e)===Kh};Nt.isMemo=function(e){return Ki(e)===Fh};Nt.isPortal=function(e){return Ki(e)===Ty};Nt.isProfiler=function(e){return Ki(e)===xh};Nt.isStrictMode=function(e){return Ki(e)===wh};Nt.isSuspense=function(e){return Ki(e)===Hh};Nt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Vh||e===Yh||e===xh||e===wh||e===Hh||e===qT||typeof e=="object"&&e!==null&&(e.$$typeof===Kh||e.$$typeof===Fh||e.$$typeof===Xh||e.$$typeof===Jh||e.$$typeof===Nh||e.$$typeof===ej||e.$$typeof===tj||e.$$typeof===nj||e.$$typeof===$T)};Nt.typeOf=Ki;/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var fB=Object.getOwnPropertySymbols,ij=Object.prototype.hasOwnProperty,rj=Object.prototype.propertyIsEnumerable;function oj(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function aj(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var i=Object.getOwnPropertyNames(t).map(function(o){return t[o]});if(i.join("")!=="0123456789")return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(o){r[o]=o}),Object.keys(Object.assign({},r)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}aj();var lj="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",sj=lj;Function.call.bind(Object.prototype.hasOwnProperty);var gj=sj;function _1(){}function O1(){}O1.resetWarningCache=_1;var cj=function(){function e(i,r,o,a,l,s){if(s!==gj){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:O1,resetWarningCache:_1};return n.PropTypes=n,n};Q1.exports=cj();var Xl=Q1.exports;function uj(e,t){var n=atob(e);return n}function Ij(e,t,n){var i=uj(e),r=i.indexOf(`
`,10)+1,o=i.substring(r)+"",a=new Blob([o],{type:"application/javascript"});return URL.createObjectURL(a)}function dj(e,t,n){var i;return function(o){return i=i||Ij(e),new Worker(i,o)}}var Cj=dj("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGdldEF1Z21lbnRlZE5hbWVzcGFjZShuKSB7CgkJaWYgKG4uX19lc01vZHVsZSkgcmV0dXJuIG47CgkJdmFyIGEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdfX2VzTW9kdWxlJywge3ZhbHVlOiB0cnVlfSk7CgkJT2JqZWN0LmtleXMobikuZm9yRWFjaChmdW5jdGlvbiAoaykgewoJCQl2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwgayk7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBrLCBkLmdldCA/IGQgOiB7CgkJCQllbnVtZXJhYmxlOiB0cnVlLAoJCQkJZ2V0OiBmdW5jdGlvbiAoKSB7CgkJCQkJcmV0dXJuIG5ba107CgkJCQl9CgkJCX0pOwoJCX0pOwoJCXJldHVybiBhOwoJfQoKCXZhciBCaW5hcnlCaXRtYXAkMSA9IHt9OwoKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBFeGNlcHRpb24kMSA9IHt9OwoKCWZ1bmN0aW9uIGZpeFByb3RvKHRhcmdldCwgcHJvdG90eXBlKSB7CgkgIHZhciBzZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZjsKCSAgc2V0UHJvdG90eXBlT2YgPyBzZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSkgOiB0YXJnZXQuX19wcm90b19fID0gcHJvdG90eXBlOwoJfQoJZnVuY3Rpb24gZml4U3RhY2sodGFyZ2V0LCBmbikgewoJICBpZiAoZm4gPT09IHZvaWQgMCkgewoJICAgIGZuID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwoJICB9CgoJICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTsKCSAgY2FwdHVyZVN0YWNrVHJhY2UgJiYgY2FwdHVyZVN0YWNrVHJhY2UodGFyZ2V0LCBmbik7Cgl9CgoJdmFyIF9fZXh0ZW5kcyRrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7CgkgICAgICBfX3Byb3RvX186IFtdCgkgICAgfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICBkLl9fcHJvdG9fXyA9IGI7CgkgICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0KCSAgICB9OwoKCSAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgfTsKCgkgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgoJICAgIGZ1bmN0aW9uIF9fKCkgewoJICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7CgkgICAgfQoKCSAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgIH07Cgl9KCk7CgoJdmFyIEN1c3RvbUVycm9yID0gZnVuY3Rpb24gKF9zdXBlcikgewoJICBfX2V4dGVuZHMkayhDdXN0b21FcnJvciwgX3N1cGVyKTsKCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKG1lc3NhZ2UpIHsKCSAgICB2YXIgX25ld1RhcmdldCA9IHRoaXMuY29uc3RydWN0b3I7CgoJICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7CgoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywgJ25hbWUnLCB7CgkgICAgICB2YWx1ZTogX25ld1RhcmdldC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmaXhQcm90byhfdGhpcywgX25ld1RhcmdldC5wcm90b3R5cGUpOwoJICAgIGZpeFN0YWNrKF90aGlzKTsKCSAgICByZXR1cm4gX3RoaXM7CgkgIH0KCgkgIHJldHVybiBDdXN0b21FcnJvcjsKCX0oRXJyb3IpOwoKCXZhciBfX3NwcmVhZEFycmF5cyA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIGFyZ3VtZW50cyQxID0gYXJndW1lbnRzOwoKCSAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7IHMgKz0gYXJndW1lbnRzJDFbaV0ubGVuZ3RoOyB9CgoJICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspIHsgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspIHsgcltrXSA9IGFbal07IH0gfQoKCSAgcmV0dXJuIHI7Cgl9OwoJZnVuY3Rpb24gY3VzdG9tRXJyb3JGYWN0b3J5KGZuLCBwYXJlbnQpIHsKCSAgaWYgKHBhcmVudCA9PT0gdm9pZCAwKSB7CgkgICAgcGFyZW50ID0gRXJyb3I7CgkgIH0KCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKCkgewoJICAgIHZhciBhcmd1bWVudHMkMSA9IGFyZ3VtZW50czsKCgkgICAgdmFyIGFyZ3MgPSBbXTsKCgkgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzJDFbX2ldOwoJICAgIH0KCgkgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEN1c3RvbUVycm9yKSkgeyByZXR1cm4gbmV3IChDdXN0b21FcnJvci5iaW5kLmFwcGx5KEN1c3RvbUVycm9yLCBfX3NwcmVhZEFycmF5cyhbdm9pZCAwXSwgYXJncykpKSgpOyB9CgkgICAgcGFyZW50LmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsKCSAgICAgIHZhbHVlOiBmbi5uYW1lIHx8IHBhcmVudC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICBmaXhTdGFjayh0aGlzLCBDdXN0b21FcnJvcik7CgkgIH0KCgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDdXN0b21FcnJvciwgewoJICAgIHByb3RvdHlwZTogewoJICAgICAgdmFsdWU6IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSwgewoJICAgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICAgIHZhbHVlOiBDdXN0b21FcnJvciwKCSAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgICAgfQoJICAgICAgfSkKCSAgICB9CgkgIH0pOwoJfQoKCXZhciBjdXN0b21FcnJvciA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCQlfX3Byb3RvX186IG51bGwsCgkJQ3VzdG9tRXJyb3I6IEN1c3RvbUVycm9yLAoJCWN1c3RvbUVycm9yRmFjdG9yeTogY3VzdG9tRXJyb3JGYWN0b3J5Cgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoY3VzdG9tRXJyb3IpOwoKCXZhciBfX2V4dGVuZHMkaiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIHRzX2N1c3RvbV9lcnJvcl8xID0gcmVxdWlyZSQkMDsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRqKEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICAvKioKCSAgICAgKiBBbGxvd3MgRXhjZXB0aW9uIHRvIGJlIGNvbnN0cnVjdGVkIGRpcmVjdGx5CgkgICAgICogd2l0aCBzb21lIG1lc3NhZ2UgYW5kIHByb3RvdHlwZSBkZWZpbml0aW9uLgoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlKSB7CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBFeGNlcHRpb24ucHJvdG90eXBlLmdldEtpbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBleCA9IHRoaXMuY29uc3RydWN0b3I7CgkgICAgICAgIHJldHVybiBleC5raW5kOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSXQncyB0eXBlZCBhcyBzdHJpbmcgc28gaXQgY2FuIGJlIGV4dGVuZGVkIGFuZCBvdmVycmlkZW4uCgkgICAgICovCgkgICAgRXhjZXB0aW9uLmtpbmQgPSAnRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRXhjZXB0aW9uOwoJfSh0c19jdXN0b21fZXJyb3JfMS5DdXN0b21FcnJvcikpOwoJRXhjZXB0aW9uJDEuZGVmYXVsdCA9IEV4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSQ5ID0gRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaShJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCkgewoJICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CgkgICAgfQoJICAgIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0lsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbjsKCX0oRXhjZXB0aW9uXzEkOS5kZWZhdWx0KSk7CglJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMS5kZWZhdWx0ID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJ5Qml0bWFwJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgQmluYXJ5Qml0bWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEJpbmFyeUJpdG1hcChiaW5hcml6ZXIpIHsKCSAgICAgICAgdGhpcy5iaW5hcml6ZXIgPSBiaW5hcml6ZXI7CgkgICAgICAgIGlmIChiaW5hcml6ZXIgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhLmRlZmF1bHQoJ0JpbmFyaXplciBtdXN0IGJlIG5vbi1udWxsLicpOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gVGhlIHdpZHRoIG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIGJpdG1hcC4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29udmVydHMgb25lIHJvdyBvZiBsdW1pbmFuY2UgZGF0YSB0byAxIGJpdCBkYXRhLiBNYXkgYWN0dWFsbHkgZG8gdGhlIGNvbnZlcnNpb24sIG9yIHJldHVybgoJICAgICAqIGNhY2hlZCBkYXRhLiBDYWxsZXJzIHNob3VsZCBhc3N1bWUgdGhpcyBtZXRob2QgaXMgZXhwZW5zaXZlIGFuZCBjYWxsIGl0IGFzIHNlbGRvbSBhcyBwb3NzaWJsZS4KCSAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMUQgYmFyY29kZXMgYW5kIG1heSBjaG9vc2UgdG8gYXBwbHkgc2hhcnBlbmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB5IFRoZSByb3cgdG8gZmV0Y2gsIHdoaWNoIG11c3QgYmUgaW4gWzAsIGJpdG1hcCBoZWlnaHQpCgkgICAgICogQHBhcmFtIHJvdyBBbiBvcHRpb25hbCBwcmVhbGxvY2F0ZWQgYXJyYXkuIElmIG51bGwgb3IgdG9vIHNtYWxsLCBpdCB3aWxsIGJlIGlnbm9yZWQuCgkgICAgICogICAgICAgICAgICBJZiB1c2VkLCB0aGUgQmluYXJpemVyIHdpbGwgY2FsbCBCaXRBcnJheS5jbGVhcigpLiBBbHdheXMgdXNlIHRoZSByZXR1cm5lZCBvYmplY3QuCgkgICAgICogQHJldHVybiBUaGUgYXJyYXkgb2YgYml0cyBmb3IgdGhpcyByb3cgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgcm93IGNhbid0IGJlIGJpbmFyaXplZAoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUuZ2V0QmxhY2tSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEJsYWNrUm93KHksIHJvdyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBhIDJEIGFycmF5IG9mIGx1bWluYW5jZSBkYXRhIHRvIDEgYml0LiBBcyBhYm92ZSwgYXNzdW1lIHRoaXMgbWV0aG9kIGlzIGV4cGVuc2l2ZQoJICAgICAqIGFuZCBkbyBub3QgY2FsbCBpdCByZXBlYXRlZGx5LiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMkQgYmFyY29kZXMgYW5kIG1heSBvcgoJICAgICAqIG1heSBub3QgYXBwbHkgc2hhcnBlbmluZy4gVGhlcmVmb3JlLCBhIHJvdyBmcm9tIHRoaXMgbWF0cml4IG1heSBub3QgYmUgaWRlbnRpY2FsIHRvIG9uZQoJICAgICAqIGZldGNoZWQgdXNpbmcgZ2V0QmxhY2tSb3coKSwgc28gZG9uJ3QgbWl4IGFuZCBtYXRjaCBiZXR3ZWVuIHRoZW0uCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIFRoZSAyRCBhcnJheSBvZiBiaXRzIGZvciB0aGUgaW1hZ2UgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgaW1hZ2UgY2FuJ3QgYmUgYmluYXJpemVkIHRvIG1ha2UgYSBtYXRyaXgKCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEJsYWNrTWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBUaGUgbWF0cml4IGlzIGNyZWF0ZWQgb24gZGVtYW5kIHRoZSBmaXJzdCB0aW1lIGl0IGlzIHJlcXVlc3RlZCwgdGhlbiBjYWNoZWQuIFRoZXJlIGFyZSB0d28KCSAgICAgICAgLy8gcmVhc29ucyBmb3IgdGhpczoKCSAgICAgICAgLy8gMS4gVGhpcyB3b3JrIHdpbGwgbmV2ZXIgYmUgZG9uZSBpZiB0aGUgY2FsbGVyIG9ubHkgaW5zdGFsbHMgMUQgUmVhZGVyIG9iamVjdHMsIG9yIGlmIGEKCSAgICAgICAgLy8gICAgMUQgUmVhZGVyIGZpbmRzIGEgYmFyY29kZSBiZWZvcmUgdGhlIDJEIFJlYWRlcnMgcnVuLgoJICAgICAgICAvLyAyLiBUaGlzIHdvcmsgd2lsbCBvbmx5IGJlIGRvbmUgb25jZSBldmVuIGlmIHRoZSBjYWxsZXIgaW5zdGFsbHMgbXVsdGlwbGUgMkQgUmVhZGVycy4KCSAgICAgICAgaWYgKHRoaXMubWF0cml4ID09PSBudWxsIHx8IHRoaXMubWF0cml4ID09PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5iaW5hcml6ZXIuZ2V0QmxhY2tNYXRyaXgoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhpcyBiaXRtYXAgY2FuIGJlIGNyb3BwZWQuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5pc0Nyb3BTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggY3JvcHBlZCBpbWFnZSBkYXRhLiBJbXBsZW1lbnRhdGlvbnMgbWF5IGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlCgkgICAgICogb3JpZ2luYWwgZGF0YSByYXRoZXIgdGhhbiBhIGNvcHkuIE9ubHkgY2FsbGFibGUgaWYgaXNDcm9wU3VwcG9ydGVkKCkgaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBsZWZ0IFRoZSBsZWZ0IGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0V2lkdGgoKSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB0b3AgY29vcmRpbmF0ZSwgd2hpY2ggbXVzdCBiZSBpbiBbMCxnZXRIZWlnaHQoKSkKCSAgICAgKiBAcGFyYW0gd2lkdGggVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHJlY3RhbmdsZSB0byBjcm9wLgoJICAgICAqIEByZXR1cm4gQSBjcm9wcGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBuZXdTb3VyY2UgPSB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5jcm9wKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIGJpdG1hcCBzdXBwb3J0cyBjb3VudGVyLWNsb2Nrd2lzZSByb3RhdGlvbi4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmlzUm90YXRlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkuaXNSb3RhdGVTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpOwoJICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUJpdG1hcCh0aGlzLmJpbmFyaXplci5jcmVhdGVCaW5hcml6ZXIobmV3U291cmNlKSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHJvdGF0ZWQgaW1hZ2UgZGF0YSBieSA0NSBkZWdyZWVzIGNvdW50ZXJjbG9ja3dpc2UuCgkgICAgICogT25seSBjYWxsYWJsZSBpZiB7QGxpbmsgI2lzUm90YXRlU3VwcG9ydGVkKCl9IGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIEEgcm90YXRlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxhY2tNYXRyaXgoKS50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlIC8qOiBOb3RGb3VuZEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICByZXR1cm4gJyc7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaW5hcnlCaXRtYXA7Cgl9KCkpOwoJdmFyIF9kZWZhdWx0JDMgPSBCaW5hcnlCaXRtYXAkMS5kZWZhdWx0ID0gQmluYXJ5Qml0bWFwOwoKCXZhciBIeWJyaWRCaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBCaW5hcml6ZXIkMSA9IHt9OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJpemVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogVGhpcyBjbGFzcyBoaWVyYXJjaHkgcHJvdmlkZXMgYSBzZXQgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGx1bWluYW5jZSBkYXRhIHRvIDEgYml0IGRhdGEuCgkgKiBJdCBhbGxvd3MgdGhlIGFsZ29yaXRobSB0byB2YXJ5IHBvbHltb3JwaGljYWxseSwgZm9yIGV4YW1wbGUgYWxsb3dpbmcgYSB2ZXJ5IGV4cGVuc2l2ZQoJICogdGhyZXNob2xkaW5nIHRlY2huaXF1ZSBmb3Igc2VydmVycyBhbmQgYSBmYXN0IG9uZSBmb3IgbW9iaWxlLiBJdCBhbHNvIHBlcm1pdHMgdGhlIGltcGxlbWVudGF0aW9uCgkgKiB0byB2YXJ5LCBlLmcuIGEgSk5JIHZlcnNpb24gZm9yIEFuZHJvaWQgYW5kIGEgSmF2YSBmYWxsYmFjayB2ZXJzaW9uIGZvciBvdGhlciBwbGF0Zm9ybXMuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpbmFyaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBCaW5hcml6ZXIoc291cmNlKSB7CgkgICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwoJICAgIH0KCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEx1bWluYW5jZVNvdXJjZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlOwoJICAgIH07CgkgICAgQmluYXJpemVyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgcmV0dXJuIEJpbmFyaXplcjsKCX0oKSk7CglCaW5hcml6ZXIkMS5kZWZhdWx0ID0gQmluYXJpemVyOwoKCXZhciBCaXRBcnJheSQxID0ge307CgoJdmFyIEFycmF5cyQxID0ge307CgoJdmFyIFN5c3RlbSQxID0ge307CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5c3RlbSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIFN5c3RlbSgpIHsKCSAgICB9CgkgICAgLy8gcHVibGljIHN0YXRpYyB2b2lkIGFycmF5Y29weShPYmplY3Qgc3JjLCBpbnQgc3JjUG9zLCBPYmplY3QgZGVzdCwgaW50IGRlc3RQb3MsIGludCBsZW5ndGgpCgkgICAgLyoqCgkgICAgICogTWFrZXMgYSBjb3B5IG9mIGEgYXJyYXkuCgkgICAgICovCgkgICAgU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7CgkgICAgICAgIC8vIFRPRE86IGJldHRlciB1c2Ugc3BsaXQgb3Igc2V0PwoJICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGltZSBpbiBtaWxsaXNlY29uZHMuCgkgICAgICovCgkgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTsKCSAgICB9OwoJICAgIHJldHVybiBTeXN0ZW07Cgl9KCkpOwoJU3lzdGVtJDEuZGVmYXVsdCA9IFN5c3RlbTsKCgl2YXIgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyRoID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDggPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaChJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbi5raW5kID0gJ0luZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ4LmRlZmF1bHQpKTsKCUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXzEgPSBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZyhBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKGluZGV4LCBtZXNzYWdlKSB7CgkgICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4OwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24ua2luZCA9ICdBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb247Cgl9KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KSk7CglBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoKCXZhciBfX3ZhbHVlcyQ3ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5cyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtXzEkNSA9IFN5c3RlbSQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDkgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMSA9IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxOwoJdmFyIEFycmF5cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBcnJheXMoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQgYXJyYXkKCSAgICAgKiBvZiBpbnRzLgoJICAgICAqCgkgICAgICogQHBhcmFtIGEgdGhlIGFycmF5IHRvIGJlIGZpbGxlZAoJICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHN0b3JlZCBpbiBhbGwgZWxlbWVudHMgb2YgdGhlIGFycmF5CgkgICAgICovCgkgICAgQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgdmFsKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKQoJICAgICAgICAgICAgYVtpXSA9IHZhbDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQKCSAgICAgKiByYW5nZSBvZiB0aGUgc3BlY2lmaWVkIGFycmF5IG9mIGludHMuICBUaGUgcmFuZ2UgdG8gYmUgZmlsbGVkCgkgICAgICogZXh0ZW5kcyBmcm9tIGluZGV4IHtAY29kZSBmcm9tSW5kZXh9LCBpbmNsdXNpdmUsIHRvIGluZGV4CgkgICAgICoge0Bjb2RlIHRvSW5kZXh9LCBleGNsdXNpdmUuICAoSWYge0Bjb2RlIGZyb21JbmRleD09dG9JbmRleH0sIHRoZQoJICAgICAqIHJhbmdlIHRvIGJlIGZpbGxlZCBpcyBlbXB0eS4pCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYSB0aGUgYXJyYXkgdG8gYmUgZmlsbGVkCgkgICAgICogQHBhcmFtIGZyb21JbmRleCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgKGluY2x1c2l2ZSkgdG8gYmUKCSAgICAgKiAgICAgICAgZmlsbGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZQoJICAgICAqIEBwYXJhbSB0b0luZGV4IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IChleGNsdXNpdmUpIHRvIGJlCgkgICAgICogICAgICAgIGZpbGxlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUKCSAgICAgKiBAcGFyYW0gdmFsIHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQgaW4gYWxsIGVsZW1lbnRzIG9mIHRoZSBhcnJheQoJICAgICAqIEB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPiB0b0luZGV4fQoJICAgICAqIEB0aHJvd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPCAwfSBvcgoJICAgICAqICAgICAgICAge0Bjb2RlIHRvSW5kZXggPiBhLmxlbmd0aH0KCSAgICAgKi8KCSAgICBBcnJheXMuZmlsbFdpdGhpbiA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkgewoJICAgICAgICBBcnJheXMucmFuZ2VDaGVjayhhLmxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykKCSAgICAgICAgICAgIGFbaV0gPSB2YWw7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDaGVja3MgdGhhdCB7QGNvZGUgZnJvbUluZGV4fSBhbmQge0Bjb2RlIHRvSW5kZXh9IGFyZSBpbgoJICAgICAqIHRoZSByYW5nZSBhbmQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGV5IGFyZW4ndC4KCSAgICAgKi8KCSAgICBBcnJheXMucmFuZ2VDaGVjayA9IGZ1bmN0aW9uIChhcnJheUxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KSB7CgkgICAgICAgIGlmIChmcm9tSW5kZXggPiB0b0luZGV4KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOS5kZWZhdWx0KCdmcm9tSW5kZXgoJyArIGZyb21JbmRleCArICcpID4gdG9JbmRleCgnICsgdG9JbmRleCArICcpJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KGZyb21JbmRleCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvSW5kZXggPiBhcnJheUxlbmd0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbl8xLmRlZmF1bHQodG9JbmRleCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEFycmF5cy5hc0xpc3QgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBhcmdzID0gW107CgkgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CgkgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGFyZ3M7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlID0gZnVuY3Rpb24gKHJvd3MsIGNvbHMsIHZhbHVlKSB7CgkgICAgICAgIHZhciBhcnIgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiByb3dzIH0pOwoJICAgICAgICByZXR1cm4gYXJyLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlSW50MzJBcnJheSA9IGZ1bmN0aW9uIChyb3dzLCBjb2xzLCB2YWx1ZSkgewoJICAgICAgICB2YXIgYXJyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogcm93cyB9KTsKCSAgICAgICAgcmV0dXJuIGFyci5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIEludDMyQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuZXF1YWxzID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKCSAgICAgICAgaWYgKCFmaXJzdCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIGlmICghc2Vjb25kKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKCFmaXJzdC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoIXNlY29uZC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZmlyc3QubGVuZ3RoICE9PSBzZWNvbmQubGVuZ3RoKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZmlyc3QubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgaWYgKGZpcnN0W2ldICE9PSBzZWNvbmRbaV0pIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBBcnJheXMuaGFzaENvZGUgPSBmdW5jdGlvbiAoYSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgaWYgKGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSAxOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgYV8xID0gX192YWx1ZXMkNyhhKSwgYV8xXzEgPSBhXzEubmV4dCgpOyAhYV8xXzEuZG9uZTsgYV8xXzEgPSBhXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAzMSAqIHJlc3VsdCArIGVsZW1lbnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChhXzFfMSAmJiAhYV8xXzEuZG9uZSAmJiAoX2EgPSBhXzEucmV0dXJuKSkgX2EuY2FsbChhXzEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBBcnJheXMuZmlsbFVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYSwgdmFsdWUpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgIT09IGEubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFbaV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZiA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbmV3TGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiBvcmlnaW5hbC5zbGljZSgwLCBuZXdMZW5ndGgpOwoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZlVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAob3JpZ2luYWwsIG5ld0xlbmd0aCkgewoJICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDw9IG5ld0xlbmd0aCkgewoJICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgICAgIG5ld0FycmF5LnNldChvcmlnaW5hbCk7CgkgICAgICAgICAgICByZXR1cm4gbmV3QXJyYXk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG9yaWdpbmFsLnNsaWNlKDAsIG5ld0xlbmd0aCk7CgkgICAgfTsKCSAgICBBcnJheXMuY29weU9mUmFuZ2UgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGZyb20sIHRvKSB7CgkgICAgICAgIHZhciBuZXdMZW5ndGggPSB0byAtIGZyb207CgkgICAgICAgIHZhciBjb3B5ID0gbmV3IEludDMyQXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgU3lzdGVtXzEkNS5kZWZhdWx0LmFycmF5Y29weShvcmlnaW5hbCwgZnJvbSwgY29weSwgMCwgbmV3TGVuZ3RoKTsKCSAgICAgICAgcmV0dXJuIGNvcHk7CgkgICAgfTsKCSAgICAvKgoJICAgICogUmV0dXJucyB0aGUgaW5kZXggb2Ygb2YgdGhlIGVsZW1lbnQgaW4gYSBzb3J0ZWQgYXJyYXkgb3IgKC1uLTEpIHdoZXJlIG4gaXMgdGhlIGluc2VydGlvbiBwb2ludAoJICAgICogZm9yIHRoZSBuZXcgZWxlbWVudC4KCSAgICAqIFBhcmFtZXRlcnM6CgkgICAgKiAgICAgYXIgLSBBIHNvcnRlZCBhcnJheQoJICAgICogICAgIGVsIC0gQW4gZWxlbWVudCB0byBzZWFyY2ggZm9yCgkgICAgKiAgICAgY29tcGFyYXRvciAtIEEgY29tcGFyYXRvciBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHRha2VzIHR3byBhcmd1bWVudHM6IChhLCBiKSBhbmQgcmV0dXJuczoKCSAgICAqICAgICAgICBhIG5lZ2F0aXZlIG51bWJlciAgaWYgYSBpcyBsZXNzIHRoYW4gYjsKCSAgICAqICAgICAgICAwIGlmIGEgaXMgZXF1YWwgdG8gYjsKCSAgICAqICAgICAgICBhIHBvc2l0aXZlIG51bWJlciBvZiBhIGlzIGdyZWF0ZXIgdGhhbiBiLgoJICAgICogVGhlIGFycmF5IG1heSBjb250YWluIGR1cGxpY2F0ZSBlbGVtZW50cy4gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgZXF1YWwgZWxlbWVudHMgaW4gdGhlIGFycmF5LAoJICAgICogdGhlIHJldHVybmVkIHZhbHVlIGNhbiBiZSB0aGUgaW5kZXggb2YgYW55IG9uZSBvZiB0aGUgZXF1YWwgZWxlbWVudHMuCgkgICAgKgoJICAgICogaHR0cDovL2pzZmlkZGxlLm5ldC9hcnl6aG92L3BrZnN0NTUwLwoJICAgICovCgkgICAgQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGZ1bmN0aW9uIChhciwgZWwsIGNvbXBhcmF0b3IpIHsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY29tcGFyYXRvcikgewoJICAgICAgICAgICAgY29tcGFyYXRvciA9IEFycmF5cy5udW1iZXJDb21wYXJhdG9yOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtID0gMDsKCSAgICAgICAgdmFyIG4gPSBhci5sZW5ndGggLSAxOwoJICAgICAgICB3aGlsZSAobSA8PSBuKSB7CgkgICAgICAgICAgICB2YXIgayA9IChuICsgbSkgPj4gMTsKCSAgICAgICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGVsLCBhcltrXSk7CgkgICAgICAgICAgICBpZiAoY21wID4gMCkgewoJICAgICAgICAgICAgICAgIG0gPSBrICsgMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHsKCSAgICAgICAgICAgICAgICBuID0gayAtIDE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gLW0gLSAxOwoJICAgIH07CgkgICAgQXJyYXlzLm51bWJlckNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoYSwgYikgewoJICAgICAgICByZXR1cm4gYSAtIGI7CgkgICAgfTsKCSAgICByZXR1cm4gQXJyYXlzOwoJfSgpKTsKCUFycmF5cyQxLmRlZmF1bHQgPSBBcnJheXM7CgoJdmFyIEludGVnZXIkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlZ2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogUG9ueWZpbGwgZm9yIEphdmEncyBJbnRlZ2VyIGNsYXNzLgoJICovCgl2YXIgSW50ZWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBJbnRlZ2VyKCkgewoJICAgIH0KCSAgICBJbnRlZ2VyLm51bWJlck9mVHJhaWxpbmdaZXJvcyA9IGZ1bmN0aW9uIChpKSB7CgkgICAgICAgIHZhciB5OwoJICAgICAgICBpZiAoaSA9PT0gMCkKCSAgICAgICAgICAgIHJldHVybiAzMjsKCSAgICAgICAgdmFyIG4gPSAzMTsKCSAgICAgICAgeSA9IGkgPDwgMTY7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDE2OwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgeSA9IGkgPDwgODsKCSAgICAgICAgaWYgKHkgIT09IDApIHsKCSAgICAgICAgICAgIG4gLT0gODsKCSAgICAgICAgICAgIGkgPSB5OwoJICAgICAgICB9CgkgICAgICAgIHkgPSBpIDw8IDQ7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDQ7CgkgICAgICAgICAgICBpID0geTsKCSAgICAgICAgfQoJICAgICAgICB5ID0gaSA8PCAyOwoJICAgICAgICBpZiAoeSAhPT0gMCkgewoJICAgICAgICAgICAgbiAtPSAyOwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG4gLSAoKGkgPDwgMSkgPj4+IDMxKTsKCSAgICB9OwoJICAgIEludGVnZXIubnVtYmVyT2ZMZWFkaW5nWmVyb3MgPSBmdW5jdGlvbiAoaSkgewoJICAgICAgICAvLyBIRCwgRmlndXJlIDUtNgoJICAgICAgICBpZiAoaSA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDMyOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gMTsKCSAgICAgICAgaWYgKGkgPj4+IDE2ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDE2OwoJICAgICAgICAgICAgaSA8PD0gMTY7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGkgPj4+IDI0ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDg7CgkgICAgICAgICAgICBpIDw8PSA4OwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID4+PiAyOCA9PT0gMCkgewoJICAgICAgICAgICAgbiArPSA0OwoJICAgICAgICAgICAgaSA8PD0gNDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaSA+Pj4gMzAgPT09IDApIHsKCSAgICAgICAgICAgIG4gKz0gMjsKCSAgICAgICAgICAgIGkgPDw9IDI7CgkgICAgICAgIH0KCSAgICAgICAgbiAtPSBpID4+PiAzMTsKCSAgICAgICAgcmV0dXJuIG47CgkgICAgfTsKCSAgICBJbnRlZ2VyLnRvSGV4U3RyaW5nID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgcmV0dXJuIGkudG9TdHJpbmcoMTYpOwoJICAgIH07CgkgICAgSW50ZWdlci50b0JpbmFyeVN0cmluZyA9IGZ1bmN0aW9uIChpbnROdW1iZXIpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZyhwYXJzZUludChTdHJpbmcoaW50TnVtYmVyKSwgMikpOwoJICAgIH07CgkgICAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4gVGhpcyBmdW5jdGlvbiBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIHBvcHVsYXRpb24gY291bnQuCgkgICAgLy8gUmV0dXJuczoKCSAgICAvLyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4KCSAgICBJbnRlZ2VyLmJpdENvdW50ID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgLy8gSEQsIEZpZ3VyZSA1LTIKCSAgICAgICAgaSA9IGkgLSAoKGkgPj4+IDEpICYgMHg1NTU1NTU1NSk7CgkgICAgICAgIGkgPSAoaSAmIDB4MzMzMzMzMzMpICsgKChpID4+PiAyKSAmIDB4MzMzMzMzMzMpOwoJICAgICAgICBpID0gKGkgKyAoaSA+Pj4gNCkpICYgMHgwZjBmMGYwZjsKCSAgICAgICAgaSA9IGkgKyAoaSA+Pj4gOCk7CgkgICAgICAgIGkgPSBpICsgKGkgPj4+IDE2KTsKCSAgICAgICAgcmV0dXJuIGkgJiAweDNmOwoJICAgIH07CgkgICAgSW50ZWdlci50cnVuY0RpdmlzaW9uID0gZnVuY3Rpb24gKGRpdmlkZW5kLCBkaXZpc29yKSB7CgkgICAgICAgIHJldHVybiBNYXRoLnRydW5jKGRpdmlkZW5kIC8gZGl2aXNvcik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBBIHN0cmluZyB0byBhbiBpbnRlZ2VyLgoJICAgICAqIEBwYXJhbSBzIEEgc3RyaW5nIHRvIGNvbnZlcnQgaW50byBhIG51bWJlci4KCSAgICAgKiBAcGFyYW0gcmFkaXggQSB2YWx1ZSBiZXR3ZWVuIDIgYW5kIDM2IHRoYXQgc3BlY2lmaWVzIHRoZSBiYXNlIG9mIHRoZSBudW1iZXIgaW4gbnVtU3RyaW5nLiBJZiB0aGlzIGFyZ3VtZW50IGlzIG5vdCBzdXBwbGllZCwgc3RyaW5ncyB3aXRoIGEgcHJlZml4IG9mICcweCcgYXJlIGNvbnNpZGVyZWQgaGV4YWRlY2ltYWwuIEFsbCBvdGhlciBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGRlY2ltYWwuCgkgICAgICovCgkgICAgSW50ZWdlci5wYXJzZUludCA9IGZ1bmN0aW9uIChudW0sIHJhZGl4KSB7CgkgICAgICAgIGlmIChyYWRpeCA9PT0gdm9pZCAwKSB7IHJhZGl4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIHJldHVybiBwYXJzZUludChudW0sIHJhZGl4KTsKCSAgICB9OwoJICAgIEludGVnZXIuTUlOX1ZBTFVFXzMyX0JJVFMgPSAtMjE0NzQ4MzY0ODsKCSAgICBJbnRlZ2VyLk1BWF9WQUxVRSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgIHJldHVybiBJbnRlZ2VyOwoJfSgpKTsKCUludGVnZXIkMS5kZWZhdWx0ID0gSW50ZWdlcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdEFycmF5JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDggPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheXNfMSQxID0gQXJyYXlzJDE7Cgl2YXIgSW50ZWdlcl8xJDIgPSBJbnRlZ2VyJDE7Cgl2YXIgU3lzdGVtXzEkNCA9IFN5c3RlbSQxOwoJLyoqCgkgKiA8cD5BIHNpbXBsZSwgZmFzdCBhcnJheSBvZiBiaXRzLCByZXByZXNlbnRlZCBjb21wYWN0bHkgYnkgYW4gYXJyYXkgb2YgaW50cyBpbnRlcm5hbGx5LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgQml0QXJyYXkgLyppbXBsZW1lbnRzIENsb25lYWJsZSovID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHsKCSAgICAvLyAgIHRoaXMuc2l6ZSA9IDAKCSAgICAvLyAgIHRoaXMuYml0cyA9IG5ldyBJbnQzMkFycmF5KDEpCgkgICAgLy8gfQoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcihzaXplPzogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh1bmRlZmluZWQgPT09IHNpemUpIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gMAoJICAgIC8vICAgfSBlbHNlIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gc2l6ZQoJICAgIC8vICAgfQoJICAgIC8vICAgdGhpcy5iaXRzID0gdGhpcy5tYWtlQXJyYXkoc2l6ZSkKCSAgICAvLyB9CgkgICAgLy8gRm9yIHRlc3Rpbmcgb25seQoJICAgIGZ1bmN0aW9uIEJpdEFycmF5KHNpemUgLyppbnQqLywgYml0cykgewoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBzaXplKSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSAwOwoJICAgICAgICAgICAgdGhpcy5iaXRzID0gbmV3IEludDMyQXJyYXkoMSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSBzaXplOwoJICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gQml0QXJyYXkubWFrZUFycmF5KHNpemUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZTsKCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXRTaXplSW5CeXRlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKHRoaXMuc2l6ZSArIDcpIC8gOCk7CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZW5zdXJlQ2FwYWNpdHkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmIChzaXplID4gdGhpcy5iaXRzLmxlbmd0aCAqIDMyKSB7CgkgICAgICAgICAgICB2YXIgbmV3Qml0cyA9IEJpdEFycmF5Lm1ha2VBcnJheShzaXplKTsKCSAgICAgICAgICAgIFN5c3RlbV8xJDQuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5iaXRzLCAwLCBuZXdCaXRzLCAwLCB0aGlzLmJpdHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBpIGJpdCB0byBnZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGJpdCBpIGlzIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiAodGhpcy5iaXRzW01hdGguZmxvb3IoaSAvIDMyKV0gJiAoMSA8PCAoaSAmIDB4MUYpKSkgIT09IDA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHRoaXMuYml0c1tNYXRoLmZsb29yKGkgLyAzMildIHw9IDEgPDwgKGkgJiAweDFGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEZsaXBzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24gKGkgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSBePSAxIDw8IChpICYgMHgxRik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBmaXJzdCBiaXQgdG8gY2hlY2sKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIGZpcnN0IGJpdCB0aGF0IGlzIHNldCwgc3RhcnRpbmcgZnJvbSB0aGUgZ2l2ZW4gaW5kZXgsIG9yIHNpemUgaWYgbm9uZSBhcmUgc2V0CgkgICAgICogIGF0IG9yIGJleW9uZCB0aGlzIGdpdmVuIGluZGV4CgkgICAgICogQHNlZSAjZ2V0TmV4dFVuc2V0KGludCkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0TmV4dFNldCA9IGZ1bmN0aW9uIChmcm9tIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7CgkgICAgICAgIGlmIChmcm9tID49IHNpemUpIHsKCSAgICAgICAgICAgIHJldHVybiBzaXplOwoJICAgICAgICB9CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IE1hdGguZmxvb3IoZnJvbSAvIDMyKTsKCSAgICAgICAgdmFyIGN1cnJlbnRCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgLy8gbWFzayBvZmYgbGVzc2VyIGJpdHMgZmlyc3QKCSAgICAgICAgY3VycmVudEJpdHMgJj0gfigoMSA8PCAoZnJvbSAmIDB4MUYpKSAtIDEpOwoJICAgICAgICB2YXIgbGVuZ3RoID0gYml0cy5sZW5ndGg7CgkgICAgICAgIHdoaWxlIChjdXJyZW50Qml0cyA9PT0gMCkgewoJICAgICAgICAgICAgaWYgKCsrYml0c09mZnNldCA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIHNpemU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjdXJyZW50Qml0cyA9IGJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBpbmRleCB0byBzdGFydCBsb29raW5nIGZvciB1bnNldCBiaXQKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgdW5zZXQgYml0LCBvciB7QGNvZGUgc2l6ZX0gaWYgbm9uZSBhcmUgdW5zZXQgdW50aWwgdGhlIGVuZAoJICAgICAqIEBzZWUgI2dldE5leHRTZXQoaW50KQoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXROZXh0VW5zZXQgPSBmdW5jdGlvbiAoZnJvbSAvKmludCovKSB7CgkgICAgICAgIHZhciBzaXplID0gdGhpcy5zaXplOwoJICAgICAgICBpZiAoZnJvbSA+PSBzaXplKSB7CgkgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIGJpdHNPZmZzZXQgPSBNYXRoLmZsb29yKGZyb20gLyAzMik7CgkgICAgICAgIHZhciBjdXJyZW50Qml0cyA9IH5iaXRzW2JpdHNPZmZzZXRdOwoJICAgICAgICAvLyBtYXNrIG9mZiBsZXNzZXIgYml0cyBmaXJzdAoJICAgICAgICBjdXJyZW50Qml0cyAmPSB+KCgxIDw8IChmcm9tICYgMHgxRikpIC0gMSk7CgkgICAgICAgIHZhciBsZW5ndGggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgd2hpbGUgKGN1cnJlbnRCaXRzID09PSAwKSB7CgkgICAgICAgICAgICBpZiAoKytiaXRzT2Zmc2V0ID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGN1cnJlbnRCaXRzID0gfmJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgYmxvY2sgb2YgMzIgYml0cywgc3RhcnRpbmcgYXQgYml0IGkuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gaSBmaXJzdCBiaXQgdG8gc2V0CgkgICAgICogQHBhcmFtIG5ld0JpdHMgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgbmV4dCAzMiBiaXRzLiBOb3RlIGFnYWluIHRoYXQgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdAoJICAgICAqIGNvcnJlc3BvbmRzIHRvIGJpdCBpLCB0aGUgbmV4dC1sZWFzdC1zaWduaWZpY2FudCB0byBpKzEsIGFuZCBzbyBvbi4KCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0QnVsayA9IGZ1bmN0aW9uIChpIC8qaW50Ki8sIG5ld0JpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgcmFuZ2Ugb2YgYml0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydCBzdGFydCBvZiByYW5nZSwgaW5jbHVzaXZlLgoJICAgICAqIEBwYXJhbSBlbmQgZW5kIG9mIHJhbmdlLCBleGNsdXNpdmUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0UmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQgLyppbnQqLywgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGVuZC0tOyAvLyB3aWxsIGJlIGVhc2llciB0byB0cmVhdCB0aGlzIGFzIHRoZSBsYXN0IGFjdHVhbGx5IHNldCBiaXQgLS0gaW5jbHVzaXZlCgkgICAgICAgIHZhciBmaXJzdEludCA9IE1hdGguZmxvb3Ioc3RhcnQgLyAzMik7CgkgICAgICAgIHZhciBsYXN0SW50ID0gTWF0aC5mbG9vcihlbmQgLyAzMik7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RJbnQ7IGkgPD0gbGFzdEludDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgZmlyc3RCaXQgPSBpID4gZmlyc3RJbnQgPyAwIDogc3RhcnQgJiAweDFGOwoJICAgICAgICAgICAgdmFyIGxhc3RCaXQgPSBpIDwgbGFzdEludCA/IDMxIDogZW5kICYgMHgxRjsKCSAgICAgICAgICAgIC8vIE9uZXMgZnJvbSBmaXJzdEJpdCB0byBsYXN0Qml0LCBpbmNsdXNpdmUKCSAgICAgICAgICAgIHZhciBtYXNrID0gKDIgPDwgbGFzdEJpdCkgLSAoMSA8PCBmaXJzdEJpdCk7CgkgICAgICAgICAgICBiaXRzW2ldIHw9IG1hc2s7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbWF4ID0gdGhpcy5iaXRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGJpdHNbaV0gPSAwOwoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBFZmZpY2llbnQgbWV0aG9kIHRvIGNoZWNrIGlmIGEgcmFuZ2Ugb2YgYml0cyBpcyBzZXQsIG9yIG5vdCBzZXQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnQgc3RhcnQgb2YgcmFuZ2UsIGluY2x1c2l2ZS4KCSAgICAgKiBAcGFyYW0gZW5kIGVuZCBvZiByYW5nZSwgZXhjbHVzaXZlCgkgICAgICogQHBhcmFtIHZhbHVlIGlmIHRydWUsIGNoZWNrcyB0aGF0IGJpdHMgaW4gcmFuZ2UgYXJlIHNldCwgb3RoZXJ3aXNlIGNoZWNrcyB0aGF0IHRoZXkgYXJlIG5vdCBzZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGFsbCBiaXRzIGFyZSBzZXQgb3Igbm90IHNldCBpbiByYW5nZSwgYWNjb3JkaW5nIHRvIHZhbHVlIGFyZ3VtZW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgZW5kIGlzIGxlc3MgdGhhbiBzdGFydCBvciB0aGUgcmFuZ2UgaXMgbm90IGNvbnRhaW5lZCBpbiB0aGUgYXJyYXkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uIChzdGFydCAvKmludCovLCBlbmQgLyppbnQqLywgdmFsdWUpIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGVtcHR5IHJhbmdlIG1hdGNoZXMKCSAgICAgICAgfQoJICAgICAgICBlbmQtLTsgLy8gd2lsbCBiZSBlYXNpZXIgdG8gdHJlYXQgdGhpcyBhcyB0aGUgbGFzdCBhY3R1YWxseSBzZXQgYml0IC0tIGluY2x1c2l2ZQoJICAgICAgICB2YXIgZmlyc3RJbnQgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMzIpOwoJICAgICAgICB2YXIgbGFzdEludCA9IE1hdGguZmxvb3IoZW5kIC8gMzIpOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZpcnN0SW50OyBpIDw9IGxhc3RJbnQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGZpcnN0Qml0ID0gaSA+IGZpcnN0SW50ID8gMCA6IHN0YXJ0ICYgMHgxRjsKCSAgICAgICAgICAgIHZhciBsYXN0Qml0ID0gaSA8IGxhc3RJbnQgPyAzMSA6IGVuZCAmIDB4MUY7CgkgICAgICAgICAgICAvLyBPbmVzIGZyb20gZmlyc3RCaXQgdG8gbGFzdEJpdCwgaW5jbHVzaXZlCgkgICAgICAgICAgICB2YXIgbWFzayA9ICgyIDw8IGxhc3RCaXQpIC0gKDEgPDwgZmlyc3RCaXQpICYgMHhGRkZGRkZGRjsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiAmIDB4RkZGRkZGRkYgYWRkZWQgdG8gZGlzY2FyZCBhbnl0aGluZyBhZnRlciAzMiBiaXRzLCBhcyBFUyBoYXMgNTMgYml0cwoJICAgICAgICAgICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIDFzIGFuZCB0aGUgbWFza2VkIGJpdHNbaV0gaXNuJ3QgYWxsIDFzIChpczogdGhhdCwKCSAgICAgICAgICAgIC8vIGVxdWFscyB0aGUgbWFzaywgb3Igd2UncmUgbG9va2luZyBmb3IgMHMgYW5kIHRoZSBtYXNrZWQgcG9ydGlvbiBpcyBub3QgYWxsIDBzCgkgICAgICAgICAgICBpZiAoKGJpdHNbaV0gJiBtYXNrKSAhPT0gKHZhbHVlID8gbWFzayA6IDApKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0cnVlOwoJICAgIH07CgkgICAgQml0QXJyYXkucHJvdG90eXBlLmFwcGVuZEJpdCA9IGZ1bmN0aW9uIChiaXQpIHsKCSAgICAgICAgdGhpcy5lbnN1cmVDYXBhY2l0eSh0aGlzLnNpemUgKyAxKTsKCSAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgdGhpcy5iaXRzW01hdGguZmxvb3IodGhpcy5zaXplIC8gMzIpXSB8PSAxIDw8ICh0aGlzLnNpemUgJiAweDFGKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLnNpemUrKzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFwcGVuZHMgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdHMsIGZyb20gdmFsdWUsIGluIG9yZGVyIGZyb20gbW9zdC1zaWduaWZpY2FudCB0bwoJICAgICAqIGxlYXN0LXNpZ25pZmljYW50LiBGb3IgZXhhbXBsZSwgYXBwZW5kaW5nIDYgYml0cyBmcm9tIDB4MDAwMDAxRSB3aWxsIGFwcGVuZCB0aGUgYml0cwoJICAgICAqIDAsIDEsIDEsIDEsIDEsIDAgaW4gdGhhdCBvcmRlci4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB2YWx1ZSB7QGNvZGUgaW50fSBjb250YWluaW5nIGJpdHMgdG8gYXBwZW5kCgkgICAgICogQHBhcmFtIG51bUJpdHMgYml0cyBmcm9tIHZhbHVlIHRvIGFwcGVuZAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5hcHBlbmRCaXRzID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICBpZiAobnVtQml0cyA8IDAgfHwgbnVtQml0cyA+IDMyKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOC5kZWZhdWx0KCdOdW0gYml0cyBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMzInKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmVuc3VyZUNhcGFjaXR5KHRoaXMuc2l6ZSArIG51bUJpdHMpOwoJICAgICAgICAvLyBjb25zdCBhcHBlbmRCaXQgPSB0aGlzLmFwcGVuZEJpdDsKCSAgICAgICAgZm9yICh2YXIgbnVtQml0c0xlZnQgPSBudW1CaXRzOyBudW1CaXRzTGVmdCA+IDA7IG51bUJpdHNMZWZ0LS0pIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KCgodmFsdWUgPj4gKG51bUJpdHNMZWZ0IC0gMSkpICYgMHgwMSkgPT09IDEpOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuYXBwZW5kQml0QXJyYXkgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdmFyIG90aGVyU2l6ZSA9IG90aGVyLnNpemU7CgkgICAgICAgIHRoaXMuZW5zdXJlQ2FwYWNpdHkodGhpcy5zaXplICsgb3RoZXJTaXplKTsKCSAgICAgICAgLy8gY29uc3QgYXBwZW5kQml0ID0gdGhpcy5hcHBlbmRCaXQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3RoZXJTaXplOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KG90aGVyLmdldChpKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDguZGVmYXVsdCgnU2l6ZXMgZG9uXCd0IG1hdGNoJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGJpdHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgLy8gVGhlIGxhc3QgaW50IGNvdWxkIGJlIGluY29tcGxldGUgKGkuZS4gbm90IGhhdmUgMzIgYml0cyBpbgoJICAgICAgICAgICAgLy8gaXQpIGJ1dCB0aGVyZSBpcyBubyBwcm9ibGVtIHNpbmNlIDAgWE9SIDAgPT0gMC4KCSAgICAgICAgICAgIGJpdHNbaV0gXj0gb3RoZXIuYml0c1tpXTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0T2Zmc2V0IGZpcnN0IGJpdCB0byBzdGFydCB3cml0aW5nCgkgICAgICogQHBhcmFtIGFycmF5IGFycmF5IHRvIHdyaXRlIGludG8uIEJ5dGVzIGFyZSB3cml0dGVuIG1vc3Qtc2lnbmlmaWNhbnQgYnl0ZSBmaXJzdC4gVGhpcyBpcyB0aGUgb3Bwb3NpdGUKCSAgICAgKiAgb2YgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyBleHBvc2VkIGJ5IHtAbGluayAjZ2V0Qml0QXJyYXkoKX0KCSAgICAgKiBAcGFyYW0gb2Zmc2V0IHBvc2l0aW9uIGluIGFycmF5IHRvIHN0YXJ0IHdyaXRpbmcKCSAgICAgKiBAcGFyYW0gbnVtQnl0ZXMgaG93IG1hbnkgYnl0ZXMgdG8gd3JpdGUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChiaXRPZmZzZXQgLyppbnQqLywgYXJyYXksIG9mZnNldCAvKmludCovLCBudW1CeXRlcyAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQnl0ZXM7IGkrKykgewoJICAgICAgICAgICAgdmFyIHRoZUJ5dGUgPSAwOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoYml0T2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICB0aGVCeXRlIHw9IDEgPDwgKDcgLSBqKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBpXSA9IC8qKGJ5dGUpKi8gdGhlQnl0ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB1bmRlcmx5aW5nIGFycmF5IG9mIGludHMuIFRoZSBmaXJzdCBlbGVtZW50IGhvbGRzIHRoZSBmaXJzdCAzMiBiaXRzLCBhbmQgdGhlIGxlYXN0CgkgICAgICogICAgICAgICBzaWduaWZpY2FudCBiaXQgaXMgYml0IDAuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmdldEJpdEFycmF5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV2ZXJzZXMgYWxsIGJpdHMgaW4gdGhlIGFycmF5LgoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3Qml0cyA9IG5ldyBJbnQzMkFycmF5KHRoaXMuYml0cy5sZW5ndGgpOwoJICAgICAgICAvLyByZXZlcnNlIGFsbCBpbnQncyBmaXJzdAoJICAgICAgICB2YXIgbGVuID0gTWF0aC5mbG9vcigodGhpcy5zaXplIC0gMSkgLyAzMik7CgkgICAgICAgIHZhciBvbGRCaXRzTGVuID0gbGVuICsgMTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQml0c0xlbjsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeCA9IGJpdHNbaV07CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDEpICYgMHg1NTU1NTU1NSkgfCAoKHggJiAweDU1NTU1NTU1KSA8PCAxKTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMikgJiAweDMzMzMzMzMzKSB8ICgoeCAmIDB4MzMzMzMzMzMpIDw8IDIpOwoJICAgICAgICAgICAgeCA9ICgoeCA+PiA0KSAmIDB4MGYwZjBmMGYpIHwgKCh4ICYgMHgwZjBmMGYwZikgPDwgNCk7CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDgpICYgMHgwMGZmMDBmZikgfCAoKHggJiAweDAwZmYwMGZmKSA8PCA4KTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMTYpICYgMHgwMDAwZmZmZikgfCAoKHggJiAweDAwMDBmZmZmKSA8PCAxNik7CgkgICAgICAgICAgICBuZXdCaXRzW2xlbiAtIGldID0gLyooaW50KSovIHg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm93IGNvcnJlY3QgdGhlIGludCdzIGlmIHRoZSBiaXQgc2l6ZSBpc24ndCBhIG11bHRpcGxlIG9mIDMyCgkgICAgICAgIGlmICh0aGlzLnNpemUgIT09IG9sZEJpdHNMZW4gKiAzMikgewoJICAgICAgICAgICAgdmFyIGxlZnRPZmZzZXQgPSBvbGRCaXRzTGVuICogMzIgLSB0aGlzLnNpemU7CgkgICAgICAgICAgICB2YXIgY3VycmVudEludCA9IG5ld0JpdHNbMF0gPj4+IGxlZnRPZmZzZXQ7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG9sZEJpdHNMZW47IGkrKykgewoJICAgICAgICAgICAgICAgIHZhciBuZXh0SW50ID0gbmV3Qml0c1tpXTsKCSAgICAgICAgICAgICAgICBjdXJyZW50SW50IHw9IG5leHRJbnQgPDwgKDMyIC0gbGVmdE9mZnNldCk7CgkgICAgICAgICAgICAgICAgbmV3Qml0c1tpIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICAgICAgICAgIGN1cnJlbnRJbnQgPSBuZXh0SW50ID4+PiBsZWZ0T2Zmc2V0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmV3Qml0c1tvbGRCaXRzTGVuIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICBCaXRBcnJheS5tYWtlQXJyYXkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShNYXRoLmZsb29yKChzaXplICsgMzEpIC8gMzIpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdEFycmF5KSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnNpemUgPT09IG90aGVyLnNpemUgJiYgQXJyYXlzXzEkMS5kZWZhdWx0LmVxdWFscyh0aGlzLmJpdHMsIG90aGVyLmJpdHMpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogdGhpcy5zaXplICsgQXJyYXlzXzEkMS5kZWZhdWx0Lmhhc2hDb2RlKHRoaXMuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5zaXplOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICBpZiAoKGkgJiAweDA3KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICc7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5nZXQoaSkgPyAnWCcgOiAnLic7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0QXJyYXkodGhpcy5zaXplLCB0aGlzLmJpdHMuc2xpY2UoKSk7CgkgICAgfTsKCSAgICByZXR1cm4gQml0QXJyYXk7Cgl9KCkpOwoJQml0QXJyYXkkMS5kZWZhdWx0ID0gQml0QXJyYXk7CgoJdmFyIEJpdE1hdHJpeCQxID0ge307CgoJdmFyIFN0cmluZ0J1aWxkZXIkMSA9IHt9OwoKCXZhciBTdHJpbmdVdGlscyQxID0ge307CgoJdmFyIERlY29kZUhpbnRUeXBlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERlY29kZUhpbnRUeXBlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIHR5cGUgb2YgaGludCB0aGF0IGEgY2FsbGVyIG1heSBwYXNzIHRvIGEgYmFyY29kZSByZWFkZXIgdG8gaGVscCBpdAoJICogbW9yZSBxdWlja2x5IG9yIGFjY3VyYXRlbHkgZGVjb2RlIGl0LiBJdCBpcyB1cCB0byBpbXBsZW1lbnRhdGlvbnMgdG8gZGVjaWRlIHdoYXQsCgkgKiBpZiBhbnl0aGluZywgdG8gZG8gd2l0aCB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBzdXBwbGllZC4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBzZWUgUmVhZGVyI2RlY29kZShCaW5hcnlCaXRtYXAsamF2YS51dGlsLk1hcCkKCSAqLwoJdmFyIERlY29kZUhpbnRUeXBlOwoJKGZ1bmN0aW9uIChEZWNvZGVIaW50VHlwZSkgewoJICAgIC8qKgoJICAgICAqIFVuc3BlY2lmaWVkLCBhcHBsaWNhdGlvbi1zcGVjaWZpYyBoaW50LiBNYXBzIHRvIGFuIHVuc3BlY2lmaWVkIHtAbGluayBPYmplY3R9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJPVEhFUiJdID0gMF0gPSAiT1RIRVIiOyAvKihPYmplY3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJbWFnZSBpcyBhIHB1cmUgbW9ub2Nocm9tZSBpbWFnZSBvZiBhIGJhcmNvZGUuIERvZXNuJ3QgbWF0dGVyIHdoYXQgaXQgbWFwcyB0bzsKCSAgICAgKiB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlBVUkVfQkFSQ09ERSJdID0gMV0gPSAiUFVSRV9CQVJDT0RFIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEltYWdlIGlzIGtub3duIHRvIGJlIG9mIG9uZSBvZiBhIGZldyBwb3NzaWJsZSBmb3JtYXRzLgoJICAgICAqIE1hcHMgdG8gYSB7QGxpbmsgTGlzdH0gb2Yge0BsaW5rIEJhcmNvZGVGb3JtYXR9cy4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiUE9TU0lCTEVfRk9STUFUUyJdID0gMl0gPSAiUE9TU0lCTEVfRk9STUFUUyI7IC8qKExpc3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVuZCBtb3JlIHRpbWUgdG8gdHJ5IHRvIGZpbmQgYSBiYXJjb2RlOyBvcHRpbWl6ZSBmb3IgYWNjdXJhY3ksIG5vdCBzcGVlZC4KCSAgICAgKiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87IHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiVFJZX0hBUkRFUiJdID0gM10gPSAiVFJZX0hBUkRFUiI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVjaWZpZXMgd2hhdCBjaGFyYWN0ZXIgZW5jb2RpbmcgdG8gdXNlIHdoZW4gZGVjb2RpbmcsIHdoZXJlIGFwcGxpY2FibGUgKHR5cGUgU3RyaW5nKQoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJDSEFSQUNURVJfU0VUIl0gPSA0XSA9ICJDSEFSQUNURVJfU0VUIjsgLyooU3RyaW5nLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQWxsb3dlZCBsZW5ndGhzIG9mIGVuY29kZWQgZGF0YSAtLSByZWplY3QgYW55dGhpbmcgZWxzZS4gTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfTEVOR1RIUyJdID0gNV0gPSAiQUxMT1dFRF9MRU5HVEhTIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEFzc3VtZSBDb2RlIDM5IGNvZGVzIGVtcGxveSBhIGNoZWNrIGRpZ2l0LiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87CgkgICAgICogdXNlIHtAbGluayBCb29sZWFuI1RSVUV9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJBU1NVTUVfQ09ERV8zOV9DSEVDS19ESUdJVCJdID0gNl0gPSAiQVNTVU1FX0NPREVfMzlfQ0hFQ0tfRElHSVQiOyAvKihWb2lkLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQXNzdW1lIHRoZSBiYXJjb2RlIGlzIGJlaW5nIHByb2Nlc3NlZCBhcyBhIEdTMSBiYXJjb2RlLCBhbmQgbW9kaWZ5IGJlaGF2aW9yIGFzIG5lZWRlZC4KCSAgICAgKiBGb3IgZXhhbXBsZSB0aGlzIGFmZmVjdHMgRk5DMSBoYW5kbGluZyBmb3IgQ29kZSAxMjggKGFrYSBHUzEtMTI4KS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOwoJICAgICAqIHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiQVNTVU1FX0dTMSJdID0gN10gPSAiQVNTVU1FX0dTMSI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJZiB0cnVlLCByZXR1cm4gdGhlIHN0YXJ0IGFuZCBlbmQgZGlnaXRzIGluIGEgQ29kYWJhciBiYXJjb2RlIGluc3RlYWQgb2Ygc3RyaXBwaW5nIHRoZW0uIFRoZXkKCSAgICAgKiBhcmUgYWxwaGEsIHdoZXJlYXMgdGhlIHJlc3QgYXJlIG51bWVyaWMuIEJ5IGRlZmF1bHQsIHRoZXkgYXJlIHN0cmlwcGVkLCBidXQgdGhpcyBjYXVzZXMgdGhlbQoJICAgICAqIHRvIG5vdCBiZS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOyB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlJFVFVSTl9DT0RBQkFSX1NUQVJUX0VORCJdID0gOF0gPSAiUkVUVVJOX0NPREFCQVJfU1RBUlRfRU5EIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIFRoZSBjYWxsZXIgbmVlZHMgdG8gYmUgbm90aWZpZWQgdmlhIGNhbGxiYWNrIHdoZW4gYSBwb3NzaWJsZSB7QGxpbmsgUmVzdWx0UG9pbnR9CgkgICAgICogaXMgZm91bmQuIE1hcHMgdG8gYSB7QGxpbmsgUmVzdWx0UG9pbnRDYWxsYmFja30uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIk5FRURfUkVTVUxUX1BPSU5UX0NBTExCQUNLIl0gPSA5XSA9ICJORUVEX1JFU1VMVF9QT0lOVF9DQUxMQkFDSyI7IC8qKFJlc3VsdFBvaW50Q2FsbGJhY2suY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBBbGxvd2VkIGV4dGVuc2lvbiBsZW5ndGhzIGZvciBFQU4gb3IgVVBDIGJhcmNvZGVzLiBPdGhlciBmb3JtYXRzIHdpbGwgaWdub3JlIHRoaXMuCgkgICAgICogTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0gb2YgdGhlIGFsbG93ZWQgZXh0ZW5zaW9uIGxlbmd0aHMsIGZvciBleGFtcGxlIFsyXSwgWzVdLCBvciBbMiwgNV0uCgkgICAgICogSWYgaXQgaXMgb3B0aW9uYWwgdG8gaGF2ZSBhbiBleHRlbnNpb24sIGRvIG5vdCBzZXQgdGhpcyBoaW50LiBJZiB0aGlzIGlzIHNldCwKCSAgICAgKiBhbmQgYSBVUEMgb3IgRUFOIGJhcmNvZGUgaXMgZm91bmQgYnV0IGFuIGV4dGVuc2lvbiBpcyBub3QsIHRoZW4gbm8gcmVzdWx0IHdpbGwgYmUgcmV0dXJuZWQKCSAgICAgKiBhdCBhbGwuCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfRUFOX0VYVEVOU0lPTlMiXSA9IDEwXSA9ICJBTExPV0VEX0VBTl9FWFRFTlNJT05TIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8vIEVuZCBvZiBlbnVtZXJhdGlvbiB2YWx1ZXMuCgkgICAgLyoqCgkgICAgICogRGF0YSB0eXBlIHRoZSBoaW50IGlzIGV4cGVjdGluZy4KCSAgICAgKiBBbW9uZyB0aGUgcG9zc2libGUgdmFsdWVzIHRoZSB7QGxpbmsgVm9pZH0gc3RhbmRzIG91dCBhcyBiZWluZyB1c2VkIGZvcgoJICAgICAqIGhpbnRzIHRoYXQgZG8gbm90IGV4cGVjdCBhIHZhbHVlIHRvIGJlIHN1cHBsaWVkIChmbGFnIGhpbnRzKS4gU3VjaCBoaW50cwoJICAgICAqIHdpbGwgcG9zc2libHkgaGF2ZSB0aGVpciB2YWx1ZSBpZ25vcmVkLCBvciByZXBsYWNlZCBieSBhCgkgICAgICoge0BsaW5rIEJvb2xlYW4jVFJVRX0uIEhpbnQgc3VwcGxpZXJzIHNob3VsZCBwcm9iYWJseSB1c2UKCSAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBhcyBkaXJlY3RlZCBieSB0aGUgYWN0dWFsIGhpbnQgZG9jdW1lbnRhdGlvbi4KCSAgICAgKi8KCSAgICAvLyBwcml2YXRlIHZhbHVlVHlwZTogQ2xhc3M8Pz4KCSAgICAvLyBEZWNvZGVIaW50VHlwZSh2YWx1ZVR5cGU6IENsYXNzPD8+KSB7CgkgICAgLy8gICB0aGlzLnZhbHVlVHlwZSA9IHZhbHVlVHlwZQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgZ2V0VmFsdWVUeXBlKCk6IENsYXNzPD8+IHsKCSAgICAvLyAgIHJldHVybiB2YWx1ZVR5cGUKCSAgICAvLyB9Cgl9KShEZWNvZGVIaW50VHlwZSB8fCAoRGVjb2RlSGludFR5cGUgPSB7fSkpOwoJRGVjb2RlSGludFR5cGUkMS5kZWZhdWx0ID0gRGVjb2RlSGludFR5cGU7CgoJdmFyIENoYXJhY3RlclNldEVDSSA9IHt9OwoKCXZhciBGb3JtYXRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXRFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDcgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRm9ybWF0RXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRmKEZvcm1hdEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBGb3JtYXRFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgRm9ybWF0RXhjZXB0aW9uLmdldEZvcm1hdEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEV4Y2VwdGlvbigpOwoJICAgIH07CgkgICAgRm9ybWF0RXhjZXB0aW9uLmtpbmQgPSAnRm9ybWF0RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRm9ybWF0RXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ3LmRlZmF1bHQpKTsKCUZvcm1hdEV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBGb3JtYXRFeGNlcHRpb247CgoJKGZ1bmN0aW9uIChleHBvcnRzKSB7CgkvKgoJICogQ29weXJpZ2h0IDIwMDggWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCWV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHZvaWQgMDsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xID0gRm9ybWF0RXhjZXB0aW9uJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsqLwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJdmFyIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnM7CgkoZnVuY3Rpb24gKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMpIHsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwNDM3Il0gPSAwXSA9ICJDcDQzNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEiXSA9IDFdID0gIklTTzg4NTlfMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzIiXSA9IDJdID0gIklTTzg4NTlfMiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzMiXSA9IDNdID0gIklTTzg4NTlfMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzQiXSA9IDRdID0gIklTTzg4NTlfNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzUiXSA9IDVdID0gIklTTzg4NTlfNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzYiXSA9IDZdID0gIklTTzg4NTlfNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzciXSA9IDddID0gIklTTzg4NTlfNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzgiXSA9IDhdID0gIklTTzg4NTlfOCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzkiXSA9IDldID0gIklTTzg4NTlfOSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEwIl0gPSAxMF0gPSAiSVNPODg1OV8xMCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzExIl0gPSAxMV0gPSAiSVNPODg1OV8xMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEzIl0gPSAxMl0gPSAiSVNPODg1OV8xMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE0Il0gPSAxM10gPSAiSVNPODg1OV8xNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE1Il0gPSAxNF0gPSAiSVNPODg1OV8xNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE2Il0gPSAxNV0gPSAiSVNPODg1OV8xNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJTSklTIl0gPSAxNl0gPSAiU0pJUyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTAiXSA9IDE3XSA9ICJDcDEyNTAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQ3AxMjUxIl0gPSAxOF0gPSAiQ3AxMjUxIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwMTI1MiJdID0gMTldID0gIkNwMTI1MiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTYiXSA9IDIwXSA9ICJDcDEyNTYiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siVW5pY29kZUJpZ1VubWFya2VkIl0gPSAyMV0gPSAiVW5pY29kZUJpZ1VubWFya2VkIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIlVURjgiXSA9IDIyXSA9ICJVVEY4IjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkFTQ0lJIl0gPSAyM10gPSAiQVNDSUkiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQmlnNSJdID0gMjRdID0gIkJpZzUiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siR0IxODAzMCJdID0gMjVdID0gIkdCMTgwMzAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siRVVDX0tSIl0gPSAyNl0gPSAiRVVDX0tSIjsKCX0pKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgPSBleHBvcnRzLkNoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgfHwgKGV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHt9KSk7CgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIENoYXJhY3RlciBTZXQgRUNJLCBhY2NvcmRpbmcgdG8gIkV4dGVuZGVkIENoYW5uZWwgSW50ZXJwcmV0YXRpb25zIiA1LjMuMS4xCgkgKiBvZiBJU08gMTgwMDQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIENoYXJhY3RlclNldEVDSSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBDaGFyYWN0ZXJTZXRFQ0kodmFsdWVJZGVudGlmaWVyLCB2YWx1ZXNQYXJhbSwgbmFtZSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG90aGVyRW5jb2RpbmdOYW1lcyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgb3RoZXJFbmNvZGluZ05hbWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmFsdWVJZGVudGlmaWVyID0gdmFsdWVJZGVudGlmaWVyOwoJICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwoJICAgICAgICBpZiAodHlwZW9mIHZhbHVlc1BhcmFtID09PSAnbnVtYmVyJykgewoJICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBJbnQzMkFycmF5LmZyb20oW3ZhbHVlc1BhcmFtXSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlc1BhcmFtOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzOwoJICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVfSURFTlRJRklFUl9UT19FQ0kuc2V0KHZhbHVlSWRlbnRpZmllciwgdGhpcyk7CgkgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQobmFtZSwgdGhpcyk7CgkgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlczsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNbaV07CgkgICAgICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVTX1RPX0VDSS5zZXQodiwgdGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIG90aGVyRW5jb2RpbmdOYW1lc18xID0gX192YWx1ZXMob3RoZXJFbmNvZGluZ05hbWVzKSwgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKTsgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZTsgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBvdGhlck5hbWUgPSBvdGhlckVuY29kaW5nTmFtZXNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQob3RoZXJOYW1lLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKG90aGVyRW5jb2RpbmdOYW1lc18xXzEgJiYgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZSAmJiAoX2EgPSBvdGhlckVuY29kaW5nTmFtZXNfMS5yZXR1cm4pKSBfYS5jYWxsKG90aGVyRW5jb2RpbmdOYW1lc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgIH0KCSAgICAvLyBDaGFyYWN0ZXJTZXRFQ0kodmFsdWU6IG51bWJlciAvKmludCovKSB7CgkgICAgLy8gICB0aGlzKG5ldyBJbnQzMkFycmF5IHt2YWx1ZX0pCgkgICAgLy8gfQoJICAgIC8vIENoYXJhY3RlclNldEVDSSh2YWx1ZTogbnVtYmVyIC8qaW50Ki8sIFN0cmluZy4uLiBvdGhlckVuY29kaW5nTmFtZXMpIHsKCSAgICAvLyAgIHRoaXMudmFsdWVzID0gbmV3IEludDMyQXJyYXkge3ZhbHVlfQoJICAgIC8vICAgdGhpcy5vdGhlckVuY29kaW5nTmFtZXMgPSBvdGhlckVuY29kaW5nTmFtZXMKCSAgICAvLyB9CgkgICAgLy8gQ2hhcmFjdGVyU2V0RUNJKHZhbHVlczogSW50MzJBcnJheSwgU3RyaW5nLi4uIG90aGVyRW5jb2RpbmdOYW1lcykgewoJICAgIC8vICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMKCSAgICAvLyAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzCgkgICAgLy8gfQoJICAgIENoYXJhY3RlclNldEVDSS5wcm90b3R5cGUuZ2V0VmFsdWVJZGVudGlmaWVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUlkZW50aWZpZXI7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm5hbWU7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbMF07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmFsdWUgY2hhcmFjdGVyIHNldCBFQ0kgdmFsdWUKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBDaGFyYWN0ZXJTZXRFQ0l9IHJlcHJlc2VudGluZyBFQ0kgb2YgZ2l2ZW4gdmFsdWUsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwgYnV0CgkgICAgICogICB1bnN1cHBvcnRlZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIEVDSSB2YWx1ZSBpcyBpbnZhbGlkCgkgICAgICovCgkgICAgQ2hhcmFjdGVyU2V0RUNJLmdldENoYXJhY3RlclNldEVDSUJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID49IDkwMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGNoYXJhY3RlclNldCA9IENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJLmdldCh2YWx1ZSk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNoYXJhY3RlclNldCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGNoYXJhY3RlclNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBuYW1lIGNoYXJhY3RlciBzZXQgRUNJIGVuY29kaW5nIG5hbWUKCSAgICAgKiBAcmV0dXJuIENoYXJhY3RlclNldEVDSSByZXByZXNlbnRpbmcgRUNJIGZvciBjaGFyYWN0ZXIgZW5jb2RpbmcsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwKCSAgICAgKiAgIGJ1dCB1bnN1cHBvcnRlZAoJICAgICAqLwoJICAgIENoYXJhY3RlclNldEVDSS5nZXRDaGFyYWN0ZXJTZXRFQ0lCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gQ2hhcmFjdGVyU2V0RUNJLk5BTUVfVE9fRUNJLmdldChuYW1lKTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgnaW5jb3JlY3QgdmFsdWUnKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY2hhcmFjdGVyU2V0OwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgQ2hhcmFjdGVyU2V0RUNJKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKSA9PT0gb3RoZXIuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlZBTFVFX0lERU5USUZJRVJfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSSA9IG5ldyBNYXAoKTsKCSAgICAvLyBFbnVtIG5hbWUgaXMgYSBKYXZhIGVuY29kaW5nIHZhbGlkIGZvciBqYXZhLmxhbmcgYW5kIGphdmEuaW8KCSAgICAvLyBUWVBFU0NSSVBUUE9SVDogY2hhbmdlZCB0aGUgbWFpbiBsYWJlbCBmb3IgSVNPIGFzIHRoZSBUZXh0RW5jb2RlciBkaWQgbm90IHJlY29nbml6ZWQgdGhlbSBpbiB0aGUgZm9ybSBmcm9tIGphdmEKCSAgICAvLyAoZWcgSVNPODg1OV8xIG11c3QgYmUgSVNPODg1OTEgb3IgSVNPODg1OS0xIG9yIElTTy04ODU5LTEpCgkgICAgLy8gbGF0ZXIgb246IHdlbGwsIGV4Y2VwdCAxNiB3aWNoIGRvZXMgbm90IHdvcmsgd2l0aCBJU084ODU5MTYgc28gdXNlZCBJU08tODg1OS0xIGZvcm0gZm9yIGRlZmF1bHQKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3A0MzcgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3A0MzcsIEludDMyQXJyYXkuZnJvbShbMCwgMl0pLCAnQ3A0MzcnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMSwgSW50MzJBcnJheS5mcm9tKFsxLCAzXSksICdJU08tODg1OS0xJywgJ0lTTzg4NTkxJywgJ0lTTzg4NTlfMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzIgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8yLCA0LCAnSVNPLTg4NTktMicsICdJU084ODU5MicsICdJU084ODU5XzInKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8zID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMywgNSwgJ0lTTy04ODU5LTMnLCAnSVNPODg1OTMnLCAnSVNPODg1OV8zJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzQsIDYsICdJU08tODg1OS00JywgJ0lTTzg4NTk0JywgJ0lTTzg4NTlfNCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV81LCA3LCAnSVNPLTg4NTktNScsICdJU084ODU5NScsICdJU084ODU5XzUnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV82ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfNiwgOCwgJ0lTTy04ODU5LTYnLCAnSVNPODg1OTYnLCAnSVNPODg1OV82Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzcsIDksICdJU08tODg1OS03JywgJ0lTTzg4NTk3JywgJ0lTTzg4NTlfNycpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV84LCAxMCwgJ0lTTy04ODU5LTgnLCAnSVNPODg1OTgnLCAnSVNPODg1OV84Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfOSA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzksIDExLCAnSVNPLTg4NTktOScsICdJU084ODU5OScsICdJU084ODU5XzknKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xMCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzEwLCAxMiwgJ0lTTy04ODU5LTEwJywgJ0lTTzg4NTkxMCcsICdJU084ODU5XzEwJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xMSwgMTMsICdJU08tODg1OS0xMScsICdJU084ODU5MTEnLCAnSVNPODg1OV8xMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzEzID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTMsIDE1LCAnSVNPLTg4NTktMTMnLCAnSVNPODg1OTEzJywgJ0lTTzg4NTlfMTMnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzE0LCAxNiwgJ0lTTy04ODU5LTE0JywgJ0lTTzg4NTkxNCcsICdJU084ODU5XzE0Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xNSwgMTcsICdJU08tODg1OS0xNScsICdJU084ODU5MTUnLCAnSVNPODg1OV8xNScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzE2ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTYsIDE4LCAnSVNPLTg4NTktMTYnLCAnSVNPODg1OTE2JywgJ0lTTzg4NTlfMTYnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuU0pJUyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5TSklTLCAyMCwgJ1NKSVMnLCAnU2hpZnRfSklTJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1MCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTAsIDIxLCAnQ3AxMjUwJywgJ3dpbmRvd3MtMTI1MCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5DcDEyNTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3AxMjUxLCAyMiwgJ0NwMTI1MScsICd3aW5kb3dzLTEyNTEnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3AxMjUyID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkNwMTI1MiwgMjMsICdDcDEyNTInLCAnd2luZG93cy0xMjUyJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1NiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTYsIDI0LCAnQ3AxMjU2JywgJ3dpbmRvd3MtMTI1NicpOwoJICAgIENoYXJhY3RlclNldEVDSS5Vbmljb2RlQmlnVW5tYXJrZWQgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVW5pY29kZUJpZ1VubWFya2VkLCAyNSwgJ1VuaWNvZGVCaWdVbm1hcmtlZCcsICdVVEYtMTZCRScsICdVbmljb2RlQmlnJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlVURjggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVVRGOCwgMjYsICdVVEY4JywgJ1VURi04Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkFTQ0lJID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkFTQ0lJLCBJbnQzMkFycmF5LmZyb20oWzI3LCAxNzBdKSwgJ0FTQ0lJJywgJ1VTLUFTQ0lJJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkJpZzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQmlnNSwgMjgsICdCaWc1Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkdCMTgwMzAgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuR0IxODAzMCwgMjksICdHQjE4MDMwJywgJ0dCMjMxMicsICdFVUNfQ04nLCAnR0JLJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkVVQ19LUiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5FVUNfS1IsIDMwLCAnRVVDX0tSJywgJ0VVQy1LUicpOwoJICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0k7Cgl9KCkpOwoJZXhwb3J0cy5kZWZhdWx0ID0gQ2hhcmFjdGVyU2V0RUNJOwoKCX0oQ2hhcmFjdGVyU2V0RUNJKSk7CgoJdmFyIFN0cmluZ0VuY29kaW5nJDEgPSB7fTsKCgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNiA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbi5raW5kID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCkpOwoJVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMS5kZWZhdWx0ID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ0VuY29kaW5nJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEgPSBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxOwoJdmFyIENoYXJhY3RlclNldEVDSV8xJDIgPSBDaGFyYWN0ZXJTZXRFQ0k7CgkvKioKCSAqIFJlc3BvbnNpYmxlIGZvciBlbi9kZWNvZGluZyBzdHJpbmdzLgoJICovCgl2YXIgU3RyaW5nRW5jb2RpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nRW5jb2RpbmcoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIERlY29kZXMgc29tZSBVaW50OEFycmF5IHRvIGEgc3RyaW5nIGZvcm1hdC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5kZWNvZGUgPSBmdW5jdGlvbiAoYnl0ZXMsIGVuY29kaW5nKSB7CgkgICAgICAgIHZhciBlbmNvZGluZ05hbWUgPSB0aGlzLmVuY29kaW5nTmFtZShlbmNvZGluZyk7CgkgICAgICAgIGlmICh0aGlzLmN1c3RvbURlY29kZXIpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURlY29kZXIoYnl0ZXMsIGVuY29kaW5nTmFtZSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSW5jcmVhc2VzIGJyb3dzZXIgc3VwcG9ydC4KCSAgICAgICAgaWYgKHR5cGVvZiBUZXh0RGVjb2RlciA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5zaG91bGREZWNvZGVPbkZhbGxiYWNrKGVuY29kaW5nTmFtZSkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUZhbGxiYWNrKGJ5dGVzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmdOYW1lKS5kZWNvZGUoYnl0ZXMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ2hlY2tzIGlmIHRoZSBkZWNvZGluZyBtZXRob2Qgc2hvdWxkIHVzZSB0aGUgZmFsbGJhY2sgZm9yIGRlY29kaW5nCgkgICAgICogb25jZSBOb2RlIFRleHREZWNvZGVyIGRvZXNuJ3Qgc3VwcG9ydCBhbGwgZW5jb2RpbmcgZm9ybWF0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBlbmNvZGluZ05hbWUKCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5zaG91bGREZWNvZGVPbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVuY29kaW5nTmFtZSkgewoJICAgICAgICByZXR1cm4gIVN0cmluZ0VuY29kaW5nLmlzQnJvd3NlcigpICYmIGVuY29kaW5nTmFtZSA9PT0gJ0lTTy04ODU5LTEnOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRW5jb2RlcyBzb21lIHN0cmluZyBpbnRvIGEgVWludDhBcnJheS4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGUgPSBmdW5jdGlvbiAocywgZW5jb2RpbmcpIHsKCSAgICAgICAgdmFyIGVuY29kaW5nTmFtZSA9IHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKTsKCSAgICAgICAgaWYgKHRoaXMuY3VzdG9tRW5jb2RlcikgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tRW5jb2RlcihzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEluY3JlYXNlcyBicm93c2VyIHN1cHBvcnQuCgkgICAgICAgIGlmICh0eXBlb2YgVGV4dEVuY29kZXIgPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVGYWxsYmFjayhzKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBUZXh0RW5jb2RlciBvbmx5IGVuY29kZXMgdG8gVVRGOCBieSBkZWZhdWx0IGFzIHNwZWNpZmllZCBieSBlbmNvZGluZy5zcGVjLndoYXR3Zy5vcmcKCSAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHdpbmRvdykgPT09ICdbb2JqZWN0IFdpbmRvd10nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHN0cmluZyB2YWx1ZSBmcm9tIHNvbWUgZW5jb2RpbmcgY2hhcmFjdGVyIHNldC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGluZ05hbWUgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycKCSAgICAgICAgICAgID8gZW5jb2RpbmcKCSAgICAgICAgICAgIDogZW5jb2RpbmcuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBjaGFyYWN0ZXIgc2V0IGZyb20gc29tZSBlbmNvZGluZyBjaGFyYWN0ZXIgc2V0LgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmVuY29kaW5nQ2hhcmFjdGVyU2V0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7CgkgICAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdCkgewoJICAgICAgICAgICAgcmV0dXJuIGVuY29kaW5nOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlOYW1lKGVuY29kaW5nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJ1bnMgYSBmYWxsYmFjayBmb3IgdGhlIG5hdGl2ZSBkZWNvZGluZyBmdW5jaW9uLgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmRlY29kZUZhbGxiYWNrID0gZnVuY3Rpb24gKGJ5dGVzLCBlbmNvZGluZykgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gdGhpcy5lbmNvZGluZ0NoYXJhY3RlclNldChlbmNvZGluZyk7CgkgICAgICAgIGlmIChTdHJpbmdFbmNvZGluZy5pc0RlY29kZUZhbGxiYWNrU3VwcG9ydGVkKGNoYXJhY3RlclNldCkpIHsKCSAgICAgICAgICAgIHZhciBzID0gJyc7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBieXRlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGggPSBieXRlc1tpXS50b1N0cmluZygxNik7CgkgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikgewoJICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcyArPSAnJScgKyBoOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuVW5pY29kZUJpZ1VubWFya2VkKSkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQxNkFycmF5KGJ5dGVzLmJ1ZmZlcikpOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgiRW5jb2RpbmcgIiArIHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKSArICIgbm90IHN1cHBvcnRlZCBieSBmYWxsYmFjay4iKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzRGVjb2RlRmFsbGJhY2tTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgIHJldHVybiBjaGFyYWN0ZXJTZXQuZXF1YWxzKENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdC5VVEY4KSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuSVNPODg1OV8xKSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuQVNDSUkpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUnVucyBhIGZhbGxiYWNrIGZvciB0aGUgbmF0aXZlIGVuY29kaW5nIGZ1bmNpb24uCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNzE5Mjg0NS80MzY3NjgzCgkgICAgICovCgkgICAgU3RyaW5nRW5jb2RpbmcuZW5jb2RlRmFsbGJhY2sgPSBmdW5jdGlvbiAocykgewoJICAgICAgICB2YXIgZW5jb2RlZFVSSXN0cmluZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHMpKSk7CgkgICAgICAgIHZhciBjaGFyTGlzdCA9IGVuY29kZWRVUklzdHJpbmcuc3BsaXQoJycpOwoJICAgICAgICB2YXIgdWludEFycmF5ID0gW107CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckxpc3QubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHVpbnRBcnJheS5wdXNoKGNoYXJMaXN0W2ldLmNoYXJDb2RlQXQoMCkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh1aW50QXJyYXkpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0VuY29kaW5nOwoJfSgpKTsKCVN0cmluZ0VuY29kaW5nJDEuZGVmYXVsdCA9IFN0cmluZ0VuY29kaW5nOwoKCS8qCgkgKiBDb3B5cmlnaHQgKEMpIDIwMTAgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ1V0aWxzJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS5uaW8uY2hhcnNldC5DaGFyc2V0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQzID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSQxID0gQ2hhcmFjdGVyU2V0RUNJOwoJdmFyIFN0cmluZ0VuY29kaW5nXzEkMSA9IFN0cmluZ0VuY29kaW5nJDE7CgkvKioKCSAqIENvbW1vbiBzdHJpbmctcmVsYXRlZCBmdW5jdGlvbnMuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgQWxleCBEdXByZQoJICovCgl2YXIgU3RyaW5nVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nVXRpbHMoKSB7CgkgICAgfQoJICAgIC8vIFNISUZUX0pJUy5lcXVhbHNJZ25vcmVDYXNlKFBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcpIHx8CgkgICAgLy8gRVVDX0pQLmVxdWFsc0lnbm9yZUNhc2UoUExBVEZPUk1fREVGQVVMVF9FTkNPRElORyk7CgkgICAgU3RyaW5nVXRpbHMuY2FzdEFzTm9uVXRmOENoYXIgPSBmdW5jdGlvbiAoY29kZSwgZW5jb2RpbmcpIHsKCSAgICAgICAgaWYgKGVuY29kaW5nID09PSB2b2lkIDApIHsgZW5jb2RpbmcgPSBudWxsOyB9CgkgICAgICAgIC8vIElTTyA4ODU5LTEgaXMgdGhlIEphdmEgZGVmYXVsdCBhcyBVVEYtOCBpcyBKYXZhU2NyaXB0cwoJICAgICAgICAvLyB5b3UgY2FuIHNlZSB0aGlzIG1ldGhvZCBhcyBhIEphdmEgdmVyc2lvbiBvZiBTdHJpbmcuZnJvbUNoYXJDb2RlCgkgICAgICAgIHZhciBlID0gZW5jb2RpbmcgPyBlbmNvZGluZy5nZXROYW1lKCkgOiB0aGlzLklTTzg4NTkxOwoJICAgICAgICAvLyB1c2UgcGFzc2VkIGZvcm1hdCAoZnJvbUNoYXJDb2RlIHdpbGwgcmV0dXJuIFVURjggZW5jb2RpbmcpCgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2NvZGVdKSwgZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYnl0ZXMgYnl0ZXMgZW5jb2RpbmcgYSBzdHJpbmcsIHdob3NlIGVuY29kaW5nIHNob3VsZCBiZSBndWVzc2VkCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kZSBoaW50cyBpZiBhcHBsaWNhYmxlCgkgICAgICogQHJldHVybiBuYW1lIG9mIGd1ZXNzZWQgZW5jb2Rpbmc7IGF0IHRoZSBtb21lbnQgd2lsbCBvbmx5IGd1ZXNzIG9uZSBvZjoKCSAgICAgKiAge0BsaW5rICNTSElGVF9KSVN9LCB7QGxpbmsgI1VURjh9LCB7QGxpbmsgI0lTTzg4NTkxfSwgb3IgdGhlIHBsYXRmb3JtCgkgICAgICogIGRlZmF1bHQgZW5jb2RpbmcgaWYgbm9uZSBvZiB0aGVzZSBjYW4gcG9zc2libHkgYmUgY29ycmVjdAoJICAgICAqLwoJICAgIFN0cmluZ1V0aWxzLmd1ZXNzRW5jb2RpbmcgPSBmdW5jdGlvbiAoYnl0ZXMsIGhpbnRzKSB7CgkgICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpKSB7CgkgICAgICAgICAgICByZXR1cm4gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpLnRvU3RyaW5nKCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRm9yIG5vdywgbWVyZWx5IHRyaWVzIHRvIGRpc3Rpbmd1aXNoIElTTy04ODU5LTEsIFVURi04IGFuZCBTaGlmdF9KSVMsCgkgICAgICAgIC8vIHdoaWNoIHNob3VsZCBiZSBieSBmYXIgdGhlIG1vc3QgY29tbW9uIGVuY29kaW5ncy4KCSAgICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKCSAgICAgICAgdmFyIGNhbkJlSVNPODg1OTEgPSB0cnVlOwoJICAgICAgICB2YXIgY2FuQmVTaGlmdEpJUyA9IHRydWU7CgkgICAgICAgIHZhciBjYW5CZVVURjggPSB0cnVlOwoJICAgICAgICB2YXIgdXRmOEJ5dGVzTGVmdCA9IDA7CgkgICAgICAgIC8vIGludCB1dGY4TG93Q2hhcnMgPSAwCgkgICAgICAgIHZhciB1dGYyQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGYzQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGY0Qnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciBzamlzQnl0ZXNMZWZ0ID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNMb3dDaGFycyA9IDAKCSAgICAgICAgdmFyIHNqaXNLYXRha2FuYUNoYXJzID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNEb3VibGVCeXRlc0NoYXJzID0gMAoJICAgICAgICB2YXIgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgIHZhciBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgdmFyIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSAwOwoJICAgICAgICB2YXIgc2ppc01heERvdWJsZUJ5dGVzV29yZExlbmd0aCA9IDA7CgkgICAgICAgIC8vIGludCBpc29Mb3dDaGFycyA9IDAKCSAgICAgICAgLy8gaW50IGlzb0hpZ2hDaGFycyA9IDAKCSAgICAgICAgdmFyIGlzb0hpZ2hPdGhlciA9IDA7CgkgICAgICAgIHZhciB1dGY4Ym9tID0gYnl0ZXMubGVuZ3RoID4gMyAmJgoJICAgICAgICAgICAgYnl0ZXNbMF0gPT09IC8qKGJ5dGUpICovIDB4RUYgJiYKCSAgICAgICAgICAgIGJ5dGVzWzFdID09PSAvKihieXRlKSAqLyAweEJCICYmCgkgICAgICAgICAgICBieXRlc1syXSA9PT0gLyooYnl0ZSkgKi8gMHhCRjsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgKGNhbkJlSVNPODg1OTEgfHwgY2FuQmVTaGlmdEpJUyB8fCBjYW5CZVVURjgpOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJ5dGVzW2ldICYgMHhGRjsKCSAgICAgICAgICAgIC8vIFVURi04IHN0dWZmCgkgICAgICAgICAgICBpZiAoY2FuQmVVVEY4KSB7CgkgICAgICAgICAgICAgICAgaWYgKHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDgwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgY2FuQmVVVEY4ID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHZhbHVlICYgMHg4MCkgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4NDApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjhCeXRlc0xlZnQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDIwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjJCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4MTApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjNCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDA4KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRmNEJ5dGVzQ2hhcnMrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJlVVRGOCA9IGZhbHNlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSAvLyBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyB1dGY4TG93Q2hhcnMrKwoJICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIElTTy04ODU5LTEgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMHg3RiAmJiB2YWx1ZSA8IDB4QTApIHsKCSAgICAgICAgICAgICAgICAgICAgY2FuQmVJU084ODU5MSA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IDB4OUYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHhDMCB8fCB2YWx1ZSA9PT0gMHhENyB8fCB2YWx1ZSA9PT0gMHhGNykgewoJICAgICAgICAgICAgICAgICAgICAgICAgaXNvSGlnaE90aGVyKys7CgkgICAgICAgICAgICAgICAgICAgIH0gLy8gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIGlzb0hpZ2hDaGFycysrCgkgICAgICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgICAgICB9IC8vIGVsc2UgewoJICAgICAgICAgICAgICAgIC8vIGlzb0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAvLyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBTaGlmdF9KSVMgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTKSB7CgkgICAgICAgICAgICAgICAgaWYgKHNqaXNCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4NDAgfHwgdmFsdWUgPT09IDB4N0YgfHwgdmFsdWUgPiAweEZDKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVNoaWZ0SklTID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDB4ODAgfHwgdmFsdWUgPT09IDB4QTAgfHwgdmFsdWUgPiAweEVGKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhbkJlU2hpZnRKSVMgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAweEEwICYmIHZhbHVlIDwgMHhFMCkgewoJICAgICAgICAgICAgICAgICAgICBzamlzS2F0YWthbmFDaGFycysrOwoJICAgICAgICAgICAgICAgICAgICBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCsrOwoJICAgICAgICAgICAgICAgICAgICBpZiAoc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA+IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSBzamlzQ3VyS2F0YWthbmFXb3JkTGVuZ3RoOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMHg3RikgewoJICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgIC8vIHNqaXNEb3VibGVCeXRlc0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGgrKzsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPiBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gc2ppc0N1ckRvdWJsZUJ5dGVzV29yZExlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gc2ppc0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPSAwOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmIHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVTaGlmdEpJUyAmJiBzamlzQnl0ZXNMZWZ0ID4gMCkgewoJICAgICAgICAgICAgY2FuQmVTaGlmdEpJUyA9IGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhc3kgLS0gaWYgdGhlcmUgaXMgQk9NIG9yIGF0IGxlYXN0IDEgdmFsaWQgbm90LXNpbmdsZSBieXRlIGNoYXJhY3RlciAoYW5kIG5vIGV2aWRlbmNlIGl0IGNhbid0IGJlIFVURi04KSwgZG9uZQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmICh1dGY4Ym9tIHx8IHV0ZjJCeXRlc0NoYXJzICsgdXRmM0J5dGVzQ2hhcnMgKyB1dGY0Qnl0ZXNDaGFycyA+IDApKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuVVRGODsKCSAgICAgICAgfQoJICAgICAgICAvLyBFYXN5IC0tIGlmIGFzc3VtaW5nIFNoaWZ0X0pJUyBvciBhdCBsZWFzdCAzIHZhbGlkIGNvbnNlY3V0aXZlIG5vdC1hc2NpaSBjaGFyYWN0ZXJzIChhbmQgbm8gZXZpZGVuY2UgaXQgY2FuJ3QgYmUpLCBkb25lCgkgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTICYmIChTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTIHx8IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPj0gMyB8fCBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID49IDMpKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuU0hJRlRfSklTOwoJICAgICAgICB9CgkgICAgICAgIC8vIERpc3Rpbmd1aXNoaW5nIFNoaWZ0X0pJUyBhbmQgSVNPLTg4NTktMSBjYW4gYmUgYSBsaXR0bGUgdG91Z2ggZm9yIHNob3J0IHdvcmRzLiBUaGUgY3J1ZGUgaGV1cmlzdGljIGlzOgoJICAgICAgICAvLyAtIElmIHdlIHNhdwoJICAgICAgICAvLyAgIC0gb25seSB0d28gY29uc2VjdXRpdmUga2F0YWthbmEgY2hhcnMgaW4gdGhlIHdob2xlIHRleHQsIG9yCgkgICAgICAgIC8vICAgLSBhdCBsZWFzdCAxMCUgb2YgYnl0ZXMgdGhhdCBjb3VsZCBiZSAidXBwZXIiIG5vdC1hbHBoYW51bWVyaWMgTGF0aW4xLAoJICAgICAgICAvLyAtIHRoZW4gd2UgY29uY2x1ZGUgU2hpZnRfSklTLCBlbHNlIElTTy04ODU5LTEKCSAgICAgICAgaWYgKGNhbkJlSVNPODg1OTEgJiYgY2FuQmVTaGlmdEpJUykgewoJICAgICAgICAgICAgcmV0dXJuIChzamlzTWF4S2F0YWthbmFXb3JkTGVuZ3RoID09PSAyICYmIHNqaXNLYXRha2FuYUNoYXJzID09PSAyKSB8fCBpc29IaWdoT3RoZXIgKiAxMCA+PSBsZW5ndGgKCSAgICAgICAgICAgICAgICA/IFN0cmluZ1V0aWxzLlNISUZUX0pJUyA6IFN0cmluZ1V0aWxzLklTTzg4NTkxOwoJICAgICAgICB9CgkgICAgICAgIC8vIE90aGVyd2lzZSwgdHJ5IGluIG9yZGVyIElTTy04ODU5LTEsIFNoaWZ0IEpJUywgVVRGLTggYW5kIGZhbGwgYmFjayB0byBkZWZhdWx0IHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuSVNPODg1OTE7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlU2hpZnRKSVMpIHsKCSAgICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5TSElGVF9KSVM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlVVRGOCkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLlVURjg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0YWtlIGEgd2lsZCBndWVzcyB3aXRoIHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5QTEFURk9STV9ERUZBVUxUX0VOQ09ESU5HOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQzOTcxMS80MzY3NjgzCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYXBwZW5kIFRoZSBuZXcgc3RyaW5nIHRvIGFwcGVuZC4KCSAgICAgKiBAcGFyYW0gYXJncyBBcmd1bWV0cyB2YWx1ZXMgdG8gYmUgZm9ybWF0ZWQuCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZm9ybWF0ID0gZnVuY3Rpb24gKGFwcGVuZCkgewoJICAgICAgICB2YXIgYXJncyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaSA9IC0xOwoJICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhleHAsIHAwLCBwMSwgcDIsIHAzLCBwNCkgewoJICAgICAgICAgICAgaWYgKGV4cCA9PT0gJyUlJykKCSAgICAgICAgICAgICAgICByZXR1cm4gJyUnOwoJICAgICAgICAgICAgaWYgKGFyZ3NbKytpXSA9PT0gdW5kZWZpbmVkKQoJICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgICAgICAgICBleHAgPSBwMiA/IHBhcnNlSW50KHAyLnN1YnN0cigxKSkgOiB1bmRlZmluZWQ7CgkgICAgICAgICAgICB2YXIgYmFzZSA9IHAzID8gcGFyc2VJbnQocDMuc3Vic3RyKDEpKSA6IHVuZGVmaW5lZDsKCSAgICAgICAgICAgIHZhciB2YWw7CgkgICAgICAgICAgICBzd2l0Y2ggKHA0KSB7CgkgICAgICAgICAgICAgICAgY2FzZSAncyc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IGFyZ3NbaV07CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2MnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBhcmdzW2ldWzBdOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdmJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChhcmdzW2ldKS50b0ZpeGVkKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ3AnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvUHJlY2lzaW9uKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2UnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvRXhwb25lbnRpYWwoZXhwKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAneCc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KGFyZ3NbaV0pLnRvU3RyaW5nKGJhc2UgPyBiYXNlIDogMTYpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdkJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChwYXJzZUludChhcmdzW2ldLCBiYXNlID8gYmFzZSA6IDEwKS50b1ByZWNpc2lvbihleHApKS50b0ZpeGVkKDApOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsKSA6ICgrdmFsKS50b1N0cmluZyhiYXNlKTsKCSAgICAgICAgICAgIHZhciBzaXplID0gcGFyc2VJbnQocDEpOyAvKiBwYWRkaW5nIHNpemUgKi8KCSAgICAgICAgICAgIHZhciBjaCA9IHAxICYmIChwMVswXSArICcnKSA9PT0gJzAnID8gJzAnIDogJyAnOyAvKiBpc251bGw/ICovCgkgICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IHNpemUpCgkgICAgICAgICAgICAgICAgdmFsID0gcDAgIT09IHVuZGVmaW5lZCA/IHZhbCArIGNoIDogY2ggKyB2YWw7IC8qIGlzbWludXM/ICovCgkgICAgICAgICAgICByZXR1cm4gdmFsOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZWdleCA9IC8lKC0pPygwP1swLTldKyk/KFsuXVswLTldKyk/KFsjXVswLTldKyk/KFtzY2ZwZXhkJV0pL2c7CgkgICAgICAgIHJldHVybiBhcHBlbmQucmVwbGFjZShyZWdleCwgY2FsbGJhY2spOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRCeXRlcyA9IGZ1bmN0aW9uIChzdHIsIGVuY29kaW5nKSB7CgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5lbmNvZGUoc3RyLCBlbmNvZGluZyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIHRoZSBjaGFyY29kZSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9yIGF0IGluZGV4IHplcm8uCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZ2V0Q2hhckNvZGUgPSBmdW5jdGlvbiAoc3RyLCBpbmRleCkgewoJICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH0KCSAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KGluZGV4KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgY2hhciBmb3IgZ2l2ZW4gY2hhcmNvZGUKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRDaGFyQXQgPSBmdW5jdGlvbiAoY2hhckNvZGUpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpOwoJICAgIH07CgkgICAgU3RyaW5nVXRpbHMuU0hJRlRfSklTID0gQ2hhcmFjdGVyU2V0RUNJXzEkMS5kZWZhdWx0LlNKSVMuZ2V0TmFtZSgpOyAvLyAiU0pJUyIKCSAgICBTdHJpbmdVdGlscy5HQjIzMTIgPSAnR0IyMzEyJzsKCSAgICBTdHJpbmdVdGlscy5JU084ODU5MSA9IENoYXJhY3RlclNldEVDSV8xJDEuZGVmYXVsdC5JU084ODU5XzEuZ2V0TmFtZSgpOyAvLyAiSVNPODg1OV8xIgoJICAgIFN0cmluZ1V0aWxzLkVVQ19KUCA9ICdFVUNfSlAnOwoJICAgIFN0cmluZ1V0aWxzLlVURjggPSBDaGFyYWN0ZXJTZXRFQ0lfMSQxLmRlZmF1bHQuVVRGOC5nZXROYW1lKCk7IC8vICJVVEY4IgoJICAgIFN0cmluZ1V0aWxzLlBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcgPSBTdHJpbmdVdGlscy5VVEY4OyAvLyAiVVRGOCIvL0NoYXJzZXQuZGVmYXVsdENoYXJzZXQoKS5uYW1lKCkKCSAgICBTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTID0gZmFsc2U7CgkgICAgcmV0dXJuIFN0cmluZ1V0aWxzOwoJfSgpKTsKCVN0cmluZ1V0aWxzJDEuZGVmYXVsdCA9IFN0cmluZ1V0aWxzOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmdCdWlsZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBTdHJpbmdVdGlsc18xJDEgPSBTdHJpbmdVdGlscyQxOwoJdmFyIFN0cmluZ0J1aWxkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nQnVpbGRlcih2YWx1ZSkgewoJICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9CgkgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCSAgICB9CgkgICAgU3RyaW5nQnVpbGRlci5wcm90b3R5cGUuZW5hYmxlRGVjb2RpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHsKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gcy50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHRoaXMuZW5jb2RpbmcpIHsKCSAgICAgICAgICAgIC8vIHVzZSBwYXNzZWQgZm9ybWF0IChmcm9tQ2hhckNvZGUgd2lsbCByZXR1cm4gVVRGOCBlbmNvZGluZykKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nVXRpbHNfMSQxLmRlZmF1bHQuY2FzdEFzTm9uVXRmOENoYXIocywgdGhpcy5lbmNvZGluZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBjb3JyZWN0bHkgY29udmVydHMgZnJvbSBVVEYtOCwgYnV0IG5vdCBvdGhlciBlbmNvZGluZ3MKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZENoYXJzID0gZnVuY3Rpb24gKHN0ciwgb2Zmc2V0LCBsZW4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IG9mZnNldDsgb2Zmc2V0IDwgb2Zmc2V0ICsgbGVuOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kKHN0cltpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmxlbmd0aDsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNoYXJBdChuKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmRlbGV0ZUNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIHRoaXMudmFsdWUuc3Vic3RyaW5nKG4gKyAxKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnNldENoYXJBdCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgMSk7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zdWJzdHJpbmcgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAbm90ZSBoZWxwZXIgbWV0aG9kIGZvciBSU1MgRXhwYW5kZWQKCSAgICAgKi8KCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zZXRMZW5ndGhUb1plcm8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSAnJzsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgYy5sZW5ndGgpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0J1aWxkZXI7Cgl9KCkpOwoJU3RyaW5nQnVpbGRlciQxLmRlZmF1bHQgPSBTdHJpbmdCdWlsZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQml0TWF0cml4JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIEJpdEFycmF5XzEkMSA9IEJpdEFycmF5JDE7Cgl2YXIgU3lzdGVtXzEkMyA9IFN5c3RlbSQxOwoJdmFyIEFycmF5c18xID0gQXJyYXlzJDE7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDIgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNyA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgMkQgbWF0cml4IG9mIGJpdHMuIEluIGZ1bmN0aW9uIGFyZ3VtZW50cyBiZWxvdywgYW5kIHRocm91Z2hvdXQgdGhlIGNvbW1vbgoJICogbW9kdWxlLCB4IGlzIHRoZSBjb2x1bW4gcG9zaXRpb24sIGFuZCB5IGlzIHRoZSByb3cgcG9zaXRpb24uIFRoZSBvcmRlcmluZyBpcyBhbHdheXMgeCwgeS4KCSAqIFRoZSBvcmlnaW4gaXMgYXQgdGhlIHRvcC1sZWZ0LjwvcD4KCSAqCgkgKiA8cD5JbnRlcm5hbGx5IHRoZSBiaXRzIGFyZSByZXByZXNlbnRlZCBpbiBhIDEtRCBhcnJheSBvZiAzMi1iaXQgaW50cy4gSG93ZXZlciwgZWFjaCByb3cgYmVnaW5zCgkgKiB3aXRoIGEgbmV3IGludC4gVGhpcyBpcyBkb25lIGludGVudGlvbmFsbHkgc28gdGhhdCB3ZSBjYW4gY29weSBvdXQgYSByb3cgaW50byBhIEJpdEFycmF5IHZlcnkKCSAqIGVmZmljaWVudGx5LjwvcD4KCSAqCgkgKiA8cD5UaGUgb3JkZXJpbmcgb2YgYml0cyBpcyByb3ctbWFqb3IuIFdpdGhpbiBlYWNoIGludCwgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdHMgYXJlIHVzZWQgZmlyc3QsCgkgKiBtZWFuaW5nIHRoZXkgcmVwcmVzZW50IGxvd2VyIHggdmFsdWVzLiBUaGlzIGlzIGNvbXBhdGlibGUgd2l0aCBCaXRBcnJheSdzIGltcGxlbWVudGF0aW9uLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpdE1hdHJpeCAvKmltcGxlbWVudHMgQ2xvbmVhYmxlKi8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSBzcXVhcmUge0BsaW5rIEJpdE1hdHJpeH0uCgkgICAgICoKCSAgICAgKiBAcGFyYW0gZGltZW5zaW9uIGhlaWdodCBhbmQgd2lkdGgKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoZGltZW5zaW9uOiBudW1iZXIgLyppbnQqLykgewoJICAgIC8vICAgdGhpcyhkaW1lbnNpb24sIGRpbWVuc2lvbikKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSB7QGxpbmsgQml0TWF0cml4fS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB3aWR0aCBiaXQgbWF0cml4IHdpZHRoCgkgICAgICogQHBhcmFtIGhlaWdodCBiaXQgbWF0cml4IGhlaWdodAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyIC8qaW50Ki8sIGhlaWdodDogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewoJICAgIC8vICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJCb3RoIGRpbWVuc2lvbnMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCIpCgkgICAgLy8gICB9CgkgICAgLy8gICB0aGlzLndpZHRoID0gd2lkdGgKCSAgICAvLyAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0CgkgICAgLy8gICB0aGlzLnJvd1NpemUgPSAod2lkdGggKyAzMSkgLyAzMgoJICAgIC8vICAgYml0cyA9IG5ldyBpbnRbcm93U2l6ZSAqIGhlaWdodF07CgkgICAgLy8gfQoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeCh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgcm93U2l6ZSAvKmludCovLCBiaXRzKSB7CgkgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKCSAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CgkgICAgICAgIHRoaXMucm93U2l6ZSA9IHJvd1NpemU7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGhlaWdodCB8fCBudWxsID09PSBoZWlnaHQpIHsKCSAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgICAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0JvdGggZGltZW5zaW9ucyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gcm93U2l6ZSB8fCBudWxsID09PSByb3dTaXplKSB7CgkgICAgICAgICAgICByb3dTaXplID0gTWF0aC5mbG9vcigod2lkdGggKyAzMSkgLyAzMik7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yb3dTaXplID0gcm93U2l6ZTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICB0aGlzLmJpdHMgPSBuZXcgSW50MzJBcnJheSh0aGlzLnJvd1NpemUgKiB0aGlzLmhlaWdodCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogSW50ZXJwcmV0cyBhIDJEIGFycmF5IG9mIGJvb2xlYW5zIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0sIHdoZXJlICJ0cnVlIiBtZWFucyBhbiAib24iIGJpdC4KCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBpbWFnZSBiaXRzIG9mIHRoZSBpbWFnZSwgYXMgYSByb3ctbWFqb3IgMkQgYXJyYXkuIEVsZW1lbnRzIGFyZSBhcnJheXMgcmVwcmVzZW50aW5nIHJvd3MKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCaXRNYXRyaXh9IHJlcHJlc2VudGF0aW9uIG9mIGltYWdlCgkgICAgICovCgkgICAgQml0TWF0cml4LnBhcnNlRnJvbUJvb2xlYW5BcnJheSA9IGZ1bmN0aW9uIChpbWFnZSkgewoJICAgICAgICB2YXIgaGVpZ2h0ID0gaW1hZ2UubGVuZ3RoOwoJICAgICAgICB2YXIgd2lkdGggPSBpbWFnZVswXS5sZW5ndGg7CgkgICAgICAgIHZhciBiaXRzID0gbmV3IEJpdE1hdHJpeCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGltYWdlSSA9IGltYWdlW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CgkgICAgICAgICAgICAgICAgaWYgKGltYWdlSVtqXSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldChqLCBpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBzdHJpbmdSZXByZXNlbnRhdGlvbgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcKCSAgICAgKiBAcGFyYW0gdW5zZXRTdHJpbmcKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucGFyc2VGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZ1JlcHJlc2VudGF0aW9uLCBzZXRTdHJpbmcsIHVuc2V0U3RyaW5nKSB7CgkgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnc3RyaW5nUmVwcmVzZW50YXRpb24gY2Fubm90IGJlIG51bGwnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBBcnJheShzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpOwoJICAgICAgICB2YXIgYml0c1BvcyA9IDA7CgkgICAgICAgIHZhciByb3dTdGFydFBvcyA9IDA7CgkgICAgICAgIHZhciByb3dMZW5ndGggPSAtMTsKCSAgICAgICAgdmFyIG5Sb3dzID0gMDsKCSAgICAgICAgdmFyIHBvcyA9IDA7CgkgICAgICAgIHdoaWxlIChwb3MgPCBzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpIHsKCSAgICAgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbi5jaGFyQXQocG9zKSA9PT0gJ1xuJyB8fAoJICAgICAgICAgICAgICAgIHN0cmluZ1JlcHJlc2VudGF0aW9uLmNoYXJBdChwb3MpID09PSAnXHInKSB7CgkgICAgICAgICAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAocm93TGVuZ3RoID09PSAtMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcm93TGVuZ3RoID0gYml0c1BvcyAtIHJvd1N0YXJ0UG9zOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJpdHNQb3MgLSByb3dTdGFydFBvcyAhPT0gcm93TGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdyb3cgbGVuZ3RocyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByb3dTdGFydFBvcyA9IGJpdHNQb3M7CgkgICAgICAgICAgICAgICAgICAgIG5Sb3dzKys7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHBvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nUmVwcmVzZW50YXRpb24uc3Vic3RyaW5nKHBvcywgcG9zICsgc2V0U3RyaW5nLmxlbmd0aCkgPT09IHNldFN0cmluZykgewoJICAgICAgICAgICAgICAgIHBvcyArPSBzZXRTdHJpbmcubGVuZ3RoOwoJICAgICAgICAgICAgICAgIGJpdHNbYml0c1Bvc10gPSB0cnVlOwoJICAgICAgICAgICAgICAgIGJpdHNQb3MrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHN0cmluZ1JlcHJlc2VudGF0aW9uLnN1YnN0cmluZyhwb3MsIHBvcyArIHVuc2V0U3RyaW5nLmxlbmd0aCkgPT09IHVuc2V0U3RyaW5nKSB7CgkgICAgICAgICAgICAgICAgcG9zICs9IHVuc2V0U3RyaW5nLmxlbmd0aDsKCSAgICAgICAgICAgICAgICBiaXRzW2JpdHNQb3NdID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgYml0c1BvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnaWxsZWdhbCBjaGFyYWN0ZXIgZW5jb3VudGVyZWQ6ICcgKyBzdHJpbmdSZXByZXNlbnRhdGlvbi5zdWJzdHJpbmcocG9zKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm8gRU9MIGF0IGVuZD8KCSAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgaWYgKHJvd0xlbmd0aCA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICByb3dMZW5ndGggPSBiaXRzUG9zIC0gcm93U3RhcnRQb3M7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmIChiaXRzUG9zIC0gcm93U3RhcnRQb3MgIT09IHJvd0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ3JvdyBsZW5ndGhzIGRvIG5vdCBtYXRjaCcpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgblJvd3MrKzsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbWF0cml4ID0gbmV3IEJpdE1hdHJpeChyb3dMZW5ndGgsIG5Sb3dzKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaXRzUG9zOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChiaXRzW2ldKSB7CgkgICAgICAgICAgICAgICAgbWF0cml4LnNldChNYXRoLmZsb29yKGkgJSByb3dMZW5ndGgpLCBNYXRoLmZsb29yKGkgLyByb3dMZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbWF0cml4OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+R2V0cyB0aGUgcmVxdWVzdGVkIGJpdCwgd2hlcmUgdHJ1ZSBtZWFucyBibGFjay48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0geCBUaGUgaG9yaXpvbnRhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggY29sdW1uKQoJICAgICAqIEBwYXJhbSB5IFRoZSB2ZXJ0aWNhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggcm93KQoJICAgICAqIEByZXR1cm4gdmFsdWUgb2YgZ2l2ZW4gYml0IGluIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHggLyppbnQqLywgeSAvKmludCovKSB7CgkgICAgICAgIHZhciBvZmZzZXQgPSB5ICogdGhpcy5yb3dTaXplICsgTWF0aC5mbG9vcih4IC8gMzIpOwoJICAgICAgICByZXR1cm4gKCh0aGlzLmJpdHNbb2Zmc2V0XSA+Pj4gKHggJiAweDFmKSkgJiAxKSAhPT0gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgdGhlIGdpdmVuIGJpdCB0byB0cnVlLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB4IFRoZSBob3Jpem9udGFsIGNvbXBvbmVudCAoaS5lLiB3aGljaCBjb2x1bW4pCgkgICAgICogQHBhcmFtIHkgVGhlIHZlcnRpY2FsIGNvbXBvbmVudCAoaS5lLiB3aGljaCByb3cpCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIHw9ICgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRjsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdICY9IH4oKDEgPDwgKHggJiAweDFmKSkgJiAweEZGRkZGRkZGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkZsaXBzIHRoZSBnaXZlbiBiaXQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHggVGhlIGhvcml6b250YWwgY29tcG9uZW50IChpLmUuIHdoaWNoIGNvbHVtbikKCSAgICAgKiBAcGFyYW0geSBUaGUgdmVydGljYWwgY29tcG9uZW50IChpLmUuIHdoaWNoIHJvdykKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIF49ICgoMSA8PCAoeCAmIDB4MWYpKSAmIDB4RkZGRkZGRkYpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRXhjbHVzaXZlLW9yIChYT1IpOiBGbGlwIHRoZSBiaXQgaW4gdGhpcyB7QGNvZGUgQml0TWF0cml4fSBpZiB0aGUgY29ycmVzcG9uZGluZwoJICAgICAqIG1hc2sgYml0IGlzIHNldC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBtYXNrIFhPUiBtYXNrCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAobWFzaykgewoJICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbWFzay5nZXRXaWR0aCgpIHx8IHRoaXMuaGVpZ2h0ICE9PSBtYXNrLmdldEhlaWdodCgpCgkgICAgICAgICAgICB8fCB0aGlzLnJvd1NpemUgIT09IG1hc2suZ2V0Um93U2l6ZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdpbnB1dCBtYXRyaXggZGltZW5zaW9ucyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcm93QXJyYXkgPSBuZXcgQml0QXJyYXlfMSQxLmRlZmF1bHQoTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gMzIpICsgMSk7CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIHZhciBvZmZzZXQgPSB5ICogcm93U2l6ZTsKCSAgICAgICAgICAgIHZhciByb3cgPSBtYXNrLmdldFJvdyh5LCByb3dBcnJheSkuZ2V0Qml0QXJyYXkoKTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgcm93U2l6ZTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgYml0c1tvZmZzZXQgKyB4XSBePSByb3dbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBtYXggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkrKykgewoJICAgICAgICAgICAgYml0c1tpXSA9IDA7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgYSBzcXVhcmUgcmVnaW9uIG9mIHRoZSBiaXQgbWF0cml4IHRvIHRydWUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGxlZnQgVGhlIGhvcml6b250YWwgcG9zaXRpb24gdG8gYmVnaW4gYXQgKGluY2x1c2l2ZSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiB0byBiZWdpbiBhdCAoaW5jbHVzaXZlKQoJICAgICAqIEBwYXJhbSB3aWR0aCBUaGUgd2lkdGggb2YgdGhlIHJlZ2lvbgoJICAgICAqIEBwYXJhbSBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgcmVnaW9uCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXRSZWdpb24gPSBmdW5jdGlvbiAobGVmdCAvKmludCovLCB0b3AgLyppbnQqLywgd2lkdGggLyppbnQqLywgaGVpZ2h0IC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHRvcCA8IDAgfHwgbGVmdCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0xlZnQgYW5kIHRvcCBtdXN0IGJlIG5vbm5lZ2F0aXZlJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlaWdodCA8IDEgfHwgd2lkdGggPCAxKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdIZWlnaHQgYW5kIHdpZHRoIG11c3QgYmUgYXQgbGVhc3QgMScpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDsKCSAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDsKCSAgICAgICAgaWYgKGJvdHRvbSA+IHRoaXMuaGVpZ2h0IHx8IHJpZ2h0ID4gdGhpcy53aWR0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnVGhlIHJlZ2lvbiBtdXN0IGZpdCBpbnNpZGUgdGhlIG1hdHJpeCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IHRvcDsgeSA8IGJvdHRvbTsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHJvd1NpemU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gbGVmdDsgeCA8IHJpZ2h0OyB4KyspIHsKCSAgICAgICAgICAgICAgICBiaXRzW29mZnNldCArIE1hdGguZmxvb3IoeCAvIDMyKV0gfD0gKCgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRik7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEEgZmFzdCBtZXRob2QgdG8gcmV0cmlldmUgb25lIHJvdyBvZiBkYXRhIGZyb20gdGhlIG1hdHJpeCBhcyBhIEJpdEFycmF5LgoJICAgICAqCgkgICAgICogQHBhcmFtIHkgVGhlIHJvdyB0byByZXRyaWV2ZQoJICAgICAqIEBwYXJhbSByb3cgQW4gb3B0aW9uYWwgY2FsbGVyLWFsbG9jYXRlZCBCaXRBcnJheSwgd2lsbCBiZSBhbGxvY2F0ZWQgaWYgbnVsbCBvciB0b28gc21hbGwKCSAgICAgKiBAcmV0dXJuIFRoZSByZXN1bHRpbmcgQml0QXJyYXkgLSB0aGlzIHJlZmVyZW5jZSBzaG91bGQgYWx3YXlzIGJlIHVzZWQgZXZlbiB3aGVuIHBhc3NpbmcKCSAgICAgKiAgICAgICAgIHlvdXIgb3duIHJvdwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIGlmIChyb3cgPT09IG51bGwgfHwgcm93ID09PSB1bmRlZmluZWQgfHwgcm93LmdldFNpemUoKSA8IHRoaXMud2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh0aGlzLndpZHRoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHJvdy5jbGVhcigpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiByb3dTaXplOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHJvd1NpemU7IHgrKykgewoJICAgICAgICAgICAgcm93LnNldEJ1bGsoeCAqIDMyLCBiaXRzW29mZnNldCArIHhdKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIHkgcm93IHRvIHNldAoJICAgICAqIEBwYXJhbSByb3cge0BsaW5rIEJpdEFycmF5fSB0byBjb3B5IGZyb20KCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLnNldFJvdyA9IGZ1bmN0aW9uICh5IC8qaW50Ki8sIHJvdykgewoJICAgICAgICBTeXN0ZW1fMSQzLmRlZmF1bHQuYXJyYXljb3B5KHJvdy5nZXRCaXRBcnJheSgpLCAwLCB0aGlzLmJpdHMsIHkgKiB0aGlzLnJvd1NpemUsIHRoaXMucm93U2l6ZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBNb2RpZmllcyB0aGlzIHtAY29kZSBCaXRNYXRyaXh9IHRvIHJlcHJlc2VudCB0aGUgc2FtZSBidXQgcm90YXRlZCAxODAgZGVncmVlcwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUucm90YXRlMTgwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgdG9wUm93ID0gbmV3IEJpdEFycmF5XzEkMS5kZWZhdWx0KHdpZHRoKTsKCSAgICAgICAgdmFyIGJvdHRvbVJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh3aWR0aCk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IE1hdGguZmxvb3IoKGhlaWdodCArIDEpIC8gMik7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB0b3BSb3cgPSB0aGlzLmdldFJvdyhpLCB0b3BSb3cpOwoJICAgICAgICAgICAgYm90dG9tUm93ID0gdGhpcy5nZXRSb3coaGVpZ2h0IC0gMSAtIGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0b3BSb3cucmV2ZXJzZSgpOwoJICAgICAgICAgICAgYm90dG9tUm93LnJldmVyc2UoKTsKCSAgICAgICAgICAgIHRoaXMuc2V0Um93KGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0aGlzLnNldFJvdyhoZWlnaHQgLSAxIC0gaSwgdG9wUm93KTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIHRoZSBlbmNsb3NpbmcgcmVjdGFuZ2xlIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBsZWZ0LHRvcCx3aWR0aCxoZWlnaHR9IGVuY2xvc2luZyByZWN0YW5nbGUgb2YgYWxsIDEgYml0cywgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldEVuY2xvc2luZ1JlY3RhbmdsZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwoJICAgICAgICB2YXIgcm93U2l6ZSA9IHRoaXMucm93U2l6ZTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBsZWZ0ID0gd2lkdGg7CgkgICAgICAgIHZhciB0b3AgPSBoZWlnaHQ7CgkgICAgICAgIHZhciByaWdodCA9IC0xOwoJICAgICAgICB2YXIgYm90dG9tID0gLTE7CgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHgzMiA9IDA7IHgzMiA8IHJvd1NpemU7IHgzMisrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHRoZUJpdHMgPSBiaXRzW3kgKiByb3dTaXplICsgeDMyXTsKCSAgICAgICAgICAgICAgICBpZiAodGhlQml0cyAhPT0gMCkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRvcCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IGJvdHRvbSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeDMyICogMzIgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYml0ID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHgzMiAqIDMyICsgYml0OwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmICh4MzIgKiAzMiArIDMxID4gcmlnaHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSAzMTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgodGhlQml0cyA+Pj4gYml0KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPiByaWdodCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0geDMyICogMzIgKyBiaXQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJpZ2h0IDwgbGVmdCB8fCBib3R0b20gPCB0b3ApIHsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2xlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0ICsgMSwgYm90dG9tIC0gdG9wICsgMV0pOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIGEgY29ybmVyIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSB4LHl9IGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQtbW9zdCAxIGJpdCwgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldFRvcExlZnRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IDA7CgkgICAgICAgIHdoaWxlIChiaXRzT2Zmc2V0IDwgYml0cy5sZW5ndGggJiYgYml0c1tiaXRzT2Zmc2V0XSA9PT0gMCkgewoJICAgICAgICAgICAgYml0c09mZnNldCsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChiaXRzT2Zmc2V0ID09PSBiaXRzLmxlbmd0aCkgewoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHkgPSBiaXRzT2Zmc2V0IC8gcm93U2l6ZTsKCSAgICAgICAgdmFyIHggPSAoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDA7CgkgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgYml0Kys7CgkgICAgICAgIH0KCSAgICAgICAgeCArPSBiaXQ7CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW3gsIHldKTsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Qm90dG9tUmlnaHRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IGJpdHMubGVuZ3RoIC0gMTsKCSAgICAgICAgd2hpbGUgKGJpdHNPZmZzZXQgPj0gMCAmJiBiaXRzW2JpdHNPZmZzZXRdID09PSAwKSB7CgkgICAgICAgICAgICBiaXRzT2Zmc2V0LS07CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJpdHNPZmZzZXQgPCAwKSB7CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoYml0c09mZnNldCAvIHJvd1NpemUpOwoJICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDMxOwoJICAgICAgICB3aGlsZSAoKHRoZUJpdHMgPj4+IGJpdCkgPT09IDApIHsKCSAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICB9CgkgICAgICAgIHggKz0gYml0OwoJICAgICAgICByZXR1cm4gSW50MzJBcnJheS5mcm9tKFt4LCB5XSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMud2lkdGg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSByb3cgc2l6ZSBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRSb3dTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yb3dTaXplOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdE1hdHJpeCkpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy53aWR0aCA9PT0gb3RoZXIud2lkdGggJiYgdGhpcy5oZWlnaHQgPT09IG90aGVyLmhlaWdodCAmJiB0aGlzLnJvd1NpemUgPT09IG90aGVyLnJvd1NpemUgJiYKCSAgICAgICAgICAgIEFycmF5c18xLmRlZmF1bHQuZXF1YWxzKHRoaXMuYml0cywgb3RoZXIuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGhhc2ggPSB0aGlzLndpZHRoOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy53aWR0aDsKCSAgICAgICAgaGFzaCA9IDMxICogaGFzaCArIHRoaXMuaGVpZ2h0OwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy5yb3dTaXplOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgQXJyYXlzXzEuZGVmYXVsdC5oYXNoQ29kZSh0aGlzLmJpdHMpOwoJICAgICAgICByZXR1cm4gaGFzaDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIHVzaW5nICJYIiBmb3Igc2V0IGFuZCAiICIgZm9yIHVuc2V0IGJpdHMKCSAgICAgKi8KCSAgICAvKkBPdmVycmlkZSovCgkgICAgLy8gcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdG9TdHJpbmcoIjogIlgsICIgICIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgdG9TdHJpbmcoc2V0U3RyaW5nOiBzdHJpbmcgPSAiWCAiLCB1bnNldFN0cmluZzogc3RyaW5nID0gIiAgIik6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5idWlsZFRvU3RyaW5nKHNldFN0cmluZywgdW5zZXRTdHJpbmcsICJcbiIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEBwYXJhbSBsaW5lU2VwYXJhdG9yIG5ld2xpbmUgY2hhcmFjdGVyIGluIHN0cmluZyByZXByZXNlbnRhdGlvbgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MgYW5kIGxpbmUgc2VwYXJhdG9yCgkgICAgICogQGRlcHJlY2F0ZWQgY2FsbCB7QGxpbmsgI3RvU3RyaW5nKFN0cmluZyxTdHJpbmcpfSBvbmx5LCB3aGljaCB1c2VzIFxuIGxpbmUgc2VwYXJhdG9yIGFsd2F5cwoJICAgICAqLwoJICAgIC8vIEBEZXByZWNhdGVkCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIChzZXRTdHJpbmcsIHVuc2V0U3RyaW5nLCBsaW5lU2VwYXJhdG9yKSB7CgkgICAgICAgIGlmIChzZXRTdHJpbmcgPT09IHZvaWQgMCkgeyBzZXRTdHJpbmcgPSAnWCAnOyB9CgkgICAgICAgIGlmICh1bnNldFN0cmluZyA9PT0gdm9pZCAwKSB7IHVuc2V0U3RyaW5nID0gJyAgJzsgfQoJICAgICAgICBpZiAobGluZVNlcGFyYXRvciA9PT0gdm9pZCAwKSB7IGxpbmVTZXBhcmF0b3IgPSAnXG4nOyB9CgkgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9TdHJpbmcoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcik7CgkgICAgfTsKCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmJ1aWxkVG9TdHJpbmcgPSBmdW5jdGlvbiAoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcikgewoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgLy8gcmVzdWx0LmFwcGVuZChsaW5lU2VwYXJhdG9yKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IHRoaXMud2lkdGg7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh0aGlzLmdldCh4LCB5KSA/IHNldFN0cmluZyA6IHVuc2V0U3RyaW5nKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobGluZVNlcGFyYXRvcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdC50b1N0cmluZygpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0TWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLnJvd1NpemUsIHRoaXMuYml0cy5zbGljZSgpKTsKCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXg7Cgl9KCkpOwoJQml0TWF0cml4JDEuZGVmYXVsdCA9IEJpdE1hdHJpeDsKCgl2YXIgTm90Rm91bmRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RGb3VuZEV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBOb3RGb3VuZEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZChOb3RGb3VuZEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBOb3RGb3VuZEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5nZXROb3RGb3VuZEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5raW5kID0gJ05vdEZvdW5kRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gTm90Rm91bmRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCkpOwoJTm90Rm91bmRFeGNlcHRpb24kMS5kZWZhdWx0ID0gTm90Rm91bmRFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYyA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24geyovCgl2YXIgQmluYXJpemVyXzEgPSBCaW5hcml6ZXIkMTsKCXZhciBCaXRBcnJheV8xID0gQml0QXJyYXkkMTsKCXZhciBCaXRNYXRyaXhfMSQ1ID0gQml0TWF0cml4JDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQ2ID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qKgoJICogVGhpcyBCaW5hcml6ZXIgaW1wbGVtZW50YXRpb24gdXNlcyB0aGUgb2xkIFpYaW5nIGdsb2JhbCBoaXN0b2dyYW0gYXBwcm9hY2guIEl0IGlzIHN1aXRhYmxlCgkgKiBmb3IgbG93LWVuZCBtb2JpbGUgZGV2aWNlcyB3aGljaCBkb24ndCBoYXZlIGVub3VnaCBDUFUgb3IgbWVtb3J5IHRvIHVzZSBhIGxvY2FsIHRocmVzaG9sZGluZwoJICogYWxnb3JpdGhtLiBIb3dldmVyLCBiZWNhdXNlIGl0IHBpY2tzIGEgZ2xvYmFsIGJsYWNrIHBvaW50LCBpdCBjYW5ub3QgaGFuZGxlIGRpZmZpY3VsdCBzaGFkb3dzCgkgKiBhbmQgZ3JhZGllbnRzLgoJICoKCSAqIEZhc3RlciBtb2JpbGUgZGV2aWNlcyBhbmQgYWxsIGRlc2t0b3AgYXBwbGljYXRpb25zIHNob3VsZCBwcm9iYWJseSB1c2UgSHlicmlkQmluYXJpemVyIGluc3RlYWQuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGMoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5sdW1pbmFuY2VzID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkVNUFRZOwoJICAgICAgICBfdGhpcy5idWNrZXRzID0gbmV3IEludDMyQXJyYXkoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CVUNLRVRTKTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvLyBBcHBsaWVzIHNpbXBsZSBzaGFycGVuaW5nIHRvIHRoZSByb3cgZGF0YSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIG9mIHRoZSAxRCBSZWFkZXJzLgoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmdldEJsYWNrUm93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gdW5kZWZpbmVkIHx8IHJvdyA9PT0gbnVsbCB8fCByb3cuZ2V0U2l6ZSgpIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xLmRlZmF1bHQod2lkdGgpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgcm93LmNsZWFyKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5pbml0QXJyYXlzKHdpZHRoKTsKCSAgICAgICAgdmFyIGxvY2FsTHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRSb3coeSwgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgdmFyIGxvY2FsQnVja2V0cyA9IHRoaXMuYnVja2V0czsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICBsb2NhbEJ1Y2tldHNbKGxvY2FsTHVtaW5hbmNlc1t4XSAmIDB4ZmYpID4+IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfU0hJRlRdKys7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJsYWNrUG9pbnQgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuZXN0aW1hdGVCbGFja1BvaW50KGxvY2FsQnVja2V0cyk7CgkgICAgICAgIGlmICh3aWR0aCA8IDMpIHsKCSAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgdmVyeSBzbWFsbCBpbWFnZXMKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgICAgIGlmICgobG9jYWxMdW1pbmFuY2VzW3hdICYgMHhmZikgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHJvdy5zZXQoeCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGxlZnQgPSBsb2NhbEx1bWluYW5jZXNbMF0gJiAweGZmOwoJICAgICAgICAgICAgdmFyIGNlbnRlciA9IGxvY2FsTHVtaW5hbmNlc1sxXSAmIDB4ZmY7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IHdpZHRoIC0gMTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gbG9jYWxMdW1pbmFuY2VzW3ggKyAxXSAmIDB4ZmY7CgkgICAgICAgICAgICAgICAgLy8gQSBzaW1wbGUgLTEgNCAtMSBib3ggZmlsdGVyIHdpdGggYSB3ZWlnaHQgb2YgMi4KCSAgICAgICAgICAgICAgICBpZiAoKChjZW50ZXIgKiA0KSAtIGxlZnQgLSByaWdodCkgLyAyIDwgYmxhY2tQb2ludCkgewoJICAgICAgICAgICAgICAgICAgICByb3cuc2V0KHgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBsZWZ0ID0gY2VudGVyOwoJICAgICAgICAgICAgICAgIGNlbnRlciA9IHJpZ2h0OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByb3c7CgkgICAgfTsKCSAgICAvLyBEb2VzIG5vdCBzaGFycGVuIHRoZSBkYXRhLCBhcyB0aGlzIGNhbGwgaXMgaW50ZW5kZWQgdG8gb25seSBiZSB1c2VkIGJ5IDJEIFJlYWRlcnMuCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBCaXRNYXRyaXhfMSQ1LmRlZmF1bHQod2lkdGgsIGhlaWdodCk7CgkgICAgICAgIC8vIFF1aWNrbHkgY2FsY3VsYXRlcyB0aGUgaGlzdG9ncmFtIGJ5IHNhbXBsaW5nIGZvdXIgcm93cyBmcm9tIHRoZSBpbWFnZS4gVGhpcyBwcm92ZWQgdG8gYmUKCSAgICAgICAgLy8gbW9yZSByb2J1c3Qgb24gdGhlIGJsYWNrYm94IHRlc3RzIHRoYW4gc2FtcGxpbmcgYSBkaWFnb25hbCBhcyB3ZSB1c2VkIHRvIGRvLgoJICAgICAgICB0aGlzLmluaXRBcnJheXMod2lkdGgpOwoJICAgICAgICB2YXIgbG9jYWxCdWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IDU7IHkrKykgewoJICAgICAgICAgICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoKGhlaWdodCAqIHkpIC8gNSk7CgkgICAgICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzXzEgPSBzb3VyY2UuZ2V0Um93KHJvdywgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgICAgIHZhciByaWdodCA9IE1hdGguZmxvb3IoKHdpZHRoICogNCkgLyA1KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSBNYXRoLmZsb29yKHdpZHRoIC8gNSk7IHggPCByaWdodDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzXzFbeF0gJiAweGZmOwoJICAgICAgICAgICAgICAgIGxvY2FsQnVja2V0c1twaXhlbCA+PiBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUXSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBibGFja1BvaW50ID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludChsb2NhbEJ1Y2tldHMpOwoJICAgICAgICAvLyBXZSBkZWxheSByZWFkaW5nIHRoZSBlbnRpcmUgaW1hZ2UgbHVtaW5hbmNlIHVudGlsIHRoZSBibGFjayBwb2ludCBlc3RpbWF0aW9uIHN1Y2NlZWRzLgoJICAgICAgICAvLyBBbHRob3VnaCB3ZSBlbmQgdXAgcmVhZGluZyBmb3VyIHJvd3MgdHdpY2UsIGl0IGlzIGNvbnNpc3RlbnQgd2l0aCBvdXIgbW90dG8gb2YKCSAgICAgICAgLy8gImZhaWwgcXVpY2tseSIgd2hpY2ggaXMgbmVjZXNzYXJ5IGZvciBjb250aW51b3VzIHNjYW5uaW5nLgoJICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzID0gc291cmNlLmdldE1hdHJpeCgpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzW29mZnNldCArIHhdICYgMHhmZjsKCSAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5zZXQoeCwgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBtYXRyaXg7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLnByb3RvdHlwZS5jcmVhdGVCaW5hcml6ZXIgPSBmdW5jdGlvbiAoc291cmNlKSB7CgkgICAgICAgIHJldHVybiBuZXcgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyKHNvdXJjZSk7CgkgICAgfTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmluaXRBcnJheXMgPSBmdW5jdGlvbiAobHVtaW5hbmNlU2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmICh0aGlzLmx1bWluYW5jZXMubGVuZ3RoIDwgbHVtaW5hbmNlU2l6ZSkgewoJICAgICAgICAgICAgdGhpcy5sdW1pbmFuY2VzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGx1bWluYW5jZVNpemUpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBidWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQlVDS0VUUzsgeCsrKSB7CgkgICAgICAgICAgICBidWNrZXRzW3hdID0gMDsKCSAgICAgICAgfQoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludCA9IGZ1bmN0aW9uIChidWNrZXRzKSB7CgkgICAgICAgIC8vIEZpbmQgdGhlIHRhbGxlc3QgcGVhayBpbiB0aGUgaGlzdG9ncmFtLgoJICAgICAgICB2YXIgbnVtQnVja2V0cyA9IGJ1Y2tldHMubGVuZ3RoOwoJICAgICAgICB2YXIgbWF4QnVja2V0Q291bnQgPSAwOwoJICAgICAgICB2YXIgZmlyc3RQZWFrID0gMDsKCSAgICAgICAgdmFyIGZpcnN0UGVha1NpemUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgaWYgKGJ1Y2tldHNbeF0gPiBmaXJzdFBlYWtTaXplKSB7CgkgICAgICAgICAgICAgICAgZmlyc3RQZWFrID0geDsKCSAgICAgICAgICAgICAgICBmaXJzdFBlYWtTaXplID0gYnVja2V0c1t4XTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChidWNrZXRzW3hdID4gbWF4QnVja2V0Q291bnQpIHsKCSAgICAgICAgICAgICAgICBtYXhCdWNrZXRDb3VudCA9IGJ1Y2tldHNbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCB0aGUgc2Vjb25kLXRhbGxlc3QgcGVhayB3aGljaCBpcyBzb21ld2hhdCBmYXIgZnJvbSB0aGUgdGFsbGVzdCBwZWFrLgoJICAgICAgICB2YXIgc2Vjb25kUGVhayA9IDA7CgkgICAgICAgIHZhciBzZWNvbmRQZWFrU2NvcmUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgdmFyIGRpc3RhbmNlVG9CaWdnZXN0ID0geCAtIGZpcnN0UGVhazsKCSAgICAgICAgICAgIC8vIEVuY291cmFnZSBtb3JlIGRpc3RhbnQgc2Vjb25kIHBlYWtzIGJ5IG11bHRpcGx5aW5nIGJ5IHNxdWFyZSBvZiBkaXN0YW5jZS4KCSAgICAgICAgICAgIHZhciBzY29yZSA9IGJ1Y2tldHNbeF0gKiBkaXN0YW5jZVRvQmlnZ2VzdCAqIGRpc3RhbmNlVG9CaWdnZXN0OwoJICAgICAgICAgICAgaWYgKHNjb3JlID4gc2Vjb25kUGVha1Njb3JlKSB7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVhayA9IHg7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVha1Njb3JlID0gc2NvcmU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTWFrZSBzdXJlIGZpcnN0UGVhayBjb3JyZXNwb25kcyB0byB0aGUgYmxhY2sgcGVhay4KCSAgICAgICAgaWYgKGZpcnN0UGVhayA+IHNlY29uZFBlYWspIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZmlyc3RQZWFrOwoJICAgICAgICAgICAgZmlyc3RQZWFrID0gc2Vjb25kUGVhazsKCSAgICAgICAgICAgIHNlY29uZFBlYWsgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHRoZXJlIGlzIHRvbyBsaXR0bGUgY29udHJhc3QgaW4gdGhlIGltYWdlIHRvIHBpY2sgYSBtZWFuaW5nZnVsIGJsYWNrIHBvaW50LCB0aHJvdyByYXRoZXIKCSAgICAgICAgLy8gdGhhbiB3YXN0ZSB0aW1lIHRyeWluZyB0byBkZWNvZGUgdGhlIGltYWdlLCBhbmQgcmlzayBmYWxzZSBwb3NpdGl2ZXMuCgkgICAgICAgIGlmIChzZWNvbmRQZWFrIC0gZmlyc3RQZWFrIDw9IG51bUJ1Y2tldHMgLyAxNikgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCBhIHZhbGxleSBiZXR3ZWVuIHRoZW0gdGhhdCBpcyBsb3cgYW5kIGNsb3NlciB0byB0aGUgd2hpdGUgcGVhay4KCSAgICAgICAgdmFyIGJlc3RWYWxsZXkgPSBzZWNvbmRQZWFrIC0gMTsKCSAgICAgICAgdmFyIGJlc3RWYWxsZXlTY29yZSA9IC0xOwoJICAgICAgICBmb3IgKHZhciB4ID0gc2Vjb25kUGVhayAtIDE7IHggPiBmaXJzdFBlYWs7IHgtLSkgewoJICAgICAgICAgICAgdmFyIGZyb21GaXJzdCA9IHggLSBmaXJzdFBlYWs7CgkgICAgICAgICAgICB2YXIgc2NvcmUgPSBmcm9tRmlyc3QgKiBmcm9tRmlyc3QgKiAoc2Vjb25kUGVhayAtIHgpICogKG1heEJ1Y2tldENvdW50IC0gYnVja2V0c1t4XSk7CgkgICAgICAgICAgICBpZiAoc2NvcmUgPiBiZXN0VmFsbGV5U2NvcmUpIHsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5ID0geDsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5U2NvcmUgPSBzY29yZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYmVzdFZhbGxleSA8PCBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUOwoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CSVRTID0gNTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUID0gOCAtIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX0JVQ0tFVFMgPSAxIDw8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuRU1QVFkgPSBVaW50OENsYW1wZWRBcnJheS5mcm9tKFswXSk7CgkgICAgcmV0dXJuIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCX0oQmluYXJpemVyXzEuZGVmYXVsdCkpOwoJR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyJDEuZGVmYXVsdCA9IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyRiID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEh5YnJpZEJpbmFyaXplciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyXzEgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMTsKCXZhciBCaXRNYXRyaXhfMSQ0ID0gQml0TWF0cml4JDE7CgkvKioKCSAqIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIGxvY2FsIHRocmVzaG9sZGluZyBhbGdvcml0aG0sIHdoaWNoIHdoaWxlIHNsb3dlciB0aGFuIHRoZQoJICogR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBpcyBmYWlybHkgZWZmaWNpZW50IGZvciB3aGF0IGl0IGRvZXMuIEl0IGlzIGRlc2lnbmVkIGZvcgoJICogaGlnaCBmcmVxdWVuY3kgaW1hZ2VzIG9mIGJhcmNvZGVzIHdpdGggYmxhY2sgZGF0YSBvbiB3aGl0ZSBiYWNrZ3JvdW5kcy4gRm9yIHRoaXMgYXBwbGljYXRpb24sCgkgKiBpdCBkb2VzIGEgbXVjaCBiZXR0ZXIgam9iIHRoYW4gYSBnbG9iYWwgYmxhY2twb2ludCB3aXRoIHNldmVyZSBzaGFkb3dzIGFuZCBncmFkaWVudHMuCgkgKiBIb3dldmVyIGl0IHRlbmRzIHRvIHByb2R1Y2UgYXJ0aWZhY3RzIG9uIGxvd2VyIGZyZXF1ZW5jeSBpbWFnZXMgYW5kIGlzIHRoZXJlZm9yZSBub3QKCSAqIGEgZ29vZCBnZW5lcmFsIHB1cnBvc2UgYmluYXJpemVyIGZvciB1c2VzIG91dHNpZGUgWlhpbmcuCgkgKgoJICogVGhpcyBjbGFzcyBleHRlbmRzIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplciwgdXNpbmcgdGhlIG9sZGVyIGhpc3RvZ3JhbSBhcHByb2FjaCBmb3IgMUQgcmVhZGVycywKCSAqIGFuZCB0aGUgbmV3ZXIgbG9jYWwgYXBwcm9hY2ggZm9yIDJEIHJlYWRlcnMuIDFEIGRlY29kaW5nIHVzaW5nIGEgcGVyLXJvdyBoaXN0b2dyYW0gaXMgYWxyZWFkeQoJICogaW5oZXJlbnRseSBsb2NhbCwgYW5kIG9ubHkgZmFpbHMgZm9yIGhvcml6b250YWwgZ3JhZGllbnRzLiBXZSBjYW4gcmV2aXNpdCB0aGF0IHByb2JsZW0gbGF0ZXIsCgkgKiBidXQgZm9yIG5vdyBpdCB3YXMgbm90IGEgd2luIHRvIHVzZSBsb2NhbCBibG9ja3MgZm9yIDFELgoJICoKCSAqIFRoaXMgQmluYXJpemVyIGlzIHRoZSBkZWZhdWx0IGZvciB0aGUgdW5pdCB0ZXN0cyBhbmQgdGhlIHJlY29tbWVuZGVkIGNsYXNzIGZvciBsaWJyYXJ5IHVzZXJzLgoJICoKCSAqIEBhdXRob3IgZHN3aXRraW5AZ29vZ2xlLmNvbSAoRGFuaWVsIFN3aXRraW4pCgkgKi8KCXZhciBIeWJyaWRCaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGIoSHlicmlkQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEh5YnJpZEJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tYXRyaXggPSBudWxsOwoJICAgICAgICByZXR1cm4gX3RoaXM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIENhbGN1bGF0ZXMgdGhlIGZpbmFsIEJpdE1hdHJpeCBvbmNlIGZvciBhbGwgcmVxdWVzdHMuIFRoaXMgY291bGQgYmUgY2FsbGVkIG9uY2UgZnJvbSB0aGUKCSAgICAgKiBjb25zdHJ1Y3RvciBpbnN0ZWFkLCBidXQgdGhlcmUgYXJlIHNvbWUgYWR2YW50YWdlcyB0byBkb2luZyBpdCBsYXppbHksIHN1Y2ggYXMgbWFraW5nCgkgICAgICogcHJvZmlsaW5nIGVhc2llciwgYW5kIG5vdCBkb2luZyBoZWF2eSBsaWZ0aW5nIHdoZW4gY2FsbGVycyBkb24ndCBleHBlY3QgaXQuCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLm1hdHJpeCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKHdpZHRoID49IEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiAmJiBoZWlnaHQgPj0gSHlicmlkQmluYXJpemVyLk1JTklNVU1fRElNRU5TSU9OKSB7CgkgICAgICAgICAgICB2YXIgbHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRNYXRyaXgoKTsKCSAgICAgICAgICAgIHZhciBzdWJXaWR0aCA9IHdpZHRoID4+IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKCh3aWR0aCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViV2lkdGgrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciBzdWJIZWlnaHQgPSBoZWlnaHQgPj4gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICBpZiAoKGhlaWdodCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViSGVpZ2h0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgYmxhY2tQb2ludHMgPSBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMobHVtaW5hbmNlcywgc3ViV2lkdGgsIHN1YkhlaWdodCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgICAgICB2YXIgbmV3TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDQuZGVmYXVsdCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgICAgIEh5YnJpZEJpbmFyaXplci5jYWxjdWxhdGVUaHJlc2hvbGRGb3JCbG9jayhsdW1pbmFuY2VzLCBzdWJXaWR0aCwgc3ViSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBibGFja1BvaW50cywgbmV3TWF0cml4KTsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gbmV3TWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHRvbyBzbWFsbCwgZmFsbCBiYWNrIHRvIHRoZSBnbG9iYWwgaGlzdG9ncmFtIGFwcHJvYWNoLgoJICAgICAgICAgICAgdGhpcy5tYXRyaXggPSBfc3VwZXIucHJvdG90eXBlLmdldEJsYWNrTWF0cml4LmNhbGwodGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuY3JlYXRlQmluYXJpemVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJICAgICAgICByZXR1cm4gbmV3IEh5YnJpZEJpbmFyaXplcihzb3VyY2UpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRm9yIGVhY2ggYmxvY2sgaW4gdGhlIGltYWdlLCBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgYmxhY2sgcG9pbnQgdXNpbmcgYSA1eDUgZ3JpZAoJICAgICAqIG9mIHRoZSBibG9ja3MgYXJvdW5kIGl0LiBBbHNvIGhhbmRsZXMgdGhlIGNvcm5lciBjYXNlcyAoZnJhY3Rpb25hbCBibG9ja3MgYXJlIGNvbXB1dGVkIGJhc2VkCgkgICAgICogb24gdGhlIGxhc3QgcGl4ZWxzIGluIHRoZSByb3cvY29sdW1uIHdoaWNoIGFyZSBhbHNvIHVzZWQgaW4gdGhlIHByZXZpb3VzIGJsb2NrKS4KCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlVGhyZXNob2xkRm9yQmxvY2sgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBibGFja1BvaW50cywgbWF0cml4KSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdWJIZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgdG9wXzEgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHksIDIsIHN1YkhlaWdodCAtIDMpOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBzdWJXaWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHhvZmZzZXQgPSB4IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgICAgIGlmICh4b2Zmc2V0ID4gbWF4WE9mZnNldCkgewoJICAgICAgICAgICAgICAgICAgICB4b2Zmc2V0ID0gbWF4WE9mZnNldDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHgsIDIsIHN1YldpZHRoIC0gMyk7CgkgICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IC0yOyB6IDw9IDI7IHorKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgYmxhY2tSb3cgPSBibGFja1BvaW50c1t0b3BfMSArIHpdOwoJICAgICAgICAgICAgICAgICAgICBzdW0gKz0gYmxhY2tSb3dbbGVmdCAtIDJdICsgYmxhY2tSb3dbbGVmdCAtIDFdICsgYmxhY2tSb3dbbGVmdF0gKyBibGFja1Jvd1tsZWZ0ICsgMV0gKyBibGFja1Jvd1tsZWZ0ICsgMl07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlID0gc3VtIC8gMjU7CgkgICAgICAgICAgICAgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrKGx1bWluYW5jZXMsIHhvZmZzZXQsIHlvZmZzZXQsIGF2ZXJhZ2UsIHdpZHRoLCBtYXRyaXgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FwID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG1pbiAvKmludCovLCBtYXggLyppbnQqLykgewoJICAgICAgICByZXR1cm4gdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbGllcyBhIHNpbmdsZSB0aHJlc2hvbGQgdG8gYSBibG9jayBvZiBwaXhlbHMuCgkgICAgICovCgkgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrID0gZnVuY3Rpb24gKGx1bWluYW5jZXMsIHhvZmZzZXQgLyppbnQqLywgeW9mZnNldCAvKmludCovLCB0aHJlc2hvbGQgLyppbnQqLywgc3RyaWRlIC8qaW50Ki8sIG1hdHJpeCkgewoJICAgICAgICBmb3IgKHZhciB5ID0gMCwgb2Zmc2V0ID0geW9mZnNldCAqIHN0cmlkZSArIHhvZmZzZXQ7IHkgPCBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsgeSsrLCBvZmZzZXQgKz0gc3RyaWRlKSB7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB4KyspIHsKCSAgICAgICAgICAgICAgICAvLyBDb21wYXJpc29uIG5lZWRzIHRvIGJlIDw9IHNvIHRoYXQgYmxhY2sgPT0gMCBwaXhlbHMgYXJlIGJsYWNrIGV2ZW4gaWYgdGhlIHRocmVzaG9sZCBpcyAwLgoJICAgICAgICAgICAgICAgIGlmICgobHVtaW5hbmNlc1tvZmZzZXQgKyB4XSAmIDB4RkYpIDw9IHRocmVzaG9sZCkgewoJICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KHhvZmZzZXQgKyB4LCB5b2Zmc2V0ICsgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDYWxjdWxhdGVzIGEgc2luZ2xlIGJsYWNrIHBvaW50IGZvciBlYWNoIGJsb2NrIG9mIHBpeGVscyBhbmQgc2F2ZXMgaXQgYXdheS4KCSAgICAgKiBTZWUgdGhlIGZvbGxvd2luZyB0aHJlYWQgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGlzIGFsZ29yaXRobToKCSAgICAgKiAgaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL3p4aW5nL2Jyb3dzZV90aHJlYWQvdGhyZWFkL2QwNmVmYTJjMzVhN2RkYzAKCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOndoaXRlc3BhY2UKCSAgICAgICAgdmFyIGJsYWNrUG9pbnRzID0gbmV3IEFycmF5KHN1YkhlaWdodCk7IC8vIHN1YldpZHRoCgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc3ViSGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGJsYWNrUG9pbnRzW3ldID0gbmV3IEludDMyQXJyYXkoc3ViV2lkdGgpOwoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHN1YldpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgeG9mZnNldCA9IHggPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICAgICAgaWYgKHhvZmZzZXQgPiBtYXhYT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgICAgIHhvZmZzZXQgPSBtYXhYT2Zmc2V0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB2YXIgc3VtID0gMDsKCSAgICAgICAgICAgICAgICB2YXIgbWluID0gMHhGRjsKCSAgICAgICAgICAgICAgICB2YXIgbWF4ID0gMDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciB5eSA9IDAsIG9mZnNldCA9IHlvZmZzZXQgKiB3aWR0aCArIHhvZmZzZXQ7IHl5IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHl5KyssIG9mZnNldCArPSB3aWR0aCkgewoJICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBwaXhlbDsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0aWxsIGxvb2tpbmcgZm9yIGdvb2QgY29udHJhc3QKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IG1pbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IHBpeGVsOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpeGVsID4gbWF4KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gcGl4ZWw7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgLy8gc2hvcnQtY2lyY3VpdCBtaW4vbWF4IHRlc3RzIG9uY2UgZHluYW1pYyByYW5nZSBpcyBtZXQKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA+IEh5YnJpZEJpbmFyaXplci5NSU5fRFlOQU1JQ19SQU5HRSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluaXNoIHRoZSByZXN0IG9mIHRoZSByb3dzIHF1aWNrbHkKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeXkrKywgb2Zmc2V0ICs9IHdpZHRoOyB5eSA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB5eSsrLCBvZmZzZXQgKz0gd2lkdGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtICs9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgZXN0aW1hdGUgaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHZhbHVlcyBpbiB0aGUgYmxvY2suCgkgICAgICAgICAgICAgICAgdmFyIGF2ZXJhZ2UgPSBzdW0gPj4gKEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSICogMik7CgkgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA8PSBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSWYgdmFyaWF0aW9uIHdpdGhpbiB0aGUgYmxvY2sgaXMgbG93LCBhc3N1bWUgdGhpcyBpcyBhIGJsb2NrIHdpdGggb25seSBsaWdodCBvciBvbmx5CgkgICAgICAgICAgICAgICAgICAgIC8vIGRhcmsgcGl4ZWxzLiBJbiB0aGF0IGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBhdmVyYWdlLCBhcyBpdCB3b3VsZCBkaXZpZGUgdGhpcwoJICAgICAgICAgICAgICAgICAgICAvLyBsb3cgY29udHJhc3QgYXJlYSBpbnRvIGJsYWNrIGFuZCB3aGl0ZSBwaXhlbHMsIGVzc2VudGlhbGx5IGNyZWF0aW5nIGRhdGEgb3V0IG9mIG5vaXNlLgoJICAgICAgICAgICAgICAgICAgICAvLwoJICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGJsb2NrIGlzIGxpZ2h0L2JhY2tncm91bmQuIFNpbmNlIG5vIGVzdGltYXRlIGZvcgoJICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGV2ZWwgb2YgZGFyayBwaXhlbHMgZXhpc3RzIGxvY2FsbHksIHVzZSBoYWxmIHRoZSBtaW4gZm9yIHRoZSBibG9jay4KCSAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IG1pbiAvIDI7CgkgICAgICAgICAgICAgICAgICAgIGlmICh5ID4gMCAmJiB4ID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ycmVjdCB0aGUgIndoaXRlIGJhY2tncm91bmQiIGFzc3VtcHRpb24gZm9yIGJsb2NrcyB0aGF0IGhhdmUgbmVpZ2hib3JzIGJ5IGNvbXBhcmluZwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHBpeGVscyBpbiB0aGlzIGJsb2NrIHRvIHRoZSBwcmV2aW91c2x5IGNhbGN1bGF0ZWQgYmxhY2sgcG9pbnRzLiBUaGlzIGlzIGJhc2VkIG9uCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IGRhcmsgYmFyY29kZSBzeW1ib2xvZ3kgaXMgYWx3YXlzIHN1cnJvdW5kZWQgYnkgc29tZSBhbW91bnQgb2YgbGlnaHQKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQgZm9yIHdoaWNoIHJlYXNvbmFibGUgYmxhY2sgcG9pbnQgZXN0aW1hdGVzIHdlcmUgbWFkZS4gVGhlIGJwIGVzdGltYXRlZCBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGJvdW5kYXJpZXMgaXMgdXNlZCBmb3IgdGhlIGludGVyaW9yLgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIChtaW4gPCBicCkgaXMgYXJiaXRyYXJ5IGJ1dCB3b3JrcyBiZXR0ZXIgdGhhbiBvdGhlciBoZXVyaXN0aWNzIHRoYXQgd2VyZSB0cmllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50ID0gKGJsYWNrUG9pbnRzW3kgLSAxXVt4XSArICgyICogYmxhY2tQb2ludHNbeV1beCAtIDFdKSArIGJsYWNrUG9pbnRzW3kgLSAxXVt4IC0gMV0pIC8gNDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW4gPCBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IGF2ZXJhZ2VOZWlnaGJvckJsYWNrUG9pbnQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYmxhY2tQb2ludHNbeV1beF0gPSBhdmVyYWdlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBibGFja1BvaW50czsKCSAgICB9OwoJICAgIC8vIFRoaXMgY2xhc3MgdXNlcyA1eDUgYmxvY2tzIHRvIGNvbXB1dGUgbG9jYWwgbHVtaW5hbmNlLCB3aGVyZSBlYWNoIGJsb2NrIGlzIDh4OCBwaXhlbHMuCgkgICAgLy8gU28gdGhpcyBpcyB0aGUgc21hbGxlc3QgZGltZW5zaW9uIGluIGVhY2ggYXhpcyB3ZSBjYW4gYWNjZXB0LgoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSID0gMzsKCSAgICBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSA9IDEgPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7IC8vIC4uLjAxMDAuLi4wMAoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0sgPSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSAtIDE7IC8vIC4uLjAwMTEuLi4xMQoJICAgIEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiA9IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFICogNTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UgPSAyNDsKCSAgICByZXR1cm4gSHlicmlkQmluYXJpemVyOwoJfShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXJfMS5kZWZhdWx0KSk7Cgl2YXIgX2RlZmF1bHQkMiA9IEh5YnJpZEJpbmFyaXplciQxLmRlZmF1bHQgPSBIeWJyaWRCaW5hcml6ZXI7CgoJdmFyIFJHQkx1bWluYW5jZVNvdXJjZSQxID0ge307CgoJdmFyIEludmVydGVkTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgl2YXIgTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJDE7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nIHsqLwoJLyoqCgkgKiBUaGUgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGhpZXJhcmNoeSBpcyB0byBhYnN0cmFjdCBkaWZmZXJlbnQgYml0bWFwIGltcGxlbWVudGF0aW9ucyBhY3Jvc3MKCSAqIHBsYXRmb3JtcyBpbnRvIGEgc3RhbmRhcmQgaW50ZXJmYWNlIGZvciByZXF1ZXN0aW5nIGdyZXlzY2FsZSBsdW1pbmFuY2UgdmFsdWVzLiBUaGUgaW50ZXJmYWNlCgkgKiBvbmx5IHByb3ZpZGVzIGltbXV0YWJsZSBtZXRob2RzOyB0aGVyZWZvcmUgY3JvcCBhbmQgcm90YXRpb24gY3JlYXRlIGNvcGllcy4gVGhpcyBpcyB0byBlbnN1cmUKCSAqIHRoYXQgb25lIFJlYWRlciBkb2VzIG5vdCBtb2RpZnkgdGhlIG9yaWdpbmFsIGx1bWluYW5jZSBzb3VyY2UgYW5kIGxlYXZlIGl0IGluIGFuIHVua25vd24gc3RhdGUKCSAqIGZvciBvdGhlciBSZWFkZXJzIGluIHRoZSBjaGFpbi4KCSAqCgkgKiBAYXV0aG9yIGRzd2l0a2luQGdvb2dsZS5jb20gKERhbmllbCBTd2l0a2luKQoJICovCgl2YXIgTHVtaW5hbmNlU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEx1bWluYW5jZVNvdXJjZSh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgYml0bWFwLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLndpZHRoOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBUaGUgaGVpZ2h0IG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmhlaWdodDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNyb3BwaW5nLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIGNyb3BwZWQgaW1hZ2UgZGF0YS4gSW1wbGVtZW50YXRpb25zIG1heSBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZQoJICAgICAqIG9yaWdpbmFsIGRhdGEgcmF0aGVyIHRoYW4gYSBjb3B5LiBPbmx5IGNhbGxhYmxlIGlmIGlzQ3JvcFN1cHBvcnRlZCgpIGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gbGVmdCBUaGUgbGVmdCBjb29yZGluYXRlLCB3aGljaCBtdXN0IGJlIGluIFswLGdldFdpZHRoKCkpCgkgICAgICogQHBhcmFtIHRvcCBUaGUgdG9wIGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0SGVpZ2h0KCkpCgkgICAgICogQHBhcmFtIHdpZHRoIFRoZSB3aWR0aCBvZiB0aGUgcmVjdGFuZ2xlIHRvIGNyb3AuCgkgICAgICogQHBhcmFtIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcmV0dXJuIEEgY3JvcHBlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjcm9wcGluZy4nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNvdW50ZXItY2xvY2t3aXNlIHJvdGF0aW9uLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGlvbiBieSA5MCBkZWdyZWVzLicpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCByb3RhdGVkIGltYWdlIGRhdGEgYnkgNDUgZGVncmVlcyBjb3VudGVyY2xvY2t3aXNlLgoJICAgICAqIE9ubHkgY2FsbGFibGUgaWYge0BsaW5rICNpc1JvdGF0ZVN1cHBvcnRlZCgpfSBpcyB0cnVlLgoJICAgICAqCgkgICAgICogQHJldHVybiBBIHJvdGF0ZWQgdmVyc2lvbiBvZiB0aGlzIG9iamVjdC4KCSAgICAgKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2U0NSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnVGhpcyBsdW1pbmFuY2Ugc291cmNlIGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24gYnkgNDUgZGVncmVlcy4nKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcm93ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRoaXMud2lkdGgpOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQxLmRlZmF1bHQoKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgc291cmNlUm93ID0gdGhpcy5nZXRSb3coeSwgcm93KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGhpcy53aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGx1bWluYW5jZSA9IHNvdXJjZVJvd1t4XSAmIDB4RkY7CgkgICAgICAgICAgICAgICAgdmFyIGMgPSB2b2lkIDA7CgkgICAgICAgICAgICAgICAgaWYgKGx1bWluYW5jZSA8IDB4NDApIHsKCSAgICAgICAgICAgICAgICAgICAgYyA9ICcjJzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAobHVtaW5hbmNlIDwgMHg4MCkgewoJICAgICAgICAgICAgICAgICAgICBjID0gJysnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChsdW1pbmFuY2UgPCAweEMwKSB7CgkgICAgICAgICAgICAgICAgICAgIGMgPSAnLic7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBjID0gJyAnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGMpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXG4nKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7CgkgICAgfTsKCSAgICByZXR1cm4gTHVtaW5hbmNlU291cmNlOwoJfSgpKTsKCUx1bWluYW5jZVNvdXJjZSQxLmRlZmF1bHQgPSBMdW1pbmFuY2VTb3VyY2U7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZlcnRlZEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEkMSA9IEx1bWluYW5jZVNvdXJjZSQxOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHdoaWNoIGludmVydHMgdGhlIGx1bWluYW5jZXMgaXQgcmV0dXJucyAtLSBibGFjayBiZWNvbWVzCgkgKiB3aGl0ZSBhbmQgdmljZSB2ZXJzYSwgYW5kIGVhY2ggdmFsdWUgYmVjb21lcyAoMjU1LXZhbHVlKS4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGEoSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UsIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UoZGVsZWdhdGUpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVsZWdhdGUuZ2V0V2lkdGgoKSwgZGVsZWdhdGUuZ2V0SGVpZ2h0KCkpIHx8IHRoaXM7CgkgICAgICAgIF90aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgdmFyIHNvdXJjZVJvdyA9IHRoaXMuZGVsZWdhdGUuZ2V0Um93KHksIHJvdyk7CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aWR0aDsgaSsrKSB7CgkgICAgICAgICAgICBzb3VyY2VSb3dbaV0gPSAvKihieXRlKSovICgyNTUgLSAoc291cmNlUm93W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBzb3VyY2VSb3c7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmdldE1hdHJpeCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZGVsZWdhdGUuZ2V0TWF0cml4KCk7CgkgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmdldFdpZHRoKCkgKiB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgaW52ZXJ0ZWRNYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobGVuZ3RoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgaW52ZXJ0ZWRNYXRyaXhbaV0gPSAvKihieXRlKSovICgyNTUgLSAobWF0cml4W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpbnZlcnRlZE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUuY3JvcChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmlzUm90YXRlU3VwcG9ydGVkKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG9yaWdpbmFsIGRlbGVnYXRlIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHNpbmNlIGludmVydCB1bmRvZXMgaXRzZWxmCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCkpOwoJICAgIH07CgkgICAgcmV0dXJuIEludmVydGVkTHVtaW5hbmNlU291cmNlOwoJfShMdW1pbmFuY2VTb3VyY2VfMSQxLmRlZmF1bHQpKTsKCUludmVydGVkTHVtaW5hbmNlU291cmNlJDEuZGVmYXVsdCA9IEludmVydGVkTHVtaW5hbmNlU291cmNlOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUkdCTHVtaW5hbmNlU291cmNlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkgLy8gcmVxdWlyZWQgYmVjYXVzZSBvZiBjaXJjdWxhciBkZXBlbmRlbmNpZXMgYmV0d2VlbiBMdW1pbmFuY2VTb3VyY2UgYW5kIEludmVydGVkTHVtaW5hbmNlU291cmNlCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMSA9IEludmVydGVkTHVtaW5hbmNlU291cmNlJDE7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEgPSBMdW1pbmFuY2VTb3VyY2UkMTsKCXZhciBTeXN0ZW1fMSQyID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNiA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gaGVscCBkZWNvZGUgaW1hZ2VzIGZyb20gZmlsZXMgd2hpY2ggYXJyaXZlIGFzIFJHQiBkYXRhIGZyb20KCSAqIGFuIEFSR0IgcGl4ZWwgYXJyYXkuIEl0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24uCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgQmV0YW1pbm9zCgkgKi8KCXZhciBSR0JMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDkoUkdCTHVtaW5hbmNlU291cmNlLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIFJHQkx1bWluYW5jZVNvdXJjZShsdW1pbmFuY2VzLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgZGF0YVdpZHRoIC8qaW50Ki8sIGRhdGFIZWlnaHQgLyppbnQqLywgbGVmdCAvKmludCovLCB0b3AgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5kYXRhV2lkdGggPSBkYXRhV2lkdGg7CgkgICAgICAgIF90aGlzLmRhdGFIZWlnaHQgPSBkYXRhSGVpZ2h0OwoJICAgICAgICBfdGhpcy5sZWZ0ID0gbGVmdDsKCSAgICAgICAgX3RoaXMudG9wID0gdG9wOwoJICAgICAgICBpZiAobHVtaW5hbmNlcy5CWVRFU19QRVJfRUxFTUVOVCA9PT0gNCkgeyAvLyBJbnQzMkFycmF5CgkgICAgICAgICAgICB2YXIgc2l6ZSA9IHdpZHRoICogaGVpZ2h0OwoJICAgICAgICAgICAgdmFyIGx1bWluYW5jZXNVaW50OEFycmF5ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHNpemUpOwoJICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgc2l6ZTsgb2Zmc2V0KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBsdW1pbmFuY2VzW29mZnNldF07CgkgICAgICAgICAgICAgICAgdmFyIHIgPSAocGl4ZWwgPj4gMTYpICYgMHhmZjsgLy8gcmVkCgkgICAgICAgICAgICAgICAgdmFyIGcyID0gKHBpeGVsID4+IDcpICYgMHgxZmU7IC8vIDIgKiBncmVlbgoJICAgICAgICAgICAgICAgIHZhciBiID0gcGl4ZWwgJiAweGZmOyAvLyBibHVlCgkgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGdyZWVuLWZhdm91cmluZyBhdmVyYWdlIGNoZWFwbHkKCSAgICAgICAgICAgICAgICBsdW1pbmFuY2VzVWludDhBcnJheVtvZmZzZXRdID0gLyooYnl0ZSkgKi8gKChyICsgZzIgKyBiKSAvIDQpICYgMHhGRjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzVWludDhBcnJheTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGRhdGFXaWR0aCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YVdpZHRoID0gd2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZGF0YUhlaWdodCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YUhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsZWZ0KSB7CgkgICAgICAgICAgICBfdGhpcy5sZWZ0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0b3ApIHsKCSAgICAgICAgICAgIF90aGlzLnRvcCA9IDA7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKF90aGlzLmxlZnQgKyB3aWR0aCA+IF90aGlzLmRhdGFXaWR0aCB8fCBfdGhpcy50b3AgKyBoZWlnaHQgPiBfdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNi5kZWZhdWx0KCdDcm9wIHJlY3RhbmdsZSBkb2VzIG5vdCBmaXQgd2l0aGluIGltYWdlIGRhdGEuJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgaWYgKHkgPCAwIHx8IHkgPj0gdGhpcy5nZXRIZWlnaHQoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCgnUmVxdWVzdGVkIHJvdyBpcyBvdXRzaWRlIHRoZSBpbWFnZTogJyArIHkpOwoJICAgICAgICB9CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCB8fCByb3cgPT09IHVuZGVmaW5lZCB8fCByb3cubGVuZ3RoIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG9mZnNldCA9ICh5ICsgdGhpcy50b3ApICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIFN5c3RlbV8xJDIuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5sdW1pbmFuY2VzLCBvZmZzZXQsIHJvdywgMCwgd2lkdGgpOwoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJHQkx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0TWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBJZiB0aGUgY2FsbGVyIGFza3MgZm9yIHRoZSBlbnRpcmUgdW5kZXJseWluZyBpbWFnZSwgc2F2ZSB0aGUgY29weSBhbmQgZ2l2ZSB0aGVtIHRoZQoJICAgICAgICAvLyBvcmlnaW5hbCBkYXRhLiBUaGUgZG9jcyBzcGVjaWZpY2FsbHkgd2FybiB0aGF0IHJlc3VsdC5sZW5ndGggbXVzdCBiZSBpZ25vcmVkLgoJICAgICAgICBpZiAod2lkdGggPT09IHRoaXMuZGF0YVdpZHRoICYmIGhlaWdodCA9PT0gdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7CgkgICAgICAgIHZhciBtYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoYXJlYSk7CgkgICAgICAgIHZhciBpbnB1dE9mZnNldCA9IHRoaXMudG9wICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIC8vIElmIHRoZSB3aWR0aCBtYXRjaGVzIHRoZSBmdWxsIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHBlcmZvcm0gYSBzaW5nbGUgY29weS4KCSAgICAgICAgaWYgKHdpZHRoID09PSB0aGlzLmRhdGFXaWR0aCkgewoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIDAsIGFyZWEpOwoJICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICAgICAgfQoJICAgICAgICAvLyBPdGhlcndpc2UgY29weSBvbmUgY3JvcHBlZCByb3cgYXQgYSB0aW1lLgoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb3V0cHV0T2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIG91dHB1dE9mZnNldCwgd2lkdGgpOwoJICAgICAgICAgICAgaW5wdXRPZmZzZXQgKz0gdGhpcy5kYXRhV2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSR0JMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmlzQ3JvcFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgUkdCTHVtaW5hbmNlU291cmNlKHRoaXMubHVtaW5hbmNlcywgd2lkdGgsIGhlaWdodCwgdGhpcy5kYXRhV2lkdGgsIHRoaXMuZGF0YUhlaWdodCwgdGhpcy5sZWZ0ICsgbGVmdCwgdGhpcy50b3AgKyB0b3ApOwoJICAgIH07CgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMS5kZWZhdWx0KHRoaXMpOwoJICAgIH07CgkgICAgcmV0dXJuIFJHQkx1bWluYW5jZVNvdXJjZTsKCX0oTHVtaW5hbmNlU291cmNlXzEuZGVmYXVsdCkpOwoJdmFyIF9kZWZhdWx0JDEgPSBSR0JMdW1pbmFuY2VTb3VyY2UkMS5kZWZhdWx0ID0gUkdCTHVtaW5hbmNlU291cmNlOwoKCXZhciBRUkNvZGVSZWFkZXIkMSA9IHt9OwoKCXZhciBCYXJjb2RlRm9ybWF0JDEgPSB7fTsKCgkvKgoJICogRGlyZWN0IHBvcnQgdG8gVHlwZVNjcmlwdCBvZiBaWGluZyBieSBBZHJpYW4gVG/ImWPEgwoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFyY29kZUZvcm1hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogRW51bWVyYXRlcyBiYXJjb2RlIGZvcm1hdHMga25vd24gdG8gdGhpcyBwYWNrYWdlLiBQbGVhc2Uga2VlcCBhbHBoYWJldGl6ZWQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJhcmNvZGVGb3JtYXQ7CgkoZnVuY3Rpb24gKEJhcmNvZGVGb3JtYXQpIHsKCSAgICAvKiogQXp0ZWMgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJBWlRFQyJdID0gMF0gPSAiQVpURUMiOwoJICAgIC8qKiBDT0RBQkFSIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREFCQVIiXSA9IDFdID0gIkNPREFCQVIiOwoJICAgIC8qKiBDb2RlIDM5IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfMzkiXSA9IDJdID0gIkNPREVfMzkiOwoJICAgIC8qKiBDb2RlIDkzIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfOTMiXSA9IDNdID0gIkNPREVfOTMiOwoJICAgIC8qKiBDb2RlIDEyOCAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJDT0RFXzEyOCJdID0gNF0gPSAiQ09ERV8xMjgiOwoJICAgIC8qKiBEYXRhIE1hdHJpeCAyRCBiYXJjb2RlIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkRBVEFfTUFUUklYIl0gPSA1XSA9ICJEQVRBX01BVFJJWCI7CgkgICAgLyoqIEVBTi04IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkVBTl84Il0gPSA2XSA9ICJFQU5fOCI7CgkgICAgLyoqIEVBTi0xMyAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJFQU5fMTMiXSA9IDddID0gIkVBTl8xMyI7CgkgICAgLyoqIElURiAoSW50ZXJsZWF2ZWQgVHdvIG9mIEZpdmUpIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIklURiJdID0gOF0gPSAiSVRGIjsKCSAgICAvKiogTWF4aUNvZGUgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJNQVhJQ09ERSJdID0gOV0gPSAiTUFYSUNPREUiOwoJICAgIC8qKiBQREY0MTcgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUERGXzQxNyJdID0gMTBdID0gIlBERl80MTciOwoJICAgIC8qKiBRUiBDb2RlIDJEIGJhcmNvZGUgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUVJfQ09ERSJdID0gMTFdID0gIlFSX0NPREUiOwoJICAgIC8qKiBSU1MgMTQgKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlJTU18xNCJdID0gMTJdID0gIlJTU18xNCI7CgkgICAgLyoqIFJTUyBFWFBBTkRFRCAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUlNTX0VYUEFOREVEIl0gPSAxM10gPSAiUlNTX0VYUEFOREVEIjsKCSAgICAvKiogVVBDLUEgMUQgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiVVBDX0EiXSA9IDE0XSA9ICJVUENfQSI7CgkgICAgLyoqIFVQQy1FIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FIl0gPSAxNV0gPSAiVVBDX0UiOwoJICAgIC8qKiBVUEMvRUFOIGV4dGVuc2lvbiBmb3JtYXQuIE5vdCBhIHN0YW5kLWFsb25lIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSAxNl0gPSAiVVBDX0VBTl9FWFRFTlNJT04iOwoJfSkoQmFyY29kZUZvcm1hdCB8fCAoQmFyY29kZUZvcm1hdCA9IHt9KSk7CglCYXJjb2RlRm9ybWF0JDEuZGVmYXVsdCA9IEJhcmNvZGVGb3JtYXQ7CgoJdmFyIFJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIFN5c3RlbV8xJDEgPSBTeXN0ZW0kMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBiYXJjb2RlIHdpdGhpbiBhbiBpbWFnZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSB0ZXh0OiBzdHJpbmcsCgkgICAgLy8gICAgICAgICAgICAgICBVaW50OEFycmF5IHJhd0J5dGVzLAoJICAgIC8vICAgICAgICAgICAgICAgUmVzdWx0UG9jb25zdCByZXN1bHRQb2ludHM6IEludDMyQXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICBCYXJjb2RlRm9ybWF0IGZvcm1hdCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmVzdWx0UG9pbnRzLCBmb3JtYXQsIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IodGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgVWludDhBcnJheSByYXdCeXRlcywKCSAgICAvLyAgICAgICAgICAgICAgIFJlc3VsdFBvY29uc3QgcmVzdWx0UG9pbnRzOiBJbnQzMkFycmF5LAoJICAgIC8vICAgICAgICAgICAgICAgQmFyY29kZUZvcm1hdCBmb3JtYXQsCgkgICAgLy8gICAgICAgICAgICAgICBsb25nIHRpbWVzdGFtcCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoLAoJICAgIC8vICAgICAgICByZXN1bHRQb2ludHMsIGZvcm1hdCwgdGltZXN0YW1wKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBSZXN1bHQodGV4dCwgcmF3Qnl0ZXMsIG51bUJpdHMsIHJlc3VsdFBvaW50cywgZm9ybWF0LCB0aW1lc3RhbXApIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPT09IHZvaWQgMCkgeyBudW1CaXRzID0gcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoOyB9CgkgICAgICAgIGlmICh0aW1lc3RhbXAgPT09IHZvaWQgMCkgeyB0aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsgfQoJICAgICAgICB0aGlzLnRleHQgPSB0ZXh0OwoJICAgICAgICB0aGlzLnJhd0J5dGVzID0gcmF3Qnl0ZXM7CgkgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gcmVzdWx0UG9pbnRzOwoJICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKCSAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7CgkgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gbnVtQml0cyB8fCBudWxsID09PSBudW1CaXRzKSB7CgkgICAgICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IG51bGwgfHwgcmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludHMgPSByZXN1bHRQb2ludHM7CgkgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwoJICAgICAgICB0aGlzLnJlc3VsdE1ldGFkYXRhID0gbnVsbDsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGltZXN0YW1wIHx8IG51bGwgPT09IHRpbWVzdGFtcCkgewoJICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IHRleHQgZW5jb2RlZCBieSB0aGUgYmFyY29kZQoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGV4dDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IGJ5dGVzIGVuY29kZWQgYnkgdGhlIGJhcmNvZGUsIGlmIGFwcGxpY2FibGUsIG90aGVyd2lzZSB7QGNvZGUgbnVsbH0KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0TnVtQml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMubnVtQml0czsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcG9pbnRzIHJlbGF0ZWQgdG8gdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGVzZSBhcmUgdHlwaWNhbGx5IHBvaW50cwoJICAgICAqICAgICAgICAgaWRlbnRpZnlpbmcgZmluZGVyIHBhdHRlcm5zIG9yIHRoZSBjb3JuZXJzIG9mIHRoZSBiYXJjb2RlLiBUaGUgZXhhY3QgbWVhbmluZyBpcwoJICAgICAqICAgICAgICAgc3BlY2lmaWMgdG8gdGhlIHR5cGUgb2YgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkLgoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0UmVzdWx0UG9pbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCYXJjb2RlRm9ybWF0fSByZXByZXNlbnRpbmcgdGhlIGZvcm1hdCBvZiB0aGUgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkCgkgICAgICovCgkgICAgUmVzdWx0LnByb3RvdHlwZS5nZXRCYXJjb2RlRm9ybWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBNYXB9IG1hcHBpbmcge0BsaW5rIFJlc3VsdE1ldGFkYXRhVHlwZX0ga2V5cyB0byB2YWx1ZXMuIE1heSBiZQoJICAgICAqICAge0Bjb2RlIG51bGx9LiBUaGlzIGNvbnRhaW5zIG9wdGlvbmFsIG1ldGFkYXRhIGFib3V0IHdoYXQgd2FzIGRldGVjdGVkIGFib3V0IHRoZSBiYXJjb2RlLAoJICAgICAqICAgbGlrZSBvcmllbnRhdGlvbi4KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJlc3VsdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRNZXRhZGF0YTsKCSAgICB9OwoJICAgIFJlc3VsdC5wcm90b3R5cGUucHV0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHsKCSAgICAgICAgaWYgKHRoaXMucmVzdWx0TWV0YWRhdGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0TWV0YWRhdGEgPSBuZXcgTWFwKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YS5zZXQodHlwZSwgdmFsdWUpOwoJICAgIH07CgkgICAgUmVzdWx0LnByb3RvdHlwZS5wdXRBbGxNZXRhZGF0YSA9IGZ1bmN0aW9uIChtZXRhZGF0YSkgewoJICAgICAgICBpZiAobWV0YWRhdGEgIT09IG51bGwpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdE1ldGFkYXRhID09PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG1ldGFkYXRhOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG5ldyBNYXAobWV0YWRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmFkZFJlc3VsdFBvaW50cyA9IGZ1bmN0aW9uIChuZXdQb2ludHMpIHsKCSAgICAgICAgdmFyIG9sZFBvaW50cyA9IHRoaXMucmVzdWx0UG9pbnRzOwoJICAgICAgICBpZiAob2xkUG9pbnRzID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnJlc3VsdFBvaW50cyA9IG5ld1BvaW50czsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChuZXdQb2ludHMgIT09IG51bGwgJiYgbmV3UG9pbnRzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgIHZhciBhbGxQb2ludHMgPSBuZXcgQXJyYXkob2xkUG9pbnRzLmxlbmd0aCArIG5ld1BvaW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgU3lzdGVtXzEkMS5kZWZhdWx0LmFycmF5Y29weShvbGRQb2ludHMsIDAsIGFsbFBvaW50cywgMCwgb2xkUG9pbnRzLmxlbmd0aCk7CgkgICAgICAgICAgICBTeXN0ZW1fMSQxLmRlZmF1bHQuYXJyYXljb3B5KG5ld1BvaW50cywgMCwgYWxsUG9pbnRzLCBvbGRQb2ludHMubGVuZ3RoLCBuZXdQb2ludHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gYWxsUG9pbnRzOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRleHQ7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0OwoJfSgpKTsKCVJlc3VsdCQxLmRlZmF1bHQgPSBSZXN1bHQ7CgoJdmFyIFJlc3VsdE1ldGFkYXRhVHlwZSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA4IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHRNZXRhZGF0YVR5cGUkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogUmVwcmVzZW50cyBzb21lIHR5cGUgb2YgbWV0YWRhdGEgYWJvdXQgdGhlIHJlc3VsdCBvZiB0aGUgZGVjb2RpbmcgdGhhdCB0aGUgZGVjb2RlcgoJICogd2lzaGVzIHRvIGNvbW11bmljYXRlIGJhY2sgdG8gdGhlIGNhbGxlci4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlOwoJKGZ1bmN0aW9uIChSZXN1bHRNZXRhZGF0YVR5cGUpIHsKCSAgICAvKioKCSAgICAgKiBVbnNwZWNpZmllZCwgYXBwbGljYXRpb24tc3BlY2lmaWMgbWV0YWRhdGEuIE1hcHMgdG8gYW4gdW5zcGVjaWZpZWQge0BsaW5rIE9iamVjdH0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiT1RIRVIiXSA9IDBdID0gIk9USEVSIjsKCSAgICAvKioKCSAgICAgKiBEZW5vdGVzIHRoZSBsaWtlbHkgYXBwcm94aW1hdGUgb3JpZW50YXRpb24gb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGlzIHZhbHVlCgkgICAgICogaXMgZ2l2ZW4gYXMgZGVncmVlcyByb3RhdGVkIGNsb2Nrd2lzZSBmcm9tIHRoZSBub3JtYWwsIHVwcmlnaHQgb3JpZW50YXRpb24uCgkgICAgICogRm9yIGV4YW1wbGUgYSAxRCBiYXJjb2RlIHdoaWNoIHdhcyBmb3VuZCBieSByZWFkaW5nIHRvcC10by1ib3R0b20gd291bGQgYmUKCSAgICAgKiBzYWlkIHRvIGhhdmUgb3JpZW50YXRpb24gIjkwIi4gVGhpcyBrZXkgbWFwcyB0byBhbiB7QGxpbmsgSW50ZWdlcn0gd2hvc2UKCSAgICAgKiB2YWx1ZSBpcyBpbiB0aGUgcmFuZ2UgWzAsMzYwKS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJPUklFTlRBVElPTiJdID0gMV0gPSAiT1JJRU5UQVRJT04iOwoJICAgIC8qKgoJICAgICAqIDxwPjJEIGJhcmNvZGUgZm9ybWF0cyB0eXBpY2FsbHkgZW5jb2RlIHRleHQsIGJ1dCBhbGxvdyBmb3IgYSBzb3J0IG9mICdieXRlIG1vZGUnCgkgICAgICogd2hpY2ggaXMgc29tZXRpbWVzIHVzZWQgdG8gZW5jb2RlIGJpbmFyeSBkYXRhLiBXaGlsZSB7QGxpbmsgUmVzdWx0fSBtYWtlcyBhdmFpbGFibGUKCSAgICAgKiB0aGUgY29tcGxldGUgcmF3IGJ5dGVzIGluIHRoZSBiYXJjb2RlIGZvciB0aGVzZSBmb3JtYXRzLCBpdCBkb2VzIG5vdCBvZmZlciB0aGUgYnl0ZXMKCSAgICAgKiBmcm9tIHRoZSBieXRlIHNlZ21lbnRzIGFsb25lLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWFwcyB0byBhIHtAbGluayBqYXZhLnV0aWwuTGlzdH0gb2YgYnl0ZSBhcnJheXMgY29ycmVzcG9uZGluZyB0byB0aGUKCSAgICAgKiByYXcgYnl0ZXMgaW4gdGhlIGJ5dGUgc2VnbWVudHMgaW4gdGhlIGJhcmNvZGUsIGluIG9yZGVyLjwvcD4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJCWVRFX1NFR01FTlRTIl0gPSAyXSA9ICJCWVRFX1NFR01FTlRTIjsKCSAgICAvKioKCSAgICAgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIHVzZWQsIGlmIGFwcGxpY2FibGUuIFRoZSB2YWx1ZSB0eXBlIGRlcGVuZHMgb24gdGhlCgkgICAgICogZm9ybWF0LCBidXQgaXMgdHlwaWNhbGx5IGEgU3RyaW5nLgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiXSA9IDNdID0gIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHBlcmlvZGljYWxzLCBpbmRpY2F0ZXMgdGhlIGlzc3VlIG51bWJlciBhcyBhbiB7QGxpbmsgSW50ZWdlcn0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiSVNTVUVfTlVNQkVSIl0gPSA0XSA9ICJJU1NVRV9OVU1CRVIiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHByb2R1Y3RzLCBpbmRpY2F0ZXMgdGhlIHN1Z2dlc3RlZCByZXRhaWwgcHJpY2UgaW4gdGhlIGJhcmNvZGUgYXMgYQoJICAgICAqIGZvcm1hdHRlZCB7QGxpbmsgU3RyaW5nfS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJTVUdHRVNURURfUFJJQ0UiXSA9IDVdID0gIlNVR0dFU1RFRF9QUklDRSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBwb3NzaWJsZSBjb3VudHJ5IG9mIG1hbnVmYWN0dXJlIGFzIGEge0BsaW5rIFN0cmluZ30gZGVub3RpbmcgdGhlCgkgICAgICogSVNPIGNvdW50cnkgY29kZS4gU29tZSBtYXAgdG8gbXVsdGlwbGUgcG9zc2libGUgY291bnRyaWVzLCBsaWtlICJVUy9DQSIuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUE9TU0lCTEVfQ09VTlRSWSJdID0gNl0gPSAiUE9TU0lCTEVfQ09VTlRSWSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBleHRlbnNpb24gdGV4dAoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSA3XSA9ICJVUENfRUFOX0VYVEVOU0lPTiI7CgkgICAgLyoqCgkgICAgICogUERGNDE3LXNwZWNpZmljIG1ldGFkYXRhCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUERGNDE3X0VYVFJBX01FVEFEQVRBIl0gPSA4XSA9ICJQREY0MTdfRVhUUkFfTUVUQURBVEEiOwoJICAgIC8qKgoJICAgICAqIElmIHRoZSBjb2RlIGZvcm1hdCBzdXBwb3J0cyBzdHJ1Y3R1cmVkIGFwcGVuZCBhbmQgdGhlIGN1cnJlbnQgc2Nhbm5lZCBjb2RlIGlzIHBhcnQgb2Ygb25lIHRoZW4gdGhlCgkgICAgICogc2VxdWVuY2UgbnVtYmVyIGlzIGdpdmVuIHdpdGggaXQuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UiXSA9IDldID0gIlNUUlVDVFVSRURfQVBQRU5EX1NFUVVFTkNFIjsKCSAgICAvKioKCSAgICAgKiBJZiB0aGUgY29kZSBmb3JtYXQgc3VwcG9ydHMgc3RydWN0dXJlZCBhcHBlbmQgYW5kIHRoZSBjdXJyZW50IHNjYW5uZWQgY29kZSBpcyBwYXJ0IG9mIG9uZSB0aGVuIHRoZQoJICAgICAqIHBhcml0eSBpcyBnaXZlbiB3aXRoIGl0LgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSJdID0gMTBdID0gIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSI7Cgl9KShSZXN1bHRNZXRhZGF0YVR5cGUgfHwgKFJlc3VsdE1ldGFkYXRhVHlwZSA9IHt9KSk7CglSZXN1bHRNZXRhZGF0YVR5cGUkMS5kZWZhdWx0ID0gUmVzdWx0TWV0YWRhdGFUeXBlOwoKCXZhciBEZWNvZGVyJDEgPSB7fTsKCgl2YXIgQ2hlY2tzdW1FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkOCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGVja3N1bUV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNCA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBDaGVja3N1bUV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkOChDaGVja3N1bUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBDaGVja3N1bUV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5nZXRDaGVja3N1bUluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IENoZWNrc3VtRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5raW5kID0gJ0NoZWNrc3VtRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQ2hlY2tzdW1FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCkpOwoJQ2hlY2tzdW1FeGNlcHRpb24kMS5kZWZhdWx0ID0gQ2hlY2tzdW1FeGNlcHRpb247CgoJdmFyIEdlbmVyaWNHRiQxID0ge307CgoJdmFyIEdlbmVyaWNHRlBvbHkkMSA9IHt9OwoKCXZhciBBYnN0cmFjdEdlbmVyaWNHRiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYnN0cmFjdEdlbmVyaWNHRiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGNvbnRhaW5zIHV0aWxpdHkgbWV0aG9kcyBmb3IgcGVyZm9ybWluZyBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvdmVyCgkgKiB0aGUgR2Fsb2lzIEZpZWxkcy4gT3BlcmF0aW9ucyB1c2UgYSBnaXZlbiBwcmltaXRpdmUgcG9seW5vbWlhbCBpbiBjYWxjdWxhdGlvbnMuPC9wPgoJICoKCSAqIDxwPlRocm91Z2hvdXQgdGhpcyBwYWNrYWdlLCBlbGVtZW50cyBvZiB0aGUgR0YgYXJlIHJlcHJlc2VudGVkIGFzIGFuIHtAY29kZSBpbnR9CgkgKiBmb3IgY29udmVuaWVuY2UgYW5kIHNwZWVkIChidXQgYXQgdGhlIGNvc3Qgb2YgbWVtb3J5KS4KCSAqIDwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBEYXZpZCBPbGl2aWVyCgkgKi8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBYnN0cmFjdEdlbmVyaWNHRigpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiAyIHRvIHRoZSBwb3dlciBvZiBhIGluIEdGKHNpemUpCgkgICAgICovCgkgICAgQWJzdHJhY3RHZW5lcmljR0YucHJvdG90eXBlLmV4cCA9IGZ1bmN0aW9uIChhKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmV4cFRhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBiYXNlIDIgbG9nIG9mIGEgaW4gR0Yoc2l6ZSkKCSAgICAgKi8KCSAgICBBYnN0cmFjdEdlbmVyaWNHRi5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKGEgLyppbnQqLykgewoJICAgICAgICBpZiAoYSA9PT0gMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0aGlzLmxvZ1RhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSW1wbGVtZW50cyBib3RoIGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbiAtLSB0aGV5IGFyZSB0aGUgc2FtZSBpbiBHRihzaXplKS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gc3VtL2RpZmZlcmVuY2Ugb2YgYSBhbmQgYgoJICAgICAqLwoJICAgIEFic3RyYWN0R2VuZXJpY0dGLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIGEgXiBiOwoJICAgIH07CgkgICAgcmV0dXJuIEFic3RyYWN0R2VuZXJpY0dGOwoJfSgpKTsKCUFic3RyYWN0R2VuZXJpY0dGJDEuZGVmYXVsdCA9IEFic3RyYWN0R2VuZXJpY0dGOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGUG9seSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5yZWVkc29sb21vbiB7Ki8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRl8xJDEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIFN5c3RlbV8xID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNCA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgcG9seW5vbWlhbCB3aG9zZSBjb2VmZmljaWVudHMgYXJlIGVsZW1lbnRzIG9mIGEgR0YuCgkgKiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBhcmUgaW1tdXRhYmxlLjwvcD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdlbmVyaWNHRlBvbHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGZpZWxkIHRoZSB7QGxpbmsgR2VuZXJpY0dGfSBpbnN0YW5jZSByZXByZXNlbnRpbmcgdGhlIGZpZWxkIHRvIHVzZQoJICAgICAqIHRvIHBlcmZvcm0gY29tcHV0YXRpb25zCgkgICAgICogQHBhcmFtIGNvZWZmaWNpZW50cyBjb2VmZmljaWVudHMgYXMgaW50cyByZXByZXNlbnRpbmcgZWxlbWVudHMgb2YgR0Yoc2l6ZSksIGFycmFuZ2VkCgkgICAgICogZnJvbSBtb3N0IHNpZ25pZmljYW50IChoaWdoZXN0LXBvd2VyIHRlcm0pIGNvZWZmaWNpZW50IHRvIGxlYXN0IHNpZ25pZmljYW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYXJndW1lbnQgaXMgbnVsbCBvciBlbXB0eSwKCSAgICAgKiBvciBpZiBsZWFkaW5nIGNvZWZmaWNpZW50IGlzIDAgYW5kIHRoaXMgaXMgbm90IGEKCSAgICAgKiBjb25zdGFudCBwb2x5bm9taWFsICh0aGF0IGlzLCBpdCBpcyBub3QgdGhlIG1vbm9taWFsICIwIikKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBHZW5lcmljR0ZQb2x5KGZpZWxkLCBjb2VmZmljaWVudHMpIHsKCSAgICAgICAgaWYgKGNvZWZmaWNpZW50cy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHNMZW5ndGggPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICBpZiAoY29lZmZpY2llbnRzTGVuZ3RoID4gMSAmJiBjb2VmZmljaWVudHNbMF0gPT09IDApIHsKCSAgICAgICAgICAgIC8vIExlYWRpbmcgdGVybSBtdXN0IGJlIG5vbi16ZXJvIGZvciBhbnl0aGluZyBleGNlcHQgdGhlIGNvbnN0YW50IHBvbHlub21pYWwgIjAiCgkgICAgICAgICAgICB2YXIgZmlyc3ROb25aZXJvID0gMTsKCSAgICAgICAgICAgIHdoaWxlIChmaXJzdE5vblplcm8gPCBjb2VmZmljaWVudHNMZW5ndGggJiYgY29lZmZpY2llbnRzW2ZpcnN0Tm9uWmVyb10gPT09IDApIHsKCSAgICAgICAgICAgICAgICBmaXJzdE5vblplcm8rKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChmaXJzdE5vblplcm8gPT09IGNvZWZmaWNpZW50c0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRoaXMuY29lZmZpY2llbnRzID0gSW50MzJBcnJheS5mcm9tKFswXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50cyA9IG5ldyBJbnQzMkFycmF5KGNvZWZmaWNpZW50c0xlbmd0aCAtIGZpcnN0Tm9uWmVybyk7CgkgICAgICAgICAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkoY29lZmZpY2llbnRzLCBmaXJzdE5vblplcm8sIHRoaXMuY29lZmZpY2llbnRzLCAwLCB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudHMgPSBjb2VmZmljaWVudHM7CgkgICAgICAgIH0KCSAgICB9CgkgICAgR2VuZXJpY0dGUG9seS5wcm90b3R5cGUuZ2V0Q29lZmZpY2llbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGRlZ3JlZSBvZiB0aGlzIHBvbHlub21pYWwKCSAgICAgKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5nZXREZWdyZWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGlzIHBvbHlub21pYWwgaXMgdGhlIG1vbm9taWFsICIwIgoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmlzWmVybyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29lZmZpY2llbnRzWzBdID09PSAwOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBjb2VmZmljaWVudCBvZiB4XmRlZ3JlZSB0ZXJtIGluIHRoaXMgcG9seW5vbWlhbAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmdldENvZWZmaWNpZW50ID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50c1t0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxIC0gZGVncmVlXTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gZXZhbHVhdGlvbiBvZiB0aGlzIHBvbHlub21pYWwgYXQgYSBnaXZlbiBwb2ludAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmV2YWx1YXRlQXQgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHJldHVybiB0aGUgeF4wIGNvZWZmaWNpZW50CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciByZXN1bHQ7CgkgICAgICAgIGlmIChhID09PSAxKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHRoZSBzdW0gb2YgdGhlIGNvZWZmaWNpZW50cwoJICAgICAgICAgICAgcmVzdWx0ID0gMDsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7IGkgIT09IGxlbmd0aF8xOyBpKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgY29lZmZpY2llbnQgPSBjb2VmZmljaWVudHNbaV07CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gQWJzdHJhY3RHZW5lcmljR0ZfMSQxLmRlZmF1bHQuYWRkT3JTdWJ0cmFjdChyZXN1bHQsIGNvZWZmaWNpZW50KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgICAgIH0KCSAgICAgICAgcmVzdWx0ID0gY29lZmZpY2llbnRzWzBdOwoJICAgICAgICB2YXIgc2l6ZSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICByZXN1bHQgPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KGZpZWxkLm11bHRpcGx5KGEsIHJlc3VsdCksIGNvZWZmaWNpZW50c1tpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRoaXMuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiBvdGhlcjsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3RoZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzbWFsbGVyQ29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBsYXJnZXJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIGlmIChzbWFsbGVyQ29lZmZpY2llbnRzLmxlbmd0aCA+IGxhcmdlckNvZWZmaWNpZW50cy5sZW5ndGgpIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gc21hbGxlckNvZWZmaWNpZW50czsKCSAgICAgICAgICAgIHNtYWxsZXJDb2VmZmljaWVudHMgPSBsYXJnZXJDb2VmZmljaWVudHM7CgkgICAgICAgICAgICBsYXJnZXJDb2VmZmljaWVudHMgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzdW1EaWZmID0gbmV3IEludDMyQXJyYXkobGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCk7CgkgICAgICAgIHZhciBsZW5ndGhEaWZmID0gbGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCAtIHNtYWxsZXJDb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICAvLyBDb3B5IGhpZ2gtb3JkZXIgdGVybXMgb25seSBmb3VuZCBpbiBoaWdoZXItZGVncmVlIHBvbHlub21pYWwncyBjb2VmZmljaWVudHMKCSAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkobGFyZ2VyQ29lZmZpY2llbnRzLCAwLCBzdW1EaWZmLCAwLCBsZW5ndGhEaWZmKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGxlbmd0aERpZmY7IGkgPCBsYXJnZXJDb2VmZmljaWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHN1bURpZmZbaV0gPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KHNtYWxsZXJDb2VmZmljaWVudHNbaSAtIGxlbmd0aERpZmZdLCBsYXJnZXJDb2VmZmljaWVudHNbaV0pOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seSh0aGlzLmZpZWxkLCBzdW1EaWZmKTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5ID0gZnVuY3Rpb24gKG90aGVyKSB7CgkgICAgICAgIGlmICghdGhpcy5maWVsZC5lcXVhbHMob3RoZXIuZmllbGQpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdHZW5lcmljR0ZQb2x5cyBkbyBub3QgaGF2ZSBzYW1lIEdlbmVyaWNHRiBmaWVsZCcpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh0aGlzLmlzWmVybygpIHx8IG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGFDb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIGFMZW5ndGggPSBhQ29lZmZpY2llbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBiTGVuZ3RoID0gYkNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoYUxlbmd0aCArIGJMZW5ndGggLSAxKTsKCSAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhTGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBhQ29lZmYgPSBhQ29lZmZpY2llbnRzW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgICAgICBwcm9kdWN0W2kgKyBqXSA9IEFic3RyYWN0R2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocHJvZHVjdFtpICsgal0sIGZpZWxkLm11bHRpcGx5KGFDb2VmZiwgYkNvZWZmaWNpZW50c1tqXSkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5tdWx0aXBseVNjYWxhciA9IGZ1bmN0aW9uIChzY2FsYXIgLyppbnQqLykgewoJICAgICAgICBpZiAoc2NhbGFyID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHNjYWxhciA9PT0gMSkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIHByb2R1Y3RbaV0gPSBmaWVsZC5tdWx0aXBseShjb2VmZmljaWVudHNbaV0sIHNjYWxhcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljR0ZQb2x5KGZpZWxkLCBwcm9kdWN0KTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5QnlNb25vbWlhbCA9IGZ1bmN0aW9uIChkZWdyZWUgLyppbnQqLywgY29lZmZpY2llbnQgLyppbnQqLykgewoJICAgICAgICBpZiAoZGVncmVlIDwgMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChjb2VmZmljaWVudCA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZ2V0WmVybygpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIHNpemUgPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBJbnQzMkFycmF5KHNpemUgKyBkZWdyZWUpOwoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykgewoJICAgICAgICAgICAgcHJvZHVjdFtpXSA9IGZpZWxkLm11bHRpcGx5KGNvZWZmaWNpZW50c1tpXSwgY29lZmZpY2llbnQpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5kaXZpZGUgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdEaXZpZGUgYnkgMCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBxdW90aWVudCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXM7CgkgICAgICAgIHZhciBkZW5vbWluYXRvckxlYWRpbmdUZXJtID0gb3RoZXIuZ2V0Q29lZmZpY2llbnQob3RoZXIuZ2V0RGVncmVlKCkpOwoJICAgICAgICB2YXIgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0gPSBmaWVsZC5pbnZlcnNlKGRlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICB3aGlsZSAocmVtYWluZGVyLmdldERlZ3JlZSgpID49IG90aGVyLmdldERlZ3JlZSgpICYmICFyZW1haW5kZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHZhciBkZWdyZWVEaWZmZXJlbmNlID0gcmVtYWluZGVyLmdldERlZ3JlZSgpIC0gb3RoZXIuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICB2YXIgc2NhbGUgPSBmaWVsZC5tdWx0aXBseShyZW1haW5kZXIuZ2V0Q29lZmZpY2llbnQocmVtYWluZGVyLmdldERlZ3JlZSgpKSwgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICAgICAgdmFyIHRlcm0gPSBvdGhlci5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZmVyZW5jZSwgc2NhbGUpOwoJICAgICAgICAgICAgdmFyIGl0ZXJhdGlvblF1b3RpZW50ID0gZmllbGQuYnVpbGRNb25vbWlhbChkZWdyZWVEaWZmZXJlbmNlLCBzY2FsZSk7CgkgICAgICAgICAgICBxdW90aWVudCA9IHF1b3RpZW50LmFkZE9yU3VidHJhY3QoaXRlcmF0aW9uUXVvdGllbnQpOwoJICAgICAgICAgICAgcmVtYWluZGVyID0gcmVtYWluZGVyLmFkZE9yU3VidHJhY3QodGVybSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFtxdW90aWVudCwgcmVtYWluZGVyXTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJlc3VsdCA9ICcnOwoJICAgICAgICBmb3IgKHZhciBkZWdyZWUgPSB0aGlzLmdldERlZ3JlZSgpOyBkZWdyZWUgPj0gMDsgZGVncmVlLS0pIHsKCSAgICAgICAgICAgIHZhciBjb2VmZmljaWVudCA9IHRoaXMuZ2V0Q29lZmZpY2llbnQoZGVncmVlKTsKCSAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCA8IDApIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgLSAnOwoJICAgICAgICAgICAgICAgICAgICBjb2VmZmljaWVudCA9IC1jb2VmZmljaWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgKyAnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgPT09IDAgfHwgY29lZmZpY2llbnQgIT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhUG93ZXIgPSB0aGlzLmZpZWxkLmxvZyhjb2VmZmljaWVudCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChhbHBoYVBvd2VyID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJzEnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFscGhhUG93ZXIgPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnYSc7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ2FeJzsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBhbHBoYVBvd2VyOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZSA9PT0gMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICd4JzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAneF4nOwoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlZ3JlZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIEdlbmVyaWNHRlBvbHk7Cgl9KCkpOwoJR2VuZXJpY0dGUG9seSQxLmRlZmF1bHQgPSBHZW5lcmljR0ZQb2x5OwoKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkMyA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcml0aG1ldGljRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ3KEFyaXRobWV0aWNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJpdGhtZXRpY0V4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcml0aG1ldGljRXhjZXB0aW9uLmtpbmQgPSAnQXJpdGhtZXRpY0V4Y2VwdGlvbic7CgkgICAgcmV0dXJuIEFyaXRobWV0aWNFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCkpOwoJQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLmRlZmF1bHQgPSBBcml0aG1ldGljRXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uLnJlZWRzb2xvbW9uIHsqLwoJdmFyIEdlbmVyaWNHRlBvbHlfMSQxID0gR2VuZXJpY0dGUG9seSQxOwoJdmFyIEFic3RyYWN0R2VuZXJpY0dGXzEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIEludGVnZXJfMSQxID0gSW50ZWdlciQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDMgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uXzEgPSBBcml0aG1ldGljRXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgY29udGFpbnMgdXRpbGl0eSBtZXRob2RzIGZvciBwZXJmb3JtaW5nIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG92ZXIKCSAqIHRoZSBHYWxvaXMgRmllbGRzLiBPcGVyYXRpb25zIHVzZSBhIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsIGluIGNhbGN1bGF0aW9ucy48L3A+CgkgKgoJICogPHA+VGhyb3VnaG91dCB0aGlzIHBhY2thZ2UsIGVsZW1lbnRzIG9mIHRoZSBHRiBhcmUgcmVwcmVzZW50ZWQgYXMgYW4ge0Bjb2RlIGludH0KCSAqIGZvciBjb252ZW5pZW5jZSBhbmQgc3BlZWQgKGJ1dCBhdCB0aGUgY29zdCBvZiBtZW1vcnkpLgoJICogPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKiBAYXV0aG9yIERhdmlkIE9saXZpZXIKCSAqLwoJdmFyIEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkNihHZW5lcmljR0YsIF9zdXBlcik7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGEgcmVwcmVzZW50YXRpb24gb2YgR0Yoc2l6ZSkgdXNpbmcgdGhlIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsLgoJICAgICAqCgkgICAgICogQHBhcmFtIHByaW1pdGl2ZSBpcnJlZHVjaWJsZSBwb2x5bm9taWFsIHdob3NlIGNvZWZmaWNpZW50cyBhcmUgcmVwcmVzZW50ZWQgYnkKCSAgICAgKiAgdGhlIGJpdHMgb2YgYW4gaW50LCB3aGVyZSB0aGUgbGVhc3Qtc2lnbmlmaWNhbnQgYml0IHJlcHJlc2VudHMgdGhlIGNvbnN0YW50CgkgICAgICogIGNvZWZmaWNpZW50CgkgICAgICogQHBhcmFtIHNpemUgdGhlIHNpemUgb2YgdGhlIGZpZWxkCgkgICAgICogQHBhcmFtIGIgdGhlIGZhY3RvciBiIGluIHRoZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBjYW4gYmUgMC0gb3IgMS1iYXNlZAoJICAgICAqICAoZyh4KSA9ICh4K2FeYikoeCthXihiKzEpKS4uLih4K2FeKGIrMnQtMSkpKS4KCSAgICAgKiAgSW4gbW9zdCBjYXNlcyBpdCBzaG91bGQgYmUgMSwgYnV0IGZvciBRUiBjb2RlIGl0IGlzIDAuCgkgICAgICovCgkgICAgZnVuY3Rpb24gR2VuZXJpY0dGKHByaW1pdGl2ZSAvKmludCovLCBzaXplIC8qaW50Ki8sIGdlbmVyYXRvckJhc2UgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5wcmltaXRpdmUgPSBwcmltaXRpdmU7CgkgICAgICAgIF90aGlzLnNpemUgPSBzaXplOwoJICAgICAgICBfdGhpcy5nZW5lcmF0b3JCYXNlID0gZ2VuZXJhdG9yQmFzZTsKCSAgICAgICAgdmFyIGV4cFRhYmxlID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciB4ID0gMTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIGV4cFRhYmxlW2ldID0geDsKCSAgICAgICAgICAgIHggKj0gMjsgLy8gd2UncmUgYXNzdW1pbmcgdGhlIGdlbmVyYXRvciBhbHBoYSBpcyAyCgkgICAgICAgICAgICBpZiAoeCA+PSBzaXplKSB7CgkgICAgICAgICAgICAgICAgeCBePSBwcmltaXRpdmU7CgkgICAgICAgICAgICAgICAgeCAmPSBzaXplIC0gMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBfdGhpcy5leHBUYWJsZSA9IGV4cFRhYmxlOwoJICAgICAgICB2YXIgbG9nVGFibGUgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplIC0gMTsgaSsrKSB7CgkgICAgICAgICAgICBsb2dUYWJsZVtleHBUYWJsZVtpXV0gPSBpOwoJICAgICAgICB9CgkgICAgICAgIF90aGlzLmxvZ1RhYmxlID0gbG9nVGFibGU7CgkgICAgICAgIC8vIGxvZ1RhYmxlWzBdID09IDAgYnV0IHRoaXMgc2hvdWxkIG5ldmVyIGJlIHVzZWQKCSAgICAgICAgX3RoaXMuemVybyA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzBdKSk7CgkgICAgICAgIF90aGlzLm9uZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzFdKSk7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRaZXJvID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRPbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm9uZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdGhlIG1vbm9taWFsIHJlcHJlc2VudGluZyBjb2VmZmljaWVudCAqIHheZGVncmVlCgkgICAgICovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5idWlsZE1vbm9taWFsID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovLCBjb2VmZmljaWVudCAvKmludCovKSB7CgkgICAgICAgIGlmIChkZWdyZWUgPCAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkMy5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvZWZmaWNpZW50ID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheShkZWdyZWUgKyAxKTsKCSAgICAgICAgY29lZmZpY2llbnRzWzBdID0gY29lZmZpY2llbnQ7CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seV8xJDEuZGVmYXVsdCh0aGlzLCBjb2VmZmljaWVudHMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBtdWx0aXBsaWNhdGl2ZSBpbnZlcnNlIG9mIGEKCSAgICAgKi8KCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQXJpdGhtZXRpY0V4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5leHBUYWJsZVt0aGlzLnNpemUgLSB0aGlzLmxvZ1RhYmxlW2FdIC0gMV07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHByb2R1Y3Qgb2YgYSBhbmQgYiBpbiBHRihzaXplKQoJICAgICAqLwoJICAgIEdlbmVyaWNHRi5wcm90b3R5cGUubXVsdGlwbHkgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGEgPT09IDAgfHwgYiA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDA7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZXhwVGFibGVbKHRoaXMubG9nVGFibGVbYV0gKyB0aGlzLmxvZ1RhYmxlW2JdKSAlICh0aGlzLnNpemUgLSAxKV07CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnNpemU7CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldEdlbmVyYXRvckJhc2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvckJhc2U7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICgnR0YoMHgnICsgSW50ZWdlcl8xJDEuZGVmYXVsdC50b0hleFN0cmluZyh0aGlzLnByaW1pdGl2ZSkgKyAnLCcgKyB0aGlzLnNpemUgKyAnKScpOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICByZXR1cm4gbyA9PT0gdGhpczsKCSAgICB9OwoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEyID0gbmV3IEdlbmVyaWNHRigweDEwNjksIDQwOTYsIDEpOyAvLyB4XjEyICsgeF42ICsgeF41ICsgeF4zICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEwID0gbmV3IEdlbmVyaWNHRigweDQwOSwgMTAyNCwgMSk7IC8vIHheMTAgKyB4XjMgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfNiA9IG5ldyBHZW5lcmljR0YoMHg0MywgNjQsIDEpOyAvLyB4XjYgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19QQVJBTSA9IG5ldyBHZW5lcmljR0YoMHgxMywgMTYsIDEpOyAvLyB4XjQgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5RUl9DT0RFX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTFkLCAyNTYsIDApOyAvLyB4XjggKyB4XjQgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkRBVEFfTUFUUklYX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTJkLCAyNTYsIDEpOyAvLyB4XjggKyB4XjUgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfOCA9IEdlbmVyaWNHRi5EQVRBX01BVFJJWF9GSUVMRF8yNTY7CgkgICAgR2VuZXJpY0dGLk1BWElDT0RFX0ZJRUxEXzY0ID0gR2VuZXJpY0dGLkFaVEVDX0RBVEFfNjsKCSAgICByZXR1cm4gR2VuZXJpY0dGOwoJfShBYnN0cmFjdEdlbmVyaWNHRl8xLmRlZmF1bHQpKTsKCUdlbmVyaWNHRiQxLmRlZmF1bHQgPSBHZW5lcmljR0Y7CgoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciQxID0ge307CgoJdmFyIFJlZWRTb2xvbW9uRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDUgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVlZFNvbG9tb25FeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDIgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgUmVlZFNvbG9tb25FeGNlcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDUoUmVlZFNvbG9tb25FeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gUmVlZFNvbG9tb25FeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgUmVlZFNvbG9tb25FeGNlcHRpb24ua2luZCA9ICdSZWVkU29sb21vbkV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQyLmRlZmF1bHQpKTsKCVJlZWRTb2xvbW9uRXhjZXB0aW9uJDEuZGVmYXVsdCA9IFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkNCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDEgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ0KElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uLmtpbmQgPSAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQxLmRlZmF1bHQpKTsKCUlsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWVkU29sb21vbkRlY29kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24ucmVlZHNvbG9tb24geyovCgl2YXIgR2VuZXJpY0dGXzEkMSA9IEdlbmVyaWNHRiQxOwoJdmFyIEdlbmVyaWNHRlBvbHlfMSA9IEdlbmVyaWNHRlBvbHkkMTsKCXZhciBSZWVkU29sb21vbkV4Y2VwdGlvbl8xID0gUmVlZFNvbG9tb25FeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5JbXBsZW1lbnRzIFJlZWQtU29sb21vbiBkZWNvZGluZywgYXMgdGhlIG5hbWUgaW1wbGllcy48L3A+CgkgKgoJICogPHA+VGhlIGFsZ29yaXRobSB3aWxsIG5vdCBiZSBleHBsYWluZWQgaGVyZSwgYnV0IHRoZSBmb2xsb3dpbmcgcmVmZXJlbmNlcyB3ZXJlIGhlbHBmdWwKCSAqIGluIGNyZWF0aW5nIHRoaXMgaW1wbGVtZW50YXRpb246PC9wPgoJICoKCSAqIDx1bD4KCSAqIDxsaT5CcnVjZSBNYWdncy4KCSAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuY3MuY211LmVkdS9hZnMvY3MuY211LmVkdS9wcm9qZWN0L3BzY2ljby1ndXliL3JlYWx3b3JsZC93d3cvcnNfZGVjb2RlLnBzIj4KCSAqICJEZWNvZGluZyBSZWVkLVNvbG9tb24gQ29kZXMiPC9hPiAoc2VlIGRpc2N1c3Npb24gb2YgRm9ybmV5J3MgRm9ybXVsYSk8L2xpPgoJICogPGxpPkouSS4gSGFsbC4gPGEgaHJlZj0id3d3Lm10aC5tc3UuZWR1L35qaGFsbC9jbGFzc2VzL2NvZGVub3Rlcy9HUlMucGRmIj4KCSAqICJDaGFwdGVyIDUuIEdlbmVyYWxpemVkIFJlZWQtU29sb21vbiBDb2RlcyI8L2E+CgkgKiAoc2VlIGRpc2N1c3Npb24gb2YgRXVjbGlkZWFuIGFsZ29yaXRobSk8L2xpPgoJICogPC91bD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgV2lsbGlhbSBSdWNrbGlkZ2UKCSAqIEBhdXRob3Igc2FuZm9yZHNxdWlyZXMKCSAqLwoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBSZWVkU29sb21vbkRlY29kZXIoZmllbGQpIHsKCSAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5EZWNvZGVzIGdpdmVuIHNldCBvZiByZWNlaXZlZCBjb2Rld29yZHMsIHdoaWNoIGluY2x1ZGUgYm90aCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uCgkgICAgICogY29kZXdvcmRzLiBSZWFsbHksIHRoaXMgbWVhbnMgaXQgdXNlcyBSZWVkLVNvbG9tb24gdG8gZGV0ZWN0IGFuZCBjb3JyZWN0IGVycm9ycywgaW4tcGxhY2UsCgkgICAgICogaW4gdGhlIGlucHV0LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByZWNlaXZlZCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcwoJICAgICAqIEBwYXJhbSB0d29TIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBhdmFpbGFibGUKCSAgICAgKiBAdGhyb3dzIFJlZWRTb2xvbW9uRXhjZXB0aW9uIGlmIGRlY29kaW5nIGZhaWxzIGZvciBhbnkgcmVhc29uCgkgICAgICovCgkgICAgUmVlZFNvbG9tb25EZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAocmVjZWl2ZWQsIHR3b1MgLyppbnQqLykgewoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgcG9seSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgcmVjZWl2ZWQpOwoJICAgICAgICB2YXIgc3luZHJvbWVDb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheSh0d29TKTsKCSAgICAgICAgdmFyIG5vRXJyb3IgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR3b1M7IGkrKykgewoJICAgICAgICAgICAgdmFyIGV2YWxSZXN1bHQgPSBwb2x5LmV2YWx1YXRlQXQoZmllbGQuZXhwKGkgKyBmaWVsZC5nZXRHZW5lcmF0b3JCYXNlKCkpKTsKCSAgICAgICAgICAgIHN5bmRyb21lQ29lZmZpY2llbnRzW3N5bmRyb21lQ29lZmZpY2llbnRzLmxlbmd0aCAtIDEgLSBpXSA9IGV2YWxSZXN1bHQ7CgkgICAgICAgICAgICBpZiAoZXZhbFJlc3VsdCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAobm9FcnJvcikgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzeW5kcm9tZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgc3luZHJvbWVDb2VmZmljaWVudHMpOwoJICAgICAgICB2YXIgc2lnbWFPbWVnYSA9IHRoaXMucnVuRXVjbGlkZWFuQWxnb3JpdGhtKGZpZWxkLmJ1aWxkTW9ub21pYWwodHdvUywgMSksIHN5bmRyb21lLCB0d29TKTsKCSAgICAgICAgdmFyIHNpZ21hID0gc2lnbWFPbWVnYVswXTsKCSAgICAgICAgdmFyIG9tZWdhID0gc2lnbWFPbWVnYVsxXTsKCSAgICAgICAgdmFyIGVycm9yTG9jYXRpb25zID0gdGhpcy5maW5kRXJyb3JMb2NhdGlvbnMoc2lnbWEpOwoJICAgICAgICB2YXIgZXJyb3JNYWduaXR1ZGVzID0gdGhpcy5maW5kRXJyb3JNYWduaXR1ZGVzKG9tZWdhLCBlcnJvckxvY2F0aW9ucyk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JMb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlY2VpdmVkLmxlbmd0aCAtIDEgLSBmaWVsZC5sb2coZXJyb3JMb2NhdGlvbnNbaV0pOwoJICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ0JhZCBlcnJvciBsb2NhdGlvbicpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVjZWl2ZWRbcG9zaXRpb25dID0gR2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocmVjZWl2ZWRbcG9zaXRpb25dLCBlcnJvck1hZ25pdHVkZXNbaV0pOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZWVkU29sb21vbkRlY29kZXIucHJvdG90eXBlLnJ1bkV1Y2xpZGVhbkFsZ29yaXRobSA9IGZ1bmN0aW9uIChhLCBiLCBSIC8qaW50Ki8pIHsKCSAgICAgICAgLy8gQXNzdW1lIGEncyBkZWdyZWUgaXMgPj0gYidzCgkgICAgICAgIGlmIChhLmdldERlZ3JlZSgpIDwgYi5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgdmFyIHRlbXAgPSBhOwoJICAgICAgICAgICAgYSA9IGI7CgkgICAgICAgICAgICBiID0gdGVtcDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgckxhc3QgPSBhOwoJICAgICAgICB2YXIgciA9IGI7CgkgICAgICAgIHZhciB0TGFzdCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHQgPSBmaWVsZC5nZXRPbmUoKTsKCSAgICAgICAgLy8gUnVuIEV1Y2xpZGVhbiBhbGdvcml0aG0gdW50aWwgcidzIGRlZ3JlZSBpcyBsZXNzIHRoYW4gUi8yCgkgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IChSIC8gMiB8IDApKSB7CgkgICAgICAgICAgICB2YXIgckxhc3RMYXN0ID0gckxhc3Q7CgkgICAgICAgICAgICB2YXIgdExhc3RMYXN0ID0gdExhc3Q7CgkgICAgICAgICAgICByTGFzdCA9IHI7CgkgICAgICAgICAgICB0TGFzdCA9IHQ7CgkgICAgICAgICAgICAvLyBEaXZpZGUgckxhc3RMYXN0IGJ5IHJMYXN0LCB3aXRoIHF1b3RpZW50IGluIHEgYW5kIHJlbWFpbmRlciBpbiByCgkgICAgICAgICAgICBpZiAockxhc3QuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgICAgICAvLyBPb3BzLCBFdWNsaWRlYW4gYWxnb3JpdGhtIGFscmVhZHkgdGVybWluYXRlZD8KCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVlZFNvbG9tb25FeGNlcHRpb25fMS5kZWZhdWx0KCdyX3tpLTF9IHdhcyB6ZXJvJyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByID0gckxhc3RMYXN0OwoJICAgICAgICAgICAgdmFyIHEgPSBmaWVsZC5nZXRaZXJvKCk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3JMZWFkaW5nVGVybSA9IHJMYXN0LmdldENvZWZmaWNpZW50KHJMYXN0LmdldERlZ3JlZSgpKTsKCSAgICAgICAgICAgIHZhciBkbHRJbnZlcnNlID0gZmllbGQuaW52ZXJzZShkZW5vbWluYXRvckxlYWRpbmdUZXJtKTsKCSAgICAgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IHJMYXN0LmdldERlZ3JlZSgpICYmICFyLmlzWmVybygpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlZ3JlZURpZmYgPSByLmdldERlZ3JlZSgpIC0gckxhc3QuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gZmllbGQubXVsdGlwbHkoci5nZXRDb2VmZmljaWVudChyLmdldERlZ3JlZSgpKSwgZGx0SW52ZXJzZSk7CgkgICAgICAgICAgICAgICAgcSA9IHEuYWRkT3JTdWJ0cmFjdChmaWVsZC5idWlsZE1vbm9taWFsKGRlZ3JlZURpZmYsIHNjYWxlKSk7CgkgICAgICAgICAgICAgICAgciA9IHIuYWRkT3JTdWJ0cmFjdChyTGFzdC5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZiwgc2NhbGUpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHQgPSBxLm11bHRpcGx5KHRMYXN0KS5hZGRPclN1YnRyYWN0KHRMYXN0TGFzdCk7CgkgICAgICAgICAgICBpZiAoci5nZXREZWdyZWUoKSA+PSByTGFzdC5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMS5kZWZhdWx0KCdEaXZpc2lvbiBhbGdvcml0aG0gZmFpbGVkIHRvIHJlZHVjZSBwb2x5bm9taWFsPycpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBzaWdtYVRpbGRlQXRaZXJvID0gdC5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgaWYgKHNpZ21hVGlsZGVBdFplcm8gPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ3NpZ21hVGlsZGUoMCkgd2FzIHplcm8nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaW52ZXJzZSA9IGZpZWxkLmludmVyc2Uoc2lnbWFUaWxkZUF0WmVybyk7CgkgICAgICAgIHZhciBzaWdtYSA9IHQubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHZhciBvbWVnYSA9IHIubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHJldHVybiBbc2lnbWEsIG9tZWdhXTsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTG9jYXRpb25zID0gZnVuY3Rpb24gKGVycm9yTG9jYXRvcikgewoJICAgICAgICAvLyBUaGlzIGlzIGEgZGlyZWN0IGFwcGxpY2F0aW9uIG9mIENoaWVuJ3Mgc2VhcmNoCgkgICAgICAgIHZhciBudW1FcnJvcnMgPSBlcnJvckxvY2F0b3IuZ2V0RGVncmVlKCk7CgkgICAgICAgIGlmIChudW1FcnJvcnMgPT09IDEpIHsgLy8gc2hvcnRjdXQKCSAgICAgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2Vycm9yTG9jYXRvci5nZXRDb2VmZmljaWVudCgxKV0pOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgSW50MzJBcnJheShudW1FcnJvcnMpOwoJICAgICAgICB2YXIgZSA9IDA7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZmllbGQuZ2V0U2l6ZSgpICYmIGUgPCBudW1FcnJvcnM7IGkrKykgewoJICAgICAgICAgICAgaWYgKGVycm9yTG9jYXRvci5ldmFsdWF0ZUF0KGkpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0W2VdID0gZmllbGQuaW52ZXJzZShpKTsKCSAgICAgICAgICAgICAgICBlKys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUgIT09IG51bUVycm9ycykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IFJlZWRTb2xvbW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnRXJyb3IgbG9jYXRvciBkZWdyZWUgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIHJvb3RzJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTWFnbml0dWRlcyA9IGZ1bmN0aW9uIChlcnJvckV2YWx1YXRvciwgZXJyb3JMb2NhdGlvbnMpIHsKCSAgICAgICAgLy8gVGhpcyBpcyBkaXJlY3RseSBhcHBseWluZyBGb3JuZXkncyBGb3JtdWxhCgkgICAgICAgIHZhciBzID0gZXJyb3JMb2NhdGlvbnMubGVuZ3RoOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEludDMyQXJyYXkocyk7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgczsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeGlJbnZlcnNlID0gZmllbGQuaW52ZXJzZShlcnJvckxvY2F0aW9uc1tpXSk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAxOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaikgewoJICAgICAgICAgICAgICAgICAgICAvLyBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLAoJICAgICAgICAgICAgICAgICAgICAvLyAgICBHZW5lcmljR0YuYWRkT3JTdWJ0cmFjdCgxLCBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKSkpCgkgICAgICAgICAgICAgICAgICAgIC8vIEFib3ZlIHNob3VsZCB3b3JrIGJ1dCBmYWlscyBvbiBzb21lIEFwcGxlIGFuZCBMaW51eCBKREtzIGR1ZSB0byBhIEhvdHNwb3QgYnVnLgoJICAgICAgICAgICAgICAgICAgICAvLyBCZWxvdyBpcyBhIGZ1bm55LWxvb2tpbmcgd29ya2Fyb3VuZCBmcm9tIFN0ZXZlbiBQYXJrZXMKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm0gPSBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1QbHVzMSA9ICh0ZXJtICYgMHgxKSA9PT0gMCA/IHRlcm0gfCAxIDogdGVybSAmIH4xOwoJICAgICAgICAgICAgICAgICAgICBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLCB0ZXJtUGx1czEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KGVycm9yRXZhbHVhdG9yLmV2YWx1YXRlQXQoeGlJbnZlcnNlKSwgZmllbGQuaW52ZXJzZShkZW5vbWluYXRvcikpOwoJICAgICAgICAgICAgaWYgKGZpZWxkLmdldEdlbmVyYXRvckJhc2UoKSAhPT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KHJlc3VsdFtpXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRGVjb2RlcjsKCX0oKSk7CglSZWVkU29sb21vbkRlY29kZXIkMS5kZWZhdWx0ID0gUmVlZFNvbG9tb25EZWNvZGVyOwoKCXZhciBCaXRNYXRyaXhQYXJzZXIkMSA9IHt9OwoKCXZhciBWZXJzaW9uJDEgPSB7fTsKCgl2YXIgRm9ybWF0SW5mb3JtYXRpb24kMSA9IHt9OwoKCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IHt9OwoKCXZhciBBcmd1bWVudEV4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyQzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkMyhBcmd1bWVudEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBcmd1bWVudEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0FyZ3VtZW50RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQXJndW1lbnRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xLmRlZmF1bHQpKTsKCUFyZ3VtZW50RXhjZXB0aW9uJDEuZGVmYXVsdCA9IEFyZ3VtZW50RXhjZXB0aW9uOwoKCShmdW5jdGlvbiAoZXhwb3J0cykgewoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CglleHBvcnRzLkVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gdm9pZCAwOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbl8xID0gQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJdmFyIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzOwoJKGZ1bmN0aW9uIChFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcykgewoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJMIl0gPSAwXSA9ICJMIjsKCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1tFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1siTSJdID0gMV0gPSAiTSI7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbIlEiXSA9IDJdID0gIlEiOwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJIIl0gPSAzXSA9ICJIIjsKCX0pKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyB8fCAoZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyA9IHt9KSk7CgkvKioKCSAqIDxwPlNlZSBJU08gMTgwMDQ6MjAwNiwgNi41LjEuIFRoaXMgZW51bSBlbmNhcHN1bGF0ZXMgdGhlIGZvdXIgZXJyb3IgY29ycmVjdGlvbiBsZXZlbHMKCSAqIGRlZmluZWQgYnkgdGhlIFFSIGNvZGUgc3RhbmRhcmQuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFcnJvckNvcnJlY3Rpb25MZXZlbCh2YWx1ZSwgc3RyaW5nVmFsdWUsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2V0KGJpdHMsIHRoaXMpOwoJICAgICAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5nZXRCaXRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIHN3aXRjaCAocykgewoJICAgICAgICAgICAgY2FzZSAnTCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5MOwoJICAgICAgICAgICAgY2FzZSAnTSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5NOwoJICAgICAgICAgICAgY2FzZSAnUSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5ROwoJICAgICAgICAgICAgY2FzZSAnSCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5IOwoJICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uXzEuZGVmYXVsdChzICsgJ25vdCBhdmFpbGFibGUnKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG90aGVyID0gbzsKCSAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG90aGVyLnZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgaW50IGNvbnRhaW5pbmcgdGhlIHR3byBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSdzIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAgICAgKiBAcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsIHJlcHJlc2VudGluZyB0aGUgZW5jb2RlZCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgICAgICovCgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZm9yQml0cyA9IGZ1bmN0aW9uIChiaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGJpdHMgPCAwIHx8IGJpdHMgPj0gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuZ2V0KGJpdHMpOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX1ZBTFVFID0gbmV3IE1hcCgpOwoJICAgIC8qKiBMID0gfjclIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5MID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkwsICdMJywgMHgwMSk7CgkgICAgLyoqIE0gPSB+MTUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5NID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLk0sICdNJywgMHgwMCk7CgkgICAgLyoqIFEgPSB+MjUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5RID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLlEsICdRJywgMHgwMyk7CgkgICAgLyoqIEggPSB+MzAlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5IID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkgsICdIJywgMHgwMik7CgkgICAgcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IEVycm9yQ29ycmVjdGlvbkxldmVsOwoKCX0oRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0SW5mb3JtYXRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbF8xID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWw7Cgl2YXIgSW50ZWdlcl8xID0gSW50ZWdlciQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBRUiBDb2RlJ3MgZm9ybWF0IGluZm9ybWF0aW9uLCBpbmNsdWRpbmcgdGhlIGRhdGEgbWFzayB1c2VkIGFuZAoJICogZXJyb3IgY29ycmVjdGlvbiBsZXZlbC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBzZWUgRGF0YU1hc2sKCSAqIEBzZWUgRXJyb3JDb3JyZWN0aW9uTGV2ZWwKCSAqLwoJdmFyIEZvcm1hdEluZm9ybWF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZvcm1hdEluZm9ybWF0aW9uKGZvcm1hdEluZm8gLyppbnQqLykgewoJICAgICAgICAvLyBCaXRzIDMsNAoJICAgICAgICB0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWxfMS5kZWZhdWx0LmZvckJpdHMoKGZvcm1hdEluZm8gPj4gMykgJiAweDAzKTsKCSAgICAgICAgLy8gQm90dG9tIDMgYml0cwoJICAgICAgICB0aGlzLmRhdGFNYXNrID0gLyooYnl0ZSkgKi8gKGZvcm1hdEluZm8gJiAweDA3KTsKCSAgICB9CgkgICAgRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyA9IGZ1bmN0aW9uIChhIC8qaW50Ki8sIGIgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gSW50ZWdlcl8xLmRlZmF1bHQuYml0Q291bnQoYSBeIGIpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIG1hc2tlZEZvcm1hdEluZm8xIGZvcm1hdCBpbmZvIGluZGljYXRvciwgd2l0aCBtYXNrIHN0aWxsIGFwcGxpZWQKCSAgICAgKiBAcGFyYW0gbWFza2VkRm9ybWF0SW5mbzIgc2Vjb25kIGNvcHkgb2Ygc2FtZSBpbmZvOyBib3RoIGFyZSBjaGVja2VkIGF0IHRoZSBzYW1lIHRpbWUKCSAgICAgKiAgdG8gZXN0YWJsaXNoIGJlc3QgbWF0Y2gKCSAgICAgKiBAcmV0dXJuIGluZm9ybWF0aW9uIGFib3V0IHRoZSBmb3JtYXQgaXQgc3BlY2lmaWVzLCBvciB7QGNvZGUgbnVsbH0KCSAgICAgKiAgaWYgZG9lc24ndCBzZWVtIHRvIG1hdGNoIGFueSBrbm93biBwYXR0ZXJuCgkgICAgICovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24uZGVjb2RlRm9ybWF0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAobWFza2VkRm9ybWF0SW5mbzEgLyppbnQqLywgbWFza2VkRm9ybWF0SW5mbzIgLyppbnQqLykgewoJICAgICAgICB2YXIgZm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uLmRvRGVjb2RlRm9ybWF0SW5mb3JtYXRpb24obWFza2VkRm9ybWF0SW5mbzEsIG1hc2tlZEZvcm1hdEluZm8yKTsKCSAgICAgICAgaWYgKGZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiBmb3JtYXRJbmZvOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNob3VsZCByZXR1cm4gbnVsbCwgYnV0LCBzb21lIFFSIGNvZGVzIGFwcGFyZW50bHkKCSAgICAgICAgLy8gZG8gbm90IG1hc2sgdGhpcyBpbmZvLiBUcnkgYWdhaW4gYnkgYWN0dWFsbHkgbWFza2luZyB0aGUgcGF0dGVybgoJICAgICAgICAvLyBmaXJzdAoJICAgICAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb24uZG9EZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihtYXNrZWRGb3JtYXRJbmZvMSBeIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX01BU0tfUVIsIG1hc2tlZEZvcm1hdEluZm8yIF4gRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUik7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5kb0RlY29kZUZvcm1hdEluZm9ybWF0aW9uID0gZnVuY3Rpb24gKG1hc2tlZEZvcm1hdEluZm8xIC8qaW50Ki8sIG1hc2tlZEZvcm1hdEluZm8yIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGVfMSwgX2E7CgkgICAgICAgIC8vIEZpbmQgdGhlIGludCBpbiBGT1JNQVRfSU5GT19ERUNPREVfTE9PS1VQIHdpdGggZmV3ZXN0IGJpdHMgZGlmZmVyaW5nCgkgICAgICAgIHZhciBiZXN0RGlmZmVyZW5jZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgICAgICB2YXIgYmVzdEZvcm1hdEluZm8gPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyQ2KEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVApLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlY29kZUluZm8gPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5mbyA9IGRlY29kZUluZm9bMF07CgkgICAgICAgICAgICAgICAgaWYgKHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8xIHx8IHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8yKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIGV4YWN0IG1hdGNoCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm9ybWF0SW5mb3JtYXRpb24oZGVjb2RlSW5mb1sxXSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBiaXRzRGlmZmVyZW5jZSA9IEZvcm1hdEluZm9ybWF0aW9uLm51bUJpdHNEaWZmZXJpbmcobWFza2VkRm9ybWF0SW5mbzEsIHRhcmdldEluZm8pOwoJICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgIGJlc3RGb3JtYXRJbmZvID0gZGVjb2RlSW5mb1sxXTsKCSAgICAgICAgICAgICAgICAgICAgYmVzdERpZmZlcmVuY2UgPSBiaXRzRGlmZmVyZW5jZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKG1hc2tlZEZvcm1hdEluZm8xICE9PSBtYXNrZWRGb3JtYXRJbmZvMikgewoJICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHRyeSB0aGUgb3RoZXIgb3B0aW9uCgkgICAgICAgICAgICAgICAgICAgIGJpdHNEaWZmZXJlbmNlID0gRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyhtYXNrZWRGb3JtYXRJbmZvMiwgdGFyZ2V0SW5mbyk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0Rm9ybWF0SW5mbyA9IGRlY29kZUluZm9bMV07CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSGFtbWluZyBkaXN0YW5jZSBvZiB0aGUgMzIgbWFza2VkIGNvZGVzIGlzIDcsIGJ5IGNvbnN0cnVjdGlvbiwgc28gPD0gMyBiaXRzCgkgICAgICAgIC8vIGRpZmZlcmluZyBtZWFucyB3ZSBmb3VuZCBhIG1hdGNoCgkgICAgICAgIGlmIChiZXN0RGlmZmVyZW5jZSA8PSAzKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEluZm9ybWF0aW9uKGJlc3RGb3JtYXRJbmZvKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5nZXRFcnJvckNvcnJlY3Rpb25MZXZlbCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWw7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5wcm90b3R5cGUuZ2V0RGF0YU1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFNYXNrOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsLmdldEJpdHMoKSA8PCAzKSB8IHRoaXMuZGF0YU1hc2s7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24ucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBGb3JtYXRJbmZvcm1hdGlvbikpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9PT0gb3RoZXIuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgJiYKCSAgICAgICAgICAgIHRoaXMuZGF0YU1hc2sgPT09IG90aGVyLmRhdGFNYXNrOwoJICAgIH07CgkgICAgRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUiA9IDB4NTQxMjsKCSAgICAvKioKCSAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYsIEFubmV4IEMsIFRhYmxlIEMuMQoJICAgICAqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVAgPSBbCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1NDEyLCAweDAwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1MTI1LCAweDAxXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1RTdDLCAweDAyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1QjRCLCAweDAzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0NUY5LCAweDA0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0MENFLCAweDA1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0Rjk3LCAweDA2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0QUEwLCAweDA3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3N0M0LCAweDA4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3MkYzLCAweDA5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3REFBLCAweDBBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3ODlELCAweDBCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2NjJGLCAweDBDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2MzE4LCAweDBEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2QzQxLCAweDBFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2OTc2LCAweDBGXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxNjg5LCAweDEwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxM0JFLCAweDExXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxQ0U3LCAweDEyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxOUQwLCAweDEzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwNzYyLCAweDE0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwMjU1LCAweDE1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwRDBDLCAweDE2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwODNCLCAweDE3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzNTVGLCAweDE4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzMDY4LCAweDE5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzRjMxLCAweDFBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzQTA2LCAweDFCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyNEI0LCAweDFDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyMTgzLCAweDFEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyRURBLCAweDFFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyQkVELCAweDFGXSksCgkgICAgXTsKCSAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb247Cgl9KCkpOwoJRm9ybWF0SW5mb3JtYXRpb24kMS5kZWZhdWx0ID0gRm9ybWF0SW5mb3JtYXRpb247CgoJdmFyIEVDQmxvY2tzJDEgPSB7fTsKCgl2YXIgX192YWx1ZXMkNSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0Jsb2NrcyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHNldCBvZiBlcnJvci1jb3JyZWN0aW9uIGJsb2NrcyBpbiBvbmUgc3ltYm9sIHZlcnNpb24uIE1vc3QgdmVyc2lvbnMgd2lsbAoJICogdXNlIGJsb2NrcyBvZiBkaWZmZXJpbmcgc2l6ZXMgd2l0aGluIG9uZSB2ZXJzaW9uLCBzbywgdGhpcyBlbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yCgkgKiBlYWNoIHNldCBvZiBibG9ja3MuIEl0IGFsc28gaG9sZHMgdGhlIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2sgc2luY2UgaXQKCSAqIHdpbGwgYmUgdGhlIHNhbWUgYWNyb3NzIGFsbCBibG9ja3Mgd2l0aGluIG9uZSB2ZXJzaW9uLjwvcD4KCSAqLwoJdmFyIEVDQmxvY2tzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEVDQmxvY2tzKGVjQ29kZXdvcmRzUGVyQmxvY2sgLyppbnQqLykgewoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayA9IGVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgICAgIHRoaXMuZWNCbG9ja3MgPSBlY0Jsb2NrczsKCSAgICB9CgkgICAgRUNCbG9ja3MucHJvdG90eXBlLmdldEVDQ29kZXdvcmRzUGVyQmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0TnVtQmxvY2tzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIHRvdGFsID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tzID0gdGhpcy5lY0Jsb2NrczsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIGVjQmxvY2tzXzEgPSBfX3ZhbHVlcyQ1KGVjQmxvY2tzKSwgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCk7ICFlY0Jsb2Nrc18xXzEuZG9uZTsgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tzXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbCArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2Nrc18xXzEgJiYgIWVjQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGVjQmxvY2tzXzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2Nrc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdG90YWw7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0VG90YWxFQ0NvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayAqIHRoaXMuZ2V0TnVtQmxvY2tzKCk7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0RUNCbG9ja3MgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQmxvY2tzOwoJICAgIH07CgkgICAgcmV0dXJuIEVDQmxvY2tzOwoJfSgpKTsKCUVDQmxvY2tzJDEuZGVmYXVsdCA9IEVDQmxvY2tzOwoKCXZhciBFQ0IkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yIG9uZSBlcnJvci1jb3JyZWN0aW9uIGJsb2NrIGluIG9uZSBzeW1ib2wgdmVyc2lvbi4KCSAqIFRoaXMgaW5jbHVkZXMgdGhlIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcywgYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgYSBibG9jayB3aXRoIHRoZXNlCgkgKiBwYXJhbWV0ZXJzIGlzIHVzZWQgY29uc2VjdXRpdmVseSBpbiB0aGUgUVIgY29kZSB2ZXJzaW9uJ3MgZm9ybWF0LjwvcD4KCSAqLwoJdmFyIEVDQiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFQ0IoY291bnQgLyppbnQqLywgZGF0YUNvZGV3b3JkcyAvKmludCovKSB7CgkgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDsKCSAgICAgICAgdGhpcy5kYXRhQ29kZXdvcmRzID0gZGF0YUNvZGV3b3JkczsKCSAgICB9CgkgICAgRUNCLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY291bnQ7CgkgICAgfTsKCSAgICBFQ0IucHJvdG90eXBlLmdldERhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICByZXR1cm4gRUNCOwoJfSgpKTsKCUVDQiQxLmRlZmF1bHQgPSBFQ0I7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX3ZhbHVlcyQ0ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlcnNpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBCaXRNYXRyaXhfMSQzID0gQml0TWF0cml4JDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSQxID0gRm9ybWF0SW5mb3JtYXRpb24kMTsKCXZhciBFQ0Jsb2Nrc18xID0gRUNCbG9ja3MkMTsKCXZhciBFQ0JfMSA9IEVDQiQxOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDIgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQyID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIFNlZSBJU08gMTgwMDQ6MjAwNiBBbm5leCBECgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gVmVyc2lvbih2ZXJzaW9uTnVtYmVyIC8qaW50Ki8sIGFsaWdubWVudFBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmVyc2lvbk51bWJlciA9IHZlcnNpb25OdW1iZXI7CgkgICAgICAgIHRoaXMuYWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBhbGlnbm1lbnRQYXR0ZXJuQ2VudGVyczsKCSAgICAgICAgdGhpcy5lY0Jsb2NrcyA9IGVjQmxvY2tzOwoJICAgICAgICB2YXIgdG90YWwgPSAwOwoJICAgICAgICB2YXIgZWNDb2Rld29yZHMgPSBlY0Jsb2Nrc1swXS5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIHZhciBlY2JBcnJheSA9IGVjQmxvY2tzWzBdLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY2JBcnJheV8xID0gX192YWx1ZXMkNChlY2JBcnJheSksIGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpOyAhZWNiQXJyYXlfMV8xLmRvbmU7IGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVjQmxvY2sgPSBlY2JBcnJheV8xXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdG90YWwgKz0gZWNCbG9jay5nZXRDb3VudCgpICogKGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpICsgZWNDb2Rld29yZHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoZWNiQXJyYXlfMV8xICYmICFlY2JBcnJheV8xXzEuZG9uZSAmJiAoX2EgPSBlY2JBcnJheV8xLnJldHVybikpIF9hLmNhbGwoZWNiQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy50b3RhbENvZGV3b3JkcyA9IHRvdGFsOwoJICAgIH0KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0VG90YWxDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRvdGFsQ29kZXdvcmRzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDE3ICsgNCAqIHRoaXMudmVyc2lvbk51bWJlcjsKCSAgICB9OwoJICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEVDQmxvY2tzRm9yTGV2ZWwgPSBmdW5jdGlvbiAoZWNMZXZlbCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0Jsb2Nrc1tlY0xldmVsLmdldFZhbHVlKCldOwoJICAgICAgICAvLyBUWVBFU0NSSVBUUE9SVDogb3JpZ2luYWwgd2FzIHVzaW5nIG9yZGluYWwsIGFuZCB1c2luZyB0aGUgb3JkZXIgb2YgbGV2ZWxzIGFzIGRlZmluZWQgaW4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwgZW51bSAoTE1RSCkKCSAgICAgICAgLy8gSSB3aWxsIHVzZSB0aGUgZGlyZWN0IHZhbHVlIGZyb20gRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXMgZW51bSB3aGljaCBpbiB0eXBlc2NyaXB0IGdvZXMgdG8gYSBudW1iZXIKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkRlZHVjZXMgdmVyc2lvbiBpbmZvcm1hdGlvbiBwdXJlbHkgZnJvbSBRUiBDb2RlIGRpbWVuc2lvbnMuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gaW4gbW9kdWxlcwoJICAgICAqIEByZXR1cm4gVmVyc2lvbiBmb3IgYSBRUiBDb2RlIG9mIHRoYXQgZGltZW5zaW9uCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCAxIG1vZCA0CgkgICAgICovCgkgICAgVmVyc2lvbi5nZXRQcm92aXNpb25hbFZlcnNpb25Gb3JEaW1lbnNpb24gPSBmdW5jdGlvbiAoZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiAlIDQgIT09IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmVyc2lvbkZvck51bWJlcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlciA9IGZ1bmN0aW9uICh2ZXJzaW9uTnVtYmVyIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPCAxIHx8IHZlcnNpb25OdW1iZXIgPiA0MCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDIuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBWZXJzaW9uLlZFUlNJT05TW3ZlcnNpb25OdW1iZXIgLSAxXTsKCSAgICB9OwoJICAgIFZlcnNpb24uZGVjb2RlVmVyc2lvbkluZm9ybWF0aW9uID0gZnVuY3Rpb24gKHZlcnNpb25CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGJlc3REaWZmZXJlbmNlID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHZhciBiZXN0VmVyc2lvbiA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVmVyc2lvbi5WRVJTSU9OX0RFQ09ERV9JTkZPLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgdGFyZ2V0VmVyc2lvbiA9IFZlcnNpb24uVkVSU0lPTl9ERUNPREVfSU5GT1tpXTsKCSAgICAgICAgICAgIC8vIERvIHRoZSB2ZXJzaW9uIGluZm8gYml0cyBtYXRjaCBleGFjdGx5PyBkb25lLgoJICAgICAgICAgICAgaWYgKHRhcmdldFZlcnNpb24gPT09IHZlcnNpb25CaXRzKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlcihpICsgNyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBPdGhlcndpc2Ugc2VlIGlmIHRoaXMgaXMgdGhlIGNsb3Nlc3QgdG8gYSByZWFsIHZlcnNpb24gaW5mbyBiaXQgc3RyaW5nCgkgICAgICAgICAgICAvLyB3ZSBoYXZlIHNlZW4gc28gZmFyCgkgICAgICAgICAgICB2YXIgYml0c0RpZmZlcmVuY2UgPSBGb3JtYXRJbmZvcm1hdGlvbl8xJDEuZGVmYXVsdC5udW1CaXRzRGlmZmVyaW5nKHZlcnNpb25CaXRzLCB0YXJnZXRWZXJzaW9uKTsKCSAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgYmVzdFZlcnNpb24gPSBpICsgNzsKCSAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFdlIGNhbiB0b2xlcmF0ZSB1cCB0byAzIGJpdHMgb2YgZXJyb3Igc2luY2Ugbm8gdHdvIHZlcnNpb24gaW5mbyBjb2Rld29yZHMgd2lsbAoJICAgICAgICAvLyBkaWZmZXIgaW4gbGVzcyB0aGFuIDggYml0cy4KCSAgICAgICAgaWYgKGJlc3REaWZmZXJlbmNlIDw9IDMpIHsKCSAgICAgICAgICAgIHJldHVybiBWZXJzaW9uLmdldFZlcnNpb25Gb3JOdW1iZXIoYmVzdFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2UgZW5vdWdoIG1hdGNoLCBmYWlsCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIElTTyAxODAwNDoyMDA2IEFubmV4IEUKCSAgICAgKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5idWlsZEZ1bmN0aW9uUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpOwoJICAgICAgICB2YXIgYml0TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDMuZGVmYXVsdChkaW1lbnNpb24pOwoJICAgICAgICAvLyBUb3AgbGVmdCBmaW5kZXIgcGF0dGVybiArIHNlcGFyYXRvciArIGZvcm1hdAoJICAgICAgICBiaXRNYXRyaXguc2V0UmVnaW9uKDAsIDAsIDksIDkpOwoJICAgICAgICAvLyBUb3AgcmlnaHQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbihkaW1lbnNpb24gLSA4LCAwLCA4LCA5KTsKCSAgICAgICAgLy8gQm90dG9tIGxlZnQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSA4LCA5LCA4KTsKCSAgICAgICAgLy8gQWxpZ25tZW50IHBhdHRlcm5zCgkgICAgICAgIHZhciBtYXggPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHgrKykgewoJICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzW3hdIC0gMjsKCSAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbWF4OyB5KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoKHggPT09IDAgJiYgKHkgPT09IDAgfHwgeSA9PT0gbWF4IC0gMSkpIHx8ICh4ID09PSBtYXggLSAxICYmIHkgPT09IDApKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vIGFsaWdubWVudCBwYXR0ZXJucyBuZWFyIHRoZSB0aHJlZSBmaW5kZXIgcGF0dGVybnMKCSAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24odGhpcy5hbGlnbm1lbnRQYXR0ZXJuQ2VudGVyc1t5XSAtIDIsIGksIDUsIDUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFZlcnRpY2FsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oNiwgOSwgMSwgZGltZW5zaW9uIC0gMTcpOwoJICAgICAgICAvLyBIb3Jpem9udGFsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oOSwgNiwgZGltZW5zaW9uIC0gMTcsIDEpOwoJICAgICAgICBpZiAodGhpcy52ZXJzaW9uTnVtYmVyID4gNikgewoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCB0b3AgcmlnaHQKCSAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oZGltZW5zaW9uIC0gMTEsIDAsIDMsIDYpOwoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCBib3R0b20gbGVmdAoJICAgICAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSAxMSwgNiwgMyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICcnICsgdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgQW5uZXggRC4KCSAgICAgICAqIEVsZW1lbnQgaSByZXByZXNlbnRzIHRoZSByYXcgdmVyc2lvbiBiaXRzIHRoYXQgc3BlY2lmeSB2ZXJzaW9uIGkgKyA3CgkgICAgICAgKi8KCSAgICBWZXJzaW9uLlZFUlNJT05fREVDT0RFX0lORk8gPSBJbnQzMkFycmF5LmZyb20oWwoJICAgICAgICAweDA3Qzk0LCAweDA4NUJDLCAweDA5QTk5LCAweDBBNEQzLCAweDBCQkY2LAoJICAgICAgICAweDBDNzYyLCAweDBEODQ3LCAweDBFNjBELCAweDBGOTI4LCAweDEwQjc4LAoJICAgICAgICAweDExNDVELCAweDEyQTE3LCAweDEzNTMyLCAweDE0OUE2LCAweDE1NjgzLAoJICAgICAgICAweDE2OEM5LCAweDE3N0VDLCAweDE4RUM0LCAweDE5MUUxLCAweDFBRkFCLAoJICAgICAgICAweDFCMDhFLCAweDFDQzFBLCAweDFEMzNGLCAweDFFRDc1LCAweDFGMjUwLAoJICAgICAgICAweDIwOUQ1LCAweDIxNkYwLCAweDIyOEJBLCAweDIzNzlGLCAweDI0QjBCLAoJICAgICAgICAweDI1NDJFLCAweDI2QTY0LCAweDI3NTQxLCAweDI4QzY5CgkgICAgXSk7CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgNi41LjEgVGFibGUgOQoJICAgICAgICovCgkgICAgVmVyc2lvbi5WRVJTSU9OUyA9IFsKCSAgICAgICAgbmV3IFZlcnNpb24oMSwgbmV3IEludDMyQXJyYXkoMCksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOSkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMiwgSW50MzJBcnJheS5mcm9tKFs2LCAxOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDEwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMywgSW50MzJBcnJheS5mcm9tKFs2LCAyMl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE1LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1NSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA4MCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA5KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCA0MykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTIpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDYsIEludDMyQXJyYXkuZnJvbShbNiwgMzRdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDcsIEludDMyQXJyYXkuZnJvbShbNiwgMjIsIDM4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDc4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDMxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNCkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNCwgNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMzgpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzOSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxOCksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE5KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDksIEludDMyQXJyYXkuZnJvbShbNiwgMjYsIDQ2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAzNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDM3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTAsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDUwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDY4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxOSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDIwKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDExLCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA4MSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDUxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTIsIEludDMyQXJyYXkuZnJvbShbNiwgMzIsIDU4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDkyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMzYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDEzLCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2Ml0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMzcpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDEyLCAxMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDYsIDY2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA0MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDQxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDE3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNSwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDgsIDcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDg3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgODgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgNDEpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNiwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDk4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0NikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTkpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyMCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTcsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU0LCA3OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxMDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE4LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NiwgODJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIwKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDQzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxOSwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE5LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1OCwgODZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTE0KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDQ0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDQ1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDE3LCAyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDE0KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMCwgSW50MzJBcnJheS5mcm9tKFs2LCAzNCwgNjIsIDkwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDEwNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0MSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIxLCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1MCwgNzIsIDk0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDIpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIyLCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1MCwgNzQsIDk4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDExMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMywgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIxKSwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI0LCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1NCwgODAsIDEwNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTcpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMwLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE3KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyNSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMTA2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTA3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMjYsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzMsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI3LCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2MiwgOTAsIDExOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0LCA5OCwgMTIyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDIsIDEyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTYpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjEsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgzNywgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTIsIDc4LCAxMDQsIDEzMF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCA0NyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjMsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjUsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTYsIDgyLCAxMDgsIDEzNF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxMywgMTE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQyLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDI4LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzIsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzUsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDM1LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzMsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzQsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNDQsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NCwgNzgsIDEwMiwgMTI2LCAxNTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDEyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMiwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgNDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzYsIEludDMyQXJyYXkuZnJvbShbNiwgMjQsIDUwLCA3NiwgMTAyLCAxMjgsIDE1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMjEpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDY0LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzcsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDU0LCA4MCwgMTA2LCAxMzIsIDE1OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIzKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDI5LCA0NiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCA0NykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0OSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjQsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNDYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzOCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTAsIDEzNiwgMTYyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE4LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzIsIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ4LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM5LCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1NCwgODIsIDExMCwgMTM4LCAxNjZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjAsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCg0MCwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNjcsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig0MCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTgsIDg2LCAxMTQsIDE0MiwgMTcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxMTgpLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyMCwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCg2MSwgMTYpKSkKCSAgICBdOwoJICAgIHJldHVybiBWZXJzaW9uOwoJfSgpKTsKCVZlcnNpb24kMS5kZWZhdWx0ID0gVmVyc2lvbjsKCgl2YXIgRGF0YU1hc2sgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5EYXRhTWFza1ZhbHVlcyA9IHZvaWQgMDsKCXZhciBEYXRhTWFza1ZhbHVlczsKCShmdW5jdGlvbiAoRGF0YU1hc2tWYWx1ZXMpIHsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAwMCJdID0gMF0gPSAiREFUQV9NQVNLXzAwMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18wMDEiXSA9IDFdID0gIkRBVEFfTUFTS18wMDEiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMDEwIl0gPSAyXSA9ICJEQVRBX01BU0tfMDEwIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAxMSJdID0gM10gPSAiREFUQV9NQVNLXzAxMSI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMDAiXSA9IDRdID0gIkRBVEFfTUFTS18xMDAiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMTAxIl0gPSA1XSA9ICJEQVRBX01BU0tfMTAxIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzExMCJdID0gNl0gPSAiREFUQV9NQVNLXzExMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMTEiXSA9IDddID0gIkRBVEFfTUFTS18xMTEiOwoJfSkoRGF0YU1hc2tWYWx1ZXMgPSBleHBvcnRzLkRhdGFNYXNrVmFsdWVzIHx8IChleHBvcnRzLkRhdGFNYXNrVmFsdWVzID0ge30pKTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGRhdGEgbWFza3MgZm9yIHRoZSBkYXRhIGJpdHMgaW4gYSBRUiBjb2RlLCBwZXIgSVNPIDE4MDA0OjIwMDYgNi44LiBJbXBsZW1lbnRhdGlvbnMKCSAqIG9mIHRoaXMgY2xhc3MgY2FuIHVuLW1hc2sgYSByYXcgQml0TWF0cml4LiBGb3Igc2ltcGxpY2l0eSwgdGhleSB3aWxsIHVubWFzayB0aGUgZW50aXJlIEJpdE1hdHJpeCwKCSAqIGluY2x1ZGluZyBhcmVhcyB1c2VkIGZvciBmaW5kZXIgcGF0dGVybnMsIHRpbWluZyBwYXR0ZXJucywgZXRjLiBUaGVzZSBhcmVhcyBzaG91bGQgYmUgdW51c2VkCgkgKiBhZnRlciB0aGUgcG9pbnQgdGhleSBhcmUgdW5tYXNrZWQgYW55d2F5LjwvcD4KCSAqCgkgKiA8cD5Ob3RlIHRoYXQgdGhlIGRpYWdyYW0gaW4gc2VjdGlvbiA2LjguMSBpcyBtaXNsZWFkaW5nIHNpbmNlIGl0IGluZGljYXRlcyB0aGF0IGkgaXMgY29sdW1uIHBvc2l0aW9uCgkgKiBhbmQgaiBpcyByb3cgcG9zaXRpb24uIEluIGZhY3QsIGFzIHRoZSB0ZXh0IHNheXMsIGkgaXMgcm93IHBvc2l0aW9uIGFuZCBqIGlzIGNvbHVtbiBwb3NpdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIFNlZSBJU08gMTgwMDQ6MjAwNiA2LjguMQoJICAgIGZ1bmN0aW9uIERhdGFNYXNrKHZhbHVlLCBpc01hc2tlZCkgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuaXNNYXNrZWQgPSBpc01hc2tlZDsKCSAgICB9CgkgICAgLy8gRW5kIG9mIGVudW0gY29uc3RhbnRzLgoJICAgIC8qKgoJICAgICAqIDxwPkltcGxlbWVudGF0aW9ucyBvZiB0aGlzIG1ldGhvZCByZXZlcnNlIHRoZSBkYXRhIG1hc2tpbmcgcHJvY2VzcyBhcHBsaWVkIHRvIGEgUVIgQ29kZSBhbmQKCSAgICAgKiBtYWtlIGl0cyBiaXRzIHJlYWR5IHRvIHJlYWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGJpdHMgcmVwcmVzZW50YXRpb24gb2YgUVIgQ29kZSBiaXRzCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gb2YgUVIgQ29kZSwgcmVwcmVzZW50ZWQgYnkgYml0cywgYmVpbmcgdW5tYXNrZWQKCSAgICAgKi8KCSAgICBEYXRhTWFzay5wcm90b3R5cGUudW5tYXNrQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGRpbWVuc2lvbiAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGltZW5zaW9uOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hc2tlZChpLCBqKSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLmZsaXAoaiwgaSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBEYXRhTWFzay52YWx1ZXMgPSBuZXcgTWFwKFsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDAwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeCArIHkpIG1vZCAyID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDAwLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMCwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoKGkgKyBqKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeCBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMDEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgJiAweDAxKSA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMDEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoIHkgbW9kIDMgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuIGogJSAzID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKHggKyB5KSBtb2QgMyA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAxMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgKyBqKSAlIDMgPT09IDA7IH0pXSwKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDEwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeC8yICsgeS8zKSBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMCwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMDAsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeHkgbW9kIDIgKyB4eSBtb2QgMyA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2ID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTAxLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMSwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoaSAqIGopICUgNiA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMTEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoICh4eSBtb2QgMiArIHh5IG1vZCAzKSBtb2QgMiA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2IDwgMwoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSAqIGopICUgNikgPCAzOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKCh4K3kpbW9kIDIgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKiBlcXVpdmFsZW50bHksIHN1Y2ggdGhhdCAoeCArIHkgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTEsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTExLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSArIGogKyAoKGkgKiBqKSAlIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgXSk7CgkgICAgcmV0dXJuIERhdGFNYXNrOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFNYXNrOwoKCX0oRGF0YU1hc2spKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdE1hdHJpeFBhcnNlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgVmVyc2lvbl8xJDEgPSBWZXJzaW9uJDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSA9IEZvcm1hdEluZm9ybWF0aW9uJDE7Cgl2YXIgRGF0YU1hc2tfMSA9IERhdGFNYXNrOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCS8qKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJpdE1hdHJpeFBhcnNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYml0TWF0cml4IHtAbGluayBCaXRNYXRyaXh9IHRvIHBhcnNlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCA+PSAyMSBhbmQgMSBtb2QgNAoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeFBhcnNlcihiaXRNYXRyaXgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IGJpdE1hdHJpeC5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiA8IDIxIHx8IChkaW1lbnNpb24gJiAweDAzKSAhPT0gMSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0TWF0cml4ID0gYml0TWF0cml4OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5SZWFkcyBmb3JtYXQgaW5mb3JtYXRpb24gZnJvbSBvbmUgb2YgaXRzIHR3byBsb2NhdGlvbnMgd2l0aGluIHRoZSBRUiBDb2RlLjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEZvcm1hdEluZm9ybWF0aW9ufSBlbmNhcHN1bGF0aW5nIHRoZSBRUiBDb2RlJ3MgZm9ybWF0IGluZm8KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIGZvcm1hdCBpbmZvcm1hdGlvbiBsb2NhdGlvbnMgY2Fubm90IGJlIHBhcnNlZCBhcwoJICAgICAqIHRoZSB2YWxpZCBlbmNvZGluZyBvZiBmb3JtYXQgaW5mb3JtYXRpb24KCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRGb3JtYXRJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKHRoaXMucGFyc2VkRm9ybWF0SW5mbyAhPT0gbnVsbCAmJiB0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VkRm9ybWF0SW5mbzsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRvcC1sZWZ0IGZvcm1hdCBpbmZvIGJpdHMKCSAgICAgICAgdmFyIGZvcm1hdEluZm9CaXRzMSA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoaSwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyAuLiBhbmQgc2tpcCBhIGJpdCBpbiB0aGUgdGltaW5nIHBhdHRlcm4gLi4uCgkgICAgICAgIGZvcm1hdEluZm9CaXRzMSA9IHRoaXMuY29weUJpdCg3LCA4LCBmb3JtYXRJbmZvQml0czEpOwoJICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgZm9ybWF0SW5mb0JpdHMxID0gdGhpcy5jb3B5Qml0KDgsIDcsIGZvcm1hdEluZm9CaXRzMSk7CgkgICAgICAgIC8vIC4uIGFuZCBza2lwIGEgYml0IGluIHRoZSB0aW1pbmcgcGF0dGVybiAuLi4KCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgaiwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRoZSB0b3AtcmlnaHQvYm90dG9tLWxlZnQgcGF0dGVybiB0b28KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgZm9ybWF0SW5mb0JpdHMyID0gMDsKCSAgICAgICAgdmFyIGpNaW4gPSBkaW1lbnNpb24gLSA3OwoJICAgICAgICBmb3IgKHZhciBqID0gZGltZW5zaW9uIC0gMTsgaiA+PSBqTWluOyBqLS0pIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdCg4LCBqLCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAodmFyIGkgPSBkaW1lbnNpb24gLSA4OyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdChpLCA4LCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uXzEuZGVmYXVsdC5kZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihmb3JtYXRJbmZvQml0czEsIGZvcm1hdEluZm9CaXRzMik7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZEZvcm1hdEluZm87CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+UmVhZHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmcm9tIG9uZSBvZiBpdHMgdHdvIGxvY2F0aW9ucyB3aXRoaW4gdGhlIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgVmVyc2lvbn0gZW5jYXBzdWxhdGluZyB0aGUgUVIgQ29kZSdzIHZlcnNpb24KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIHZlcnNpb24gaW5mb3JtYXRpb24gbG9jYXRpb25zIGNhbm5vdCBiZSBwYXJzZWQgYXMKCSAgICAgKiB0aGUgdmFsaWQgZW5jb2Rpbmcgb2YgdmVyc2lvbiBpbmZvcm1hdGlvbgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUucmVhZFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZFZlcnNpb24gIT09IG51bGwgJiYgdGhpcy5wYXJzZWRWZXJzaW9uICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgcHJvdmlzaW9uYWxWZXJzaW9uID0gTWF0aC5mbG9vcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24gPD0gNikgewoJICAgICAgICAgICAgcmV0dXJuIFZlcnNpb25fMSQxLmRlZmF1bHQuZ2V0VmVyc2lvbkZvck51bWJlcihwcm92aXNpb25hbFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJlYWQgdG9wLXJpZ2h0IHZlcnNpb24gaW5mbzogMyB3aWRlIGJ5IDYgdGFsbAoJICAgICAgICB2YXIgdmVyc2lvbkJpdHMgPSAwOwoJICAgICAgICB2YXIgaWpNaW4gPSBkaW1lbnNpb24gLSAxMTsKCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gZGltZW5zaW9uIC0gOTsgaSA+PSBpak1pbjsgaS0tKSB7CgkgICAgICAgICAgICAgICAgdmVyc2lvbkJpdHMgPSB0aGlzLmNvcHlCaXQoaSwgaiwgdmVyc2lvbkJpdHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBmYWlsZWQuIFRyeSBib3R0b20gbGVmdDogNiB3aWRlIGJ5IDMgdGFsbAoJICAgICAgICB2ZXJzaW9uQml0cyA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSA1OyBpID49IDA7IGktLSkgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRpbWVuc2lvbiAtIDk7IGogPj0gaWpNaW47IGotLSkgewoJICAgICAgICAgICAgICAgIHZlcnNpb25CaXRzID0gdGhpcy5jb3B5Qml0KGksIGosIHZlcnNpb25CaXRzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5jb3B5Qml0ID0gZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovLCB2ZXJzaW9uQml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBiaXQgPSB0aGlzLmlzTWlycm9yID8gdGhpcy5iaXRNYXRyaXguZ2V0KGosIGkpIDogdGhpcy5iaXRNYXRyaXguZ2V0KGksIGopOwoJICAgICAgICByZXR1cm4gYml0ID8gKHZlcnNpb25CaXRzIDw8IDEpIHwgMHgxIDogdmVyc2lvbkJpdHMgPDwgMTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlJlYWRzIHRoZSBiaXRzIGluIHRoZSB7QGxpbmsgQml0TWF0cml4fSByZXByZXNlbnRpbmcgdGhlIGZpbmRlciBwYXR0ZXJuIGluIHRoZQoJICAgICAqIGNvcnJlY3Qgb3JkZXIgaW4gb3JkZXIgdG8gcmVjb25zdHJ1Y3QgdGhlIGNvZGV3b3JkcyBieXRlcyBjb250YWluZWQgd2l0aGluIHRoZQoJICAgICAqIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBleGFjdCBudW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgaXMgbm90IHJlYWQKCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBmb3JtYXRJbmZvID0gdGhpcy5yZWFkRm9ybWF0SW5mb3JtYXRpb24oKTsKCSAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9uKCk7CgkgICAgICAgIC8vIEdldCB0aGUgZGF0YSBtYXNrIGZvciB0aGUgZm9ybWF0IHVzZWQgaW4gdGhpcyBRUiBDb2RlLiBUaGlzIHdpbGwgZXhjbHVkZQoJICAgICAgICAvLyBzb21lIGJpdHMgZnJvbSByZWFkaW5nIGFzIHdlIHdpbmQgdGhyb3VnaCB0aGUgYml0IG1hdHJpeC4KCSAgICAgICAgdmFyIGRhdGFNYXNrID0gRGF0YU1hc2tfMS5kZWZhdWx0LnZhbHVlcy5nZXQoZm9ybWF0SW5mby5nZXREYXRhTWFzaygpKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICBkYXRhTWFzay51bm1hc2tCaXRNYXRyaXgodGhpcy5iaXRNYXRyaXgsIGRpbWVuc2lvbik7CgkgICAgICAgIHZhciBmdW5jdGlvblBhdHRlcm4gPSB2ZXJzaW9uLmJ1aWxkRnVuY3Rpb25QYXR0ZXJuKCk7CgkgICAgICAgIHZhciByZWFkaW5nVXAgPSB0cnVlOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKTsKCSAgICAgICAgdmFyIHJlc3VsdE9mZnNldCA9IDA7CgkgICAgICAgIHZhciBjdXJyZW50Qnl0ZSA9IDA7CgkgICAgICAgIHZhciBiaXRzUmVhZCA9IDA7CgkgICAgICAgIC8vIFJlYWQgY29sdW1ucyBpbiBwYWlycywgZnJvbSByaWdodCB0byBsZWZ0CgkgICAgICAgIGZvciAodmFyIGogPSBkaW1lbnNpb24gLSAxOyBqID4gMDsgaiAtPSAyKSB7CgkgICAgICAgICAgICBpZiAoaiA9PT0gNikgewoJICAgICAgICAgICAgICAgIC8vIFNraXAgd2hvbGUgY29sdW1uIHdpdGggdmVydGljYWwgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgICAgICAgICAgICAvLyBzYXZlcyB0aW1lIGFuZCBtYWtlcyB0aGUgb3RoZXIgY29kZSBwcm9jZWVkIG1vcmUgY2xlYW5seQoJICAgICAgICAgICAgICAgIGotLTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIFJlYWQgYWx0ZXJuYXRpbmdseSBmcm9tIGJvdHRvbSB0byB0b3AgdGhlbiB0b3AgdG8gYm90dG9tCgkgICAgICAgICAgICBmb3IgKHZhciBjb3VudCA9IDA7IGNvdW50IDwgZGltZW5zaW9uOyBjb3VudCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGkgPSByZWFkaW5nVXAgPyBkaW1lbnNpb24gLSAxIC0gY291bnQgOiBjb3VudDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCAyOyBjb2wrKykgewoJICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYml0cyBjb3ZlcmVkIGJ5IHRoZSBmdW5jdGlvbiBwYXR0ZXJuCgkgICAgICAgICAgICAgICAgICAgIGlmICghZnVuY3Rpb25QYXR0ZXJuLmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBhIGJpdAoJICAgICAgICAgICAgICAgICAgICAgICAgYml0c1JlYWQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIDw8PSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYml0TWF0cml4LmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIHw9IDE7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBtYWRlIGEgd2hvbGUgYnl0ZSwgc2F2ZSBpdCBvZmYKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzUmVhZCA9PT0gOCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRPZmZzZXQrK10gPSAvKihieXRlKSAqLyBjdXJyZW50Qnl0ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRzUmVhZCA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVhZGluZ1VwID0gIXJlYWRpbmdVcDsgLy8gcmVhZGluZ1VwIF49IHRydWU7IC8vIHJlYWRpbmdVcCA9ICFyZWFkaW5nVXA7IC8vIHN3aXRjaCBkaXJlY3Rpb25zCgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJlc3VsdE9mZnNldCAhPT0gdmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldmVydCB0aGUgbWFzayByZW1vdmFsIGRvbmUgd2hpbGUgcmVhZGluZyB0aGUgY29kZSB3b3Jkcy4gVGhlIGJpdCBtYXRyaXggc2hvdWxkIHJldmVydCB0byBpdHMgb3JpZ2luYWwgc3RhdGUuCgkgICAgICovCgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5yZW1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybjsgLy8gV2UgaGF2ZSBubyBmb3JtYXQgaW5mb3JtYXRpb24sIGFuZCBoYXZlIG5vIGRhdGEgbWFzawoJICAgICAgICB9CgkgICAgICAgIHZhciBkYXRhTWFzayA9IERhdGFNYXNrXzEuZGVmYXVsdC52YWx1ZXNbdGhpcy5wYXJzZWRGb3JtYXRJbmZvLmdldERhdGFNYXNrKCldOwoJICAgICAgICB2YXIgZGltZW5zaW9uID0gdGhpcy5iaXRNYXRyaXguZ2V0SGVpZ2h0KCk7CgkgICAgICAgIGRhdGFNYXNrLnVubWFza0JpdE1hdHJpeCh0aGlzLmJpdE1hdHJpeCwgZGltZW5zaW9uKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFByZXBhcmUgdGhlIHBhcnNlciBmb3IgYSBtaXJyb3JlZCBvcGVyYXRpb24uCgkgICAgICogVGhpcyBmbGFnIGhhcyBlZmZlY3Qgb25seSBvbiB0aGUge0BsaW5rICNyZWFkRm9ybWF0SW5mb3JtYXRpb24oKX0gYW5kIHRoZQoJICAgICAqIHtAbGluayAjcmVhZFZlcnNpb24oKX0uIEJlZm9yZSBwcm9jZWVkaW5nIHdpdGgge0BsaW5rICNyZWFkQ29kZXdvcmRzKCl9IHRoZQoJICAgICAqIHtAbGluayAjbWlycm9yKCl9IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkLgoJICAgICAqCgkgICAgICogQHBhcmFtIG1pcnJvciBXaGV0aGVyIHRvIHJlYWQgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm9ybWF0aW9uIG1pcnJvcmVkLgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUuc2V0TWlycm9yID0gZnVuY3Rpb24gKGlzTWlycm9yKSB7CgkgICAgICAgIHRoaXMucGFyc2VkVmVyc2lvbiA9IG51bGw7CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IG51bGw7CgkgICAgICAgIHRoaXMuaXNNaXJyb3IgPSBpc01pcnJvcjsKCSAgICB9OwoJICAgIC8qKiBNaXJyb3IgdGhlIGJpdCBtYXRyaXggaW4gb3JkZXIgdG8gYXR0ZW1wdCBhIHNlY29uZCByZWFkaW5nLiAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUubWlycm9yID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgYml0TWF0cml4ID0gdGhpcy5iaXRNYXRyaXg7CgkgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IGJpdE1hdHJpeC5nZXRXaWR0aCgpOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgeSA9IHggKyAxLCBoZWlnaHQgPSBiaXRNYXRyaXguZ2V0SGVpZ2h0KCk7IHkgPCBoZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgICAgIGlmIChiaXRNYXRyaXguZ2V0KHgsIHkpICE9PSBiaXRNYXRyaXguZ2V0KHksIHgpKSB7CgkgICAgICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5mbGlwKHksIHgpOwoJICAgICAgICAgICAgICAgICAgICBiaXRNYXRyaXguZmxpcCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXhQYXJzZXI7Cgl9KCkpOwoJQml0TWF0cml4UGFyc2VyJDEuZGVmYXVsdCA9IEJpdE1hdHJpeFBhcnNlcjsKCgl2YXIgRGF0YUJsb2NrJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YUJsb2NrJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQxID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIGJsb2NrIG9mIGRhdGEgd2l0aGluIGEgUVIgQ29kZS4gUVIgQ29kZXMgbWF5IHNwbGl0IHRoZWlyIGRhdGEgaW50bwoJICogbXVsdGlwbGUgYmxvY2tzLCBlYWNoIG9mIHdoaWNoIGlzIGEgdW5pdCBvZiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3Jkcy4gRWFjaAoJICogaXMgcmVwcmVzZW50ZWQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFCbG9jayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEYXRhQmxvY2sobnVtRGF0YUNvZGV3b3JkcyAvKmludCovLCBjb2Rld29yZHMpIHsKCSAgICAgICAgdGhpcy5udW1EYXRhQ29kZXdvcmRzID0gbnVtRGF0YUNvZGV3b3JkczsKCSAgICAgICAgdGhpcy5jb2Rld29yZHMgPSBjb2Rld29yZHM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIDxwPldoZW4gUVIgQ29kZXMgdXNlIG11bHRpcGxlIGRhdGEgYmxvY2tzLCB0aGV5IGFyZSBhY3R1YWxseSBpbnRlcmxlYXZlZC4KCSAgICAgKiBUaGF0IGlzLCB0aGUgZmlyc3QgYnl0ZSBvZiBkYXRhIGJsb2NrIDEgdG8gbiBpcyB3cml0dGVuLCB0aGVuIHRoZSBzZWNvbmQgYnl0ZXMsIGFuZCBzbyBvbi4gVGhpcwoJICAgICAqIG1ldGhvZCB3aWxsIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gb3JpZ2luYWwgYmxvY2tzLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByYXdDb2Rld29yZHMgYnl0ZXMgYXMgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBRUiBDb2RlCgkgICAgICogQHBhcmFtIHZlcnNpb24gdmVyc2lvbiBvZiB0aGUgUVIgQ29kZQoJICAgICAqIEBwYXJhbSBlY0xldmVsIGVycm9yLWNvcnJlY3Rpb24gbGV2ZWwgb2YgdGhlIFFSIENvZGUKCSAgICAgKiBAcmV0dXJuIERhdGFCbG9ja3MgY29udGFpbmluZyBvcmlnaW5hbCBieXRlcywgImRlLWludGVybGVhdmVkIiBmcm9tIHJlcHJlc2VudGF0aW9uIGluIHRoZQoJICAgICAqICAgICAgICAgUVIgQ29kZQoJICAgICAqLwoJICAgIERhdGFCbG9jay5nZXREYXRhQmxvY2tzID0gZnVuY3Rpb24gKHJhd0NvZGV3b3JkcywgdmVyc2lvbiwgZWNMZXZlbCkgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgaWYgKHJhd0NvZGV3b3Jkcy5sZW5ndGggIT09IHZlcnNpb24uZ2V0VG90YWxDb2Rld29yZHMoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBhbmQgc2l6ZSBvZiBkYXRhIGJsb2NrcyB1c2VkIGJ5IHRoaXMgdmVyc2lvbiBhbmQKCSAgICAgICAgLy8gZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICAgICAgICB2YXIgZWNCbG9ja3MgPSB2ZXJzaW9uLmdldEVDQmxvY2tzRm9yTGV2ZWwoZWNMZXZlbCk7CgkgICAgICAgIC8vIEZpcnN0IGNvdW50IHRoZSB0b3RhbCBudW1iZXIgb2YgZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIHRvdGFsQmxvY2tzID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tBcnJheSA9IGVjQmxvY2tzLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY0Jsb2NrQXJyYXlfMSA9IF9fdmFsdWVzJDMoZWNCbG9ja0FycmF5KSwgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKTsgIWVjQmxvY2tBcnJheV8xXzEuZG9uZTsgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBlY0Jsb2NrID0gZWNCbG9ja0FycmF5XzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbEJsb2NrcyArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2NrQXJyYXlfMV8xICYmICFlY0Jsb2NrQXJyYXlfMV8xLmRvbmUgJiYgKF9hID0gZWNCbG9ja0FycmF5XzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2NrQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGVzdGFibGlzaCBEYXRhQmxvY2tzIG9mIHRoZSBhcHByb3ByaWF0ZSBzaXplIGFuZCBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh0b3RhbEJsb2Nrcyk7CgkgICAgICAgIHZhciBudW1SZXN1bHRCbG9ja3MgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZWNCbG9ja0FycmF5XzIgPSBfX3ZhbHVlcyQzKGVjQmxvY2tBcnJheSksIGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCk7ICFlY0Jsb2NrQXJyYXlfMl8xLmRvbmU7IGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tBcnJheV8yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlY0Jsb2NrLmdldENvdW50KCk7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtRGF0YUNvZGV3b3JkcyA9IGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtQmxvY2tDb2Rld29yZHMgPSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCkgKyBudW1EYXRhQ29kZXdvcmRzOwoJICAgICAgICAgICAgICAgICAgICByZXN1bHRbbnVtUmVzdWx0QmxvY2tzKytdID0gbmV3IERhdGFCbG9jayhudW1EYXRhQ29kZXdvcmRzLCBuZXcgVWludDhBcnJheShudW1CbG9ja0NvZGV3b3JkcykpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGVjQmxvY2tBcnJheV8yXzEgJiYgIWVjQmxvY2tBcnJheV8yXzEuZG9uZSAmJiAoX2IgPSBlY0Jsb2NrQXJyYXlfMi5yZXR1cm4pKSBfYi5jYWxsKGVjQmxvY2tBcnJheV8yKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICAvLyBBbGwgYmxvY2tzIGhhdmUgdGhlIHNhbWUgYW1vdW50IG9mIGRhdGEsIGV4Y2VwdCB0aGF0IHRoZSBsYXN0IG4KCSAgICAgICAgLy8gKHdoZXJlIG4gbWF5IGJlIDApIGhhdmUgMSBtb3JlIGJ5dGUuIEZpZ3VyZSBvdXQgd2hlcmUgdGhlc2Ugc3RhcnQuCgkgICAgICAgIHZhciBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGxvbmdlckJsb2Nrc1N0YXJ0QXQgPSByZXN1bHQubGVuZ3RoIC0gMTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IGNoZWNrIGxlbmd0aCBpcyBjb3JyZWN0IGhlcmUKCSAgICAgICAgd2hpbGUgKGxvbmdlckJsb2Nrc1N0YXJ0QXQgPj0gMCkgewoJICAgICAgICAgICAgdmFyIG51bUNvZGV3b3JkcyA9IHJlc3VsdFtsb25nZXJCbG9ja3NTdGFydEF0XS5jb2Rld29yZHMubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKG51bUNvZGV3b3JkcyA9PT0gc2hvcnRlckJsb2Nrc1RvdGFsQ29kZXdvcmRzKSB7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsb25nZXJCbG9ja3NTdGFydEF0LS07CgkgICAgICAgIH0KCSAgICAgICAgbG9uZ2VyQmxvY2tzU3RhcnRBdCsrOwoJICAgICAgICB2YXIgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHMgPSBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgLSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIC8vIFRoZSBsYXN0IGVsZW1lbnRzIG9mIHJlc3VsdCBtYXkgYmUgMSBlbGVtZW50IGxvbmdlcgoJICAgICAgICAvLyBmaXJzdCBmaWxsIG91dCBhcyBtYW55IGVsZW1lbnRzIGFzIGFsbCBvZiB0aGVtIGhhdmUKCSAgICAgICAgdmFyIHJhd0NvZGV3b3Jkc09mZnNldCA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1SZXN1bHRCbG9ja3M7IGorKykgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaV0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIEZpbGwgb3V0IHRoZSBsYXN0IGRhdGEgYmxvY2sgaW4gdGhlIGxvbmdlciBvbmVzCgkgICAgICAgIGZvciAodmFyIGogPSBsb25nZXJCbG9ja3NTdGFydEF0OyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHNdID0gcmF3Q29kZXdvcmRzW3Jhd0NvZGV3b3Jkc09mZnNldCsrXTsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cgYWRkIGluIGVycm9yIGNvcnJlY3Rpb24gYmxvY2tzCgkgICAgICAgIHZhciBtYXggPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IHNob3J0ZXJCbG9ja3NOdW1EYXRhQ29kZXdvcmRzOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgaU9mZnNldCA9IGogPCBsb25nZXJCbG9ja3NTdGFydEF0ID8gaSA6IGkgKyAxOwoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaU9mZnNldF0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldE51bURhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bURhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldENvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29kZXdvcmRzOwoJICAgIH07CgkgICAgcmV0dXJuIERhdGFCbG9jazsKCX0oKSk7CglEYXRhQmxvY2skMS5kZWZhdWx0ID0gRGF0YUJsb2NrOwoKCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEgPSB7fTsKCgl2YXIgQml0U291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdFNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbiB7Ki8KCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIHByb3ZpZGVzIGFuIGVhc3kgYWJzdHJhY3Rpb24gdG8gcmVhZCBiaXRzIGF0IGEgdGltZSBmcm9tIGEgc2VxdWVuY2Ugb2YgYnl0ZXMsIHdoZXJlIHRoZQoJICogbnVtYmVyIG9mIGJpdHMgcmVhZCBpcyBub3Qgb2Z0ZW4gYSBtdWx0aXBsZSBvZiA4LjwvcD4KCSAqCgkgKiA8cD5UaGlzIGNsYXNzIGlzIHRocmVhZC1zYWZlIGJ1dCBub3QgcmVlbnRyYW50IC0tIHVubGVzcyB0aGUgY2FsbGVyIG1vZGlmaWVzIHRoZSBieXRlcyBhcnJheQoJICogaXQgcGFzc2VkIGluLCBpbiB3aGljaCBjYXNlIGFsbCBiZXRzIGFyZSBvZmYuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBCaXRTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJ5dGVzIGJ5dGVzIGZyb20gd2hpY2ggdGhpcyB3aWxsIHJlYWQgYml0cy4gQml0cyB3aWxsIGJlIHJlYWQgZnJvbSB0aGUgZmlyc3QgYnl0ZSBmaXJzdC4KCSAgICAgKiBCaXRzIGFyZSByZWFkIHdpdGhpbiBhIGJ5dGUgZnJvbSBtb3N0LXNpZ25pZmljYW50IHRvIGxlYXN0LXNpZ25pZmljYW50IGJpdC4KCSAgICAgKi8KCSAgICBmdW5jdGlvbiBCaXRTb3VyY2UoYnl0ZXMpIHsKCSAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAwOwoJICAgICAgICB0aGlzLmJpdE9mZnNldCA9IDA7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaW5kZXggb2YgbmV4dCBiaXQgaW4gY3VycmVudCBieXRlIHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qml0T2Zmc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRPZmZzZXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgYnl0ZSBpbiBpbnB1dCBieXRlIGFycmF5IHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qnl0ZU9mZnNldCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBudW1CaXRzIG51bWJlciBvZiBiaXRzIHRvIHJlYWQKCSAgICAgKiBAcmV0dXJuIGludCByZXByZXNlbnRpbmcgdGhlIGJpdHMgcmVhZC4gVGhlIGJpdHMgd2lsbCBhcHBlYXIgYXMgdGhlIGxlYXN0LXNpZ25pZmljYW50CgkgICAgICogICAgICAgICBiaXRzIG9mIHRoZSBpbnQKCSAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBudW1CaXRzIGlzbid0IGluIFsxLDMyXSBvciBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlCgkgICAgICovCgkgICAgQml0U291cmNlLnByb3RvdHlwZS5yZWFkQml0cyA9IGZ1bmN0aW9uIChudW1CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPCAxIHx8IG51bUJpdHMgPiAzMiB8fCBudW1CaXRzID4gdGhpcy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoJycgKyBudW1CaXRzKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVzdWx0ID0gMDsKCSAgICAgICAgdmFyIGJpdE9mZnNldCA9IHRoaXMuYml0T2Zmc2V0OwoJICAgICAgICB2YXIgYnl0ZU9mZnNldCA9IHRoaXMuYnl0ZU9mZnNldDsKCSAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKCSAgICAgICAgLy8gRmlyc3QsIHJlYWQgcmVtYWluZGVyIGZyb20gY3VycmVudCBieXRlCgkgICAgICAgIGlmIChiaXRPZmZzZXQgPiAwKSB7CgkgICAgICAgICAgICB2YXIgYml0c0xlZnQgPSA4IC0gYml0T2Zmc2V0OwoJICAgICAgICAgICAgdmFyIHRvUmVhZCA9IG51bUJpdHMgPCBiaXRzTGVmdCA/IG51bUJpdHMgOiBiaXRzTGVmdDsKCSAgICAgICAgICAgIHZhciBiaXRzVG9Ob3RSZWFkID0gYml0c0xlZnQgLSB0b1JlYWQ7CgkgICAgICAgICAgICB2YXIgbWFzayA9ICgweEZGID4+ICg4IC0gdG9SZWFkKSkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgIHJlc3VsdCA9IChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQ7CgkgICAgICAgICAgICBudW1CaXRzIC09IHRvUmVhZDsKCSAgICAgICAgICAgIGJpdE9mZnNldCArPSB0b1JlYWQ7CgkgICAgICAgICAgICBpZiAoYml0T2Zmc2V0ID09PSA4KSB7CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0ID0gMDsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTmV4dCByZWFkIHdob2xlIGJ5dGVzCgkgICAgICAgIGlmIChudW1CaXRzID4gMCkgewoJICAgICAgICAgICAgd2hpbGUgKG51bUJpdHMgPj0gOCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCAoYnl0ZXNbYnl0ZU9mZnNldF0gJiAweEZGKTsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICAgICAgbnVtQml0cyAtPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gRmluYWxseSByZWFkIGEgcGFydGlhbCBieXRlCgkgICAgICAgICAgICBpZiAobnVtQml0cyA+IDApIHsKCSAgICAgICAgICAgICAgICB2YXIgYml0c1RvTm90UmVhZCA9IDggLSBudW1CaXRzOwoJICAgICAgICAgICAgICAgIHZhciBtYXNrID0gKDB4RkYgPj4gYml0c1RvTm90UmVhZCkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0IDw8IG51bUJpdHMpIHwgKChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQpOwoJICAgICAgICAgICAgICAgIGJpdE9mZnNldCArPSBudW1CaXRzOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0T2Zmc2V0ID0gYml0T2Zmc2V0OwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0OwoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB0aGF0IGNhbiBiZSByZWFkIHN1Y2Nlc3NmdWxseQoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuYXZhaWxhYmxlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gOCAqICh0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMuYnl0ZU9mZnNldCkgLSB0aGlzLmJpdE9mZnNldDsKCSAgICB9OwoJICAgIHJldHVybiBCaXRTb3VyY2U7Cgl9KCkpOwoJQml0U291cmNlJDEuZGVmYXVsdCA9IEJpdFNvdXJjZTsKCgl2YXIgRGVjb2RlclJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVyUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBtYXRyaXggb2YgYml0cy4gVGhpcyB0eXBpY2FsbHkKCSAqIGFwcGxpZXMgdG8gMkQgYmFyY29kZSBmb3JtYXRzLiBGb3Igbm93IGl0IGNvbnRhaW5zIHRoZSByYXcgYnl0ZXMgb2J0YWluZWQsCgkgKiBhcyB3ZWxsIGFzIGEgU3RyaW5nIGludGVycHJldGF0aW9uIG9mIHRob3NlIGJ5dGVzLCBpZiBhcHBsaWNhYmxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlclJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocmF3Qnl0ZXM6IFVpbnQ4QXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICAgICAgICAgdGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIExpc3Q8VWludDhBcnJheT4gYnl0ZVNlZ21lbnRzLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBlY0xldmVsKSB7CgkgICAgLy8gICB0aGlzKHJhd0J5dGVzLCB0ZXh0LCBieXRlU2VnbWVudHMsIGVjTGV2ZWwsIC0xLCAtMSkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRGVjb2RlclJlc3VsdChyYXdCeXRlcywgdGV4dCwgYnl0ZVNlZ21lbnRzLCBlY0xldmVsLCBzdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXIsIHN0cnVjdHVyZWRBcHBlbmRQYXJpdHkpIHsKCSAgICAgICAgaWYgKHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9PT0gdm9pZCAwKSB7IHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9IC0xOyB9CgkgICAgICAgIGlmIChzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID09PSB2b2lkIDApIHsgc3RydWN0dXJlZEFwcGVuZFBhcml0eSA9IC0xOyB9CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDsKCSAgICAgICAgdGhpcy5ieXRlU2VnbWVudHMgPSBieXRlU2VnbWVudHM7CgkgICAgICAgIHRoaXMuZWNMZXZlbCA9IGVjTGV2ZWw7CgkgICAgICAgIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyOwoJICAgICAgICB0aGlzLnN0cnVjdHVyZWRBcHBlbmRQYXJpdHkgPSBzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCB8fCByYXdCeXRlcyA9PT0gbnVsbCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiByYXcgYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSByZXN1bHQsIG9yIHtAY29kZSBudWxsfSBpZiBub3QgYXBwbGljYWJsZQoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldE51bUJpdHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bUJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gbnVtQml0cyBvdmVycmlkZXMgdGhlIG51bWJlciBvZiBiaXRzIHRoYXQgYXJlIHZhbGlkIGluIHtAbGluayAjZ2V0UmF3Qnl0ZXMoKX0KCSAgICAgKiBAc2luY2UgMy4zLjAKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXROdW1CaXRzID0gZnVuY3Rpb24gKG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLm51bUJpdHMgPSBudW1CaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0ZXh0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50ZXh0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBsaXN0IG9mIGJ5dGUgc2VnbWVudHMgaW4gdGhlIHJlc3VsdCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0Qnl0ZVNlZ21lbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5ieXRlU2VnbWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG5hbWUgb2YgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCB1c2VkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFQ0xldmVsID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0xldmVsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJyb3JzIGNvcnJlY3RlZCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0RXJyb3JzQ29ycmVjdGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnNDb3JyZWN0ZWQ7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcnJvcnNDb3JyZWN0ZWQgPSBmdW5jdGlvbiAoZXJyb3JzQ29ycmVjdGVkIC8qSW50ZWdlciovKSB7CgkgICAgICAgIHRoaXMuZXJyb3JzQ29ycmVjdGVkID0gZXJyb3JzQ29ycmVjdGVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJhc3VyZXMgY29ycmVjdGVkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFcmFzdXJlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJhc3VyZXM7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcmFzdXJlcyA9IGZ1bmN0aW9uIChlcmFzdXJlcyAvKkludGVnZXIqLykgewoJICAgICAgICB0aGlzLmVyYXN1cmVzID0gZXJhc3VyZXM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGFyYml0cmFyeSBhZGRpdGlvbmFsIG1ldGFkYXRhCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0T3RoZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuc2V0T3RoZXIgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdGhpcy5vdGhlciA9IG90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuaGFzU3RydWN0dXJlZEFwcGVuZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc3RydWN0dXJlZEFwcGVuZFBhcml0eSA+PSAwICYmIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID49IDA7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXI7CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlclJlc3VsdDsKCX0oKSk7CglEZWNvZGVyUmVzdWx0JDEuZGVmYXVsdCA9IERlY29kZXJSZXN1bHQ7CgoJdmFyIE1vZGUgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5Nb2RlVmFsdWVzID0gdm9pZCAwOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgTW9kZVZhbHVlczsKCShmdW5jdGlvbiAoTW9kZVZhbHVlcykgewoJICAgIE1vZGVWYWx1ZXNbTW9kZVZhbHVlc1siVEVSTUlOQVRPUiJdID0gMF0gPSAiVEVSTUlOQVRPUiI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJOVU1FUklDIl0gPSAxXSA9ICJOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkFMUEhBTlVNRVJJQyJdID0gMl0gPSAiQUxQSEFOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIlNUUlVDVFVSRURfQVBQRU5EIl0gPSAzXSA9ICJTVFJVQ1RVUkVEX0FQUEVORCI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJCWVRFIl0gPSA0XSA9ICJCWVRFIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkVDSSJdID0gNV0gPSAiRUNJIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIktBTkpJIl0gPSA2XSA9ICJLQU5KSSI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJGTkMxX0ZJUlNUX1BPU0lUSU9OIl0gPSA3XSA9ICJGTkMxX0ZJUlNUX1BPU0lUSU9OIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkZOQzFfU0VDT05EX1BPU0lUSU9OIl0gPSA4XSA9ICJGTkMxX1NFQ09ORF9QT1NJVElPTiI7CgkgICAgLyoqIFNlZSBHQlQgMTgyODQtMjAwMDsgIkhhbnppIiBpcyBhIHRyYW5zbGl0ZXJhdGlvbiBvZiB0aGlzIG1vZGUgbmFtZS4gKi8KCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkhBTlpJIl0gPSA5XSA9ICJIQU5aSSI7Cgl9KShNb2RlVmFsdWVzID0gZXhwb3J0cy5Nb2RlVmFsdWVzIHx8IChleHBvcnRzLk1vZGVWYWx1ZXMgPSB7fSkpOwoJLyoqCgkgKiA8cD5TZWUgSVNPIDE4MDA0OjIwMDYsIDYuNC4xLCBUYWJsZXMgMiBhbmQgMy4gVGhpcyBlbnVtIGVuY2Fwc3VsYXRlcyB0aGUgdmFyaW91cyBtb2RlcyBpbiB3aGljaAoJICogZGF0YSBjYW4gYmUgZW5jb2RlZCB0byBiaXRzIGluIHRoZSBRUiBjb2RlIHN0YW5kYXJkLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgTW9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBNb2RlKHZhbHVlLCBzdHJpbmdWYWx1ZSwgY2hhcmFjdGVyQ291bnRCaXRzRm9yVmVyc2lvbnMsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9ucyA9IGNoYXJhY3RlckNvdW50Qml0c0ZvclZlcnNpb25zOwoJICAgICAgICB0aGlzLmJpdHMgPSBiaXRzOwoJICAgICAgICBNb2RlLkZPUl9CSVRTLnNldChiaXRzLCB0aGlzKTsKCSAgICAgICAgTW9kZS5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgZm91ciBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSBkYXRhIG1vZGUKCSAgICAgKiBAcmV0dXJuIE1vZGUgZW5jb2RlZCBieSB0aGVzZSBiaXRzCgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYml0cyBkbyBub3QgY29ycmVzcG9uZCB0byBhIGtub3duIG1vZGUKCSAgICAgKi8KCSAgICBNb2RlLmZvckJpdHMgPSBmdW5jdGlvbiAoYml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBtb2RlID0gTW9kZS5GT1JfQklUUy5nZXQoYml0cyk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1vZGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1vZGU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmVyc2lvbiB2ZXJzaW9uIGluIHF1ZXN0aW9uCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB1c2VkLCBpbiB0aGlzIFFSIENvZGUgc3ltYm9sIHtAbGluayBWZXJzaW9ufSwgdG8gZW5jb2RlIHRoZQoJICAgICAqICAgICAgICAgY291bnQgb2YgY2hhcmFjdGVycyB0aGF0IHdpbGwgZm9sbG93IGVuY29kZWQgaW4gdGhpcyBNb2RlCgkgICAgICovCgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQ291bnRCaXRzID0gZnVuY3Rpb24gKHZlcnNpb24pIHsKCSAgICAgICAgdmFyIHZlcnNpb25OdW1iZXIgPSB2ZXJzaW9uLmdldFZlcnNpb25OdW1iZXIoKTsKCSAgICAgICAgdmFyIG9mZnNldDsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPD0gOSkgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmICh2ZXJzaW9uTnVtYmVyIDw9IDI2KSB7CgkgICAgICAgICAgICBvZmZzZXQgPSAxOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9uc1tvZmZzZXRdOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNb2RlKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBvdGhlci52YWx1ZTsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIE1vZGUuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5GT1JfVkFMVUUgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5URVJNSU5BVE9SID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5URVJNSU5BVE9SLCAnVEVSTUlOQVRPUicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDAwKTsgLy8gTm90IHJlYWxseSBhIG1vZGUuLi4KCSAgICBNb2RlLk5VTUVSSUMgPSBuZXcgTW9kZShNb2RlVmFsdWVzLk5VTUVSSUMsICdOVU1FUklDJywgSW50MzJBcnJheS5mcm9tKFsxMCwgMTIsIDE0XSksIDB4MDEpOwoJICAgIE1vZGUuQUxQSEFOVU1FUklDID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5BTFBIQU5VTUVSSUMsICdBTFBIQU5VTUVSSUMnLCBJbnQzMkFycmF5LmZyb20oWzksIDExLCAxM10pLCAweDAyKTsKCSAgICBNb2RlLlNUUlVDVFVSRURfQVBQRU5EID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5TVFJVQ1RVUkVEX0FQUEVORCwgJ1NUUlVDVFVSRURfQVBQRU5EJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDMpOyAvLyBOb3Qgc3VwcG9ydGVkCgkgICAgTW9kZS5CWVRFID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5CWVRFLCAnQllURScsIEludDMyQXJyYXkuZnJvbShbOCwgMTYsIDE2XSksIDB4MDQpOwoJICAgIE1vZGUuRUNJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5FQ0ksICdFQ0knLCBJbnQzMkFycmF5LmZyb20oWzAsIDAsIDBdKSwgMHgwNyk7IC8vIGNoYXJhY3RlciBjb3VudHMgZG9uJ3QgYXBwbHkKCSAgICBNb2RlLktBTkpJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5LQU5KSSwgJ0tBTkpJJywgSW50MzJBcnJheS5mcm9tKFs4LCAxMCwgMTJdKSwgMHgwOCk7CgkgICAgTW9kZS5GTkMxX0ZJUlNUX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX0ZJUlNUX1BPU0lUSU9OLCAnRk5DMV9GSVJTVF9QT1NJVElPTicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDA1KTsKCSAgICBNb2RlLkZOQzFfU0VDT05EX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX1NFQ09ORF9QT1NJVElPTiwgJ0ZOQzFfU0VDT05EX1BPU0lUSU9OJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDkpOwoJICAgIC8qKiBTZWUgR0JUIDE4Mjg0LTIwMDA7ICJIYW56aSIgaXMgYSB0cmFuc2xpdGVyYXRpb24gb2YgdGhpcyBtb2RlIG5hbWUuICovCgkgICAgTW9kZS5IQU5aSSA9IG5ldyBNb2RlKE1vZGVWYWx1ZXMuSEFOWkksICdIQU5aSScsIEludDMyQXJyYXkuZnJvbShbOCwgMTAsIDEyXSksIDB4MEQpOwoJICAgIHJldHVybiBNb2RlOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IE1vZGU7CgoJfShNb2RlKSk7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlLmRlY29kZXIgeyovCgl2YXIgQml0U291cmNlXzEgPSBCaXRTb3VyY2UkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSA9IENoYXJhY3RlclNldEVDSTsKCXZhciBEZWNvZGVyUmVzdWx0XzEgPSBEZWNvZGVyUmVzdWx0JDE7Cgl2YXIgU3RyaW5nVXRpbHNfMSA9IFN0cmluZ1V0aWxzJDE7Cgl2YXIgRm9ybWF0RXhjZXB0aW9uXzEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBTdHJpbmdCdWlsZGVyXzEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgU3RyaW5nRW5jb2RpbmdfMSA9IFN0cmluZ0VuY29kaW5nJDE7Cgl2YXIgTW9kZV8xID0gTW9kZTsKCS8qaW1wb3J0IGphdmEuaW8uVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbjsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlFSIENvZGVzIGNhbiBlbmNvZGUgdGV4dCBhcyBiaXRzIGluIG9uZSBvZiBzZXZlcmFsIG1vZGVzLCBhbmQgY2FuIHVzZSBtdWx0aXBsZSBtb2RlcwoJICogaW4gb25lIFFSIENvZGUuIFRoaXMgY2xhc3MgZGVjb2RlcyB0aGUgYml0cyBiYWNrIGludG8gdGV4dC48L3A+CgkgKgoJICogPHA+U2VlIElTTyAxODAwNDoyMDA2LCA2LjQuMyAtIDYuNC43PC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERlY29kZWRCaXRTdHJlYW1QYXJzZXIoKSB7CgkgICAgfQoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlID0gZnVuY3Rpb24gKGJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cykgewoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRTb3VyY2VfMS5kZWZhdWx0KGJ5dGVzKTsKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTdHJpbmdCdWlsZGVyXzEuZGVmYXVsdCgpOwoJICAgICAgICB2YXIgYnl0ZVNlZ21lbnRzID0gbmV3IEFycmF5KCk7IC8vIDEKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IEkgZG8gbm90IHVzZSBjb25zdHJ1Y3RvciB3aXRoIHNpemUgMSBhcyBpbiBvcmlnaW5hbCBKYXZhIG1lYW5zIGNhcGFjaXR5IGFuZCB0aGUgYXJyYXkgbGVuZ3RoIGlzIGNoZWNrZWQgYmVsb3cKCSAgICAgICAgdmFyIHN5bWJvbFNlcXVlbmNlID0gLTE7CgkgICAgICAgIHZhciBwYXJpdHlEYXRhID0gLTE7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB2YXIgY3VycmVudENoYXJhY3RlclNldEVDSSA9IG51bGw7CgkgICAgICAgICAgICB2YXIgZmMxSW5FZmZlY3QgPSBmYWxzZTsKCSAgICAgICAgICAgIHZhciBtb2RlID0gdm9pZCAwOwoJICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgIC8vIFdoaWxlIHN0aWxsIGFub3RoZXIgc2VnbWVudCB0byByZWFkLi4uCgkgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA0KSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE9LLCBhc3N1bWUgd2UncmUgZG9uZS4gUmVhbGx5LCBhIFRFUk1JTkFUT1IgbW9kZSBzaG91bGQgaGF2ZSBiZWVuIHJlY29yZGVkIGhlcmUKCSAgICAgICAgICAgICAgICAgICAgbW9kZSA9IE1vZGVfMS5kZWZhdWx0LlRFUk1JTkFUT1I7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZUJpdHMgPSBiaXRzLnJlYWRCaXRzKDQpOwoJICAgICAgICAgICAgICAgICAgICBtb2RlID0gTW9kZV8xLmRlZmF1bHQuZm9yQml0cyhtb2RlQml0cyk7IC8vIG1vZGUgaXMgZW5jb2RlZCBieSA0IGJpdHMKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkZOQzFfRklSU1RfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuRk5DMV9TRUNPTkRfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBsaXR0bGUgd2l0aCBGTkMxIGV4Y2VwdCBhbHRlciB0aGUgcGFyc2VkIHJlc3VsdCBhIGJpdCBhY2NvcmRpbmcgdG8gdGhlIHNwZWMKCSAgICAgICAgICAgICAgICAgICAgICAgIGZjMUluRWZmZWN0ID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LlNUUlVDVFVSRURfQVBQRU5EOgoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCAxNikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXIgYW5kIHBhcml0eSBpcyBhZGRlZCBsYXRlciB0byB0aGUgcmVzdWx0IG1ldGFkYXRhCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIG5leHQgOCBiaXRzIChzeW1ib2wgc2VxdWVuY2UgIykgYW5kIDggYml0cyAoZGF0YTogcGFyaXR5KSwgdGhlbiBjb250aW51ZQoJICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VxdWVuY2UgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyaXR5RGF0YSA9IGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5FQ0k6CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBkb2Vzbid0IGFwcGx5IHRvIEVDSQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5wYXJzZUVDSVZhbHVlKGJpdHMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJhY3RlclNldEVDSSA9IENoYXJhY3RlclNldEVDSV8xLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlWYWx1ZSh2YWx1ZSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5IQU5aSToKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGhhbmRsZSBIYW56aSBtb2RlIHdoaWNoIGRvZXMgbm90IHN0YXJ0IHdpdGggY2hhcmFjdGVyIGNvdW50CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGluZXNlIG1vZGUgY29udGFpbnMgYSBzdWIgc2V0IGluZGljYXRvciByaWdodCBhZnRlciBtb2RlIGluZGljYXRvcgoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNldCA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRIYW56aSA9IGJpdHMucmVhZEJpdHMobW9kZS5nZXRDaGFyYWN0ZXJDb3VudEJpdHModmVyc2lvbikpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNldCA9PT0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVIYW56aVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudEhhbnppKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk5vcm1hbCIgUVIgY29kZSBtb2RlczoKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgd2lsbCBmb2xsb3csIGVuY29kZWQgaW4gdGhpcyBtb2RlPwoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYml0cy5yZWFkQml0cyhtb2RlLmdldENoYXJhY3RlckNvdW50Qml0cyh2ZXJzaW9uKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0Lk5VTUVSSUM6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlTnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuQUxQSEFOVU1FUklDOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgZmMxSW5FZmZlY3QpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkJZVEU6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgY3VycmVudENoYXJhY3RlclNldEVDSSwgYnl0ZVNlZ21lbnRzLCBoaW50cyk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuS0FOSkk6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlS2FuamlTZWdtZW50KGJpdHMsIHJlc3VsdCwgY291bnQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSB3aGlsZSAobW9kZSAhPT0gTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUik7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlhZSAvKjogSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIGZyb20gcmVhZEJpdHMoKSBjYWxscwoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbmV3IERlY29kZXJSZXN1bHRfMS5kZWZhdWx0KGJ5dGVzLCByZXN1bHQudG9TdHJpbmcoKSwgYnl0ZVNlZ21lbnRzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBieXRlU2VnbWVudHMsIGVjTGV2ZWwgPT09IG51bGwgPyBudWxsIDogZWNMZXZlbC50b1N0cmluZygpLCBzeW1ib2xTZXF1ZW5jZSwgcGFyaXR5RGF0YSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZWUgc3BlY2lmaWNhdGlvbiBHQlQgMTgyODQtMjAwMAoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlSGFuemlTZWdtZW50ID0gZnVuY3Rpb24gKGJpdHMsIHJlc3VsdCwgY291bnQgLyppbnQqLykgewoJICAgICAgICAvLyBEb24ndCBjcmFzaCB0cnlpbmcgdG8gcmVhZCBtb3JlIGJpdHMgdGhhbiB3ZSBoYXZlIGF2YWlsYWJsZS4KCSAgICAgICAgaWYgKGNvdW50ICogMTMgPiBiaXRzLmF2YWlsYWJsZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhY2ggY2hhcmFjdGVyIHdpbGwgcmVxdWlyZSAyIGJ5dGVzLiBSZWFkIHRoZSBjaGFyYWN0ZXJzIGFzIDItYnl0ZSBwYWlycwoJICAgICAgICAvLyBhbmQgZGVjb2RlIGFzIEdCMjMxMiBhZnRlcndhcmRzCgkgICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSgyICogY291bnQpOwoJICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKCSAgICAgICAgd2hpbGUgKGNvdW50ID4gMCkgewoJICAgICAgICAgICAgLy8gRWFjaCAxMyBiaXRzIGVuY29kZXMgYSAyLWJ5dGUgY2hhcmFjdGVyCgkgICAgICAgICAgICB2YXIgdHdvQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDEzKTsKCSAgICAgICAgICAgIHZhciBhc3NlbWJsZWRUd29CeXRlcyA9ICgoKHR3b0J5dGVzIC8gMHgwNjApIDw8IDgpICYgMHhGRkZGRkZGRikgfCAodHdvQnl0ZXMgJSAweDA2MCk7CgkgICAgICAgICAgICBpZiAoYXNzZW1ibGVkVHdvQnl0ZXMgPCAweDAwM0JGKSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QTFBMSB0byAweEFBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBMUExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QjBBMSB0byAweEZBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBNkExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gPSAvKihieXRlKSAqLyAoKGFzc2VtYmxlZFR3b0J5dGVzID4+IDgpICYgMHhGRik7CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgMV0gPSAvKihieXRlKSAqLyAoYXNzZW1ibGVkVHdvQnl0ZXMgJiAweEZGKTsKCSAgICAgICAgICAgIG9mZnNldCArPSAyOwoJICAgICAgICAgICAgY291bnQtLTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKGJ1ZmZlciwgU3RyaW5nVXRpbHNfMS5kZWZhdWx0LkdCMjMxMikpOwoJICAgICAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IFRPRE86IGltcGxlbWVudCBHQjIzMTIgZGVjb2RlLiBTdHJpbmdWaWV3IGZyb20gTUROIGNvdWxkIGJlIGEgc3RhcnRpbmcgcG9pbnQKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVLYW5qaVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoY291bnQgKiAxMyA+IGJpdHMuYXZhaWxhYmxlKCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRWFjaCBjaGFyYWN0ZXIgd2lsbCByZXF1aXJlIDIgYnl0ZXMuIFJlYWQgdGhlIGNoYXJhY3RlcnMgYXMgMi1ieXRlIHBhaXJzCgkgICAgICAgIC8vIGFuZCBkZWNvZGUgYXMgU2hpZnRfSklTIGFmdGVyd2FyZHMKCSAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDIgKiBjb3VudCk7CgkgICAgICAgIHZhciBvZmZzZXQgPSAwOwoJICAgICAgICB3aGlsZSAoY291bnQgPiAwKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEzIGJpdHMgZW5jb2RlcyBhIDItYnl0ZSBjaGFyYWN0ZXIKCSAgICAgICAgICAgIHZhciB0d29CeXRlcyA9IGJpdHMucmVhZEJpdHMoMTMpOwoJICAgICAgICAgICAgdmFyIGFzc2VtYmxlZFR3b0J5dGVzID0gKCgodHdvQnl0ZXMgLyAweDBDMCkgPDwgOCkgJiAweEZGRkZGRkZGKSB8ICh0d29CeXRlcyAlIDB4MEMwKTsKCSAgICAgICAgICAgIGlmIChhc3NlbWJsZWRUd29CeXRlcyA8IDB4MDFGMDApIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHg4MTQwIHRvIDB4OUZGQyByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MDgxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHhFMDQwIHRvIDB4RUJCRiByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MEMxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSA9IC8qKGJ5dGUpICovIChhc3NlbWJsZWRUd29CeXRlcyA+PiA4KTsKCSAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyAxXSA9IC8qKGJ5dGUpICovIGFzc2VtYmxlZFR3b0J5dGVzOwoJICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgkgICAgICAgICAgICBjb3VudC0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNoaWZ0X0pJUyBtYXkgbm90IGJlIHN1cHBvcnRlZCBpbiBzb21lIGVudmlyb25tZW50czoKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoU3RyaW5nRW5jb2RpbmdfMS5kZWZhdWx0LmRlY29kZShidWZmZXIsIFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5TSElGVF9KSVMpKTsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBUT0RPOiBpbXBsZW1lbnQgU0hJRlRfSklTIGRlY29kZS4gU3RyaW5nVmlldyBmcm9tIE1ETiBjb3VsZCBiZSBhIHN0YXJ0aW5nIHBvaW50CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IFVuc3VwcG9ydGVkRW5jb2RpbmdFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoaWdub3JlZCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLCBieXRlU2VnbWVudHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoOCAqIGNvdW50ID4gYml0cy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVhZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKCSAgICAgICAgICAgIHJlYWRCeXRlc1tpXSA9IC8qKGJ5dGUpICovIGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVuY29kaW5nOwoJICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgLy8gVGhlIHNwZWMgaXNuJ3QgY2xlYXIgb24gdGhpcyBtb2RlOyBzZWUKCSAgICAgICAgICAgIC8vIHNlY3Rpb24gNi40LjU6IHQgZG9lcyBub3Qgc2F5IHdoaWNoIGVuY29kaW5nIHRvIGFzc3VtaW5nCgkgICAgICAgICAgICAvLyB1cG9uIGRlY29kaW5nLiBJIGhhdmUgc2VlbiBJU08tODg1OS0xIHVzZWQgYXMgd2VsbCBhcwoJICAgICAgICAgICAgLy8gU2hpZnRfSklTIC0tIHdpdGhvdXQgYW55dGhpbmcgbGlrZSBhbiBFQ0kgZGVzaWduYXRvciB0bwoJICAgICAgICAgICAgLy8gZ2l2ZSBhIGhpbnQuCgkgICAgICAgICAgICBlbmNvZGluZyA9IFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5ndWVzc0VuY29kaW5nKHJlYWRCeXRlcywgaGludHMpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgZW5jb2RpbmcgPSBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLmdldE5hbWUoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKHJlYWRCeXRlcywgZW5jb2RpbmcpKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgICAgICBieXRlU2VnbWVudHMucHVzaChyZWFkQnl0ZXMpOwoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPj0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5BTFBIQU5VTUVSSUNfQ0hBUlMubGVuZ3RoKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLkFMUEhBTlVNRVJJQ19DSEFSU1t2YWx1ZV07CgkgICAgfTsKCSAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBmYzFJbkVmZmVjdCkgewoJICAgICAgICAvLyBSZWFkIHR3byBjaGFyYWN0ZXJzIGF0IGEgdGltZQoJICAgICAgICB2YXIgc3RhcnQgPSByZXN1bHQubGVuZ3RoKCk7CgkgICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHsKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTEpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG5leHRUd29DaGFyc0JpdHMgPSBiaXRzLnJlYWRCaXRzKDExKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcihuZXh0VHdvQ2hhcnNCaXRzIC8gNDUpKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKG5leHRUd29DaGFyc0JpdHMgJSA0NSkpOwoJICAgICAgICAgICAgY291bnQgLT0gMjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY291bnQgPT09IDEpIHsKCSAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb25lIGNoYXJhY3RlciBsZWZ0CgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDYpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcihiaXRzLnJlYWRCaXRzKDYpKSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gU2VlIHNlY3Rpb24gNi40LjguMSwgNi40LjguMgoJICAgICAgICBpZiAoZmMxSW5FZmZlY3QpIHsKCSAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFzc2FnZSB0aGUgcmVzdWx0IGEgYml0IGlmIGluIGFuIEZOQzEgbW9kZToKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHJlc3VsdC5sZW5ndGgoKTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFyQXQoaSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHJlc3VsdC5sZW5ndGgoKSAtIDEgJiYgcmVzdWx0LmNoYXJBdChpICsgMSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gJSUgaXMgcmVuZGVyZWQgYXMgJQoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRlbGV0ZUNoYXJBdChpICsgMSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbHBoYSBtb2RlLCAlIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gRk5DMSBzZXBhcmF0b3IgMHgxRAoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldENoYXJBdChpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MUQpKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVOdW1lcmljU2VnbWVudCA9IGZ1bmN0aW9uIChiaXRzLCByZXN1bHQsIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgLy8gUmVhZCB0aHJlZSBkaWdpdHMgYXQgYSB0aW1lCgkgICAgICAgIHdoaWxlIChjb3VudCA+PSAzKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEwIGJpdHMgZW5jb2RlcyB0aHJlZSBkaWdpdHMKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTApIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIHRocmVlRGlnaXRzQml0cyA9IGJpdHMucmVhZEJpdHMoMTApOwoJICAgICAgICAgICAgaWYgKHRocmVlRGlnaXRzQml0cyA+PSAxMDAwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcih0aHJlZURpZ2l0c0JpdHMgLyAxMDApKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodGhyZWVEaWdpdHNCaXRzIC8gMTApICUgMTApKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIodGhyZWVEaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgICAgIGNvdW50IC09IDM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7CgkgICAgICAgICAgICAvLyBUd28gZGlnaXRzIGxlZnQgb3ZlciB0byByZWFkLCBlbmNvZGVkIGluIDcgYml0cwoJICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA3KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciB0d29EaWdpdHNCaXRzID0gYml0cy5yZWFkQml0cyg3KTsKCSAgICAgICAgICAgIGlmICh0d29EaWdpdHNCaXRzID49IDEwMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodHdvRGlnaXRzQml0cyAvIDEwKSkpOwoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcih0d29EaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChjb3VudCA9PT0gMSkgewoJICAgICAgICAgICAgLy8gT25lIGRpZ2l0IGxlZnQgb3ZlciB0byByZWFkCgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIGRpZ2l0Qml0cyA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICBpZiAoZGlnaXRCaXRzID49IDEwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoZGlnaXRCaXRzKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIucGFyc2VFQ0lWYWx1ZSA9IGZ1bmN0aW9uIChiaXRzKSB7CgkgICAgICAgIHZhciBmaXJzdEJ5dGUgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4ODApID09PSAwKSB7CgkgICAgICAgICAgICAvLyBqdXN0IG9uZSBieXRlCgkgICAgICAgICAgICByZXR1cm4gZmlyc3RCeXRlICYgMHg3RjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICAvLyB0d28gYnl0ZXMKCSAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gYml0cy5yZWFkQml0cyg4KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDNGKSA8PCA4KSAmIDB4RkZGRkZGRkYpIHwgc2Vjb25kQnl0ZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4RTApID09PSAweEMwKSB7CgkgICAgICAgICAgICAvLyB0aHJlZSBieXRlcwoJICAgICAgICAgICAgdmFyIHNlY29uZFRoaXJkQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDE2KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDFGKSA8PCAxNikgJiAweEZGRkZGRkZGKSB8IHNlY29uZFRoaXJkQnl0ZXM7CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFNlZSBJU08gMTgwMDQ6MjAwNiwgNi40LjQgVGFibGUgNQoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuQUxQSEFOVU1FUklDX0NIQVJTID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiAkJSorLS4vOic7CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUID0gMTsKCSAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcjsKCX0oKSk7CglEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEuZGVmYXVsdCA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXI7CgoJdmFyIFFSQ29kZURlY29kZXJNZXRhRGF0YSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDEzIFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShRUkNvZGVEZWNvZGVyTWV0YURhdGEkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiBNZXRhLWRhdGEgY29udGFpbmVyIGZvciBRUiBDb2RlIGRlY29kaW5nLiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBtYXkgYmUgdXNlZCB0byBjb252ZXkgaW5mb3JtYXRpb24gYmFjayB0byB0aGUKCSAqIGRlY29kaW5nIGNhbGxlci4gQ2FsbGVycyBhcmUgZXhwZWN0ZWQgdG8gcHJvY2VzcyB0aGlzLgoJICoKCSAqIEBzZWUgY29tLmdvb2dsZS56eGluZy5jb21tb24uRGVjb2RlclJlc3VsdCNnZXRPdGhlcigpCgkgKi8KCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUVJDb2RlRGVjb2Rlck1ldGFEYXRhKG1pcnJvcmVkKSB7CgkgICAgICAgIHRoaXMubWlycm9yZWQgPSBtaXJyb3JlZDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBRUiBDb2RlIHdhcyBtaXJyb3JlZC4KCSAgICAgKi8KCSAgICBRUkNvZGVEZWNvZGVyTWV0YURhdGEucHJvdG90eXBlLmlzTWlycm9yZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm1pcnJvcmVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbHkgdGhlIHJlc3VsdCBwb2ludHMnIG9yZGVyIGNvcnJlY3Rpb24gZHVlIHRvIG1pcnJvcmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBwb2ludHMgQXJyYXkgb2YgcG9pbnRzIHRvIGFwcGx5IG1pcnJvciBjb3JyZWN0aW9uIHRvLgoJICAgICAqLwoJICAgIFFSQ29kZURlY29kZXJNZXRhRGF0YS5wcm90b3R5cGUuYXBwbHlNaXJyb3JlZENvcnJlY3Rpb24gPSBmdW5jdGlvbiAocG9pbnRzKSB7CgkgICAgICAgIGlmICghdGhpcy5taXJyb3JlZCB8fCBwb2ludHMgPT09IG51bGwgfHwgcG9pbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IHBvaW50c1swXTsKCSAgICAgICAgcG9pbnRzWzBdID0gcG9pbnRzWzJdOwoJICAgICAgICBwb2ludHNbMl0gPSBib3R0b21MZWZ0OwoJICAgICAgICAvLyBObyBuZWVkIHRvICdmaXgnIHRvcC1sZWZ0IGFuZCBhbGlnbm1lbnQgcGF0dGVybi4KCSAgICB9OwoJICAgIHJldHVybiBRUkNvZGVEZWNvZGVyTWV0YURhdGE7Cgl9KCkpOwoJUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDEuZGVmYXVsdCA9IFFSQ29kZURlY29kZXJNZXRhRGF0YTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVjb2RlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZWNvZGVyIHsqLwoJdmFyIENoZWNrc3VtRXhjZXB0aW9uXzEgPSBDaGVja3N1bUV4Y2VwdGlvbiQxOwoJdmFyIEJpdE1hdHJpeF8xJDIgPSBCaXRNYXRyaXgkMTsKCXZhciBHZW5lcmljR0ZfMSA9IEdlbmVyaWNHRiQxOwoJdmFyIFJlZWRTb2xvbW9uRGVjb2Rlcl8xID0gUmVlZFNvbG9tb25EZWNvZGVyJDE7Cgl2YXIgQml0TWF0cml4UGFyc2VyXzEgPSBCaXRNYXRyaXhQYXJzZXIkMTsKCXZhciBEYXRhQmxvY2tfMSA9IERhdGFCbG9jayQxOwoJdmFyIERlY29kZWRCaXRTdHJlYW1QYXJzZXJfMSA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxID0gUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoZSBtYWluIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgUVIgQ29kZSBkZWNvZGluZyAtLSBhcyBvcHBvc2VkIHRvIGxvY2F0aW5nIGFuZCBleHRyYWN0aW5nCgkgKiB0aGUgUVIgQ29kZSBmcm9tIGFuIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEZWNvZGVyKCkgewoJICAgICAgICB0aGlzLnJzRGVjb2RlciA9IG5ldyBSZWVkU29sb21vbkRlY29kZXJfMS5kZWZhdWx0KEdlbmVyaWNHRl8xLmRlZmF1bHQuUVJfQ09ERV9GSUVMRF8yNTYpOwoJICAgIH0KCSAgICAvLyBwdWJsaWMgZGVjb2RlKGltYWdlOiBib29sZWFuW11bXSk6IERlY29kZXJSZXN1bHQgLyp0aHJvd3MgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkNvbnZlbmllbmNlIG1ldGhvZCB0aGF0IGNhbiBkZWNvZGUgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEgMkQgYXJyYXkgb2YgYm9vbGVhbnMuCgkgICAgICogInRydWUiIGlzIHRha2VuIHRvIG1lYW4gYSBibGFjayBtb2R1bGUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGJvb2xlYW5zIHJlcHJlc2VudGluZyB3aGl0ZS9ibGFjayBRUiBDb2RlIG1vZHVsZXMKCSAgICAgKiBAcGFyYW0gaGludHMgZGVjb2RpbmcgaGludHMgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBpbmZsdWVuY2UgZGVjb2RpbmcKCSAgICAgKiBAcmV0dXJuIHRleHQgYW5kIGJ5dGVzIGVuY29kZWQgd2l0aGluIHRoZSBRUiBDb2RlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgdGhlIFFSIENvZGUgY2Fubm90IGJlIGRlY29kZWQKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCb29sZWFuQXJyYXkgPSBmdW5jdGlvbiAoaW1hZ2UsIGhpbnRzKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeChCaXRNYXRyaXhfMSQyLmRlZmF1bHQucGFyc2VGcm9tQm9vbGVhbkFycmF5KGltYWdlKSwgaGludHMpOwoJICAgIH07CgkgICAgLy8gcHVibGljIGRlY29kZUJpdE1hdHJpeChiaXRzOiBCaXRNYXRyaXgpOiBEZWNvZGVyUmVzdWx0IC8qdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uLCBGb3JtYXRFeGNlcHRpb24qLyB7CgkgICAgLy8gICByZXR1cm4gZGVjb2RlKGJpdHMsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkRlY29kZXMgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0uIEEgMSBvciAidHJ1ZSIgaXMgdGFrZW4gdG8gbWVhbiBhIGJsYWNrIG1vZHVsZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0cyBib29sZWFucyByZXByZXNlbnRpbmcgd2hpdGUvYmxhY2sgUVIgQ29kZSBtb2R1bGVzCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kaW5nIGhpbnRzIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gaW5mbHVlbmNlIGRlY29kaW5nCgkgICAgICogQHJldHVybiB0ZXh0IGFuZCBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBRUiBDb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIENvbnN0cnVjdCBhIHBhcnNlciBhbmQgcmVhZCB2ZXJzaW9uLCBlcnJvci1jb3JyZWN0aW9uIGxldmVsCgkgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgQml0TWF0cml4UGFyc2VyXzEuZGVmYXVsdChiaXRzKTsKCSAgICAgICAgdmFyIGV4ID0gbnVsbDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKjogRm9ybWF0RXhjZXB0aW9uLCBDaGVja3N1bUV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICBleCA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFJldmVydCB0aGUgYml0IG1hdHJpeAoJICAgICAgICAgICAgcGFyc2VyLnJlbWFzaygpOwoJICAgICAgICAgICAgLy8gV2lsbCBiZSBhdHRlbXB0aW5nIGEgbWlycm9yZWQgcmVhZGluZyBvZiB0aGUgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm8uCgkgICAgICAgICAgICBwYXJzZXIuc2V0TWlycm9yKHRydWUpOwoJICAgICAgICAgICAgLy8gUHJlZW1wdGl2ZWx5IHJlYWQgdGhlIHZlcnNpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgICAgIC8vIFByZWVtcHRpdmVseSByZWFkIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCk7CgkgICAgICAgICAgICAvKgoJICAgICAgICAgICAgICogU2luY2Ugd2UncmUgaGVyZSwgdGhpcyBtZWFucyB3ZSBoYXZlIHN1Y2Nlc3NmdWxseSBkZXRlY3RlZCBzb21lIGtpbmQKCSAgICAgICAgICAgICAqIG9mIHZlcnNpb24gYW5kIGZvcm1hdCBpbmZvcm1hdGlvbiB3aGVuIG1pcnJvcmVkLiBUaGlzIGlzIGEgZ29vZCBzaWduLAoJICAgICAgICAgICAgICogdGhhdCB0aGUgUVIgY29kZSBtYXkgYmUgbWlycm9yZWQsIGFuZCB3ZSBzaG91bGQgdHJ5IG9uY2UgbW9yZSB3aXRoIGEKCSAgICAgICAgICAgICAqIG1pcnJvcmVkIGNvbnRlbnQuCgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIFByZXBhcmUgZm9yIGEgbWlycm9yZWQgcmVhZGluZy4KCSAgICAgICAgICAgIHBhcnNlci5taXJyb3IoKTsKCSAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgICAgIC8vIFN1Y2Nlc3MhIE5vdGlmeSB0aGUgY2FsbGVyIHRoYXQgdGhlIGNvZGUgd2FzIG1pcnJvcmVkLgoJICAgICAgICAgICAgcmVzdWx0LnNldE90aGVyKG5ldyBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxLmRlZmF1bHQodHJ1ZSkpOwoJICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKkZvcm1hdEV4Y2VwdGlvbiB8IENoZWNrc3VtRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIFRocm93IHRoZSBleGNlcHRpb24gZnJvbSB0aGUgb3JpZ2luYWwgcmVhZGluZwoJICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgZXg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aHJvdyBlOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCaXRNYXRyaXhQYXJzZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBoaW50cykgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCkuZ2V0RXJyb3JDb3JyZWN0aW9uTGV2ZWwoKTsKCSAgICAgICAgLy8gUmVhZCBjb2Rld29yZHMKCSAgICAgICAgdmFyIGNvZGV3b3JkcyA9IHBhcnNlci5yZWFkQ29kZXdvcmRzKCk7CgkgICAgICAgIC8vIFNlcGFyYXRlIGludG8gZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIGRhdGFCbG9ja3MgPSBEYXRhQmxvY2tfMS5kZWZhdWx0LmdldERhdGFCbG9ja3MoY29kZXdvcmRzLCB2ZXJzaW9uLCBlY0xldmVsKTsKCSAgICAgICAgLy8gQ291bnQgdG90YWwgbnVtYmVyIG9mIGRhdGEgYnl0ZXMKCSAgICAgICAgdmFyIHRvdGFsQnl0ZXMgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZGF0YUJsb2Nrc18xID0gX192YWx1ZXMkMihkYXRhQmxvY2tzKSwgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpOyAhZGF0YUJsb2Nrc18xXzEuZG9uZTsgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGRhdGFCbG9ja3NfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gZGF0YUJsb2NrLmdldE51bURhdGFDb2Rld29yZHMoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMV8xICYmICFkYXRhQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGRhdGFCbG9ja3NfMS5yZXR1cm4pKSBfYS5jYWxsKGRhdGFCbG9ja3NfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodG90YWxCeXRlcyk7CgkgICAgICAgIHZhciByZXN1bHRPZmZzZXQgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gRXJyb3ItY29ycmVjdCBhbmQgY29weSBkYXRhIGJsb2NrcyB0b2dldGhlciBpbnRvIGEgc3RyZWFtIG9mIGJ5dGVzCgkgICAgICAgICAgICBmb3IgKHZhciBkYXRhQmxvY2tzXzIgPSBfX3ZhbHVlcyQyKGRhdGFCbG9ja3MpLCBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCk7ICFkYXRhQmxvY2tzXzJfMS5kb25lOyBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gZGF0YUJsb2Nrc18yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdmFyIGNvZGV3b3JkQnl0ZXMgPSBkYXRhQmxvY2suZ2V0Q29kZXdvcmRzKCk7CgkgICAgICAgICAgICAgICAgdmFyIG51bURhdGFDb2Rld29yZHMgPSBkYXRhQmxvY2suZ2V0TnVtRGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgIHRoaXMuY29ycmVjdEVycm9ycyhjb2Rld29yZEJ5dGVzLCBudW1EYXRhQ29kZXdvcmRzKTsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICByZXN1bHRCeXRlc1tyZXN1bHRPZmZzZXQrK10gPSBjb2Rld29yZEJ5dGVzW2ldOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMl8xICYmICFkYXRhQmxvY2tzXzJfMS5kb25lICYmIChfYiA9IGRhdGFCbG9ja3NfMi5yZXR1cm4pKSBfYi5jYWxsKGRhdGFCbG9ja3NfMik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRGVjb2RlIHRoZSBjb250ZW50cyBvZiB0aGF0IHN0cmVhbSBvZiBieXRlcwoJICAgICAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcl8xLmRlZmF1bHQuZGVjb2RlKHJlc3VsdEJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5HaXZlbiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyByZWNlaXZlZCwgcG9zc2libHkgY29ycnVwdGVkIGJ5IGVycm9ycywgYXR0ZW1wdHMgdG8KCSAgICAgKiBjb3JyZWN0IHRoZSBlcnJvcnMgaW4tcGxhY2UgdXNpbmcgUmVlZC1Tb2xvbW9uIGVycm9yIGNvcnJlY3Rpb24uPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGNvZGV3b3JkQnl0ZXMgZGF0YSBhbmQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgKiBAcGFyYW0gbnVtRGF0YUNvZGV3b3JkcyBudW1iZXIgb2YgY29kZXdvcmRzIHRoYXQgYXJlIGRhdGEgYnl0ZXMKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5jb3JyZWN0RXJyb3JzID0gZnVuY3Rpb24gKGNvZGV3b3JkQnl0ZXMsIG51bURhdGFDb2Rld29yZHMgLyppbnQqLykgewoJICAgICAgICAvLyBjb25zdCBudW1Db2Rld29yZHMgPSBjb2Rld29yZEJ5dGVzLmxlbmd0aDsKCSAgICAgICAgLy8gRmlyc3QgcmVhZCBpbnRvIGFuIGFycmF5IG9mIGludHMKCSAgICAgICAgdmFyIGNvZGV3b3Jkc0ludHMgPSBuZXcgSW50MzJBcnJheShjb2Rld29yZEJ5dGVzKTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG5vdCByZWFseSBuZWNlc3NhcnkgdG8gdHJhbnNmb3JtIHRvIGludHM/IGNvdWxkIHJlZGVzaWduIGV2ZXJ5dGhpbmcgdG8gd29yayB3aXRoIHVuc2lnbmVkIGJ5dGVzPwoJICAgICAgICAvLyBjb25zdCBjb2Rld29yZHNJbnRzID0gbmV3IEludDMyQXJyYXkobnVtQ29kZXdvcmRzKQoJICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IG51bUNvZGV3b3JkczsgaSsrKSB7CgkgICAgICAgIC8vICAgY29kZXdvcmRzSW50c1tpXSA9IGNvZGV3b3JkQnl0ZXNbaV0gJiAweEZGCgkgICAgICAgIC8vIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMucnNEZWNvZGVyLmRlY29kZShjb2Rld29yZHNJbnRzLCBjb2Rld29yZEJ5dGVzLmxlbmd0aCAtIG51bURhdGFDb2Rld29yZHMpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChpZ25vcmVkIC8qOiBSZWVkU29sb21vbkV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQ2hlY2tzdW1FeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29weSBiYWNrIGludG8gYXJyYXkgb2YgYnl0ZXMgLS0gb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IHRoZSBieXRlcyB0aGF0IHdlcmUgZGF0YQoJICAgICAgICAvLyBXZSBkb24ndCBjYXJlIGFib3V0IGVycm9ycyBpbiB0aGUgZXJyb3ItY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1EYXRhQ29kZXdvcmRzOyBpKyspIHsKCSAgICAgICAgICAgIGNvZGV3b3JkQnl0ZXNbaV0gPSAvKihieXRlKSAqLyBjb2Rld29yZHNJbnRzW2ldOwoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlcjsKCX0oKSk7CglEZWNvZGVyJDEuZGVmYXVsdCA9IERlY29kZXI7CgoJdmFyIERldGVjdG9yJDEgPSB7fTsKCgl2YXIgTWF0aFV0aWxzJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMTIgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGhVdGlscyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5kZXRlY3RvciB7Ki8KCS8qKgoJICogR2VuZXJhbCBtYXRoLXJlbGF0ZWQgYW5kIG51bWVyaWMgdXRpbGl0eSBmdW5jdGlvbnMuCgkgKi8KCXZhciBNYXRoVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gTWF0aFV0aWxzKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBFbmRzIHVwIGJlaW5nIGEgYml0IGZhc3RlciB0aGFuIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0uIFRoaXMgbWVyZWx5IHJvdW5kcyBpdHMKCSAgICAgKiBhcmd1bWVudCB0byB0aGUgbmVhcmVzdCBpbnQsIHdoZXJlIHguNSByb3VuZHMgdXAgdG8geCsxLiBTZW1hbnRpY3Mgb2YgdGhpcyBzaG9ydGN1dAoJICAgICAqIGRpZmZlciBzbGlnaHRseSBmcm9tIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0gaW4gdGhhdCBoYWxmIHJvdW5kcyBkb3duIGZvciBuZWdhdGl2ZQoJICAgICAqIHZhbHVlcy4gLTIuNSByb3VuZHMgdG8gLTMsIG5vdCAtMi4gRm9yIHB1cnBvc2VzIGhlcmUgaXQgbWFrZXMgbm8gZGlmZmVyZW5jZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBkIHJlYWwgdmFsdWUgdG8gcm91bmQKCSAgICAgKiBAcmV0dXJuIG5lYXJlc3Qge0Bjb2RlIGludH0KCSAgICAgKi8KCSAgICBNYXRoVXRpbHMucm91bmQgPSBmdW5jdGlvbiAoZCAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE5hTiA9PT0gZCkKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICBpZiAoZCA8PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikKCSAgICAgICAgICAgIHJldHVybiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjsKCSAgICAgICAgaWYgKGQgPj0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpCgkgICAgICAgICAgICByZXR1cm4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHJldHVybiAvKihpbnQpICovIChkICsgKGQgPCAwLjAgPyAtMC41IDogMC41KSkgfCAwOwoJICAgIH07CgkgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG1heWJlIHJlbW92ZSByb3VuZCBtZXRob2QgYW5kIGNhbGwgZGlyZWN0bHkgTWF0aC5yb3VuZCwgaXQgbG9va3MgbGlrZSBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIGpzCgkgICAgLyoqCgkgICAgICogQHBhcmFtIGFYIHBvaW50IEEgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGFZIHBvaW50IEEgeSBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJYIHBvaW50IEIgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJZIHBvaW50IEIgeSBjb29yZGluYXRlCgkgICAgICogQHJldHVybiBFdWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgQSBhbmQgQgoJICAgICAqLwoJICAgIE1hdGhVdGlscy5kaXN0YW5jZSA9IGZ1bmN0aW9uIChhWCAvKmZsb2F0fGludCovLCBhWSAvKmZsb2F0fGludCovLCBiWCAvKmZsb2F0fGludCovLCBiWSAvKmZsb2F0fGludCovKSB7CgkgICAgICAgIHZhciB4RGlmZiA9IGFYIC0gYlg7CgkgICAgICAgIHZhciB5RGlmZiA9IGFZIC0gYlk7CgkgICAgICAgIHJldHVybiAvKihmbG9hdCkgKi8gTWF0aC5zcXJ0KHhEaWZmICogeERpZmYgKyB5RGlmZiAqIHlEaWZmKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBhWCBwb2ludCBBIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBhWSBwb2ludCBBIHkgY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWCBwb2ludCBCIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWSBwb2ludCBCIHkgY29vcmRpbmF0ZQoJICAgICAqIEByZXR1cm4gRXVjbGlkZWFuIGRpc3RhbmNlIGJldHdlZW4gcG9pbnRzIEEgYW5kIEIKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgc3RhdGljIGRpc3RhbmNlKGFYOiBudW1iZXIgLyppbnQqLywgYVk6IG51bWJlciAvKmludCovLCBiWDogbnVtYmVyIC8qaW50Ki8sIGJZOiBudW1iZXIgLyppbnQqLyk6IGZsb2F0IHsKCSAgICAvLyAgIGNvbnN0IHhEaWZmID0gYVggLSBiWAoJICAgIC8vICAgY29uc3QgeURpZmYgPSBhWSAtIGJZCgkgICAgLy8gICByZXR1cm4gKGZsb2F0KSBNYXRoLnNxcnQoeERpZmYgKiB4RGlmZiArIHlEaWZmICogeURpZmYpOwoJICAgIC8vIH0KCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYXJyYXkgdmFsdWVzIHRvIHN1bQoJICAgICAqIEByZXR1cm4gc3VtIG9mIHZhbHVlcyBpbiBhcnJheQoJICAgICAqLwoJICAgIE1hdGhVdGlscy5zdW0gPSBmdW5jdGlvbiAoYXJyYXkpIHsKCSAgICAgICAgdmFyIGNvdW50ID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyYXkubGVuZ3RoOyBpICE9PSBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgYSA9IGFycmF5W2ldOwoJICAgICAgICAgICAgY291bnQgKz0gYTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY291bnQ7CgkgICAgfTsKCSAgICByZXR1cm4gTWF0aFV0aWxzOwoJfSgpKTsKCU1hdGhVdGlscyQxLmRlZmF1bHQgPSBNYXRoVXRpbHM7CgoJdmFyIERldGVjdG9yUmVzdWx0JDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERldGVjdG9yUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGV0ZWN0aW5nIGEgYmFyY29kZSBpbiBhbiBpbWFnZS4gVGhpcyBpbmNsdWRlcyB0aGUgcmF3CgkgKiBtYXRyaXggb2YgYmxhY2svd2hpdGUgcGl4ZWxzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGJhcmNvZGUsIGFuZCBwb3NzaWJseSBwb2ludHMgb2YgaW50ZXJlc3QKCSAqIGluIHRoZSBpbWFnZSwgbGlrZSB0aGUgbG9jYXRpb24gb2YgZmluZGVyIHBhdHRlcm5zIG9yIGNvcm5lcnMgb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGV0ZWN0b3JSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gRGV0ZWN0b3JSZXN1bHQoYml0cywgcG9pbnRzKSB7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzOwoJICAgIH0KCSAgICBEZXRlY3RvclJlc3VsdC5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIERldGVjdG9yUmVzdWx0LnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnBvaW50czsKCSAgICB9OwoJICAgIHJldHVybiBEZXRlY3RvclJlc3VsdDsKCX0oKSk7CglEZXRlY3RvclJlc3VsdCQxLmRlZmF1bHQgPSBEZXRlY3RvclJlc3VsdDsKCgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSQxID0ge307CgoJdmFyIERlZmF1bHRHcmlkU2FtcGxlciQxID0ge307CgoJdmFyIEdyaWRTYW1wbGVyJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDUgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBJbXBsZW1lbnRhdGlvbnMgb2YgdGhpcyBjbGFzcyBjYW4sIGdpdmVuIGxvY2F0aW9ucyBvZiBmaW5kZXIgcGF0dGVybnMgZm9yIGEgUVIgY29kZSBpbiBhbgoJICogaW1hZ2UsIHNhbXBsZSB0aGUgcmlnaHQgcG9pbnRzIGluIHRoZSBpbWFnZSB0byByZWNvbnN0cnVjdCB0aGUgUVIgY29kZSwgYWNjb3VudGluZyBmb3IKCSAqIHBlcnNwZWN0aXZlIGRpc3RvcnRpb24uIEl0IGlzIGFic3RyYWN0ZWQgc2luY2UgaXQgaXMgcmVsYXRpdmVseSBleHBlbnNpdmUgYW5kIHNob3VsZCBiZSBhbGxvd2VkCgkgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6ZWQgaW1wbGVtZW50YXRpb25zLCBsaWtlIFN1bidzIEphdmEgQWR2YW5jZWQKCSAqIEltYWdpbmcgbGlicmFyeSwgYnV0IHdoaWNoIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIG90aGVyIGVudmlyb25tZW50cyBzdWNoIGFzIEoyTUUsIGFuZCB2aWNlCgkgKiB2ZXJzYS4KCSAqCgkgKiBUaGUgaW1wbGVtZW50YXRpb24gdXNlZCBjYW4gYmUgY29udHJvbGxlZCBieSBjYWxsaW5nIHtAbGluayAjc2V0R3JpZFNhbXBsZXIoR3JpZFNhbXBsZXIpfQoJICogd2l0aCBhbiBpbnN0YW5jZSBvZiBhIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdyaWRTYW1wbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEdyaWRTYW1wbGVyKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5DaGVja3MgYSBzZXQgb2YgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zZm9ybWVkIHRvIHNhbXBsZSBwb2ludHMgb24gYW4gaW1hZ2UgYWdhaW5zdAoJICAgICAqIHRoZSBpbWFnZSdzIGRpbWVuc2lvbnMgdG8gc2VlIGlmIHRoZSBwb2ludCBhcmUgZXZlbiB3aXRoaW4gdGhlIGltYWdlLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHdpbGwgYWN0dWFsbHkgIm51ZGdlIiB0aGUgZW5kcG9pbnRzIGJhY2sgb250byB0aGUgaW1hZ2UgaWYgdGhleSBhcmUgZm91bmQgdG8gYmUKCSAgICAgKiBiYXJlbHkgKGxlc3MgdGhhbiAxIHBpeGVsKSBvZmYgdGhlIGltYWdlLiBUaGlzIGFjY291bnRzIGZvciBpbXBlcmZlY3QgZGV0ZWN0aW9uIG9mIGZpbmRlcgoJICAgICAqIHBhdHRlcm5zIGluIGFuIGltYWdlIHdoZXJlIHRoZSBRUiBDb2RlIHJ1bnMgYWxsIHRoZSB3YXkgdG8gdGhlIGltYWdlIGJvcmRlci48L3A+CgkgICAgICoKCSAgICAgKiA8cD5Gb3IgZWZmaWNpZW5jeSwgdGhlIG1ldGhvZCB3aWxsIGNoZWNrIHBvaW50cyBmcm9tIGVpdGhlciBlbmQgb2YgdGhlIGxpbmUgdW50aWwgb25lIGlzIGZvdW5kCgkgICAgICogdG8gYmUgd2l0aGluIHRoZSBpbWFnZS4gQmVjYXVzZSB0aGUgc2V0IG9mIHBvaW50cyBhcmUgYXNzdW1lZCB0byBiZSBsaW5lYXIsIHRoaXMgaXMgdmFsaWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGltYWdlIGludG8gd2hpY2ggdGhlIHBvaW50cyBzaG91bGQgbWFwCgkgICAgICogQHBhcmFtIHBvaW50cyBhY3R1YWwgcG9pbnRzIGluIHgxLHkxLC4uLix4bix5biBmb3JtCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhbiBlbmRwb2ludCBpcyBsaWVzIG91dHNpZGUgdGhlIGltYWdlIGJvdW5kYXJpZXMKCSAgICAgKi8KCSAgICBHcmlkU2FtcGxlci5jaGVja0FuZE51ZGdlUG9pbnRzID0gZnVuY3Rpb24gKGltYWdlLCBwb2ludHMpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gc3RhcnQgdW50aWwgd2Ugc2VlIHNvbWUgdGhhdCBhcmUgT0s6CgkgICAgICAgIHZhciBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSAwOyBvZmZzZXQgPCBwb2ludHMubGVuZ3RoICYmIG51ZGdlZDsgb2Zmc2V0ICs9IDIpIHsKCSAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0XSk7CgkgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IocG9pbnRzW29mZnNldCArIDFdKTsKCSAgICAgICAgICAgIGlmICh4IDwgLTEgfHwgeCA+IHdpZHRoIHx8IHkgPCAtMSB8fCB5ID4gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBudWRnZWQgPSBmYWxzZTsKCSAgICAgICAgICAgIGlmICh4ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gMC4wOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmICh4ID09PSB3aWR0aCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gd2lkdGggLSAxOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoeSA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICBwb2ludHNbb2Zmc2V0ICsgMV0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IGhlaWdodCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gZW5kOgoJICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSBwb2ludHMubGVuZ3RoIC0gMjsgb2Zmc2V0ID49IDAgJiYgbnVkZ2VkOyBvZmZzZXQgLT0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHBvaW50c1tvZmZzZXRdKTsKCSAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0ICsgMV0pOwoJICAgICAgICAgICAgaWYgKHggPCAtMSB8fCB4ID4gd2lkdGggfHwgeSA8IC0xIHx8IHkgPiBoZWlnaHQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ1LmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIG51ZGdlZCA9IGZhbHNlOwoJICAgICAgICAgICAgaWYgKHggPT09IC0xKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHggPT09IHdpZHRoKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSB3aWR0aCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICh5ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IDAuMDsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoeSA9PT0gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldCArIDFdID0gaGVpZ2h0IC0gMTsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXI7Cgl9KCkpOwoJR3JpZFNhbXBsZXIkMS5kZWZhdWx0ID0gR3JpZFNhbXBsZXI7CgoJdmFyIFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGltcGxlbWVudHMgYSBwZXJzcGVjdGl2ZSB0cmFuc2Zvcm0gaW4gdHdvIGRpbWVuc2lvbnMuIEdpdmVuIGZvdXIgc291cmNlIGFuZCBmb3VyCgkgKiBkZXN0aW5hdGlvbiBwb2ludHMsIGl0IHdpbGwgY29tcHV0ZSB0aGUgdHJhbnNmb3JtYXRpb24gaW1wbGllZCBiZXR3ZWVuIHRoZW0uIFRoZSBjb2RlIGlzIGJhc2VkCgkgKiBkaXJlY3RseSB1cG9uIHNlY3Rpb24gMy40LjIgb2YgR2VvcmdlIFdvbGJlcmcncyAiRGlnaXRhbCBJbWFnZSBXYXJwaW5nIjsgc2VlIHBhZ2VzIDU0LTU2LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUGVyc3BlY3RpdmVUcmFuc2Zvcm0oYTExIC8qZmxvYXQqLywgYTIxIC8qZmxvYXQqLywgYTMxIC8qZmxvYXQqLywgYTEyIC8qZmxvYXQqLywgYTIyIC8qZmxvYXQqLywgYTMyIC8qZmxvYXQqLywgYTEzIC8qZmxvYXQqLywgYTIzIC8qZmxvYXQqLywgYTMzIC8qZmxvYXQqLykgewoJICAgICAgICB0aGlzLmExMSA9IGExMTsKCSAgICAgICAgdGhpcy5hMjEgPSBhMjE7CgkgICAgICAgIHRoaXMuYTMxID0gYTMxOwoJICAgICAgICB0aGlzLmExMiA9IGExMjsKCSAgICAgICAgdGhpcy5hMjIgPSBhMjI7CgkgICAgICAgIHRoaXMuYTMyID0gYTMyOwoJICAgICAgICB0aGlzLmExMyA9IGExMzsKCSAgICAgICAgdGhpcy5hMjMgPSBhMjM7CgkgICAgICAgIHRoaXMuYTMzID0gYTMzOwoJICAgIH0KCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsID0gZnVuY3Rpb24gKHgwIC8qZmxvYXQqLywgeTAgLypmbG9hdCovLCB4MSAvKmZsb2F0Ki8sIHkxIC8qZmxvYXQqLywgeDIgLypmbG9hdCovLCB5MiAvKmZsb2F0Ki8sIHgzIC8qZmxvYXQqLywgeTMgLypmbG9hdCovLCB4MHAgLypmbG9hdCovLCB5MHAgLypmbG9hdCovLCB4MXAgLypmbG9hdCovLCB5MXAgLypmbG9hdCovLCB4MnAgLypmbG9hdCovLCB5MnAgLypmbG9hdCovLCB4M3AgLypmbG9hdCovLCB5M3AgLypmbG9hdCovKSB7CgkgICAgICAgIHZhciBxVG9TID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0ucXVhZHJpbGF0ZXJhbFRvU3F1YXJlKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Myk7CgkgICAgICAgIHZhciBzVG9RID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwcCwgeTBwLCB4MXAsIHkxcCwgeDJwLCB5MnAsIHgzcCwgeTNwKTsKCSAgICAgICAgcmV0dXJuIHNUb1EudGltZXMocVRvUyk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykgewoJICAgICAgICB2YXIgbWF4ID0gcG9pbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkgKz0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBwb2ludHNbaV07CgkgICAgICAgICAgICB2YXIgeSA9IHBvaW50c1tpICsgMV07CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBhMTMgKiB4ICsgYTIzICogeSArIGEzMzsKCSAgICAgICAgICAgIHBvaW50c1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHBvaW50c1tpICsgMV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludHNXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHhWYWx1ZXMsIHlWYWx1ZXMpIHsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgdmFyIG4gPSB4VmFsdWVzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB4ID0geFZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciB5ID0geVZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGExMyAqIHggKyBhMjMgKiB5ICsgYTMzOwoJICAgICAgICAgICAgeFZhbHVlc1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHlWYWx1ZXNbaV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnNxdWFyZVRvUXVhZHJpbGF0ZXJhbCA9IGZ1bmN0aW9uICh4MCAvKmZsb2F0Ki8sIHkwIC8qZmxvYXQqLywgeDEgLypmbG9hdCovLCB5MSAvKmZsb2F0Ki8sIHgyIC8qZmxvYXQqLywgeTIgLypmbG9hdCovLCB4MyAvKmZsb2F0Ki8sIHkzIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgZHgzID0geDAgLSB4MSArIHgyIC0geDM7CgkgICAgICAgIHZhciBkeTMgPSB5MCAtIHkxICsgeTIgLSB5MzsKCSAgICAgICAgaWYgKGR4MyA9PT0gMC4wICYmIGR5MyA9PT0gMC4wKSB7CgkgICAgICAgICAgICAvLyBBZmZpbmUKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCwgeDIgLSB4MSwgeDAsIHkxIC0geTAsIHkyIC0geTEsIHkwLCAwLjAsIDAuMCwgMS4wKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHZhciBkeDEgPSB4MSAtIHgyOwoJICAgICAgICAgICAgdmFyIGR4MiA9IHgzIC0geDI7CgkgICAgICAgICAgICB2YXIgZHkxID0geTEgLSB5MjsKCSAgICAgICAgICAgIHZhciBkeTIgPSB5MyAtIHkyOwoJICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZHgxICogZHkyIC0gZHgyICogZHkxOwoJICAgICAgICAgICAgdmFyIGExMyA9IChkeDMgKiBkeTIgLSBkeDIgKiBkeTMpIC8gZGVub21pbmF0b3I7CgkgICAgICAgICAgICB2YXIgYTIzID0gKGR4MSAqIGR5MyAtIGR4MyAqIGR5MSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCArIGExMyAqIHgxLCB4MyAtIHgwICsgYTIzICogeDMsIHgwLCB5MSAtIHkwICsgYTEzICogeTEsIHkzIC0geTAgKyBhMjMgKiB5MywgeTAsIGExMywgYTIzLCAxLjApOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9TcXVhcmUgPSBmdW5jdGlvbiAoeDAgLypmbG9hdCovLCB5MCAvKmZsb2F0Ki8sIHgxIC8qZmxvYXQqLywgeTEgLypmbG9hdCovLCB4MiAvKmZsb2F0Ki8sIHkyIC8qZmxvYXQqLywgeDMgLypmbG9hdCovLCB5MyAvKmZsb2F0Ki8pIHsKCSAgICAgICAgLy8gSGVyZSwgdGhlIGFkam9pbnQgc2VydmVzIGFzIHRoZSBpbnZlcnNlOgoJICAgICAgICByZXR1cm4gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MykuYnVpbGRBZGpvaW50KCk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUuYnVpbGRBZGpvaW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBBZGpvaW50IGlzIHRoZSB0cmFuc3Bvc2Ugb2YgdGhlIGNvZmFjdG9yIG1hdHJpeDoKCSAgICAgICAgcmV0dXJuIG5ldyBQZXJzcGVjdGl2ZVRyYW5zZm9ybSh0aGlzLmEyMiAqIHRoaXMuYTMzIC0gdGhpcy5hMjMgKiB0aGlzLmEzMiwgdGhpcy5hMjMgKiB0aGlzLmEzMSAtIHRoaXMuYTIxICogdGhpcy5hMzMsIHRoaXMuYTIxICogdGhpcy5hMzIgLSB0aGlzLmEyMiAqIHRoaXMuYTMxLCB0aGlzLmExMyAqIHRoaXMuYTMyIC0gdGhpcy5hMTIgKiB0aGlzLmEzMywgdGhpcy5hMTEgKiB0aGlzLmEzMyAtIHRoaXMuYTEzICogdGhpcy5hMzEsIHRoaXMuYTEyICogdGhpcy5hMzEgLSB0aGlzLmExMSAqIHRoaXMuYTMyLCB0aGlzLmExMiAqIHRoaXMuYTIzIC0gdGhpcy5hMTMgKiB0aGlzLmEyMiwgdGhpcy5hMTMgKiB0aGlzLmEyMSAtIHRoaXMuYTExICogdGhpcy5hMjMsIHRoaXMuYTExICogdGhpcy5hMjIgLSB0aGlzLmExMiAqIHRoaXMuYTIxKTsKCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50aW1lcyA9IGZ1bmN0aW9uIChvdGhlcikgewoJICAgICAgICByZXR1cm4gbmV3IFBlcnNwZWN0aXZlVHJhbnNmb3JtKHRoaXMuYTExICogb3RoZXIuYTExICsgdGhpcy5hMjEgKiBvdGhlci5hMTIgKyB0aGlzLmEzMSAqIG90aGVyLmExMywgdGhpcy5hMTEgKiBvdGhlci5hMjEgKyB0aGlzLmEyMSAqIG90aGVyLmEyMiArIHRoaXMuYTMxICogb3RoZXIuYTIzLCB0aGlzLmExMSAqIG90aGVyLmEzMSArIHRoaXMuYTIxICogb3RoZXIuYTMyICsgdGhpcy5hMzEgKiBvdGhlci5hMzMsIHRoaXMuYTEyICogb3RoZXIuYTExICsgdGhpcy5hMjIgKiBvdGhlci5hMTIgKyB0aGlzLmEzMiAqIG90aGVyLmExMywgdGhpcy5hMTIgKiBvdGhlci5hMjEgKyB0aGlzLmEyMiAqIG90aGVyLmEyMiArIHRoaXMuYTMyICogb3RoZXIuYTIzLCB0aGlzLmExMiAqIG90aGVyLmEzMSArIHRoaXMuYTIyICogb3RoZXIuYTMyICsgdGhpcy5hMzIgKiBvdGhlci5hMzMsIHRoaXMuYTEzICogb3RoZXIuYTExICsgdGhpcy5hMjMgKiBvdGhlci5hMTIgKyB0aGlzLmEzMyAqIG90aGVyLmExMywgdGhpcy5hMTMgKiBvdGhlci5hMjEgKyB0aGlzLmEyMyAqIG90aGVyLmEyMiArIHRoaXMuYTMzICogb3RoZXIuYTIzLCB0aGlzLmExMyAqIG90aGVyLmEzMSArIHRoaXMuYTIzICogb3RoZXIuYTMyICsgdGhpcy5hMzMgKiBvdGhlci5hMzMpOwoJICAgIH07CgkgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoJfSgpKTsKCVBlcnNwZWN0aXZlVHJhbnNmb3JtJDEuZGVmYXVsdCA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVmYXVsdEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEdyaWRTYW1wbGVyXzEgPSBHcmlkU2FtcGxlciQxOwoJdmFyIEJpdE1hdHJpeF8xJDEgPSBCaXRNYXRyaXgkMTsKCXZhciBQZXJzcGVjdGl2ZVRyYW5zZm9ybV8xJDEgPSBQZXJzcGVjdGl2ZVRyYW5zZm9ybSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEkNCA9IE5vdEZvdW5kRXhjZXB0aW9uJDE7CgkvKioKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWZhdWx0R3JpZFNhbXBsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDIoRGVmYXVsdEdyaWRTYW1wbGVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIERlZmF1bHRHcmlkU2FtcGxlcigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgRGVmYXVsdEdyaWRTYW1wbGVyLnByb3RvdHlwZS5zYW1wbGVHcmlkID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgcDFUb1ggLypmbG9hdCovLCBwMVRvWSAvKmZsb2F0Ki8sIHAyVG9YIC8qZmxvYXQqLywgcDJUb1kgLypmbG9hdCovLCBwM1RvWCAvKmZsb2F0Ki8sIHAzVG9ZIC8qZmxvYXQqLywgcDRUb1ggLypmbG9hdCovLCBwNFRvWSAvKmZsb2F0Ki8sIHAxRnJvbVggLypmbG9hdCovLCBwMUZyb21ZIC8qZmxvYXQqLywgcDJGcm9tWCAvKmZsb2F0Ki8sIHAyRnJvbVkgLypmbG9hdCovLCBwM0Zyb21YIC8qZmxvYXQqLywgcDNGcm9tWSAvKmZsb2F0Ki8sIHA0RnJvbVggLypmbG9hdCovLCBwNEZyb21ZIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSQxLmRlZmF1bHQucXVhZHJpbGF0ZXJhbFRvUXVhZHJpbGF0ZXJhbChwMVRvWCwgcDFUb1ksIHAyVG9YLCBwMlRvWSwgcDNUb1gsIHAzVG9ZLCBwNFRvWCwgcDRUb1ksIHAxRnJvbVgsIHAxRnJvbVksIHAyRnJvbVgsIHAyRnJvbVksIHAzRnJvbVgsIHAzRnJvbVksIHA0RnJvbVgsIHA0RnJvbVkpOwoJICAgICAgICByZXR1cm4gdGhpcy5zYW1wbGVHcmlkV2l0aFRyYW5zZm9ybShpbWFnZSwgZGltZW5zaW9uWCwgZGltZW5zaW9uWSwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBEZWZhdWx0R3JpZFNhbXBsZXIucHJvdG90eXBlLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgdHJhbnNmb3JtKSB7CgkgICAgICAgIGlmIChkaW1lbnNpb25YIDw9IDAgfHwgZGltZW5zaW9uWSA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMSQxLmRlZmF1bHQoZGltZW5zaW9uWCwgZGltZW5zaW9uWSk7CgkgICAgICAgIHZhciBwb2ludHMgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiBkaW1lbnNpb25YKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBkaW1lbnNpb25ZOyB5KyspIHsKCSAgICAgICAgICAgIHZhciBtYXggPSBwb2ludHMubGVuZ3RoOwoJICAgICAgICAgICAgdmFyIGlWYWx1ZSA9IHkgKyAwLjU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1heDsgeCArPSAyKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW3hdID0gKHggLyAyKSArIDAuNTsKCSAgICAgICAgICAgICAgICBwb2ludHNbeCArIDFdID0gaVZhbHVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50cyhwb2ludHMpOwoJICAgICAgICAgICAgLy8gUXVpY2sgY2hlY2sgdG8gc2VlIGlmIHBvaW50cyB0cmFuc2Zvcm1lZCB0byBzb21ldGhpbmcgaW5zaWRlIHRoZSBpbWFnZQoJICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0byBjaGVjayB0aGUgZW5kcG9pbnRzCgkgICAgICAgICAgICBHcmlkU2FtcGxlcl8xLmRlZmF1bHQuY2hlY2tBbmROdWRnZVBvaW50cyhpbWFnZSwgcG9pbnRzKTsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHggKz0gMikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KE1hdGguZmxvb3IocG9pbnRzW3hdKSwgTWF0aC5mbG9vcihwb2ludHNbeCArIDFdKSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsYWNrKC1pc2gpIHBpeGVsCgkgICAgICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4IC8gMiwgeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoYWlvb2JlIC8qOiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgICAgIC8vIFRoaXMgZmVlbHMgd3JvbmcsIGJ1dCwgc29tZXRpbWVzIGlmIHRoZSBmaW5kZXIgcGF0dGVybnMgYXJlIG1pc2lkZW50aWZpZWQsIHRoZSByZXN1bHRpbmcKCSAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gZ2V0cyAidHdpc3RlZCIgc3VjaCB0aGF0IGl0IG1hcHMgYSBzdHJhaWdodCBsaW5lIG9mIHBvaW50cyB0byBhIHNldCBvZiBwb2ludHMKCSAgICAgICAgICAgICAgICAvLyB3aG9zZSBlbmRwb2ludHMgYXJlIGluIGJvdW5kcywgYnV0IG90aGVycyBhcmUgbm90LiBUaGVyZSBpcyBwcm9iYWJseSBzb21lIG1hdGhlbWF0aWNhbAoJICAgICAgICAgICAgICAgIC8vIHdheSB0byBkZXRlY3QgdGhpcyBhYm91dCB0aGUgdHJhbnNmb3JtYXRpb24gdGhhdCBJIGRvbid0IGtub3cgeWV0LgoJICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVzdWx0cyBpbiBhbiB1Z2x5IHJ1bnRpbWUgZXhjZXB0aW9uIGRlc3BpdGUgb3VyIGNsZXZlciBjaGVja3MgYWJvdmUgLS0gY2FuJ3QgaGF2ZQoJICAgICAgICAgICAgICAgIC8vIHRoYXQuIFdlIGNvdWxkIGNoZWNrIGVhY2ggcG9pbnQncyBjb29yZGluYXRlcyBidXQgdGhhdCBmZWVscyBkdXBsaWNhdGl2ZS4gV2Ugc2V0dGxlIGZvcgoJICAgICAgICAgICAgICAgIC8vIGNhdGNoaW5nIGFuZCB3cmFwcGluZyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24uCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNC5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICByZXR1cm4gRGVmYXVsdEdyaWRTYW1wbGVyOwoJfShHcmlkU2FtcGxlcl8xLmRlZmF1bHQpKTsKCURlZmF1bHRHcmlkU2FtcGxlciQxLmRlZmF1bHQgPSBEZWZhdWx0R3JpZFNhbXBsZXI7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVySW5zdGFuY2UkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIERlZmF1bHRHcmlkU2FtcGxlcl8xID0gRGVmYXVsdEdyaWRTYW1wbGVyJDE7Cgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBHcmlkU2FtcGxlckluc3RhbmNlKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBTZXRzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBHcmlkU2FtcGxlciB1c2VkIGJ5IHRoZSBsaWJyYXJ5LiBPbmUgZ2xvYmFsCgkgICAgICogaW5zdGFuY2UgaXMgc3RvcmVkLCB3aGljaCBtYXkgc291bmQgcHJvYmxlbWF0aWMuIEJ1dCwgdGhlIGltcGxlbWVudGF0aW9uIHByb3ZpZGVkCgkgICAgICogb3VnaHQgdG8gYmUgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnRpcmUgcGxhdGZvcm0sIGFuZCBhbGwgdXNlcyBvZiB0aGlzIGxpYnJhcnkKCSAgICAgKiBpbiB0aGUgd2hvbGUgbGlmZXRpbWUgb2YgdGhlIEpWTS4gRm9yIGluc3RhbmNlLCBhbiBBbmRyb2lkIGFjdGl2aXR5IGNhbiBzd2FwIGluCgkgICAgICogYW4gaW1wbGVtZW50YXRpb24gdGhhdCB0YWtlcyBhZHZhbnRhZ2Ugb2YgbmF0aXZlIHBsYXRmb3JtIGxpYnJhcmllcy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBuZXdHcmlkU2FtcGxlciBUaGUgcGxhdGZvcm0tc3BlY2lmaWMgb2JqZWN0IHRvIGluc3RhbGwuCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5zZXRHcmlkU2FtcGxlciA9IGZ1bmN0aW9uIChuZXdHcmlkU2FtcGxlcikgewoJICAgICAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3R3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIEdyaWRTYW1wbGVyCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIEdyaWRTYW1wbGVySW5zdGFuY2UuZ3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3IERlZmF1bHRHcmlkU2FtcGxlcl8xLmRlZmF1bHQoKTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXJJbnN0YW5jZTsKCX0oKSk7CglHcmlkU2FtcGxlckluc3RhbmNlJDEuZGVmYXVsdCA9IEdyaWRTYW1wbGVySW5zdGFuY2U7CgoJdmFyIFJlc3VsdFBvaW50JDEgPSB7fTsKCgl2YXIgRmxvYXQkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbG9hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIFBvbnlmaWxsIGZvciBKYXZhJ3MgRmxvYXQgY2xhc3MuCgkgKi8KCXZhciBGbG9hdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBGbG9hdCgpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogU2luY1RTIGhhcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaW50IGFuZCBmbG9hdCwgdGhlcmUncyBhbGwgbnVtYmVycywKCSAgICAgKiB0aGlzIGlzIHVzZWQgb25seSB0byBwb2x5ZmlsbCBKYXZhIGNvZGUuCgkgICAgICovCgkgICAgRmxvYXQuZmxvYXRUb0ludEJpdHMgPSBmdW5jdGlvbiAoZikgewoJICAgICAgICByZXR1cm4gZjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFRoZSBmbG9hdCBtYXggdmFsdWUgaW4gSlMgaXMgdGhlIG51bWJlciBtYXggdmFsdWUuCgkgICAgICovCgkgICAgRmxvYXQuTUFYX1ZBTFVFID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgcmV0dXJuIEZsb2F0OwoJfSgpKTsKCUZsb2F0JDEuZGVmYXVsdCA9IEZsb2F0OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdWx0UG9pbnQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCXZhciBNYXRoVXRpbHNfMSQxID0gTWF0aFV0aWxzJDE7Cgl2YXIgRmxvYXRfMSA9IEZsb2F0JDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHBvaW50IG9mIGludGVyZXN0IGluIGFuIGltYWdlIGNvbnRhaW5pbmcgYSBiYXJjb2RlLiBUeXBpY2FsbHksIHRoaXMKCSAqIHdvdWxkIGJlIHRoZSBsb2NhdGlvbiBvZiBhIGZpbmRlciBwYXR0ZXJuIG9yIHRoZSBjb3JuZXIgb2YgdGhlIGJhcmNvZGUsIGZvciBleGFtcGxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0UG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUmVzdWx0UG9pbnQoeCwgeSkgewoJICAgICAgICB0aGlzLnggPSB4OwoJICAgICAgICB0aGlzLnkgPSB5OwoJICAgIH0KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMueDsKCSAgICB9OwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy55OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVzdWx0UG9pbnQpIHsKCSAgICAgICAgICAgIHZhciBvdGhlclBvaW50ID0gb3RoZXI7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy54ID09PSBvdGhlclBvaW50LnggJiYgdGhpcy55ID09PSBvdGhlclBvaW50Lnk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogRmxvYXRfMS5kZWZhdWx0LmZsb2F0VG9JbnRCaXRzKHRoaXMueCkgKyBGbG9hdF8xLmRlZmF1bHQuZmxvYXRUb0ludEJpdHModGhpcy55KTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiAnKCcgKyB0aGlzLnggKyAnLCcgKyB0aGlzLnkgKyAnKSc7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBPcmRlcnMgYW4gYXJyYXkgb2YgdGhyZWUgUmVzdWx0UG9pbnRzIGluIGFuIG9yZGVyIFtBLEIsQ10gc3VjaCB0aGF0IEFCIGlzIGxlc3MgdGhhbiBBQwoJICAgICAqIGFuZCBCQyBpcyBsZXNzIHRoYW4gQUMsIGFuZCB0aGUgYW5nbGUgYmV0d2VlbiBCQyBhbmQgQkEgaXMgbGVzcyB0aGFuIDE4MCBkZWdyZWVzLgoJICAgICAqCgkgICAgICogQHBhcmFtIHBhdHRlcm5zIGFycmF5IG9mIHRocmVlIHtAY29kZSBSZXN1bHRQb2ludH0gdG8gb3JkZXIKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5vcmRlckJlc3RQYXR0ZXJucyA9IGZ1bmN0aW9uIChwYXR0ZXJucykgewoJICAgICAgICAvLyBGaW5kIGRpc3RhbmNlcyBiZXR3ZWVuIHBhdHRlcm4gY2VudGVycwoJICAgICAgICB2YXIgemVyb09uZURpc3RhbmNlID0gdGhpcy5kaXN0YW5jZShwYXR0ZXJuc1swXSwgcGF0dGVybnNbMV0pOwoJICAgICAgICB2YXIgb25lVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzFdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciB6ZXJvVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzBdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciBwb2ludEE7CgkgICAgICAgIHZhciBwb2ludEI7CgkgICAgICAgIHZhciBwb2ludEM7CgkgICAgICAgIC8vIEFzc3VtZSBvbmUgY2xvc2VzdCB0byBvdGhlciB0d28gaXMgQjsgQSBhbmQgQyB3aWxsIGp1c3QgYmUgZ3Vlc3NlcyBhdCBmaXJzdAoJICAgICAgICBpZiAob25lVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlICYmIG9uZVR3b0Rpc3RhbmNlID49IHplcm9Ud29EaXN0YW5jZSkgewoJICAgICAgICAgICAgcG9pbnRCID0gcGF0dGVybnNbMF07CgkgICAgICAgICAgICBwb2ludEEgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QyA9IHBhdHRlcm5zWzJdOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHplcm9Ud29EaXN0YW5jZSA+PSBvbmVUd29EaXN0YW5jZSAmJiB6ZXJvVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlKSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMl07CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1syXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMV07CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIGNyb3NzIHByb2R1Y3QgdG8gZmlndXJlIG91dCB3aGV0aGVyIEEgYW5kIEMgYXJlIGNvcnJlY3Qgb3IgZmxpcHBlZC4KCSAgICAgICAgLy8gVGhpcyBhc2tzIHdoZXRoZXIgQkMgeCBCQSBoYXMgYSBwb3NpdGl2ZSB6IGNvbXBvbmVudCwgd2hpY2ggaXMgdGhlIGFycmFuZ2VtZW50CgkgICAgICAgIC8vIHdlIHdhbnQgZm9yIEEsIEIsIEMuIElmIGl0J3MgbmVnYXRpdmUsIHRoZW4gd2UndmUgZ290IGl0IGZsaXBwZWQgYXJvdW5kIGFuZAoJICAgICAgICAvLyBzaG91bGQgc3dhcCBBIGFuZCBDLgoJICAgICAgICBpZiAodGhpcy5jcm9zc1Byb2R1Y3RaKHBvaW50QSwgcG9pbnRCLCBwb2ludEMpIDwgMC4wKSB7CgkgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50QTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBvaW50QzsKCSAgICAgICAgICAgIHBvaW50QyA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgcGF0dGVybnNbMF0gPSBwb2ludEE7CgkgICAgICAgIHBhdHRlcm5zWzFdID0gcG9pbnRCOwoJICAgICAgICBwYXR0ZXJuc1syXSA9IHBvaW50QzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBwYXR0ZXJuMSBmaXJzdCBwYXR0ZXJuCgkgICAgICogQHBhcmFtIHBhdHRlcm4yIHNlY29uZCBwYXR0ZXJuCgkgICAgICogQHJldHVybiBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHMKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5kaXN0YW5jZSA9IGZ1bmN0aW9uIChwYXR0ZXJuMSwgcGF0dGVybjIpIHsKCSAgICAgICAgcmV0dXJuIE1hdGhVdGlsc18xJDEuZGVmYXVsdC5kaXN0YW5jZShwYXR0ZXJuMS54LCBwYXR0ZXJuMS55LCBwYXR0ZXJuMi54LCBwYXR0ZXJuMi55KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHogY29tcG9uZW50IG9mIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdmVjdG9ycyBCQyBhbmQgQkEuCgkgICAgICovCgkgICAgUmVzdWx0UG9pbnQuY3Jvc3NQcm9kdWN0WiA9IGZ1bmN0aW9uIChwb2ludEEsIHBvaW50QiwgcG9pbnRDKSB7CgkgICAgICAgIHZhciBiWCA9IHBvaW50Qi54OwoJICAgICAgICB2YXIgYlkgPSBwb2ludEIueTsKCSAgICAgICAgcmV0dXJuICgocG9pbnRDLnggLSBiWCkgKiAocG9pbnRBLnkgLSBiWSkpIC0gKChwb2ludEMueSAtIGJZKSAqIChwb2ludEEueCAtIGJYKSk7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0UG9pbnQ7Cgl9KCkpOwoJUmVzdWx0UG9pbnQkMS5kZWZhdWx0ID0gUmVzdWx0UG9pbnQ7CgoJdmFyIEFsaWdubWVudFBhdHRlcm5GaW5kZXIkMSA9IHt9OwoKCXZhciBBbGlnbm1lbnRQYXR0ZXJuJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyQxID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFsaWdubWVudFBhdHRlcm4kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgUmVzdWx0UG9pbnRfMSQzID0gUmVzdWx0UG9pbnQkMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGFuIGFsaWdubWVudCBwYXR0ZXJuLCB3aGljaCBhcmUgdGhlIHNtYWxsZXIgc3F1YXJlIHBhdHRlcm5zIGZvdW5kIGluCgkgKiBhbGwgYnV0IHRoZSBzaW1wbGVzdCBRUiBDb2Rlcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEFsaWdubWVudFBhdHRlcm4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDEoQWxpZ25tZW50UGF0dGVybiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZXJtaW5lcyBpZiB0aGlzIGFsaWdubWVudCBwYXR0ZXJuICJhYm91dCBlcXVhbHMiIGFuIGFsaWdubWVudCBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhbiBhdmVyYWdlIG9mIHRoZSB0d28uCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybi5wcm90b3R5cGUuY29tYmluZUVzdGltYXRlID0gZnVuY3Rpb24gKGkgLypmbG9hdCovLCBqIC8qZmxvYXQqLywgbmV3TW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIGNvbWJpbmVkWCA9ICh0aGlzLmdldFgoKSArIGopIC8gMi4wOwoJICAgICAgICB2YXIgY29tYmluZWRZID0gKHRoaXMuZ2V0WSgpICsgaSkgLyAyLjA7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplICsgbmV3TW9kdWxlU2l6ZSkgLyAyLjA7CgkgICAgICAgIHJldHVybiBuZXcgQWxpZ25tZW50UGF0dGVybihjb21iaW5lZFgsIGNvbWJpbmVkWSwgY29tYmluZWRNb2R1bGVTaXplKTsKCSAgICB9OwoJICAgIHJldHVybiBBbGlnbm1lbnRQYXR0ZXJuOwoJfShSZXN1bHRQb2ludF8xJDMuZGVmYXVsdCkpOwoJQWxpZ25tZW50UGF0dGVybiQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX192YWx1ZXMkMSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuXzEgPSBBbGlnbm1lbnRQYXR0ZXJuJDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQzID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBhbGlnbm1lbnQgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBBbGlnbm1lbnQgcGF0dGVybnMgbG9vayBsaWtlIGZpbmRlcgoJICogcGF0dGVybnMgYnV0IGFyZSBzbWFsbGVyIGFuZCBhcHBlYXIgYXQgcmVndWxhciBpbnRlcnZhbHMgdGhyb3VnaG91dCB0aGUgaW1hZ2UuPC9wPgoJICoKCSAqIDxwPkF0IHRoZSBtb21lbnQgdGhpcyBvbmx5IGxvb2tzIGZvciB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAqCgkgKiA8cD5UaGlzIGlzIG1vc3RseSBhIHNpbXBsaWZpZWQgY29weSBvZiB7QGxpbmsgRmluZGVyUGF0dGVybkZpbmRlcn0uIEl0IGlzIGNvcGllZCwKCSAqIHBhc3RlZCBhbmQgc3RyaXBwZWQgZG93biBoZXJlIGZvciBtYXhpbXVtIHBlcmZvcm1hbmNlIGJ1dCBkb2VzIHVuZm9ydHVuYXRlbHkgZHVwbGljYXRlCgkgKiBzb21lIGNvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8qKgoJICAgICAqIDxwPkNyZWF0ZXMgYSBmaW5kZXIgdGhhdCB3aWxsIGxvb2sgaW4gYSBwb3J0aW9uIG9mIHRoZSB3aG9sZSBpbWFnZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gaW1hZ2UgaW1hZ2UgdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIHN0YXJ0WCBsZWZ0IGNvbHVtbiBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSBzdGFydFkgdG9wIHJvdyBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSB3aWR0aCB3aWR0aCBvZiByZWdpb24gdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIGhlaWdodCBoZWlnaHQgb2YgcmVnaW9uIHRvIHNlYXJjaAoJICAgICAqIEBwYXJhbSBtb2R1bGVTaXplIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBzbyBmYXIKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyKGltYWdlLCBzdGFydFggLyppbnQqLywgc3RhcnRZIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBtb2R1bGVTaXplIC8qZmxvYXQqLywgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMuc3RhcnRYID0gc3RhcnRYOwoJICAgICAgICB0aGlzLnN0YXJ0WSA9IHN0YXJ0WTsKCSAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwoJICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgdGhpcy5tb2R1bGVTaXplID0gbW9kdWxlU2l6ZTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICAgICAgdGhpcy5wb3NzaWJsZUNlbnRlcnMgPSBbXTsgLy8gbmV3IEFycmF5PGFueT4oNSkpCgkgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBhcnJheSBpbml0aWFsaXphdGlvbiB3aXRob3V0IHNpemUgYXMgdGhlIGxlbmd0aCBpcyBjaGVja2VkIGJlbG93CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSgzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+VGhpcyBtZXRob2QgYXR0ZW1wdHMgdG8gZmluZCB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuIGluIHRoZSBpbWFnZS4gSXQgaXMgYSBiaXQgbWVzc3kgc2luY2UKCSAgICAgKiBpdCdzIHByZXR0eSBwZXJmb3JtYW5jZS1jcml0aWNhbCBhbmQgc28gaXMgd3JpdHRlbiB0byBiZSBmYXN0IGZvcmVtb3N0LjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBub3QgZm91bmQKCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgc3RhcnRYID0gdGhpcy5zdGFydFg7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodDsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIG1heEogPSBzdGFydFggKyB3aWR0aDsKCSAgICAgICAgdmFyIG1pZGRsZUkgPSB0aGlzLnN0YXJ0WSArIChoZWlnaHQgLyAyKTsKCSAgICAgICAgLy8gV2UgYXJlIGxvb2tpbmcgZm9yIGJsYWNrL3doaXRlL2JsYWNrIG1vZHVsZXMgaW4gMToxOjEgcmF0aW8KCSAgICAgICAgLy8gdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIHNlZW4gc28gZmFyCgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoMyk7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIGZvciAodmFyIGlHZW4gPSAwOyBpR2VuIDwgaGVpZ2h0OyBpR2VuKyspIHsKCSAgICAgICAgICAgIC8vIFNlYXJjaCBmcm9tIG1pZGRsZSBvdXR3YXJkcwoJICAgICAgICAgICAgdmFyIGkgPSBtaWRkbGVJICsgKChpR2VuICYgMHgwMSkgPT09IDAgPyBNYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSA6IC1NYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSk7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICB2YXIgaiA9IHN0YXJ0WDsKCSAgICAgICAgICAgIC8vIEJ1cm4gb2ZmIGxlYWRpbmcgd2hpdGUgcGl4ZWxzIGJlZm9yZSBhbnl0aGluZyBlbHNlOyBpZiB3ZSBzdGFydCBpbiB0aGUgbWlkZGxlIG9mCgkgICAgICAgICAgICAvLyBhIHdoaXRlIHJ1biwgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGNvdW50IGl0cyBsZW5ndGgsIHNpbmNlIHdlIGRvbid0IGtub3cgaWYgdGhlCgkgICAgICAgICAgICAvLyB3aGl0ZSBydW4gY29udGludWVkIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBwb2ludAoJICAgICAgICAgICAgd2hpbGUgKGogPCBtYXhKICYmICFpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gMDsKCSAgICAgICAgICAgIHdoaWxlIChqIDwgbWF4SikgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMV0rKzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gQ291bnRpbmcgd2hpdGUgcGl4ZWxzCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YXRlID09PSAyKSB7IC8vIEEgd2lubmVyPwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvdW5kUGF0dGVybkNyb3NzKHN0YXRlQ291bnQpKSB7IC8vIFllcwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBqKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gc3RhdGVDb3VudFsyXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gMTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsrK2N1cnJlbnRTdGF0ZV0rKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodGhpcy5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSkgewoJICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIG1heEopOwoJICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQgIT09IG51bGwpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBub3RoaW5nIHdlIHNhdyB3YXMgb2JzZXJ2ZWQgYW5kIGNvbmZpcm1lZCB0d2ljZS4gSWYgd2UgaGFkCgkgICAgICAgIC8vIGFueSBndWVzcyBhdCBhbGwsIHJldHVybiBpdC4KCSAgICAgICAgaWYgKHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aCAhPT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zc2libGVDZW50ZXJzWzBdOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogR2l2ZW4gYSBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCBzZWVuIGFuZCBhbiBlbmQgcG9zaXRpb24sCgkgICAgICogZmlndXJlcyB0aGUgbG9jYXRpb24gb2YgdGhlIGNlbnRlciBvZiB0aGlzIGJsYWNrL3doaXRlL2JsYWNrIHJ1bi4KCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCwgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIChlbmQgLSBzdGF0ZUNvdW50WzJdKSAtIHN0YXRlQ291bnRbMV0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8xIHJhdGlvcwoJICAgICAqICAgICAgICAgdXNlZCBieSBhbGlnbm1lbnQgcGF0dGVybnMgdG8gYmUgY29uc2lkZXJlZCBhIG1hdGNoCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMubW9kdWxlU2l6ZTsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFtpXSkgPj0gbWF4VmFyaWFuY2UpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5BZnRlciBhIGhvcml6b250YWwgc2NhbiBmaW5kcyBhIHBvdGVudGlhbCBhbGlnbm1lbnQgcGF0dGVybiwgdGhpcyBtZXRob2QKCSAgICAgKiAiY3Jvc3MtY2hlY2tzIiBieSBzY2FubmluZyBkb3duIHZlcnRpY2FsbHkgdGhyb3VnaCB0aGUgY2VudGVyIG9mIHRoZSBwb3NzaWJsZQoJICAgICAqIGFsaWdubWVudCBwYXR0ZXJuIHRvIHNlZSBpZiB0aGUgc2FtZSBwcm9wb3J0aW9uIGlzIGRldGVjdGVkLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydEkgcm93IHdoZXJlIGFuIGFsaWdubWVudCBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYW4gYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBhbGlnbm1lbnQgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAvLyBTdGFydCBjb3VudGluZyB1cCBmcm9tIGNlbnRlcgoJICAgICAgICB2YXIgaSA9IHN0YXJ0STsKCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbMF0gPD0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMF0rKzsKCSAgICAgICAgICAgIGktLTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFswXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIC8vIE5vdyBhbHNvIGNvdW50IGRvd24gZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IHN0YXJ0SSArIDE7CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbMV0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA8IG1heEkgJiYgIWltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzJdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzJdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMl0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSAyICogb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkgPyBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaSkgOiBOYU47CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5UaGlzIGlzIGNhbGxlZCB3aGVuIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4uIEl0IHdpbGwKCSAgICAgKiBjcm9zcyBjaGVjayB3aXRoIGEgdmVydGljYWwgc2NhbiwgYW5kIGlmIHN1Y2Nlc3NmdWwsIHdpbGwgc2VlIGlmIHRoaXMgcGF0dGVybiBoYWQgYmVlbgoJICAgICAqIGZvdW5kIG9uIGEgcHJldmlvdXMgaG9yaXpvbnRhbCBzY2FuLiBJZiBzbywgd2UgY29uc2lkZXIgaXQgY29uZmlybWVkIGFuZCBjb25jbHVkZSB3ZSBoYXZlCgkgICAgICogZm91bmQgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGF0ZUNvdW50IHJlYWRpbmcgc3RhdGUgbW9kdWxlIGNvdW50cyBmcm9tIGhvcml6b250YWwgc2NhbgoJICAgICAqIEBwYXJhbSBpIHJvdyB3aGVyZSBhbGlnbm1lbnQgcGF0dGVybiBtYXkgYmUgZm91bmQKCSAgICAgKiBAcGFyYW0gaiBlbmQgb2YgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4gaW4gcm93CgkgICAgICogQHJldHVybiB7QGxpbmsgQWxpZ25tZW50UGF0dGVybn0gaWYgd2UgaGF2ZSBmb3VuZCB0aGUgc2FtZSBwYXR0ZXJuIHR3aWNlLCBvciBudWxsIGlmIG5vdAoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmhhbmRsZVBvc3NpYmxlQ2VudGVyID0gZnVuY3Rpb24gKHN0YXRlQ291bnQsIGkgLyppbnQqLywgaiAvKmludCovKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICB2YXIgY2VudGVySiA9IEFsaWdubWVudFBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKTsKCSAgICAgICAgdmFyIGNlbnRlckkgPSB0aGlzLmNyb3NzQ2hlY2tWZXJ0aWNhbChpLCAvKihpbnQpICovIGNlbnRlckosIDIgKiBzdGF0ZUNvdW50WzFdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IChzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0pIC8gMy4wOwoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzJDEodGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICAgICAgLy8gTG9vayBmb3IgYWJvdXQgdGhlIHNhbWUgY2VudGVyIGFuZCBtb2R1bGUgc2l6ZToKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5hYm91dEVxdWFscyhlc3RpbWF0ZWRNb2R1bGVTaXplLCBjZW50ZXJJLCBjZW50ZXJKKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbnRlci5jb21iaW5lRXN0aW1hdGUoY2VudGVySSwgY2VudGVySiwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBIYWRuJ3QgZm91bmQgdGhpcyBiZWZvcmU7IHNhdmUgaXQKCSAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBBbGlnbm1lbnRQYXR0ZXJuXzEuZGVmYXVsdChjZW50ZXJKLCBjZW50ZXJJLCBlc3RpbWF0ZWRNb2R1bGVTaXplKTsKCSAgICAgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzLnB1c2gocG9pbnQpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjay5mb3VuZFBvc3NpYmxlUmVzdWx0UG9pbnQocG9pbnQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIEFsaWdubWVudFBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJQWxpZ25tZW50UGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyOwoKCXZhciBGaW5kZXJQYXR0ZXJuRmluZGVyJDEgPSB7fTsKCgl2YXIgRmluZGVyUGF0dGVybiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRmluZGVyUGF0dGVybiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZXRlY3RvciB7Ki8KCXZhciBSZXN1bHRQb2ludF8xJDIgPSBSZXN1bHRQb2ludCQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBmaW5kZXIgcGF0dGVybiwgd2hpY2ggYXJlIHRoZSB0aHJlZSBzcXVhcmUgcGF0dGVybnMgZm91bmQgaW4KCSAqIHRoZSBjb3JuZXJzIG9mIFFSIENvZGVzLiBJdCBhbHNvIGVuY2Fwc3VsYXRlcyBhIGNvdW50IG9mIHNpbWlsYXIgZmluZGVyIHBhdHRlcm5zLAoJICogYXMgYSBjb252ZW5pZW5jZSB0byB0aGUgZmluZGVyJ3MgYm9va2tlZXBpbmcuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBGaW5kZXJQYXR0ZXJuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyhGaW5kZXJQYXR0ZXJuLCBfc3VwZXIpOwoJICAgIC8vIEZpbmRlclBhdHRlcm4ocG9zWDogbnVtYmVyLypmbG9hdCovLCBwb3NZOiBudW1iZXIvKmZsb2F0Ki8sIGVzdGltYXRlZE1vZHVsZVNpemU6IG51bWJlci8qZmxvYXQqLykgewoJICAgIC8vICAgdGhpcyhwb3NYLCBwb3NZLCBlc3RpbWF0ZWRNb2R1bGVTaXplLCAxKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBGaW5kZXJQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8sIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIF90aGlzLmNvdW50ID0gY291bnQ7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNvdW50KSB7CgkgICAgICAgICAgICBfdGhpcy5jb3VudCA9IDE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybi5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvdW50OwoJICAgIH07CgkgICAgLyoKCSAgICB2b2lkIGluY3JlbWVudENvdW50KCkgewoJICAgICAgdGhpcy5jb3VudCsrCgkgICAgfQoJICAgICAqLwoJICAgIC8qKgoJICAgICAqIDxwPkRldGVybWluZXMgaWYgdGhpcyBmaW5kZXIgcGF0dGVybiAiYWJvdXQgZXF1YWxzIiBhIGZpbmRlciBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhIHdlaWdodGVkIGF2ZXJhZ2UKCSAgICAgKiBiYXNlZCBvbiBjb3VudC4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5jb21iaW5lRXN0aW1hdGUgPSBmdW5jdGlvbiAoaSAvKmZsb2F0Ki8sIGogLypmbG9hdCovLCBuZXdNb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgY29tYmluZWRDb3VudCA9IHRoaXMuY291bnQgKyAxOwoJICAgICAgICB2YXIgY29tYmluZWRYID0gKHRoaXMuY291bnQgKiB0aGlzLmdldFgoKSArIGopIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgdmFyIGNvbWJpbmVkWSA9ICh0aGlzLmNvdW50ICogdGhpcy5nZXRZKCkgKyBpKSAvIGNvbWJpbmVkQ291bnQ7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5jb3VudCAqIHRoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSArIG5ld01vZHVsZVNpemUpIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgcmV0dXJuIG5ldyBGaW5kZXJQYXR0ZXJuKGNvbWJpbmVkWCwgY29tYmluZWRZLCBjb21iaW5lZE1vZHVsZVNpemUsIGNvbWJpbmVkQ291bnQpOwoJICAgIH07CgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm47Cgl9KFJlc3VsdFBvaW50XzEkMi5kZWZhdWx0KSk7CglGaW5kZXJQYXR0ZXJuJDEuZGVmYXVsdCA9IEZpbmRlclBhdHRlcm47CgoJdmFyIEZpbmRlclBhdHRlcm5JbmZvJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5JbmZvJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGluZm9ybWF0aW9uIGFib3V0IGZpbmRlciBwYXR0ZXJucyBpbiBhbiBpbWFnZSwgaW5jbHVkaW5nIHRoZSBsb2NhdGlvbiBvZgoJICogdGhlIHRocmVlIGZpbmRlciBwYXR0ZXJucywgYW5kIHRoZWlyIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZpbmRlclBhdHRlcm5JbmZvKHBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHRoaXMuYm90dG9tTGVmdCA9IHBhdHRlcm5DZW50ZXJzWzBdOwoJICAgICAgICB0aGlzLnRvcExlZnQgPSBwYXR0ZXJuQ2VudGVyc1sxXTsKCSAgICAgICAgdGhpcy50b3BSaWdodCA9IHBhdHRlcm5DZW50ZXJzWzJdOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuSW5mby5wcm90b3R5cGUuZ2V0Qm90dG9tTGVmdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tTGVmdDsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5JbmZvLnByb3RvdHlwZS5nZXRUb3BMZWZ0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BMZWZ0OwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkluZm8ucHJvdG90eXBlLmdldFRvcFJpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BSaWdodDsKCSAgICB9OwoJICAgIHJldHVybiBGaW5kZXJQYXR0ZXJuSW5mbzsKCX0oKSk7CglGaW5kZXJQYXR0ZXJuSW5mbyQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuSW5mbzsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5GaW5kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQyID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBSZXN1bHRQb2ludF8xJDEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIEZpbmRlclBhdHRlcm5fMSA9IEZpbmRlclBhdHRlcm4kMTsKCXZhciBGaW5kZXJQYXR0ZXJuSW5mb18xID0gRmluZGVyUGF0dGVybkluZm8kMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDIgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBmaW5kZXIgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBGaW5kZXIgcGF0dGVybnMgYXJlIHRoZSBzcXVhcmUKCSAqIG1hcmtlcnMgYXQgdGhyZWUgY29ybmVycyBvZiBhIFFSIENvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5GaW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogPHA+Q3JlYXRlcyBhIGZpbmRlciB0aGF0IHdpbGwgc2VhcmNoIHRoZSBpbWFnZSBmb3IgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBpbWFnZSBpbWFnZSB0byBzZWFyY2gKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2U6IEJpdE1hdHJpeCkgewoJICAgIC8vICAgdGhpcyhpbWFnZSwgbnVsbCkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRmluZGVyUGF0dGVybkZpbmRlcihpbWFnZSwgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayA9IHJlc3VsdFBvaW50Q2FsbGJhY2s7CgkgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzID0gW107CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSg1KTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICB9CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmltYWdlOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0UG9zc2libGVDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKGhpbnRzKSB7CgkgICAgICAgIHZhciB0cnlIYXJkZXIgPSAoaGludHMgIT09IG51bGwgJiYgaGludHMgIT09IHVuZGVmaW5lZCkgJiYgdW5kZWZpbmVkICE9PSBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQyLmRlZmF1bHQuVFJZX0hBUkRFUik7CgkgICAgICAgIHZhciBwdXJlQmFyY29kZSA9IChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkKSAmJiB1bmRlZmluZWQgIT09IGhpbnRzLmdldChEZWNvZGVIaW50VHlwZV8xJDIuZGVmYXVsdC5QVVJFX0JBUkNPREUpOwoJICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlOwoJICAgICAgICB2YXIgbWF4SSA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgbWF4SiA9IGltYWdlLmdldFdpZHRoKCk7CgkgICAgICAgIC8vIFdlIGFyZSBsb29raW5nIGZvciBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIGluCgkgICAgICAgIC8vIDE6MTozOjE6MSByYXRpbzsgdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBzdWNoIG1vZHVsZXMgc2VlbiBzbyBmYXIKCSAgICAgICAgLy8gTGV0J3MgYXNzdW1lIHRoYXQgdGhlIG1heGltdW0gdmVyc2lvbiBRUiBDb2RlIHdlIHN1cHBvcnQgdGFrZXMgdXAgMS80IHRoZSBoZWlnaHQgb2YgdGhlCgkgICAgICAgIC8vIGltYWdlLCBhbmQgdGhlbiBhY2NvdW50IGZvciB0aGUgY2VudGVyIGJlaW5nIDMgbW9kdWxlcyBpbiBzaXplLiBUaGlzIGdpdmVzIHRoZSBzbWFsbGVzdAoJICAgICAgICAvLyBudW1iZXIgb2YgcGl4ZWxzIHRoZSBjZW50ZXIgY291bGQgYmUsIHNvIHNraXAgdGhpcyBvZnRlbi4gV2hlbiB0cnlpbmcgaGFyZGVyLCBsb29rIGZvciBhbGwKCSAgICAgICAgLy8gUVIgdmVyc2lvbnMgcmVnYXJkbGVzcyBvZiBob3cgZGVuc2UgdGhleSBhcmUuCgkgICAgICAgIHZhciBpU2tpcCA9IE1hdGguZmxvb3IoKDMgKiBtYXhJKSAvICg0ICogRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUykpOwoJICAgICAgICBpZiAoaVNraXAgPCBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQIHx8IHRyeUhhcmRlcikgewoJICAgICAgICAgICAgaVNraXAgPSBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkb25lID0gZmFsc2U7CgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoNSk7CgkgICAgICAgIGZvciAodmFyIGkgPSBpU2tpcCAtIDE7IGkgPCBtYXhJICYmICFkb25lOyBpICs9IGlTa2lwKSB7CgkgICAgICAgICAgICAvLyBHZXQgYSByb3cgb2YgYmxhY2svd2hpdGUgdmFsdWVzCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0gPSAwOwoJICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IDA7CgkgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1heEo7IGorKykgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMSkgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMCkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09IDQpIHsgLy8gQSB3aW5uZXI/CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsgLy8gWWVzCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIGosIHB1cmVCYXJjb2RlKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgZXhhbWluaW5nIGV2ZXJ5IG90aGVyIGxpbmUuIENoZWNraW5nIGVhY2ggbGluZSB0dXJuZWQgb3V0IHRvIGJlIHRvbwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZW5zaXZlIGFuZCBkaWRuJ3QgaW1wcm92ZSBwZXJmb3JtYW5jZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlTa2lwID0gMjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93U2tpcCA9IHRoaXMuZmluZFJvd1NraXAoKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93U2tpcCA+IHN0YXRlQ291bnRbMl0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCByb3dzIGJldHdlZW4gcm93IG9mIGxvd2VyIGNvbmZpcm1lZCBjZW50ZXIKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRvcCBvZiBwcmVzdW1lZCB0aGlyZCBjb25maXJtZWQgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBiYWNrIHVwIGEgYml0IHRvIGdldCBhIGZ1bGwgY2hhbmNlIG9mIGRldGVjdGluZwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCwgZW50aXJlIHdpZHRoIG9mIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGJ5IHJvd1NraXAsIGJ1dCBiYWNrIG9mZiBieSBzdGF0ZUNvdW50WzJdIChzaXplIG9mIGxhc3QgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIHBhdHRlcm4gd2Ugc2F3KSB0byBiZSBjb25zZXJ2YXRpdmUsIGFuZCBhbHNvIGJhY2sgb2ZmIGJ5IGlTa2lwIHdoaWNoCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFib3V0IHRvIGJlIHJlLWFkZGVkCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gcm93U2tpcCAtIHN0YXRlQ291bnRbMl0gLSBpU2tpcDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG1heEogLSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IHN0YXRlQ291bnRbM107CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gc3RhdGVDb3VudFs0XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgc3RhdGUgdG8gc3RhcnQgbG9va2luZyBhZ2FpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBObywgc2hpZnQgY291bnRzIGJhY2sgYnkgdHdvCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gc3RhdGVDb3VudFszXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IHN0YXRlQ291bnRbNF07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gMzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WysrY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBtYXhKLCBwdXJlQmFyY29kZSk7CgkgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICBpU2tpcCA9IHN0YXRlQ291bnRbMF07CgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGEgdGhpcmQgb25lCgkgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBhdHRlcm5JbmZvID0gdGhpcy5zZWxlY3RCZXN0UGF0dGVybnMoKTsKCSAgICAgICAgUmVzdWx0UG9pbnRfMSQxLmRlZmF1bHQub3JkZXJCZXN0UGF0dGVybnMocGF0dGVybkluZm8pOwoJICAgICAgICByZXR1cm4gbmV3IEZpbmRlclBhdHRlcm5JbmZvXzEuZGVmYXVsdChwYXR0ZXJuSW5mbyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBHaXZlbiBhIGNvdW50IG9mIGJsYWNrL3doaXRlL2JsYWNrL3doaXRlL2JsYWNrIHBpeGVscyBqdXN0IHNlZW4gYW5kIGFuIGVuZCBwb3NpdGlvbiwKCSAgICAgKiBmaWd1cmVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2VudGVyIG9mIHRoaXMgcnVuLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZCA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBlbmQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gKGVuZCAtIHN0YXRlQ291bnRbNF0gLSBzdGF0ZUNvdW50WzNdKSAtIHN0YXRlQ291bnRbMl0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8zLzEvMSByYXRpb3MKCSAgICAgKiAgICAgICAgIHVzZWQgYnkgZmluZGVyIHBhdHRlcm5zIHRvIGJlIGNvbnNpZGVyZWQgYSBtYXRjaAoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHsKCSAgICAgICAgICAgIHZhciBjb3VudCA9IHN0YXRlQ291bnRbaV07CgkgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gY291bnQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvdGFsTW9kdWxlU2l6ZSA8IDcpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIDcuMDsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgLy8gQWxsb3cgbGVzcyB0aGFuIDUwJSB2YXJpYW5jZSBmcm9tIDEtMS0zLTEtMSBwcm9wb3J0aW9ucwoJICAgICAgICByZXR1cm4gTWF0aC5hYnMobW9kdWxlU2l6ZSAtIHN0YXRlQ291bnRbMF0pIDwgbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzFdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicygzLjAgKiBtb2R1bGVTaXplIC0gc3RhdGVDb3VudFsyXSkgPCAzICogbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzNdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFs0XSkgPCBtYXhWYXJpYW5jZTsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgY3Jvc3NDaGVja1N0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFswXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzFdID0gMDsKCSAgICAgICAgY3Jvc3NDaGVja1N0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFszXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgcmV0dXJuIGNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQWZ0ZXIgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jcm9zcy1jcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gZGlhZ29uYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnRJIHJvdyB3aGVyZSBhIGZpbmRlciBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYSBmaW5kZXIgcGF0dGVybgoJICAgICAqIEBwYXJhbSBtYXhDb3VudCBtYXhpbXVtIHJlYXNvbmFibGUgbnVtYmVyIG9mIG1vZHVsZXMgdGhhdCBzaG91bGQgYmUKCSAgICAgKiAgb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcGFyYW0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgVGhlIG9yaWdpbmFsIHN0YXRlIGNvdW50IHRvdGFsLgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBwcm9wb3J0aW9ucyBhcmUgd2l0aGluZyBleHBlY3RlZCBsaW1pdHMKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrRGlhZ29uYWwgPSBmdW5jdGlvbiAoc3RhcnRJIC8qaW50Ki8sIGNlbnRlckogLyppbnQqLywgbWF4Q291bnQgLyppbnQqLywgb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgLyppbnQqLykgewoJICAgICAgICB2YXIgc3RhdGVDb3VudCA9IHRoaXMuZ2V0Q3Jvc3NDaGVja1N0YXRlQ291bnQoKTsKCSAgICAgICAgLy8gU3RhcnQgY291bnRpbmcgdXAsIGxlZnQgZnJvbSBjZW50ZXIgZmluZGluZyBibGFjayBjZW50ZXIgbWFzcwoJICAgICAgICB2YXIgaSA9IDA7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHdoaWxlIChzdGFydEkgPj0gaSAmJiBjZW50ZXJKID49IGkgJiYgaW1hZ2UuZ2V0KGNlbnRlckogLSBpLCBzdGFydEkgLSBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgPCBpIHx8IGNlbnRlckogPCBpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyB3aGl0ZSBzcGFjZQoJICAgICAgICB3aGlsZSAoc3RhcnRJID49IGkgJiYgY2VudGVySiA+PSBpICYmICFpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgYWxyZWFkeSB0b28gbWFueSBtb2R1bGVzIGluIHRoaXMgc3RhdGUgb3IgcmFuIG9mZiB0aGUgZWRnZToKCSAgICAgICAgaWYgKHN0YXJ0SSA8IGkgfHwgY2VudGVySiA8IGkgfHwgc3RhdGVDb3VudFsxXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyBibGFjayBib3JkZXIKCSAgICAgICAgd2hpbGUgKHN0YXJ0SSA+PSBpICYmIGNlbnRlckogPj0gaSAmJiBpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMF0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtYXhJID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biwgcmlnaHQgZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IDE7CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgaW1hZ2UuZ2V0KGNlbnRlckogKyBpLCBzdGFydEkgKyBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJhbiBvZmYgdGhlIGVkZ2U/CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgIWltYWdlLmdldChjZW50ZXJKICsgaSwgc3RhcnRJICsgaSkgJiYKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKHN0YXJ0SSArIGkgPCBtYXhJICYmIGNlbnRlckogKyBpIDwgbWF4SiAmJiBpbWFnZS5nZXQoY2VudGVySiArIGksIHN0YXJ0SSArIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGZvdW5kIGEgZmluZGVyLXBhdHRlcm4tbGlrZSBzZWN0aW9uLCBidXQgaXRzIHNpemUgaXMgbW9yZSB0aGFuIDEwMCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgcmV0dXJuIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA8IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAmJgoJICAgICAgICAgICAgRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkFmdGVyIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gdmVydGljYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXJ0SSByb3cgd2hlcmUgYSBmaW5kZXIgcGF0dGVybiB3YXMgZGV0ZWN0ZWQKCSAgICAgKiBAcGFyYW0gY2VudGVySiBjZW50ZXIgb2YgdGhlIHNlY3Rpb24gdGhhdCBhcHBlYXJzIHRvIGNyb3NzIGEgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIC8vIFN0YXJ0IGNvdW50aW5nIHVwIGZyb20gY2VudGVyCgkgICAgICAgIHZhciBpID0gc3RhcnRJOwoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biBmcm9tIGNlbnRlcgoJICAgICAgICBpID0gc3RhcnRJICsgMTsKCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJKSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbM10gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB3ZSBmb3VuZCBhIGZpbmRlci1wYXR0ZXJuLWxpa2Ugc2VjdGlvbiwgYnV0IGl0cyBzaXplIGlzIG1vcmUgdGhhbiA0MCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF07CgkgICAgICAgIGlmICg1ICogTWF0aC5hYnMoc3RhdGVDb3VudFRvdGFsIC0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpID49IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBpKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkxpa2Uge0BsaW5rICNjcm9zc0NoZWNrVmVydGljYWwoaW50LCBpbnQsIGludCwgaW50KX0sIGFuZCBpbiBmYWN0IGlzIGJhc2ljYWxseSBpZGVudGljYWwsCgkgICAgICogZXhjZXB0IGl0IHJlYWRzIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHZlcnRpY2FsbHkuIFRoaXMgaXMgdXNlZCB0byBjcm9zcy1jcm9zcwoJICAgICAqIGNoZWNrIGEgdmVydGljYWwgY3Jvc3MgY2hlY2sgYW5kIGxvY2F0ZSB0aGUgcmVhbCBjZW50ZXIgb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzdGFydEogLyppbnQqLywgY2VudGVySSAvKmludCovLCBtYXhDb3VudCAvKmludCovLCBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAvKmludCovKSB7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIHZhciBqID0gc3RhcnRKOwoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmIGltYWdlLmdldChqLCBjZW50ZXJJKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmICFpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgaiA9IHN0YXJ0SiArIDE7CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMl0rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA8IG1heEogJiYgIWltYWdlLmdldChqLCBjZW50ZXJJKSAmJiBzdGF0ZUNvdW50WzNdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFs0XSA8IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdKys7CgkgICAgICAgICAgICBqKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbNF0gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgd2UgZm91bmQgYSBmaW5kZXItcGF0dGVybi1saWtlIHNlY3Rpb24sIGJ1dCBpdHMgc2l6ZSBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCB0aGFuCgkgICAgICAgIC8vIHRoZSBvcmlnaW5hbCwgYXNzdW1lIGl0J3MgYSBmYWxzZSBwb3NpdGl2ZQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdICsgc3RhdGVDb3VudFszXSArCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgaXMgY2FsbGVkIHdoZW4gYSBob3Jpem9udGFsIHNjYW4gZmluZHMgYSBwb3NzaWJsZSBhbGlnbm1lbnQgcGF0dGVybi4gSXQgd2lsbAoJICAgICAqIGNyb3NzIGNoZWNrIHdpdGggYSB2ZXJ0aWNhbCBzY2FuLCBhbmQgaWYgc3VjY2Vzc2Z1bCwgd2lsbCwgYWgsIGNyb3NzLWNyb3NzLWNoZWNrCgkgICAgICogd2l0aCBhbm90aGVyIGhvcml6b250YWwgc2Nhbi4gVGhpcyBpcyBuZWVkZWQgcHJpbWFyaWx5IHRvIGxvY2F0ZSB0aGUgcmVhbCBob3Jpem9udGFsCgkgICAgICogY2VudGVyIG9mIHRoZSBwYXR0ZXJuIGluIGNhc2VzIG9mIGV4dHJlbWUgc2tldy4KCSAgICAgKiBBbmQgdGhlbiB3ZSBjcm9zcy1jcm9zcy1jcm9zcyBjaGVjayB3aXRoIGFub3RoZXIgZGlhZ29uYWwgc2Nhbi48L3A+CgkgICAgICoKCSAgICAgKiA8cD5JZiB0aGF0IHN1Y2NlZWRzIHRoZSBmaW5kZXIgcGF0dGVybiBsb2NhdGlvbiBpcyBhZGRlZCB0byBhIGxpc3QgdGhhdCB0cmFja3MKCSAgICAgKiB0aGUgbnVtYmVyIG9mIHRpbWVzIGVhY2ggbG9jYXRpb24gaGFzIGJlZW4gbmVhcmx5LW1hdGNoZWQgYXMgYSBmaW5kZXIgcGF0dGVybi4KCSAgICAgKiBFYWNoIGFkZGl0aW9uYWwgZmluZCBpcyBtb3JlIGV2aWRlbmNlIHRoYXQgdGhlIGxvY2F0aW9uIGlzIGluIGZhY3QgYSBmaW5kZXIKCSAgICAgKiBwYXR0ZXJuIGNlbnRlcgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXRlQ291bnQgcmVhZGluZyBzdGF0ZSBtb2R1bGUgY291bnRzIGZyb20gaG9yaXpvbnRhbCBzY2FuCgkgICAgICogQHBhcmFtIGkgcm93IHdoZXJlIGZpbmRlciBwYXR0ZXJuIG1heSBiZSBmb3VuZAoJICAgICAqIEBwYXJhbSBqIGVuZCBvZiBwb3NzaWJsZSBmaW5kZXIgcGF0dGVybiBpbiByb3cKCSAgICAgKiBAcGFyYW0gcHVyZUJhcmNvZGUgdHJ1ZSBpZiBpbiAicHVyZSBiYXJjb2RlIiBtb2RlCgkgICAgICogQHJldHVybiB0cnVlIGlmIGEgZmluZGVyIHBhdHRlcm4gY2FuZGlkYXRlIHdhcyBmb3VuZCB0aGlzIHRpbWUKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYW5kbGVQb3NzaWJsZUNlbnRlciA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBpIC8qaW50Ki8sIGogLyppbnQqLywgcHVyZUJhcmNvZGUpIHsKCSAgICAgICAgdmFyIHN0YXRlQ291bnRUb3RhbCA9IHN0YXRlQ291bnRbMF0gKyBzdGF0ZUNvdW50WzFdICsgc3RhdGVDb3VudFsyXSArIHN0YXRlQ291bnRbM10gKwoJICAgICAgICAgICAgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgdmFyIGNlbnRlckogPSBGaW5kZXJQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaik7CgkgICAgICAgIHZhciBjZW50ZXJJID0gdGhpcy5jcm9zc0NoZWNrVmVydGljYWwoaSwgLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCBzdGF0ZUNvdW50WzJdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICAvLyBSZS1jcm9zcyBjaGVjawoJICAgICAgICAgICAgY2VudGVySiA9IHRoaXMuY3Jvc3NDaGVja0hvcml6b250YWwoLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCAvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIHN0YXRlQ291bnRbMl0sIHN0YXRlQ291bnRUb3RhbCk7CgkgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckopICYmCgkgICAgICAgICAgICAgICAgKCFwdXJlQmFyY29kZSB8fCB0aGlzLmNyb3NzQ2hlY2tEaWFnb25hbCgvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIC8qKGludCkgKi8gTWF0aC5mbG9vcihjZW50ZXJKKSwgc3RhdGVDb3VudFsyXSwgc3RhdGVDb3VudFRvdGFsKSkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IHN0YXRlQ291bnRUb3RhbCAvIDcuMDsKCSAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXJzID0gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGhfMSA9IHBvc3NpYmxlQ2VudGVycy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoXzE7IGluZGV4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHBvc3NpYmxlQ2VudGVyc1tpbmRleF07CgkgICAgICAgICAgICAgICAgICAgIC8vIExvb2sgZm9yIGFib3V0IHRoZSBzYW1lIGNlbnRlciBhbmQgbW9kdWxlIHNpemU6CgkgICAgICAgICAgICAgICAgICAgIGlmIChjZW50ZXIuYWJvdXRFcXVhbHMoZXN0aW1hdGVkTW9kdWxlU2l6ZSwgY2VudGVySSwgY2VudGVySikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVyc1tpbmRleF0gPSBjZW50ZXIuY29tYmluZUVzdGltYXRlKGNlbnRlckksIGNlbnRlckosIGVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgRmluZGVyUGF0dGVybl8xLmRlZmF1bHQoY2VudGVySiwgY2VudGVySSwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5wdXNoKHBvaW50KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrLmZvdW5kUG9zc2libGVSZXN1bHRQb2ludChwb2ludCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2Ygcm93cyB3ZSBjb3VsZCBzYWZlbHkgc2tpcCBkdXJpbmcgc2Nhbm5pbmcsIGJhc2VkIG9uIHRoZSBmaXJzdAoJICAgICAqICAgICAgICAgdHdvIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBsb2NhdGVkLiBJbiBzb21lIGNhc2VzIHRoZWlyIHBvc2l0aW9uIHdpbGwKCSAgICAgKiAgICAgICAgIGFsbG93IHVzIHRvIGluZmVyIHRoYXQgdGhlIHRoaXJkIHBhdHRlcm4gbXVzdCBsaWUgYmVsb3cgYSBjZXJ0YWluIHBvaW50IGZhcnRoZXIKCSAgICAgKiAgICAgICAgIGRvd24gaW4gdGhlIGltYWdlLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmZpbmRSb3dTa2lwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKG1heCA8PSAxKSB7CgkgICAgICAgICAgICByZXR1cm4gMDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBudWxsOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gX2MudmFsdWU7CgkgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDb25maXJtZWRDZW50ZXIgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBjZW50ZXI7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHR3byBjb25maXJtZWQgY2VudGVycwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93IGZhciBkb3duIGNhbiB3ZSBza2lwIGJlZm9yZSByZXN1bWluZyBsb29raW5nIGZvciB0aGUgbmV4dAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVybj8gSW4gdGhlIHdvcnN0IGNhc2UsIG9ubHkgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIHggLyB5IGNvb3JkaW5hdGVzIG9mIHRoZSB0d28gY2VudGVycy4KCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgeW91IGZpbmQgdG9wIGxlZnQgbGFzdC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU2tpcHBlZCA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLyooaW50KSAqLyBNYXRoLmZsb29yKChNYXRoLmFicyhmaXJzdENvbmZpcm1lZENlbnRlci5nZXRYKCkgLSBjZW50ZXIuZ2V0WCgpKSAtCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZmlyc3RDb25maXJtZWRDZW50ZXIuZ2V0WSgpIC0gY2VudGVyLmdldFkoKSkpIC8gMik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZmYgd2UgaGF2ZSBmb3VuZCBhdCBsZWFzdCAzIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZAoJICAgICAqICAgICAgICAgYXQgbGVhc3Qge0BsaW5rICNDRU5URVJfUVVPUlVNfSB0aW1lcyBlYWNoLCBhbmQsIHRoZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgb2YgdGhlCgkgICAgICogICAgICAgICBjYW5kaWRhdGVzIGlzICJwcmV0dHkgc2ltaWxhciIKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8yLCBfYSwgZV8zLCBfYjsKCSAgICAgICAgdmFyIGNvbmZpcm1lZENvdW50ID0gMDsKCSAgICAgICAgdmFyIHRvdGFsTW9kdWxlU2l6ZSA9IDAuMDsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZC52YWx1ZTsKCSAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBjb25maXJtZWRDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcGF0dGVybi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvbmZpcm1lZENvdW50IDwgMykgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIE9LLCB3ZSBoYXZlIGF0IGxlYXN0IDMgY29uZmlybWVkIGNlbnRlcnMsIGJ1dCwgaXQncyBwb3NzaWJsZSB0aGF0IG9uZSBpcyBhICJmYWxzZSBwb3NpdGl2ZSIKCSAgICAgICAgLy8gYW5kIHRoYXQgd2UgbmVlZCB0byBrZWVwIGxvb2tpbmcuIFdlIGRldGVjdCB0aGlzIGJ5IGFza2luZyBpZiB0aGUgZXN0aW1hdGVkIG1vZHVsZSBzaXplcwoJICAgICAgICAvLyB2YXJ5IHRvbyBtdWNoLiBXZSBhcmJpdHJhcmlseSBzYXkgdGhhdCB3aGVuIHRoZSB0b3RhbCBkZXZpYXRpb24gZnJvbSBhdmVyYWdlIGV4Y2VlZHMKCSAgICAgICAgLy8gNSUgb2YgdGhlIHRvdGFsIG1vZHVsZSBzaXplIGVzdGltYXRlcywgaXQncyB0b28gbXVjaC4KCSAgICAgICAgdmFyIGF2ZXJhZ2UgPSB0b3RhbE1vZHVsZVNpemUgLyBtYXg7CgkgICAgICAgIHZhciB0b3RhbERldmlhdGlvbiA9IDAuMDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9lID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZiA9IF9lLm5leHQoKTsgIV9mLmRvbmU7IF9mID0gX2UubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZi52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbERldmlhdGlvbiArPSBNYXRoLmFicyhwYXR0ZXJuLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2YgJiYgIV9mLmRvbmUgJiYgKF9iID0gX2UucmV0dXJuKSkgX2IuY2FsbChfZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRvdGFsRGV2aWF0aW9uIDw9IDAuMDUgKiB0b3RhbE1vZHVsZVNpemU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSAzIGJlc3Qge0BsaW5rIEZpbmRlclBhdHRlcm59cyBmcm9tIG91ciBsaXN0IG9mIGNhbmRpZGF0ZXMuIFRoZSAiYmVzdCIgYXJlCgkgICAgICogICAgICAgICB0aG9zZSB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZCBhdCBsZWFzdCB7QGxpbmsgI0NFTlRFUl9RVU9SVU19IHRpbWVzLCBhbmQgd2hvc2UgbW9kdWxlCgkgICAgICogICAgICAgICBzaXplIGRpZmZlcnMgZnJvbSB0aGUgYXZlcmFnZSBhbW9uZyB0aG9zZSBwYXR0ZXJucyB0aGUgbGVhc3QKCSAgICAgKiBAdGhyb3dzIE5vdEZvdW5kRXhjZXB0aW9uIGlmIDMgc3VjaCBmaW5kZXIgcGF0dGVybnMgZG8gbm90IGV4aXN0CgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuc2VsZWN0QmVzdFBhdHRlcm5zID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV80LCBfYSwgZV81LCBfYjsKCSAgICAgICAgdmFyIHN0YXJ0U2l6ZSA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKHN0YXJ0U2l6ZSA8IDMpIHsKCSAgICAgICAgICAgIC8vIENvdWxkbid0IGZpbmQgZW5vdWdoIGZpbmRlciBwYXR0ZXJucwoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBvc3NpYmxlQ2VudGVycyA9IHRoaXMucG9zc2libGVDZW50ZXJzOwoJICAgICAgICB2YXIgYXZlcmFnZTsKCSAgICAgICAgLy8gRmlsdGVyIG91dGxpZXIgcG9zc2liaWxpdGllcyB3aG9zZSBtb2R1bGUgc2l6ZSBpcyB0b28gZGlmZmVyZW50CgkgICAgICAgIGlmIChzdGFydFNpemUgPiAzKSB7CgkgICAgICAgICAgICAvLyBCdXQgd2UgY2FuIG9ubHkgYWZmb3JkIHRvIGRvIHNvIGlmIHdlIGhhdmUgYXQgbGVhc3QgNCBwb3NzaWJpbGl0aWVzIHRvIGNob29zZSBmcm9tCgkgICAgICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMC4wOwoJICAgICAgICAgICAgdmFyIHNxdWFyZSA9IDAuMDsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IF9kLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlbnRlci5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgICAgIHRvdGFsTW9kdWxlU2l6ZSArPSBzaXplOwoJICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gc2l6ZSAqIHNpemU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVfNF8xKSB7IGVfNCA9IHsgZXJyb3I6IGVfNF8xIH07IH0KCSAgICAgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjsgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYXZlcmFnZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIHN0YXJ0U2l6ZTsKCSAgICAgICAgICAgIHZhciBzdGREZXYgPSBNYXRoLnNxcnQoc3F1YXJlIC8gc3RhcnRTaXplIC0gYXZlcmFnZSAqIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzLnNvcnQoCgkgICAgICAgICAgICAvKioKCSAgICAgICAgICAgICAqIDxwPk9yZGVycyBieSBmdXJ0aGVzdCBmcm9tIGF2ZXJhZ2U8L3A+CgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIEZ1cnRoZXN0RnJvbUF2ZXJhZ2VDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICB2YXIgZEEgPSBNYXRoLmFicyhjZW50ZXIyLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgICAgIHZhciBkQiA9IE1hdGguYWJzKGNlbnRlcjEuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSk7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAtMSA6IGRBID4gZEIgPyAxIDogMDsKCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgdmFyIGxpbWl0ID0gTWF0aC5tYXgoMC4yICogYXZlcmFnZSwgc3RkRGV2KTsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zc2libGVDZW50ZXJzLmxlbmd0aCAmJiBwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMzsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBwb3NzaWJsZUNlbnRlcnNbaV07CgkgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHBhdHRlcm4uZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSkgPiBsaW1pdCkgewoJICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKGksIDEpOwoJICAgICAgICAgICAgICAgICAgICBpLS07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGlmIChwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMykgewoJICAgICAgICAgICAgLy8gVGhyb3cgYXdheSBhbGwgYnV0IHRob3NlIGZpcnN0IHNpemUgY2FuZGlkYXRlIHBvaW50cyB3ZSBmb3VuZC4KCSAgICAgICAgICAgIHZhciB0b3RhbE1vZHVsZVNpemUgPSAwLjA7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIHBvc3NpYmxlQ2VudGVyc18xID0gX192YWx1ZXMocG9zc2libGVDZW50ZXJzKSwgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKTsgIXBvc3NpYmxlQ2VudGVyc18xXzEuZG9uZTsgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXIgPSBwb3NzaWJsZUNlbnRlcnNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcG9zc2libGVDZW50ZXIuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9CgkgICAgICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVDZW50ZXJzXzFfMSAmJiAhcG9zc2libGVDZW50ZXJzXzFfMS5kb25lICYmIChfYiA9IHBvc3NpYmxlQ2VudGVyc18xLnJldHVybikpIF9iLmNhbGwocG9zc2libGVDZW50ZXJzXzEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhdmVyYWdlID0gdG90YWxNb2R1bGVTaXplIC8gcG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5zb3J0KAoJICAgICAgICAgICAgLyoqCgkgICAgICAgICAgICAgKiA8cD5PcmRlcnMgYnkge0BsaW5rIEZpbmRlclBhdHRlcm4jZ2V0Q291bnQoKX0sIGRlc2NlbmRpbmcuPC9wPgoJICAgICAgICAgICAgICovCgkgICAgICAgICAgICAvLyBDZW50ZXJDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICBpZiAoY2VudGVyMi5nZXRDb3VudCgpID09PSBjZW50ZXIxLmdldENvdW50KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRBID0gTWF0aC5hYnMoY2VudGVyMi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRCID0gTWF0aC5hYnMoY2VudGVyMS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAxIDogZEEgPiBkQiA/IC0xIDogMDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50ZXIyLmdldENvdW50KCkgLSBjZW50ZXIxLmdldENvdW50KCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKDMpOyAvLyB0aGlzIGlzIG5vdCByZWFseSBuZWNlc3NhcnkgYXMgd2Ugb25seSByZXR1cm4gZmlyc3QgMyBhbnl3YXkKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gWwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzBdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzFdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzJdCgkgICAgICAgIF07CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLkNFTlRFUl9RVU9SVU0gPSAyOwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuTUlOX1NLSVAgPSAzOyAvLyAxIHBpeGVsL21vZHVsZSB0aW1lcyAzIG1vZHVsZXMvY2VudGVyCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUyA9IDU3OyAvLyBzdXBwb3J0IHVwIHRvIHZlcnNpb24gMTAgZm9yIG1vYmlsZSBjbGllbnRzCgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJRmluZGVyUGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuRmluZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV0ZWN0b3IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIE1hdGhVdGlsc18xID0gTWF0aFV0aWxzJDE7Cgl2YXIgRGV0ZWN0b3JSZXN1bHRfMSA9IERldGVjdG9yUmVzdWx0JDE7CgkvLyBpbXBvcnQgR3JpZFNhbXBsZXIgZnJvbSAnLi4vLi4vY29tbW9uL0dyaWRTYW1wbGVyJzsKCXZhciBHcmlkU2FtcGxlckluc3RhbmNlXzEgPSBHcmlkU2FtcGxlckluc3RhbmNlJDE7Cgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtJDE7Cgl2YXIgRGVjb2RlSGludFR5cGVfMSQxID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdFBvaW50XzEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIFZlcnNpb25fMSA9IFZlcnNpb24kMTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyXzEgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDE7Cgl2YXIgRmluZGVyUGF0dGVybkZpbmRlcl8xID0gRmluZGVyUGF0dGVybkZpbmRlciQxOwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgbG9naWMgdGhhdCBjYW4gZGV0ZWN0IGEgUVIgQ29kZSBpbiBhbiBpbWFnZSwgZXZlbiBpZiB0aGUgUVIgQ29kZQoJICogaXMgcm90YXRlZCBvciBza2V3ZWQsIG9yIHBhcnRpYWxseSBvYnNjdXJlZC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERldGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERldGVjdG9yKGltYWdlKSB7CgkgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKCSAgICB9CgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLmdldEltYWdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTsKCSAgICB9OwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5nZXRSZXN1bHRQb2ludENhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBkZXRlY3QoKTogRGV0ZWN0b3JSZXN1bHQgLyp0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZXRlY3QobnVsbCkKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGhpbnRzIG9wdGlvbmFsIGhpbnRzIHRvIGRldGVjdG9yCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5kZXRlY3QgPSBmdW5jdGlvbiAoaGludHMpIHsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gKGhpbnRzID09PSBudWxsIHx8IGhpbnRzID09PSB1bmRlZmluZWQpID8gbnVsbCA6CgkgICAgICAgICAgICAvKihSZXN1bHRQb2ludENhbGxiYWNrKSAqLyBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQxLmRlZmF1bHQuTkVFRF9SRVNVTFRfUE9JTlRfQ0FMTEJBQ0spOwoJICAgICAgICB2YXIgZmluZGVyID0gbmV3IEZpbmRlclBhdHRlcm5GaW5kZXJfMS5kZWZhdWx0KHRoaXMuaW1hZ2UsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHZhciBpbmZvID0gZmluZGVyLmZpbmQoaGludHMpOwoJICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmluZGVyUGF0dGVybkluZm8oaW5mbyk7CgkgICAgfTsKCSAgICBEZXRlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ZpbmRlclBhdHRlcm5JbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCSAgICAgICAgdmFyIHRvcExlZnQgPSBpbmZvLmdldFRvcExlZnQoKTsKCSAgICAgICAgdmFyIHRvcFJpZ2h0ID0gaW5mby5nZXRUb3BSaWdodCgpOwoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IGluZm8uZ2V0Qm90dG9tTGVmdCgpOwoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMuY2FsY3VsYXRlTW9kdWxlU2l6ZSh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCk7CgkgICAgICAgIGlmIChtb2R1bGVTaXplIDwgMS4wKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ05vIHBhdHRlcm4gZm91bmQgaW4gcHJvY2Nlc3MgZmluZGVyLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkaW1lbnNpb24gPSBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHByb3Zpc2lvbmFsVmVyc2lvbiA9IFZlcnNpb25fMS5kZWZhdWx0LmdldFByb3Zpc2lvbmFsVmVyc2lvbkZvckRpbWVuc2lvbihkaW1lbnNpb24pOwoJICAgICAgICB2YXIgbW9kdWxlc0JldHdlZW5GUENlbnRlcnMgPSBwcm92aXNpb25hbFZlcnNpb24uZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpIC0gNzsKCSAgICAgICAgdmFyIGFsaWdubWVudFBhdHRlcm4gPSBudWxsOwoJICAgICAgICAvLyBBbnl0aGluZyBhYm92ZSB2ZXJzaW9uIDEgaGFzIGFuIGFsaWdubWVudCBwYXR0ZXJuCgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24uZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMoKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAvLyBHdWVzcyB3aGVyZSBhICJib3R0b20gcmlnaHQiIGZpbmRlciBwYXR0ZXJuIHdvdWxkIGhhdmUgYmVlbgoJICAgICAgICAgICAgdmFyIGJvdHRvbVJpZ2h0WCA9IHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpICsgYm90dG9tTGVmdC5nZXRYKCk7CgkgICAgICAgICAgICB2YXIgYm90dG9tUmlnaHRZID0gdG9wUmlnaHQuZ2V0WSgpIC0gdG9wTGVmdC5nZXRZKCkgKyBib3R0b21MZWZ0LmdldFkoKTsKCSAgICAgICAgICAgIC8vIEVzdGltYXRlIHRoYXQgYWxpZ25tZW50IHBhdHRlcm4gaXMgY2xvc2VyIGJ5IDMgbW9kdWxlcwoJICAgICAgICAgICAgLy8gZnJvbSAiYm90dG9tIHJpZ2h0IiB0byBrbm93biB0b3AgbGVmdCBsb2NhdGlvbgoJICAgICAgICAgICAgdmFyIGNvcnJlY3Rpb25Ub1RvcExlZnQgPSAxLjAgLSAzLjAgLyBtb2R1bGVzQmV0d2VlbkZQQ2VudGVyczsKCSAgICAgICAgICAgIHZhciBlc3RBbGlnbm1lbnRYID0gLyooaW50KSAqLyBNYXRoLmZsb29yKHRvcExlZnQuZ2V0WCgpICsgY29ycmVjdGlvblRvVG9wTGVmdCAqIChib3R0b21SaWdodFggLSB0b3BMZWZ0LmdldFgoKSkpOwoJICAgICAgICAgICAgdmFyIGVzdEFsaWdubWVudFkgPSAvKihpbnQpICovIE1hdGguZmxvb3IodG9wTGVmdC5nZXRZKCkgKyBjb3JyZWN0aW9uVG9Ub3BMZWZ0ICogKGJvdHRvbVJpZ2h0WSAtIHRvcExlZnQuZ2V0WSgpKSk7CgkgICAgICAgICAgICAvLyBLaW5kIG9mIGFyYml0cmFyeSAtLSBleHBhbmQgc2VhcmNoIHJhZGl1cyBiZWZvcmUgZ2l2aW5nIHVwCgkgICAgICAgICAgICBmb3IgKHZhciBpID0gNDsgaSA8PSAxNjsgaSA8PD0gMSkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudFBhdHRlcm4gPSB0aGlzLmZpbmRBbGlnbm1lbnRJblJlZ2lvbihtb2R1bGVTaXplLCBlc3RBbGlnbm1lbnRYLCBlc3RBbGlnbm1lbnRZLCBpKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhdGNoIChyZSAvKk5vdEZvdW5kRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCEocmUgaW5zdGFuY2VvZiBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHJlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIC8vIHRyeSBuZXh0IHJvdW5kCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYWxpZ25tZW50IHBhdHRlcm4uLi4gd2VsbCB0cnkgYW55d2F5IHdpdGhvdXQgaXQKCSAgICAgICAgfQoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gRGV0ZWN0b3IuY3JlYXRlVHJhbnNmb3JtKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBhbGlnbm1lbnRQYXR0ZXJuLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgYml0cyA9IERldGVjdG9yLnNhbXBsZUdyaWQodGhpcy5pbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgcG9pbnRzOwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgcG9pbnRzID0gW2JvdHRvbUxlZnQsIHRvcExlZnQsIHRvcFJpZ2h0XTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHBvaW50cyA9IFtib3R0b21MZWZ0LCB0b3BMZWZ0LCB0b3BSaWdodCwgYWxpZ25tZW50UGF0dGVybl07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBEZXRlY3RvclJlc3VsdF8xLmRlZmF1bHQoYml0cywgcG9pbnRzKTsKCSAgICB9OwoJICAgIERldGVjdG9yLmNyZWF0ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCwgYWxpZ25tZW50UGF0dGVybiwgZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGRpbU1pbnVzVGhyZWUgPSBkaW1lbnNpb24gLSAzLjU7CgkgICAgICAgIHZhciBib3R0b21SaWdodFg7IC8qZmxvYXQqLwoJICAgICAgICB2YXIgYm90dG9tUmlnaHRZOyAvKmZsb2F0Ki8KCSAgICAgICAgdmFyIHNvdXJjZUJvdHRvbVJpZ2h0WDsgLypmbG9hdCovCgkgICAgICAgIHZhciBzb3VyY2VCb3R0b21SaWdodFk7IC8qZmxvYXQqLwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiAhPT0gbnVsbCkgewoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gYWxpZ25tZW50UGF0dGVybi5nZXRYKCk7CgkgICAgICAgICAgICBib3R0b21SaWdodFkgPSBhbGlnbm1lbnRQYXR0ZXJuLmdldFkoKTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WCA9IGRpbU1pbnVzVGhyZWUgLSAzLjA7CgkgICAgICAgICAgICBzb3VyY2VCb3R0b21SaWdodFkgPSBzb3VyY2VCb3R0b21SaWdodFg7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBEb24ndCBoYXZlIGFuIGFsaWdubWVudCBwYXR0ZXJuLCBqdXN0IG1ha2UgdXAgdGhlIGJvdHRvbS1yaWdodCBwb2ludAoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gKHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpKSArIGJvdHRvbUxlZnQuZ2V0WCgpOwoJICAgICAgICAgICAgYm90dG9tUmlnaHRZID0gKHRvcFJpZ2h0LmdldFkoKSAtIHRvcExlZnQuZ2V0WSgpKSArIGJvdHRvbUxlZnQuZ2V0WSgpOwoJICAgICAgICAgICAgc291cmNlQm90dG9tUmlnaHRYID0gZGltTWludXNUaHJlZTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WSA9IGRpbU1pbnVzVGhyZWU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtXzEuZGVmYXVsdC5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsKDMuNSwgMy41LCBkaW1NaW51c1RocmVlLCAzLjUsIHNvdXJjZUJvdHRvbVJpZ2h0WCwgc291cmNlQm90dG9tUmlnaHRZLCAzLjUsIGRpbU1pbnVzVGhyZWUsIHRvcExlZnQuZ2V0WCgpLCB0b3BMZWZ0LmdldFkoKSwgdG9wUmlnaHQuZ2V0WCgpLCB0b3BSaWdodC5nZXRZKCksIGJvdHRvbVJpZ2h0WCwgYm90dG9tUmlnaHRZLCBib3R0b21MZWZ0LmdldFgoKSwgYm90dG9tTGVmdC5nZXRZKCkpOwoJICAgIH07CgkgICAgRGV0ZWN0b3Iuc2FtcGxlR3JpZCA9IGZ1bmN0aW9uIChpbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24gLyppbnQqLykgewoJICAgICAgICB2YXIgc2FtcGxlciA9IEdyaWRTYW1wbGVySW5zdGFuY2VfMS5kZWZhdWx0LmdldEluc3RhbmNlKCk7CgkgICAgICAgIHJldHVybiBzYW1wbGVyLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtKGltYWdlLCBkaW1lbnNpb24sIGRpbWVuc2lvbiwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkNvbXB1dGVzIHRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBtb2R1bGVzIG9uIGEgc2l6ZSkgb2YgdGhlIFFSIENvZGUgYmFzZWQgb24gdGhlIHBvc2l0aW9uCgkgICAgICogb2YgdGhlIGZpbmRlciBwYXR0ZXJucyBhbmQgZXN0aW1hdGVkIG1vZHVsZSBzaXplLjwvcD4KCSAgICAgKi8KCSAgICBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uID0gZnVuY3Rpb24gKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdGx0ckNlbnRlcnNEaW1lbnNpb24gPSBNYXRoVXRpbHNfMS5kZWZhdWx0LnJvdW5kKFJlc3VsdFBvaW50XzEuZGVmYXVsdC5kaXN0YW5jZSh0b3BMZWZ0LCB0b3BSaWdodCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHRsYmxDZW50ZXJzRGltZW5zaW9uID0gTWF0aFV0aWxzXzEuZGVmYXVsdC5yb3VuZChSZXN1bHRQb2ludF8xLmRlZmF1bHQuZGlzdGFuY2UodG9wTGVmdCwgYm90dG9tTGVmdCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IE1hdGguZmxvb3IoKHRsdHJDZW50ZXJzRGltZW5zaW9uICsgdGxibENlbnRlcnNEaW1lbnNpb24pIC8gMikgKyA3OwoJICAgICAgICBzd2l0Y2ggKGRpbWVuc2lvbiAmIDB4MDMpIHsgLy8gbW9kIDQKCSAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24rKzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIC8vIDE/IGRvIG5vdGhpbmcKCSAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24tLTsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ0RpbWVuc2lvbnMgY291bGQgYmUgbm90IGZvdW5kLicpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBkaW1lbnNpb247CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5Db21wdXRlcyBhbiBhdmVyYWdlIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBiYXNlZCBvbiBlc3RpbWF0ZWQgZGVyaXZlZCBmcm9tIHRoZSBwb3NpdGlvbnMKCSAgICAgKiBvZiB0aGUgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB0b3BMZWZ0IGRldGVjdGVkIHRvcC1sZWZ0IGZpbmRlciBwYXR0ZXJuIGNlbnRlcgoJICAgICAqIEBwYXJhbSB0b3BSaWdodCBkZXRlY3RlZCB0b3AtcmlnaHQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHBhcmFtIGJvdHRvbUxlZnQgZGV0ZWN0ZWQgYm90dG9tLWxlZnQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHJldHVybiBlc3RpbWF0ZWQgbW9kdWxlIHNpemUKCSAgICAgKi8KCSAgICBEZXRlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlTW9kdWxlU2l6ZSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCkgewoJICAgICAgICAvLyBUYWtlIHRoZSBhdmVyYWdlCgkgICAgICAgIHJldHVybiAodGhpcy5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5KHRvcExlZnQsIHRvcFJpZ2h0KSArCgkgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU1vZHVsZVNpemVPbmVXYXkodG9wTGVmdCwgYm90dG9tTGVmdCkpIC8gMi4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RXN0aW1hdGVzIG1vZHVsZSBzaXplIGJhc2VkIG9uIHR3byBmaW5kZXIgcGF0dGVybnMgLS0gaXQgdXNlcwoJICAgICAqIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuQm90aFdheXMoaW50LCBpbnQsIGludCwgaW50KX0gdG8gZmlndXJlIHRoZQoJICAgICAqIHdpZHRoIG9mIGVhY2gsIG1lYXN1cmluZyBhbG9uZyB0aGUgYXhpcyBiZXR3ZWVuIHRoZWlyIGNlbnRlcnMuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG90aGVyUGF0dGVybikgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZUVzdDEgPSB0aGlzLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzKC8qKGludCkgKi8gTWF0aC5mbG9vcihwYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRZKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRZKCkpKTsKCSAgICAgICAgdmFyIG1vZHVsZVNpemVFc3QyID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW5Cb3RoV2F5cygvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFkoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKHBhdHRlcm4uZ2V0WSgpKSk7CgkgICAgICAgIGlmIChpc05hTihtb2R1bGVTaXplRXN0MSkpIHsKCSAgICAgICAgICAgIHJldHVybiBtb2R1bGVTaXplRXN0MiAvIDcuMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaXNOYU4obW9kdWxlU2l6ZUVzdDIpKSB7CgkgICAgICAgICAgICByZXR1cm4gbW9kdWxlU2l6ZUVzdDEgLyA3LjA7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQXZlcmFnZSB0aGVtLCBhbmQgZGl2aWRlIGJ5IDcgc2luY2Ugd2UndmUgY291bnRlZCB0aGUgd2lkdGggb2YgMyBibGFjayBtb2R1bGVzLAoJICAgICAgICAvLyBhbmQgMSB3aGl0ZSBhbmQgMSBibGFjayBtb2R1bGUgb24gZWl0aGVyIHNpZGUuIEVyZ28sIGRpdmlkZSBzdW0gYnkgMTQuCgkgICAgICAgIHJldHVybiAobW9kdWxlU2l6ZUVzdDEgKyBtb2R1bGVTaXplRXN0MikgLyAxNC4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuKGludCwgaW50LCBpbnQsIGludCl9OyBjb21wdXRlcyB0aGUgdG90YWwgd2lkdGggb2YKCSAgICAgKiBhIGZpbmRlciBwYXR0ZXJuIGJ5IGxvb2tpbmcgZm9yIGEgYmxhY2std2hpdGUtYmxhY2sgcnVuIGZyb20gdGhlIGNlbnRlciBpbiB0aGUgZGlyZWN0aW9uCgkgICAgICogb2YgYW5vdGhlciBwb2ludCAoYW5vdGhlciBmaW5kZXIgcGF0dGVybiBjZW50ZXIpLCBhbmQgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0b28uCgkgICAgICovCgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzID0gZnVuY3Rpb24gKGZyb21YIC8qaW50Ki8sIGZyb21ZIC8qaW50Ki8sIHRvWCAvKmludCovLCB0b1kgLyppbnQqLykgewoJICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCB0b1gsIHRvWSk7CgkgICAgICAgIC8vIE5vdyBjb3VudCBvdGhlciB3YXkgLS0gZG9uJ3QgcnVuIG9mZiBpbWFnZSB0aG91Z2ggb2YgY291cnNlCgkgICAgICAgIHZhciBzY2FsZSA9IDEuMDsKCSAgICAgICAgdmFyIG90aGVyVG9YID0gZnJvbVggLSAodG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAob3RoZXJUb1ggPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21YIC8gLyooZmxvYXQpICovIChmcm9tWCAtIG90aGVyVG9YKTsKCSAgICAgICAgICAgIG90aGVyVG9YID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWCA+PSB0aGlzLmltYWdlLmdldFdpZHRoKCkpIHsKCSAgICAgICAgICAgIHNjYWxlID0gKHRoaXMuaW1hZ2UuZ2V0V2lkdGgoKSAtIDEgLSBmcm9tWCkgLyAvKihmbG9hdCkgKi8gKG90aGVyVG9YIC0gZnJvbVgpOwoJICAgICAgICAgICAgb3RoZXJUb1ggPSB0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlclRvWSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihmcm9tWSAtICh0b1kgLSBmcm9tWSkgKiBzY2FsZSk7CgkgICAgICAgIHNjYWxlID0gMS4wOwoJICAgICAgICBpZiAob3RoZXJUb1kgPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21ZIC8gLyooZmxvYXQpICovIChmcm9tWSAtIG90aGVyVG9ZKTsKCSAgICAgICAgICAgIG90aGVyVG9ZID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWSA+PSB0aGlzLmltYWdlLmdldEhlaWdodCgpKSB7CgkgICAgICAgICAgICBzY2FsZSA9ICh0aGlzLmltYWdlLmdldEhlaWdodCgpIC0gMSAtIGZyb21ZKSAvIC8qKGZsb2F0KSAqLyAob3RoZXJUb1kgLSBmcm9tWSk7CgkgICAgICAgICAgICBvdGhlclRvWSA9IHRoaXMuaW1hZ2UuZ2V0SGVpZ2h0KCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIG90aGVyVG9YID0gLyooaW50KSAqLyBNYXRoLmZsb29yKGZyb21YICsgKG90aGVyVG9YIC0gZnJvbVgpICogc2NhbGUpOwoJICAgICAgICByZXN1bHQgKz0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCBvdGhlclRvWCwgb3RoZXJUb1kpOwoJICAgICAgICAvLyBNaWRkbGUgcGl4ZWwgaXMgZG91YmxlLWNvdW50ZWQgdGhpcyB3YXk7IHN1YnRyYWN0IDEKCSAgICAgICAgcmV0dXJuIHJlc3VsdCAtIDEuMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHRyYWNlcyBhIGxpbmUgZnJvbSBhIHBvaW50IGluIHRoZSBpbWFnZSwgaW4gdGhlIGRpcmVjdGlvbiB0b3dhcmRzIGFub3RoZXIgcG9pbnQuCgkgICAgICogSXQgYmVnaW5zIGluIGEgYmxhY2sgcmVnaW9uLCBhbmQga2VlcHMgZ29pbmcgdW50aWwgaXQgZmluZHMgd2hpdGUsIHRoZW4gYmxhY2ssIHRoZW4gd2hpdGUgYWdhaW4uCgkgICAgICogSXQgcmVwb3J0cyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQgdG8gdGhpcyBwb2ludC48L3A+CgkgICAgICoKCSAgICAgKiA8cD5UaGlzIGlzIHVzZWQgd2hlbiBmaWd1cmluZyBvdXQgaG93IHdpZGUgYSBmaW5kZXIgcGF0dGVybiBpcywgd2hlbiB0aGUgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBtYXkgYmUgc2tld2VkIG9yIHJvdGF0ZWQuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4gPSBmdW5jdGlvbiAoZnJvbVggLyppbnQqLywgZnJvbVkgLyppbnQqLywgdG9YIC8qaW50Ki8sIHRvWSAvKmludCovKSB7CgkgICAgICAgIC8vIE1pbGQgdmFyaWFudCBvZiBCcmVzZW5oYW0ncyBhbGdvcml0aG0KCSAgICAgICAgLy8gc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQnJlc2VuaGFtJ3NfbGluZV9hbGdvcml0aG0KCSAgICAgICAgdmFyIHN0ZWVwID0gTWF0aC5hYnModG9ZIC0gZnJvbVkpID4gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAoc3RlZXApIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZnJvbVg7CgkgICAgICAgICAgICBmcm9tWCA9IGZyb21ZOwoJICAgICAgICAgICAgZnJvbVkgPSB0ZW1wOwoJICAgICAgICAgICAgdGVtcCA9IHRvWDsKCSAgICAgICAgICAgIHRvWCA9IHRvWTsKCSAgICAgICAgICAgIHRvWSA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGR4ID0gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICB2YXIgZHkgPSBNYXRoLmFicyh0b1kgLSBmcm9tWSk7CgkgICAgICAgIHZhciBlcnJvciA9IC1keCAvIDI7CgkgICAgICAgIHZhciB4c3RlcCA9IGZyb21YIDwgdG9YID8gMSA6IC0xOwoJICAgICAgICB2YXIgeXN0ZXAgPSBmcm9tWSA8IHRvWSA/IDEgOiAtMTsKCSAgICAgICAgLy8gSW4gYmxhY2sgcGl4ZWxzLCBsb29raW5nIGZvciB3aGl0ZSwgZmlyc3Qgb3Igc2Vjb25kIHRpbWUuCgkgICAgICAgIHZhciBzdGF0ZSA9IDA7CgkgICAgICAgIC8vIExvb3AgdXAgdW50aWwgeCA9PSB0b1gsIGJ1dCBub3QgYmV5b25kCgkgICAgICAgIHZhciB4TGltaXQgPSB0b1ggKyB4c3RlcDsKCSAgICAgICAgZm9yICh2YXIgeCA9IGZyb21YLCB5ID0gZnJvbVk7IHggIT09IHhMaW1pdDsgeCArPSB4c3RlcCkgewoJICAgICAgICAgICAgdmFyIHJlYWxYID0gc3RlZXAgPyB5IDogeDsKCSAgICAgICAgICAgIHZhciByZWFsWSA9IHN0ZWVwID8geCA6IHk7CgkgICAgICAgICAgICAvLyBEb2VzIGN1cnJlbnQgcGl4ZWwgbWVhbiB3ZSBoYXZlIG1vdmVkIHdoaXRlIHRvIGJsYWNrIG9yIHZpY2UgdmVyc2E/CgkgICAgICAgICAgICAvLyBTY2FubmluZyBibGFjayBpbiBzdGF0ZSAwLDIgYW5kIHdoaXRlIGluIHN0YXRlIDEsIHNvIGlmIHdlIGZpbmQgdGhlIHdyb25nCgkgICAgICAgICAgICAvLyBjb2xvciwgYWR2YW5jZSB0byBuZXh0IHN0YXRlIG9yIGVuZCBpZiB3ZSBhcmUgaW4gc3RhdGUgMiBhbHJlYWR5CgkgICAgICAgICAgICBpZiAoKHN0YXRlID09PSAxKSA9PT0gdGhpcy5pbWFnZS5nZXQocmVhbFgsIHJlYWxZKSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aFV0aWxzXzEuZGVmYXVsdC5kaXN0YW5jZSh4LCB5LCBmcm9tWCwgZnJvbVkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBzdGF0ZSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZXJyb3IgKz0gZHk7CgkgICAgICAgICAgICBpZiAoZXJyb3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgaWYgKHkgPT09IHRvWSkgewoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgeSArPSB5c3RlcDsKCSAgICAgICAgICAgICAgICBlcnJvciAtPSBkeDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBGb3VuZCBibGFjay13aGl0ZS1ibGFjazsgZ2l2ZSB0aGUgYmVuZWZpdCBvZiB0aGUgZG91YnQgdGhhdCB0aGUgbmV4dCBwaXhlbCBvdXRzaWRlIHRoZSBpbWFnZQoJICAgICAgICAvLyBpcyAid2hpdGUiIHNvIHRoaXMgbGFzdCBwb2ludCBhdCAodG9YK3hTdGVwLHRvWSkgaXMgdGhlIHJpZ2h0IGVuZGluZy4gVGhpcyBpcyByZWFsbHkgYQoJICAgICAgICAvLyBzbWFsbCBhcHByb3hpbWF0aW9uOyAodG9YK3hTdGVwLHRvWSt5U3RlcCkgbWlnaHQgYmUgcmVhbGx5IGNvcnJlY3QuIElnbm9yZSB0aGlzLgoJICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKCSAgICAgICAgICAgIHJldHVybiBNYXRoVXRpbHNfMS5kZWZhdWx0LmRpc3RhbmNlKHRvWCArIHhzdGVwLCB0b1ksIGZyb21YLCBmcm9tWSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gZWxzZSB3ZSBkaWRuJ3QgZmluZCBldmVuIGJsYWNrLXdoaXRlLWJsYWNrOyBubyBlc3RpbWF0ZSBpcyByZWFsbHkgcG9zc2libGUKCSAgICAgICAgcmV0dXJuIE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBhbGlnbm1lbnQgcGF0dGVybiBpbiBhIGxpbWl0ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZSwgd2hpY2ggaXMKCSAgICAgKiBndWVzc2VkIHRvIGNvbnRhaW4gaXQuIFRoaXMgbWV0aG9kIHVzZXMge0BsaW5rIEFsaWdubWVudFBhdHRlcm59LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBvdmVyYWxsRXN0TW9kdWxlU2l6ZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgc28gZmFyCgkgICAgICogQHBhcmFtIGVzdEFsaWdubWVudFggeCBjb29yZGluYXRlIG9mIGNlbnRlciBvZiBhcmVhIHByb2JhYmx5IGNvbnRhaW5pbmcgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gZXN0QWxpZ25tZW50WSB5IGNvb3JkaW5hdGUgb2YgYWJvdmUKCSAgICAgKiBAcGFyYW0gYWxsb3dhbmNlRmFjdG9yIG51bWJlciBvZiBwaXhlbHMgaW4gYWxsIGRpcmVjdGlvbnMgdG8gc2VhcmNoIGZyb20gdGhlIGNlbnRlcgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kLCBvciBudWxsIG90aGVyd2lzZQoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgYW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnMgZHVyaW5nIGRldGVjdGlvbgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5maW5kQWxpZ25tZW50SW5SZWdpb24gPSBmdW5jdGlvbiAob3ZlcmFsbEVzdE1vZHVsZVNpemUgLypmbG9hdCovLCBlc3RBbGlnbm1lbnRYIC8qaW50Ki8sIGVzdEFsaWdubWVudFkgLyppbnQqLywgYWxsb3dhbmNlRmFjdG9yIC8qZmxvYXQqLykgewoJICAgICAgICAvLyBMb29rIGZvciBhbiBhbGlnbm1lbnQgcGF0dGVybiAoMyBtb2R1bGVzIGluIHNpemUpIGFyb3VuZCB3aGVyZSBpdAoJICAgICAgICAvLyBzaG91bGQgYmUKCSAgICAgICAgdmFyIGFsbG93YW5jZSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihhbGxvd2FuY2VGYWN0b3IgKiBvdmVyYWxsRXN0TW9kdWxlU2l6ZSk7CgkgICAgICAgIHZhciBhbGlnbm1lbnRBcmVhTGVmdFggPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRYIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFSaWdodFggPSBNYXRoLm1pbih0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxLCBlc3RBbGlnbm1lbnRYICsgYWxsb3dhbmNlKTsKCSAgICAgICAgaWYgKGFsaWdubWVudEFyZWFSaWdodFggLSBhbGlnbm1lbnRBcmVhTGVmdFggPCBvdmVyYWxsRXN0TW9kdWxlU2l6ZSAqIDMpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgnQWxpZ25tZW50IHRvcCBleGNlZWRzIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS4nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYWxpZ25tZW50QXJlYVRvcFkgPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRZIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFCb3R0b21ZID0gTWF0aC5taW4odGhpcy5pbWFnZS5nZXRIZWlnaHQoKSAtIDEsIGVzdEFsaWdubWVudFkgKyBhbGxvd2FuY2UpOwoJICAgICAgICBpZiAoYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSA8IG92ZXJhbGxFc3RNb2R1bGVTaXplICogMykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMS5kZWZhdWx0KCdBbGlnbm1lbnQgYm90dG9tIGV4Y2VlZHMgZXN0aW1hdGVkIG1vZHVsZSBzaXplLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhbGlnbm1lbnRGaW5kZXIgPSBuZXcgQWxpZ25tZW50UGF0dGVybkZpbmRlcl8xLmRlZmF1bHQodGhpcy5pbWFnZSwgYWxpZ25tZW50QXJlYUxlZnRYLCBhbGlnbm1lbnRBcmVhVG9wWSwgYWxpZ25tZW50QXJlYVJpZ2h0WCAtIGFsaWdubWVudEFyZWFMZWZ0WCwgYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSwgb3ZlcmFsbEVzdE1vZHVsZVNpemUsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHJldHVybiBhbGlnbm1lbnRGaW5kZXIuZmluZCgpOwoJICAgIH07CgkgICAgcmV0dXJuIERldGVjdG9yOwoJfSgpKTsKCURldGVjdG9yJDEuZGVmYXVsdCA9IERldGVjdG9yOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUVJDb2RlUmVhZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlIHsqLwoJdmFyIEJhcmNvZGVGb3JtYXRfMSA9IEJhcmNvZGVGb3JtYXQkMTsKCXZhciBCaXRNYXRyaXhfMSA9IEJpdE1hdHJpeCQxOwoJdmFyIERlY29kZUhpbnRUeXBlXzEgPSBEZWNvZGVIaW50VHlwZSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdF8xID0gUmVzdWx0JDE7Cgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlXzEgPSBSZXN1bHRNZXRhZGF0YVR5cGUkMTsKCS8vIGltcG9ydCBEZXRlY3RvclJlc3VsdCBmcm9tICcuLi9jb21tb24vRGV0ZWN0b3JSZXN1bHQnOwoJdmFyIERlY29kZXJfMSA9IERlY29kZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSA9IFFSQ29kZURlY29kZXJNZXRhRGF0YSQxOwoJdmFyIERldGVjdG9yXzEgPSBEZXRlY3RvciQxOwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5NYXA7Ki8KCS8qKgoJICogVGhpcyBpbXBsZW1lbnRhdGlvbiBjYW4gZGV0ZWN0IGFuZCBkZWNvZGUgUVIgQ29kZXMgaW4gYW4gaW1hZ2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFFSQ29kZVJlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBRUkNvZGVSZWFkZXIoKSB7CgkgICAgICAgIHRoaXMuZGVjb2RlciA9IG5ldyBEZWNvZGVyXzEuZGVmYXVsdCgpOwoJICAgIH0KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmdldERlY29kZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBMb2NhdGVzIGFuZCBkZWNvZGVzIGEgUVIgY29kZSBpbiBhbiBpbWFnZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gYSByZXByZXNlbnRpbmc6IHN0cmluZyB0aGUgY29udGVudCBlbmNvZGVkIGJ5IHRoZSBRUiBjb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhIFFSIGNvZGUgY2Fubm90IGJlIGZvdW5kCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgYSBRUiBjb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIC8vIHB1YmxpYyBkZWNvZGUoaW1hZ2U6IEJpbmFyeUJpdG1hcCk6IFJlc3VsdCAvKnRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiwgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiAqLyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5kZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChpbWFnZSwgaGludHMpIHsKCSAgICAgICAgdmFyIGRlY29kZXJSZXN1bHQ7CgkgICAgICAgIHZhciBwb2ludHM7CgkgICAgICAgIGlmIChoaW50cyAhPT0gdW5kZWZpbmVkICYmIGhpbnRzICE9PSBudWxsICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEuZGVmYXVsdC5QVVJFX0JBUkNPREUpKSB7CgkgICAgICAgICAgICB2YXIgYml0cyA9IFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMoaW1hZ2UuZ2V0QmxhY2tNYXRyaXgoKSk7CgkgICAgICAgICAgICBkZWNvZGVyUmVzdWx0ID0gdGhpcy5kZWNvZGVyLmRlY29kZUJpdE1hdHJpeChiaXRzLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGRldGVjdG9yUmVzdWx0ID0gbmV3IERldGVjdG9yXzEuZGVmYXVsdChpbWFnZS5nZXRCbGFja01hdHJpeCgpKS5kZXRlY3QoaGludHMpOwoJICAgICAgICAgICAgZGVjb2RlclJlc3VsdCA9IHRoaXMuZGVjb2Rlci5kZWNvZGVCaXRNYXRyaXgoZGV0ZWN0b3JSZXN1bHQuZ2V0Qml0cygpLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBkZXRlY3RvclJlc3VsdC5nZXRQb2ludHMoKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB0aGUgY29kZSB3YXMgbWlycm9yZWQ6IHN3YXAgdGhlIGJvdHRvbS1sZWZ0IGFuZCB0aGUgdG9wLXJpZ2h0IHBvaW50cy4KCSAgICAgICAgaWYgKGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKSBpbnN0YW5jZW9mIFFSQ29kZURlY29kZXJNZXRhRGF0YV8xLmRlZmF1bHQpIHsKCSAgICAgICAgICAgIGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKS5hcHBseU1pcnJvcmVkQ29ycmVjdGlvbihwb2ludHMpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0XzEuZGVmYXVsdChkZWNvZGVyUmVzdWx0LmdldFRleHQoKSwgZGVjb2RlclJlc3VsdC5nZXRSYXdCeXRlcygpLCB1bmRlZmluZWQsIHBvaW50cywgQmFyY29kZUZvcm1hdF8xLmRlZmF1bHQuUVJfQ09ERSwgdW5kZWZpbmVkKTsKCSAgICAgICAgdmFyIGJ5dGVTZWdtZW50cyA9IGRlY29kZXJSZXN1bHQuZ2V0Qnl0ZVNlZ21lbnRzKCk7CgkgICAgICAgIGlmIChieXRlU2VnbWVudHMgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkJZVEVfU0VHTUVOVFMsIGJ5dGVTZWdtZW50cyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBkZWNvZGVyUmVzdWx0LmdldEVDTGV2ZWwoKTsKCSAgICAgICAgaWYgKGVjTGV2ZWwgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwsIGVjTGV2ZWwpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChkZWNvZGVyUmVzdWx0Lmhhc1N0cnVjdHVyZWRBcHBlbmQoKSkgewoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UsIGRlY29kZXJSZXN1bHQuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyKCkpOwoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfUEFSSVRZLCBkZWNvZGVyUmVzdWx0LmdldFN0cnVjdHVyZWRBcHBlbmRQYXJpdHkoKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBkbyBub3RoaW5nCgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBUaGlzIG1ldGhvZCBkZXRlY3RzIGEgY29kZSBpbiBhICJwdXJlIiBpbWFnZSAtLSB0aGF0IGlzLCBwdXJlIG1vbm9jaHJvbWUgaW1hZ2UKCSAgICAgKiB3aGljaCBjb250YWlucyBvbmx5IGFuIHVucm90YXRlZCwgdW5za2V3ZWQsIGltYWdlIG9mIGEgY29kZSwgd2l0aCBzb21lIHdoaXRlIGJvcmRlcgoJICAgICAqIGFyb3VuZCBpdC4gVGhpcyBpcyBhIHNwZWNpYWxpemVkIG1ldGhvZCB0aGF0IHdvcmtzIGV4Y2VwdGlvbmFsbHkgZmFzdCBpbiB0aGlzIHNwZWNpYWwKCSAgICAgKiBjYXNlLgoJICAgICAqCgkgICAgICogQHNlZSBjb20uZ29vZ2xlLnp4aW5nLmRhdGFtYXRyaXguRGF0YU1hdHJpeFJlYWRlciNleHRyYWN0UHVyZUJpdHMoQml0TWF0cml4KQoJICAgICAqLwoJICAgIFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKCSAgICAgICAgdmFyIGxlZnRUb3BCbGFjayA9IGltYWdlLmdldFRvcExlZnRPbkJpdCgpOwoJICAgICAgICB2YXIgcmlnaHRCb3R0b21CbGFjayA9IGltYWdlLmdldEJvdHRvbVJpZ2h0T25CaXQoKTsKCSAgICAgICAgaWYgKGxlZnRUb3BCbGFjayA9PT0gbnVsbCB8fCByaWdodEJvdHRvbUJsYWNrID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1vZHVsZVNpemUgPSB0aGlzLm1vZHVsZVNpemUobGVmdFRvcEJsYWNrLCBpbWFnZSk7CgkgICAgICAgIHZhciB0b3AgPSBsZWZ0VG9wQmxhY2tbMV07CgkgICAgICAgIHZhciBib3R0b20gPSByaWdodEJvdHRvbUJsYWNrWzFdOwoJICAgICAgICB2YXIgbGVmdCA9IGxlZnRUb3BCbGFja1swXTsKCSAgICAgICAgdmFyIHJpZ2h0ID0gcmlnaHRCb3R0b21CbGFja1swXTsKCSAgICAgICAgLy8gU2FuaXR5IGNoZWNrIQoJICAgICAgICBpZiAobGVmdCA+PSByaWdodCB8fCB0b3AgPj0gYm90dG9tKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJvdHRvbSAtIHRvcCAhPT0gcmlnaHQgLSBsZWZ0KSB7CgkgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UsIHdoZXJlIGJvdHRvbS1yaWdodCBtb2R1bGUgd2Fzbid0IGJsYWNrIHNvIHdlIGZvdW5kIHNvbWV0aGluZyBlbHNlIGluIHRoZSBsYXN0IHJvdwoJICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSBzcXVhcmUsIHNvIHVzZSBoZWlnaHQgYXMgdGhlIHdpZHRoCgkgICAgICAgICAgICByaWdodCA9IGxlZnQgKyAoYm90dG9tIC0gdG9wKTsKCSAgICAgICAgICAgIGlmIChyaWdodCA+PSBpbWFnZS5nZXRXaWR0aCgpKSB7CgkgICAgICAgICAgICAgICAgLy8gQWJvcnQgaWYgdGhhdCB3b3VsZCBub3QgbWFrZSBzZW5zZSAtLSBvZmYgaW1hZ2UKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1hdHJpeFdpZHRoID0gTWF0aC5yb3VuZCgocmlnaHQgLSBsZWZ0ICsgMSkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIG1hdHJpeEhlaWdodCA9IE1hdGgucm91bmQoKGJvdHRvbSAtIHRvcCArIDEpIC8gbW9kdWxlU2l6ZSk7CgkgICAgICAgIGlmIChtYXRyaXhXaWR0aCA8PSAwIHx8IG1hdHJpeEhlaWdodCA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG1hdHJpeEhlaWdodCAhPT0gbWF0cml4V2lkdGgpIHsKCSAgICAgICAgICAgIC8vIE9ubHkgcG9zc2libHkgZGVjb2RlIHNxdWFyZSByZWdpb25zCgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gUHVzaCBpbiB0aGUgImJvcmRlciIgYnkgaGFsZiB0aGUgbW9kdWxlIHdpZHRoIHNvIHRoYXQgd2Ugc3RhcnQKCSAgICAgICAgLy8gc2FtcGxpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgbW9kdWxlLiBKdXN0IGluIGNhc2UgdGhlIGltYWdlIGlzIGEKCSAgICAgICAgLy8gbGl0dGxlIG9mZiwgdGhpcyB3aWxsIGhlbHAgcmVjb3Zlci4KCSAgICAgICAgdmFyIG51ZGdlID0gLyooaW50KSAqLyBNYXRoLmZsb29yKG1vZHVsZVNpemUgLyAyLjApOwoJICAgICAgICB0b3AgKz0gbnVkZ2U7CgkgICAgICAgIGxlZnQgKz0gbnVkZ2U7CgkgICAgICAgIC8vIEJ1dCBjYXJlZnVsIHRoYXQgdGhpcyBkb2VzIG5vdCBzYW1wbGUgb2ZmIHRoZSBlZGdlCgkgICAgICAgIC8vICJyaWdodCIgaXMgdGhlIGZhcnRoZXN0LXJpZ2h0IHZhbGlkIHBpeGVsIGxvY2F0aW9uIC0tIHJpZ2h0KzEgaXMgbm90IG5lY2Vzc2FyaWx5CgkgICAgICAgIC8vIFRoaXMgaXMgcG9zaXRpdmUgYnkgaG93IG11Y2ggdGhlIGlubmVyIHggbG9vcCBiZWxvdyB3b3VsZCBiZSB0b28gbGFyZ2UKCSAgICAgICAgdmFyIG51ZGdlZFRvb0ZhclJpZ2h0ID0gbGVmdCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4V2lkdGggLSAxKSAqIG1vZHVsZVNpemUpIC0gcmlnaHQ7CgkgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IDApIHsKCSAgICAgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsZWZ0IC09IG51ZGdlZFRvb0ZhclJpZ2h0OwoJICAgICAgICB9CgkgICAgICAgIC8vIFNlZSBsb2dpYyBhYm92ZQoJICAgICAgICB2YXIgbnVkZ2VkVG9vRmFyRG93biA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4SGVpZ2h0IC0gMSkgKiBtb2R1bGVTaXplKSAtIGJvdHRvbTsKCSAgICAgICAgaWYgKG51ZGdlZFRvb0ZhckRvd24gPiAwKSB7CgkgICAgICAgICAgICBpZiAobnVkZ2VkVG9vRmFyRG93biA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3AgLT0gbnVkZ2VkVG9vRmFyRG93bjsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cganVzdCByZWFkIG9mZiB0aGUgYml0cwoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMS5kZWZhdWx0KG1hdHJpeFdpZHRoLCBtYXRyaXhIZWlnaHQpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IG1hdHJpeEhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgaU9mZnNldCA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcih5ICogbW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1hdHJpeFdpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KGxlZnQgKyAvKihpbnQpICovIE1hdGguZmxvb3IoeCAqIG1vZHVsZVNpemUpLCBpT2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIubW9kdWxlU2l6ZSA9IGZ1bmN0aW9uIChsZWZ0VG9wQmxhY2ssIGltYWdlKSB7CgkgICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHggPSBsZWZ0VG9wQmxhY2tbMF07CgkgICAgICAgIHZhciB5ID0gbGVmdFRvcEJsYWNrWzFdOwoJICAgICAgICB2YXIgaW5CbGFjayA9IHRydWU7CgkgICAgICAgIHZhciB0cmFuc2l0aW9ucyA9IDA7CgkgICAgICAgIHdoaWxlICh4IDwgd2lkdGggJiYgeSA8IGhlaWdodCkgewoJICAgICAgICAgICAgaWYgKGluQmxhY2sgIT09IGltYWdlLmdldCh4LCB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgrK3RyYW5zaXRpb25zID09PSA1KSB7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpbkJsYWNrID0gIWluQmxhY2s7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB4Kys7CgkgICAgICAgICAgICB5Kys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHggPT09IHdpZHRoIHx8IHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiAoeCAtIGxlZnRUb3BCbGFja1swXSkgLyA3LjA7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTID0gbmV3IEFycmF5KCk7CgkgICAgcmV0dXJuIFFSQ29kZVJlYWRlcjsKCX0oKSk7Cgl2YXIgX2RlZmF1bHQgPSBRUkNvZGVSZWFkZXIkMS5kZWZhdWx0ID0gUVJDb2RlUmVhZGVyOwoKCXZhciB0b0dyYXlzY2FsZUJ1ZmZlciA9IGZ1bmN0aW9uIHRvR3JheXNjYWxlQnVmZmVyKGltYWdlQnVmZmVyLCB3aWR0aCwgaGVpZ2h0KSB7CgkgIHZhciBncmF5c2NhbGVCdWZmZXIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKCSAgZm9yICh2YXIgaSA9IDAsIGogPSAwLCBsZW5ndGhfMSA9IGltYWdlQnVmZmVyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpICs9IDQsIGorKykgewoJICAgIHZhciBncmF5ID0gdm9pZCAwOwoJICAgIHZhciBhbHBoYSA9IGltYWdlQnVmZmVyW2kgKyAzXTsgLy8gVGhlIGNvbG9yIG9mIGZ1bGx5LXRyYW5zcGFyZW50IHBpeGVscyBpcyBpcnJlbGV2YW50LiBUaGV5IGFyZSBvZnRlbiwgdGVjaG5pY2FsbHksIGZ1bGx5LXRyYW5zcGFyZW50CgkgICAgLy8gYmxhY2sgKDAgYWxwaGEsIGFuZCB0aGVuIDAgUkdCKS4gVGhleSBhcmUgb2Z0ZW4gdXNlZCwgb2YgY291cnNlIGFzIHRoZSAid2hpdGUiIGFyZWEgaW4gYQoJICAgIC8vIGJhcmNvZGUgaW1hZ2UuIEZvcmNlIGFueSBzdWNoIHBpeGVsIHRvIGJlIHdoaXRlOgoKCSAgICBpZiAoYWxwaGEgPT09IDApIHsKCSAgICAgIGdyYXkgPSAweEZGOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgcGl4ZWxSID0gaW1hZ2VCdWZmZXJbaV07CgkgICAgICB2YXIgcGl4ZWxHID0gaW1hZ2VCdWZmZXJbaSArIDFdOwoJICAgICAgdmFyIHBpeGVsQiA9IGltYWdlQnVmZmVyW2kgKyAyXTsgLy8gLjI5OVIgKyAwLjU4N0cgKyAwLjExNEIgKFlVVi9ZSVEgZm9yIFBBTCBhbmQgTlRTQyksCgkgICAgICAvLyAoMzA2KlIpID4+IDEwIGlzIGFwcHJveGltYXRlbHkgZXF1YWwgdG8gUiowLjI5OSwgYW5kIHNvIG9uLgoJICAgICAgLy8gMHgyMDAgPj4gMTAgaXMgMC41LCBpdCBpbXBsZW1lbnRzIHJvdW5kaW5nLgoKCSAgICAgIGdyYXkgPSAzMDYgKiBwaXhlbFIgKyA2MDEgKiBwaXhlbEcgKyAxMTcgKiBwaXhlbEIgKyAweDIwMCA+PiAxMDsKCSAgICB9CgoJICAgIGdyYXlzY2FsZUJ1ZmZlcltqXSA9IGdyYXk7CgkgIH0KCgkgIHJldHVybiBncmF5c2NhbGVCdWZmZXI7Cgl9OwoKCXZhciByZWFkZXIgPSBuZXcgX2RlZmF1bHQoKTsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CgkgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCgkgIHRyeSB7CgkgICAgdmFyIGx1bWluYW5jZXMgPSB0b0dyYXlzY2FsZUJ1ZmZlcihlLmRhdGEuZGF0YSwgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgbHVtaW5hbmNlU291cmNlID0gbmV3IF9kZWZhdWx0JDEobHVtaW5hbmNlcywgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgaHlicmlkQmluYXJpemVyID0gbmV3IF9kZWZhdWx0JDIobHVtaW5hbmNlU291cmNlKTsKCSAgICB2YXIgYmluYXJ5Qml0bWFwID0gbmV3IF9kZWZhdWx0JDMoaHlicmlkQmluYXJpemVyKTsKCSAgICB2YXIgZGVjb2RlZCA9IHJlYWRlci5kZWNvZGUoYmluYXJ5Qml0bWFwKTsKCSAgICBwb3N0TWVzc2FnZShkZWNvZGVkKTsKCSAgfSBjYXRjaCAoZXJyKSB7CgkgICAgcG9zdE1lc3NhZ2UobnVsbCk7CgkgIH0KCX0pOwoKfSkoKTsKCg=="),hj=["constraints","onError","onLoad","onScan","resolution","qrArea"];function pB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function bB(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pB(Object(n),!0).forEach(function(i){se(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pB(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}var mj=function(){return new Cj},yB=function(t){t&&(t.getVideoTracks&&t.getAudioTracks?(t.getVideoTracks().forEach(function(n){t.removeTrack(n),n.stop()}),t.getAudioTracks().forEach(function(n){t.removeTrack(n),n.stop()})):t.stop())},Uy=function(t){var n=t.constraints,i=t.onError,r=t.onLoad,o=t.onScan,a=t.resolution,l=t.qrArea,s=Zt(t,hj),g=h.useRef(null),c=h.useRef(null),u=h.useRef(document.createElement("canvas")),I=h.useRef(null),C=h.useRef(),m=h.useState(null),f=$(m,2),b=f[0],A=f[1],p=h.useRef(!1),y=h.useRef();h.useEffect(function(){y.current=mj();var B=y.current;return B.onmessage=function(R){o&&o(R.data?bB(bB({},R.data),{},{canvas:u.current}):null),p.current=!1},function(){B.terminate()}},[o]);var Z=JSON.stringify(l),G=h.useCallback(function(){var B=JSON.parse(Z),R=y.current,X=c.current&&c.current.readyState===c.current.HAVE_ENOUGH_DATA;if(!p.current&&X){p.current=!0;var W=c.current.videoWidth,V=c.current.videoHeight,Y=W>V?W:V,K=Math.floor(a/Y*100)/100;V=Math.floor(K*V),W=Math.floor(K*W),u.current.width=W,u.current.height=V,I.current=u.current.getContext("2d"),I.current.drawImage(c.current,0,0,W,V);var M;B&&B.length===2&&B[0]>0&&B[1]>0?M=I.current.getImageData(Math.floor((W-B[0])/2),Math.floor((V-B[1])/2),B[0],B[1]):M=I.current.getImageData(0,0,W,V),R.postMessage(M)}C.current=requestAnimationFrame(G)},[a,Z]),v=JSON.stringify(n);return h.useEffect(function(){var B=JSON.parse(v),R=!0;return navigator.mediaDevices.getUserMedia(B).then(function(X){if(!R)yB(X);else{g.current=X;try{c.current&&(c.current.srcObject=X,c.current.setAttribute("playsinline",!0))}catch{A(window.URL.createObjectURL(X))}r&&r(),C.current=requestAnimationFrame(G)}}).catch(function(X){return R?i(X):null}),function(){cancelAnimationFrame(C.current),R=!1,yB(g.current),b&&window.URL.revokeObjectURL(b)}},[G,v,i,r,b]),h.createElement("video",Qe({autoPlay:!0,playsInline:!0,src:b,ref:c},s))};Uy.propTypes={constraints:Xl.object,onError:Xl.func.isRequired,onLoad:Xl.func,onScan:Xl.func.isRequired,resolution:Xl.number,qrArea:Xl.array};Uy.defaultProps={constraints:{audio:!1,video:!0},resolution:640,qrArea:[]};var q1={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var o="",a=0;a<arguments.length;a++){var l=arguments[a];l&&(o=r(o,i(l)))}return o}function i(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return n.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var a="";for(var l in o)t.call(o,l)&&o[l]&&(a=r(a,l));return a}function r(o,a){return a?o?o+" "+a:o+a:o}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(q1);var Aj=q1.exports;const he=Es(Aj);var fj=Symbol.for("react.element"),pj=Symbol.for("react.transitional.element"),bj=Symbol.for("react.fragment");function $1(e){return e&&gt(e)==="object"&&(e.$$typeof===fj||e.$$typeof===pj)&&e.type===bj}function sl(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[];return ce.Children.forEach(e,function(i){i==null&&!t.keepEmpty||(Array.isArray(i)?n=n.concat(sl(i)):$1(i)&&i.props?n=n.concat(sl(i.props.children,t)):n.push(i))}),n}var Pp={},yj=function(t){};function Zj(e,t){}function vj(e,t){}function Gj(){Pp={}}function ex(e,t,n){!t&&!Pp[n]&&(e(!1,n),Pp[n]=!0)}function ml(e,t){ex(Zj,e,t)}function Sj(e,t){ex(vj,e,t)}ml.preMessage=yj;ml.resetWarned=Gj;ml.noteOnce=Sj;function ZB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ZB(Object(n),!0).forEach(function(i){se(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZB(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function $c(e){return e instanceof HTMLElement||e instanceof SVGElement}function Bj(e){return e&&gt(e)==="object"&&$c(e.nativeElement)?e.nativeElement:$c(e)?e:null}function Gd(e){var t=Bj(e);if(t)return t;if(e instanceof ce.Component){var n;return(n=bp.findDOMNode)===null||n===void 0?void 0:n.call(bp,e)}return null}var tx={exports:{}},wt={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qy=Symbol.for("react.element"),Py=Symbol.for("react.portal"),Eh=Symbol.for("react.fragment"),Mh=Symbol.for("react.strict_mode"),zh=Symbol.for("react.profiler"),Lh=Symbol.for("react.provider"),Dh=Symbol.for("react.context"),Rj=Symbol.for("react.server_context"),Th=Symbol.for("react.forward_ref"),jh=Symbol.for("react.suspense"),Uh=Symbol.for("react.suspense_list"),Qh=Symbol.for("react.memo"),Ph=Symbol.for("react.lazy"),Wj=Symbol.for("react.offscreen"),nx;nx=Symbol.for("react.module.reference");function tr(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Qy:switch(e=e.type,e){case Eh:case zh:case Mh:case jh:case Uh:return e;default:switch(e=e&&e.$$typeof,e){case Rj:case Dh:case Th:case Ph:case Qh:case Lh:return e;default:return t}}case Py:return t}}}wt.ContextConsumer=Dh;wt.ContextProvider=Lh;wt.Element=Qy;wt.ForwardRef=Th;wt.Fragment=Eh;wt.Lazy=Ph;wt.Memo=Qh;wt.Portal=Py;wt.Profiler=zh;wt.StrictMode=Mh;wt.Suspense=jh;wt.SuspenseList=Uh;wt.isAsyncMode=function(){return!1};wt.isConcurrentMode=function(){return!1};wt.isContextConsumer=function(e){return tr(e)===Dh};wt.isContextProvider=function(e){return tr(e)===Lh};wt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Qy};wt.isForwardRef=function(e){return tr(e)===Th};wt.isFragment=function(e){return tr(e)===Eh};wt.isLazy=function(e){return tr(e)===Ph};wt.isMemo=function(e){return tr(e)===Qh};wt.isPortal=function(e){return tr(e)===Py};wt.isProfiler=function(e){return tr(e)===zh};wt.isStrictMode=function(e){return tr(e)===Mh};wt.isSuspense=function(e){return tr(e)===jh};wt.isSuspenseList=function(e){return tr(e)===Uh};wt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Eh||e===zh||e===Mh||e===jh||e===Uh||e===Wj||typeof e=="object"&&e!==null&&(e.$$typeof===Ph||e.$$typeof===Qh||e.$$typeof===Lh||e.$$typeof===Dh||e.$$typeof===Th||e.$$typeof===nx||e.getModuleId!==void 0)};wt.typeOf=tr;tx.exports=wt;var xA=tx.exports;function _h(e,t,n){var i=h.useRef({});return(!("value"in i.current)||n(i.current.condition,t))&&(i.current.value=e(),i.current.condition=t),i.current.value}var _y=function(t,n){typeof t=="function"?t(n):gt(t)==="object"&&t&&"current"in t&&(t.current=n)},Ps=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=n.filter(Boolean);return r.length<=1?r[0]:function(o){n.forEach(function(a){_y(a,o)})}},_s=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return _h(function(){return Ps.apply(void 0,n)},n,function(r,o){return r.length!==o.length||r.every(function(a,l){return a!==o[l]})})},Al=function(t){var n,i;if(!t)return!1;if(ix(t)&&t.props.propertyIsEnumerable("ref"))return!0;var r=xA.isMemo(t)?t.type.type:t.type;return!(typeof r=="function"&&!((n=r.prototype)!==null&&n!==void 0&&n.render)&&r.$$typeof!==xA.ForwardRef||typeof t=="function"&&!((i=t.prototype)!==null&&i!==void 0&&i.render)&&t.$$typeof!==xA.ForwardRef)};function ix(e){return h.isValidElement(e)&&!$1(e)}var Os=function(t){if(t&&ix(t)){var n=t;return n.props.propertyIsEnumerable("ref")?n.props.ref:n.ref}return null},_p=h.createContext(null);function kj(e){var t=e.children,n=e.onBatchResize,i=h.useRef(0),r=h.useRef([]),o=h.useContext(_p),a=h.useCallback(function(l,s,g){i.current+=1;var c=i.current;r.current.push({size:l,element:s,data:g}),Promise.resolve().then(function(){c===i.current&&(n==null||n(r.current),r.current=[])}),o==null||o(l,s,g)},[n,o]);return h.createElement(_p.Provider,{value:a},t)}var rx=function(){if(typeof Map<"u")return Map;function e(t,n){var i=-1;return t.some(function(r,o){return r[0]===n?(i=o,!0):!1}),i}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(n){var i=e(this.__entries__,n),r=this.__entries__[i];return r&&r[1]},t.prototype.set=function(n,i){var r=e(this.__entries__,n);~r?this.__entries__[r][1]=i:this.__entries__.push([n,i])},t.prototype.delete=function(n){var i=this.__entries__,r=e(i,n);~r&&i.splice(r,1)},t.prototype.has=function(n){return!!~e(this.__entries__,n)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(n,i){i===void 0&&(i=null);for(var r=0,o=this.__entries__;r<o.length;r++){var a=o[r];n.call(i,a[1],a[0])}},t}()}(),Op=typeof window<"u"&&typeof document<"u"&&window.document===document,GC=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),Vj=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(GC):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),wj=2;function xj(e,t){var n=!1,i=!1,r=0;function o(){n&&(n=!1,e()),i&&l()}function a(){Vj(o)}function l(){var s=Date.now();if(n){if(s-r<wj)return;i=!0}else n=!0,i=!1,setTimeout(a,t);r=s}return l}var Xj=20,Jj=["top","right","bottom","left","width","height","size","weight"],Yj=typeof MutationObserver<"u",Nj=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=xj(this.refresh.bind(this),Xj)}return e.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},e.prototype.removeObserver=function(t){var n=this.observers_,i=n.indexOf(t);~i&&n.splice(i,1),!n.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var t=this.updateObservers_();t&&this.refresh()},e.prototype.updateObservers_=function(){var t=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return t.forEach(function(n){return n.broadcastActive()}),t.length>0},e.prototype.connect_=function(){!Op||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Yj?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!Op||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(t){var n=t.propertyName,i=n===void 0?"":n,r=Jj.some(function(o){return!!~i.indexOf(o)});r&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),ox=function(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];Object.defineProperty(e,r,{value:t[r],enumerable:!1,writable:!1,configurable:!0})}return e},Xs=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||GC},ax=Oh(0,0,0,0);function SC(e){return parseFloat(e)||0}function vB(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(i,r){var o=e["border-"+r+"-width"];return i+SC(o)},0)}function Hj(e){for(var t=["top","right","bottom","left"],n={},i=0,r=t;i<r.length;i++){var o=r[i],a=e["padding-"+o];n[o]=SC(a)}return n}function Fj(e){var t=e.getBBox();return Oh(0,0,t.width,t.height)}function Kj(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return ax;var i=Xs(e).getComputedStyle(e),r=Hj(i),o=r.left+r.right,a=r.top+r.bottom,l=SC(i.width),s=SC(i.height);if(i.boxSizing==="border-box"&&(Math.round(l+o)!==t&&(l-=vB(i,"left","right")+o),Math.round(s+a)!==n&&(s-=vB(i,"top","bottom")+a)),!Mj(e)){var g=Math.round(l+o)-t,c=Math.round(s+a)-n;Math.abs(g)!==1&&(l-=g),Math.abs(c)!==1&&(s-=c)}return Oh(r.left,r.top,l,s)}var Ej=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof Xs(e).SVGGraphicsElement}:function(e){return e instanceof Xs(e).SVGElement&&typeof e.getBBox=="function"}}();function Mj(e){return e===Xs(e).document.documentElement}function zj(e){return Op?Ej(e)?Fj(e):Kj(e):ax}function Lj(e){var t=e.x,n=e.y,i=e.width,r=e.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(o.prototype);return ox(a,{x:t,y:n,width:i,height:r,top:n,right:t+i,bottom:r+n,left:t}),a}function Oh(e,t,n,i){return{x:e,y:t,width:n,height:i}}var Dj=function(){function e(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Oh(0,0,0,0),this.target=t}return e.prototype.isActive=function(){var t=zj(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},e}(),Tj=function(){function e(t,n){var i=Lj(n);ox(this,{target:t,contentRect:i})}return e}(),jj=function(){function e(t,n,i){if(this.activeObservations_=[],this.observations_=new rx,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=i}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof Xs(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)||(n.set(t,new Dj(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof Xs(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)&&(n.delete(t),n.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&t.activeObservations_.push(n)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,n=this.activeObservations_.map(function(i){return new Tj(i.target,i.broadcastRect())});this.callback_.call(t,n,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),lx=typeof WeakMap<"u"?new WeakMap:new rx,sx=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=Nj.getInstance(),i=new jj(t,n,this);lx.set(this,i)}return e}();["observe","unobserve","disconnect"].forEach(function(e){sx.prototype[e]=function(){var t;return(t=lx.get(this))[e].apply(t,arguments)}});var Uj=function(){return typeof GC.ResizeObserver<"u"?GC.ResizeObserver:sx}(),Uo=new Map;function Qj(e){e.forEach(function(t){var n,i=t.target;(n=Uo.get(i))===null||n===void 0||n.forEach(function(r){return r(i)})})}var gx=new Uj(Qj);function Pj(e,t){Uo.has(e)||(Uo.set(e,new Set),gx.observe(e)),Uo.get(e).add(t)}function _j(e,t){Uo.has(e)&&(Uo.get(e).delete(t),Uo.get(e).size||(gx.unobserve(e),Uo.delete(e)))}function Zi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,T1(i.key),i)}}function vi(e,t,n){return t&&GB(e.prototype,t),n&&GB(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function qp(e,t){return qp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qp(e,t)}function fl(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qp(e,t)}function BC(e){return BC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},BC(e)}function cx(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cx=function(){return!!e})()}function qa(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oj(e,t){if(t&&(gt(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qa(e)}function pl(e){var t=cx();return function(){var n,i=BC(e);if(t){var r=BC(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Oj(this,n)}}var qj=function(e){fl(n,e);var t=pl(n);function n(){return Zi(this,n),t.apply(this,arguments)}return vi(n,[{key:"render",value:function(){return this.props.children}}]),n}(h.Component);function $j(e,t){var n=e.children,i=e.disabled,r=h.useRef(null),o=h.useRef(null),a=h.useContext(_p),l=typeof n=="function",s=l?n(r):n,g=h.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),c=!l&&h.isValidElement(s)&&Al(s),u=c?Os(s):null,I=_s(u,r),C=function(){var A;return Gd(r.current)||(r.current&&gt(r.current)==="object"?Gd((A=r.current)===null||A===void 0?void 0:A.nativeElement):null)||Gd(o.current)};h.useImperativeHandle(t,function(){return C()});var m=h.useRef(e);m.current=e;var f=h.useCallback(function(b){var A=m.current,p=A.onResize,y=A.data,Z=b.getBoundingClientRect(),G=Z.width,v=Z.height,B=b.offsetWidth,R=b.offsetHeight,X=Math.floor(G),W=Math.floor(v);if(g.current.width!==X||g.current.height!==W||g.current.offsetWidth!==B||g.current.offsetHeight!==R){var V={width:X,height:W,offsetWidth:B,offsetHeight:R};g.current=V;var Y=B===Math.round(G)?G:B,K=R===Math.round(v)?v:R,M=te(te({},V),{},{offsetWidth:Y,offsetHeight:K});a==null||a(M,b,y),p&&Promise.resolve().then(function(){p(M,b)})}},[]);return h.useEffect(function(){var b=C();return b&&!i&&Pj(b,f),function(){return _j(b,f)}},[r.current,i]),h.createElement(qj,{ref:o},c?h.cloneElement(s,{ref:I}):s)}var eU=h.forwardRef($j),tU="rc-observer-key";function nU(e,t){var n=e.children,i=typeof n=="function"?[n]:sl(n);return i.map(function(r,o){var a=(r==null?void 0:r.key)||"".concat(tU,"-").concat(o);return h.createElement(eU,Qe({},e,{key:a,ref:o===0?t:void 0}),r)})}var oa=h.forwardRef(nU);oa.Collection=kj;function pa(e,t){var n=Object.assign({},e);return Array.isArray(t)&&t.forEach(function(i){delete n[i]}),n}function iU(e){if(Array.isArray(e))return Qp(e)}function ux(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yt(e){return iU(e)||ux(e)||Ly(e)||rU()}var Ix=function(t){return+setTimeout(t,16)},dx=function(t){return clearTimeout(t)};typeof window<"u"&&"requestAnimationFrame"in window&&(Ix=function(t){return window.requestAnimationFrame(t)},dx=function(t){return window.cancelAnimationFrame(t)});var SB=0,Oy=new Map;function Cx(e){Oy.delete(e)}var On=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;SB+=1;var i=SB;function r(o){if(o===0)Cx(i),t();else{var a=Ix(function(){r(o-1)});Oy.set(i,a)}}return r(n),i};On.cancel=function(e){var t=Oy.get(e);return Cx(e),dx(t)};function eu(e){for(var t=0,n,i=0,r=e.length;r>=4;++i,r-=4)n=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(r){case 3:t^=(e.charCodeAt(i+2)&255)<<16;case 2:t^=(e.charCodeAt(i+1)&255)<<8;case 1:t^=e.charCodeAt(i)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}function Yi(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function oU(e,t){if(!e)return!1;if(e.contains)return e.contains(t);for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1}var BB="data-rc-order",RB="data-rc-priority",aU="rc-util-key",$p=new Map;function hx(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.mark;return t?t.startsWith("data-")?t:"data-".concat(t):aU}function qh(e){if(e.attachTo)return e.attachTo;var t=document.querySelector("head");return t||document.body}function lU(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function qy(e){return Array.from(($p.get(e)||e).children).filter(function(t){return t.tagName==="STYLE"})}function mx(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Yi())return null;var n=t.csp,i=t.prepend,r=t.priority,o=r===void 0?0:r,a=lU(i),l=a==="prependQueue",s=document.createElement("style");s.setAttribute(BB,a),l&&o&&s.setAttribute(RB,"".concat(o)),n!=null&&n.nonce&&(s.nonce=n==null?void 0:n.nonce),s.innerHTML=e;var g=qh(t),c=g.firstChild;if(i){if(l){var u=(t.styles||qy(g)).filter(function(I){if(!["prepend","prependQueue"].includes(I.getAttribute(BB)))return!1;var C=Number(I.getAttribute(RB)||0);return o>=C});if(u.length)return g.insertBefore(s,u[u.length-1].nextSibling),s}g.insertBefore(s,c)}else g.appendChild(s);return s}function Ax(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=qh(t);return(t.styles||qy(n)).find(function(i){return i.getAttribute(hx(t))===e})}function tu(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=Ax(e,t);if(n){var i=qh(t);i.removeChild(n)}}function sU(e,t){var n=$p.get(e);if(!n||!oU(document,n)){var i=mx("",t),r=i.parentNode;$p.set(e,r),e.removeChild(i)}}function io(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=qh(n),r=qy(i),o=te(te({},n),{},{styles:r});sU(i,o);var a=Ax(t,o);if(a){var l,s;if((l=o.csp)!==null&&l!==void 0&&l.nonce&&a.nonce!==((s=o.csp)===null||s===void 0?void 0:s.nonce)){var g;a.nonce=(g=o.csp)===null||g===void 0?void 0:g.nonce}return a.innerHTML!==e&&(a.innerHTML=e),a}var c=mx(e,o);return c.setAttribute(hx(o),t),c}function $y(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=new Set;function r(o,a){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=i.has(o);if(ml(!s,"Warning: There may be circular references"),s)return!1;if(o===a)return!0;if(n&&l>1)return!1;i.add(o);var g=l+1;if(Array.isArray(o)){if(!Array.isArray(a)||o.length!==a.length)return!1;for(var c=0;c<o.length;c++)if(!r(o[c],a[c],g))return!1;return!0}if(o&&a&&gt(o)==="object"&&gt(a)==="object"){var u=Object.keys(o);return u.length!==Object.keys(a).length?!1:u.every(function(I){return r(o[I],a[I],g)})}return!1}return r(e,t)}var gU="%";function eb(e){return e.join(gU)}var cU=function(){function e(t){Zi(this,e),se(this,"instanceId",void 0),se(this,"cache",new Map),this.instanceId=t}return vi(e,[{key:"get",value:function(n){return this.opGet(eb(n))}},{key:"opGet",value:function(n){return this.cache.get(n)||null}},{key:"update",value:function(n,i){return this.opUpdate(eb(n),i)}},{key:"opUpdate",value:function(n,i){var r=this.cache.get(n),o=i(r);o===null?this.cache.delete(n):this.cache.set(n,o)}}]),e}(),Js="data-token-hash",mr="data-css-hash",Qo="__cssinjs_instance__";function uU(){var e=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var t=document.body.querySelectorAll("style[".concat(mr,"]"))||[],n=document.head.firstChild;Array.from(t).forEach(function(r){r[Qo]=r[Qo]||e,r[Qo]===e&&document.head.insertBefore(r,n)});var i={};Array.from(document.querySelectorAll("style[".concat(mr,"]"))).forEach(function(r){var o=r.getAttribute(mr);if(i[o]){if(r[Qo]===e){var a;(a=r.parentNode)===null||a===void 0||a.removeChild(r)}}else i[o]=!0})}return new cU(e)}var $h=h.createContext({hashPriority:"low",cache:uU(),defaultCache:!0});function IU(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var eZ=function(){function e(){Zi(this,e),se(this,"cache",void 0),se(this,"keys",void 0),se(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return vi(e,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(n){var i,r,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a={map:this.cache};return n.forEach(function(l){if(!a)a=void 0;else{var s;a=(s=a)===null||s===void 0||(s=s.map)===null||s===void 0?void 0:s.get(l)}}),(i=a)!==null&&i!==void 0&&i.value&&o&&(a.value[1]=this.cacheCallTimes++),(r=a)===null||r===void 0?void 0:r.value}},{key:"get",value:function(n){var i;return(i=this.internalGet(n,!0))===null||i===void 0?void 0:i[0]}},{key:"has",value:function(n){return!!this.internalGet(n)}},{key:"set",value:function(n,i){var r=this;if(!this.has(n)){if(this.size()+1>e.MAX_CACHE_SIZE+e.MAX_CACHE_OFFSET){var o=this.keys.reduce(function(g,c){var u=$(g,2),I=u[1];return r.internalGet(c)[1]<I?[c,r.internalGet(c)[1]]:g},[this.keys[0],this.cacheCallTimes]),a=$(o,1),l=a[0];this.delete(l)}this.keys.push(n)}var s=this.cache;n.forEach(function(g,c){if(c===n.length-1)s.set(g,{value:[i,r.cacheCallTimes++]});else{var u=s.get(g);u?u.map||(u.map=new Map):s.set(g,{map:new Map}),s=s.get(g).map}})}},{key:"deleteByPath",value:function(n,i){var r=n.get(i[0]);if(i.length===1){var o;return r.map?n.set(i[0],{map:r.map}):n.delete(i[0]),(o=r.value)===null||o===void 0?void 0:o[0]}var a=this.deleteByPath(r.map,i.slice(1));return(!r.map||r.map.size===0)&&!r.value&&n.delete(i[0]),a}},{key:"delete",value:function(n){if(this.has(n))return this.keys=this.keys.filter(function(i){return!IU(i,n)}),this.deleteByPath(this.cache,n)}}]),e}();se(eZ,"MAX_CACHE_SIZE",20);se(eZ,"MAX_CACHE_OFFSET",5);var WB=0,fx=function(){function e(t){Zi(this,e),se(this,"derivatives",void 0),se(this,"id",void 0),this.derivatives=Array.isArray(t)?t:[t],this.id=WB,t.length===0&&(t.length>0,void 0),WB+=1}return vi(e,[{key:"getDerivativeToken",value:function(n){return this.derivatives.reduce(function(i,r){return r(n,i)},void 0)}}]),e}(),XA=new eZ;function tb(e){var t=Array.isArray(e)?e:[e];return XA.has(t)||XA.set(t,new fx(t)),XA.get(t)}var dU=new WeakMap,JA={};function CU(e,t){for(var n=dU,i=0;i<t.length;i+=1){var r=t[i];n.has(r)||n.set(r,new WeakMap),n=n.get(r)}return n.has(JA)||n.set(JA,e()),n.get(JA)}var kB=new WeakMap;function fc(e){var t=kB.get(e)||"";return t||(Object.keys(e).forEach(function(n){var i=e[n];t+=n,i instanceof fx?t+=i.id:i&&gt(i)==="object"?t+=fc(i):t+=i}),t=eu(t),kB.set(e,t)),t}function VB(e,t){return eu("".concat(t,"_").concat(fc(e)))}var nb=Yi();function Ve(e){return typeof e=="number"?"".concat(e,"px"):e}function RC(e,t,n){var i,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(o)return e;var a=te(te({},r),{},(i={},se(i,Js,t),se(i,mr,n),i)),l=Object.keys(a).map(function(s){var g=a[s];return g?"".concat(s,'="').concat(g,'"'):null}).filter(function(s){return s}).join(" ");return"<style ".concat(l,">").concat(e,"</style>")}var Sd=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return"--".concat(n?"".concat(n,"-"):"").concat(t).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z]+)([A-Z][a-z0-9]+)/g,"$1-$2").replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase()},hU=function(t,n,i){return Object.keys(t).length?".".concat(n).concat(i!=null&&i.scope?".".concat(i.scope):"","{").concat(Object.entries(t).map(function(r){var o=$(r,2),a=o[0],l=o[1];return"".concat(a,":").concat(l,";")}).join(""),"}"):""},px=function(t,n,i){var r={},o={};return Object.entries(t).forEach(function(a){var l,s,g=$(a,2),c=g[0],u=g[1];if(i!=null&&(l=i.preserve)!==null&&l!==void 0&&l[c])o[c]=u;else if((typeof u=="string"||typeof u=="number")&&!(i!=null&&(s=i.ignore)!==null&&s!==void 0&&s[c])){var I,C=Sd(c,i==null?void 0:i.prefix);r[C]=typeof u=="number"&&!(i!=null&&(I=i.unitless)!==null&&I!==void 0&&I[c])?"".concat(u,"px"):String(u),o[c]="var(".concat(C,")")}}),[o,hU(r,n,{scope:i==null?void 0:i.scope})]},wB=Yi()?h.useLayoutEffect:h.useEffect,Kn=function(t,n){var i=h.useRef(!0);wB(function(){return t(i.current)},n),wB(function(){return i.current=!1,function(){i.current=!0}},[])},ib=function(t,n){Kn(function(i){if(!i)return t()},n)},mU=te({},qC),xB=mU.useInsertionEffect,AU=function(t,n,i){h.useMemo(t,i),Kn(function(){return n(!0)},i)},fU=xB?function(e,t,n){return xB(function(){return e(),t()},n)}:AU,pU=te({},qC),bU=pU.useInsertionEffect,yU=function(t){var n=[],i=!1;function r(o){i||n.push(o)}return h.useEffect(function(){return i=!1,function(){i=!0,n.length&&n.forEach(function(o){return o()})}},t),r},ZU=function(){return function(t){t()}},vU=typeof bU<"u"?yU:ZU;function tZ(e,t,n,i,r){var o=h.useContext($h),a=o.cache,l=[e].concat(Yt(t)),s=eb(l),g=vU([s]),c=function(m){a.opUpdate(s,function(f){var b=f||[void 0,void 0],A=$(b,2),p=A[0],y=p===void 0?0:p,Z=A[1],G=Z,v=G||n(),B=[y,v];return m?m(B):B})};h.useMemo(function(){c()},[s]);var u=a.opGet(s),I=u[1];return fU(function(){r==null||r(I)},function(C){return c(function(m){var f=$(m,2),b=f[0],A=f[1];return C&&b===0&&(r==null||r(I)),[b+1,A]}),function(){a.opUpdate(s,function(m){var f=m||[],b=$(f,2),A=b[0],p=A===void 0?0:A,y=b[1],Z=p-1;return Z===0?(g(function(){(C||!a.opGet(s))&&(i==null||i(y,!1))}),null):[p-1,y]})}},[s]),I}var GU={},SU="css",za=new Map;function BU(e){za.set(e,(za.get(e)||0)+1)}function RU(e,t){if(typeof document<"u"){var n=document.querySelectorAll("style[".concat(Js,'="').concat(e,'"]'));n.forEach(function(i){if(i[Qo]===t){var r;(r=i.parentNode)===null||r===void 0||r.removeChild(i)}})}}var WU=0;function kU(e,t){za.set(e,(za.get(e)||0)-1);var n=Array.from(za.keys()),i=n.filter(function(r){var o=za.get(r)||0;return o<=0});n.length-i.length>WU&&i.forEach(function(r){RU(r,t),za.delete(r)})}var VU=function(t,n,i,r){var o=i.getDerivativeToken(t),a=te(te({},o),n);return r&&(a=r(a)),a},bx="token";function wU(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=h.useContext($h),r=i.cache.instanceId,o=i.container,a=n.salt,l=a===void 0?"":a,s=n.override,g=s===void 0?GU:s,c=n.formatToken,u=n.getComputedToken,I=n.cssVar,C=CU(function(){return Object.assign.apply(Object,[{}].concat(Yt(t)))},t),m=fc(C),f=fc(g),b=I?fc(I):"",A=tZ(bx,[l,e.id,m,f,b],function(){var p,y=u?u(C,g,e):VU(C,g,e,c),Z=te({},y),G="";if(I){var v=px(y,I.key,{prefix:I.prefix,ignore:I.ignore,unitless:I.unitless,preserve:I.preserve}),B=$(v,2);y=B[0],G=B[1]}var R=VB(y,l);y._tokenKey=R,Z._tokenKey=VB(Z,l);var X=(p=I==null?void 0:I.key)!==null&&p!==void 0?p:R;y._themeKey=X,BU(X);var W="".concat(SU,"-").concat(eu(R));return y._hashId=W,[y,W,Z,G,(I==null?void 0:I.key)||""]},function(p){kU(p[0]._themeKey,r)},function(p){var y=$(p,4),Z=y[0],G=y[3];if(I&&G){var v=io(G,eu("css-variables-".concat(Z._themeKey)),{mark:mr,prepend:"queue",attachTo:o,priority:-999});v[Qo]=r,v.setAttribute(Js,Z._themeKey)}});return A}var xU=function(t,n,i){var r=$(t,5),o=r[2],a=r[3],l=r[4],s=i||{},g=s.plain;if(!a)return null;var c=o._tokenKey,u=-999,I={"data-rc-order":"prependQueue","data-rc-priority":"".concat(u)},C=RC(a,l,c,I,g);return[u,c,C]},XU={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},yx="comm",Zx="rule",vx="decl",JU="@import",YU="@keyframes",NU="@layer",Gx=Math.abs,nZ=String.fromCharCode;function Sx(e){return e.trim()}function Bd(e,t,n){return e.replace(t,n)}function HU(e,t,n){return e.indexOf(t,n)}function nu(e,t){return e.charCodeAt(t)|0}function Ys(e,t,n){return e.slice(t,n)}function Jr(e){return e.length}function FU(e){return e.length}function FI(e,t){return t.push(e),e}var em=1,Ns=1,Bx=0,er=0,fn=0,qs="";function iZ(e,t,n,i,r,o,a,l){return{value:e,root:t,parent:n,type:i,props:r,children:o,line:em,column:Ns,length:a,return:"",siblings:l}}function KU(){return fn}function EU(){return fn=er>0?nu(qs,--er):0,Ns--,fn===10&&(Ns=1,em--),fn}function Ar(){return fn=er<Bx?nu(qs,er++):0,Ns++,fn===10&&(Ns=1,em++),fn}function Po(){return nu(qs,er)}function Rd(){return er}function tm(e,t){return Ys(qs,e,t)}function iu(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function MU(e){return em=Ns=1,Bx=Jr(qs=e),er=0,[]}function zU(e){return qs="",e}function YA(e){return Sx(tm(er-1,rb(e===91?e+2:e===40?e+1:e)))}function LU(e){for(;(fn=Po())&&fn<33;)Ar();return iu(e)>2||iu(fn)>3?"":" "}function DU(e,t){for(;--t&&Ar()&&!(fn<48||fn>102||fn>57&&fn<65||fn>70&&fn<97););return tm(e,Rd()+(t<6&&Po()==32&&Ar()==32))}function rb(e){for(;Ar();)switch(fn){case e:return er;case 34:case 39:e!==34&&e!==39&&rb(fn);break;case 40:e===41&&rb(e);break;case 92:Ar();break}return er}function TU(e,t){for(;Ar()&&e+fn!==57;)if(e+fn===84&&Po()===47)break;return"/*"+tm(t,er-1)+"*"+nZ(e===47?e:Ar())}function jU(e){for(;!iu(Po());)Ar();return tm(e,er)}function UU(e){return zU(Wd("",null,null,null,[""],e=MU(e),0,[0],e))}function Wd(e,t,n,i,r,o,a,l,s){for(var g=0,c=0,u=a,I=0,C=0,m=0,f=1,b=1,A=1,p=0,y="",Z=r,G=o,v=i,B=y;b;)switch(m=p,p=Ar()){case 40:if(m!=108&&nu(B,u-1)==58){HU(B+=Bd(YA(p),"&","&\f"),"&\f",Gx(g?l[g-1]:0))!=-1&&(A=-1);break}case 34:case 39:case 91:B+=YA(p);break;case 9:case 10:case 13:case 32:B+=LU(m);break;case 92:B+=DU(Rd()-1,7);continue;case 47:switch(Po()){case 42:case 47:FI(QU(TU(Ar(),Rd()),t,n,s),s),(iu(m||1)==5||iu(Po()||1)==5)&&Jr(B)&&Ys(B,-1,void 0)!==" "&&(B+=" ");break;default:B+="/"}break;case 123*f:l[g++]=Jr(B)*A;case 125*f:case 59:case 0:switch(p){case 0:case 125:b=0;case 59+c:A==-1&&(B=Bd(B,/\f/g,"")),C>0&&(Jr(B)-u||f===0&&m===47)&&FI(C>32?JB(B+";",i,n,u-1,s):JB(Bd(B," ","")+";",i,n,u-2,s),s);break;case 59:B+=";";default:if(FI(v=XB(B,t,n,g,c,r,l,y,Z=[],G=[],u,o),o),p===123)if(c===0)Wd(B,t,v,v,Z,o,u,l,G);else switch(I===99&&nu(B,3)===110?100:I){case 100:case 108:case 109:case 115:Wd(e,v,v,i&&FI(XB(e,v,v,0,0,r,l,y,r,Z=[],u,G),G),r,G,u,l,i?Z:G);break;default:Wd(B,v,v,v,[""],G,0,l,G)}}g=c=C=0,f=A=1,y=B="",u=a;break;case 58:u=1+Jr(B),C=m;default:if(f<1){if(p==123)--f;else if(p==125&&f++==0&&EU()==125)continue}switch(B+=nZ(p),p*f){case 38:A=c>0?1:(B+="\f",-1);break;case 44:l[g++]=(Jr(B)-1)*A,A=1;break;case 64:Po()===45&&(B+=YA(Ar())),I=Po(),c=u=Jr(y=B+=jU(Rd())),p++;break;case 45:m===45&&Jr(B)==2&&(f=0)}}return o}function XB(e,t,n,i,r,o,a,l,s,g,c,u){for(var I=r-1,C=r===0?o:[""],m=FU(C),f=0,b=0,A=0;f<i;++f)for(var p=0,y=Ys(e,I+1,I=Gx(b=a[f])),Z=e;p<m;++p)(Z=Sx(b>0?C[p]+" "+y:Bd(y,/&\f/g,C[p])))&&(s[A++]=Z);return iZ(e,t,n,r===0?Zx:l,s,g,c,u)}function QU(e,t,n,i){return iZ(e,t,n,yx,nZ(KU()),Ys(e,2,-2),0,i)}function JB(e,t,n,i,r){return iZ(e,t,n,vx,Ys(e,0,i),Ys(e,i+1,-1),i,r)}function ob(e,t){for(var n="",i=0;i<e.length;i++)n+=t(e[i],i,e,t)||"";return n}function PU(e,t,n,i){switch(e.type){case NU:if(e.children.length)break;case JU:case vx:return e.return=e.return||e.value;case yx:return"";case YU:return e.return=e.value+"{"+ob(e.children,i)+"}";case Zx:if(!Jr(e.value=e.props.join(",")))return""}return Jr(n=ob(e.children,i))?e.return=e.value+"{"+n+"}":""}var YB="data-ant-cssinjs-cache-path",Rx="_FILE_STYLE__",$a,Wx=!0;function _U(){if(!$a&&($a={},Yi())){var e=document.createElement("div");e.className=YB,e.style.position="fixed",e.style.visibility="hidden",e.style.top="-9999px",document.body.appendChild(e);var t=getComputedStyle(e).content||"";t=t.replace(/^"/,"").replace(/"$/,""),t.split(";").forEach(function(r){var o=r.split(":"),a=$(o,2),l=a[0],s=a[1];$a[l]=s});var n=document.querySelector("style[".concat(YB,"]"));if(n){var i;Wx=!1,(i=n.parentNode)===null||i===void 0||i.removeChild(n)}document.body.removeChild(e)}}function OU(e){return _U(),!!$a[e]}function qU(e){var t=$a[e],n=null;if(t&&Yi())if(Wx)n=Rx;else{var i=document.querySelector("style[".concat(mr,'="').concat($a[e],'"]'));i?n=i.innerHTML:delete $a[e]}return[n,t]}var $U="_skip_check_",kx="_multi_value_";function kd(e){var t=ob(UU(e),PU);return t.replace(/\{%%%\:[^;];}/g,";")}function eQ(e){return gt(e)==="object"&&e&&($U in e||kx in e)}function NB(e,t,n){if(!t)return e;var i=".".concat(t),r=n==="low"?":where(".concat(i,")"):i,o=e.split(",").map(function(a){var l,s=a.trim().split(/\s+/),g=s[0]||"",c=((l=g.match(/^\w+/))===null||l===void 0?void 0:l[0])||"";return g="".concat(c).concat(r).concat(g.slice(c.length)),[g].concat(Yt(s.slice(1))).join(" ")});return o.join(",")}var tQ=function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},r=i.root,o=i.injectHash,a=i.parentSelectors,l=n.hashId,s=n.layer;n.path;var g=n.hashPriority,c=n.transformers,u=c===void 0?[]:c;n.linters;var I="",C={};function m(A){var p=A.getName(l);if(!C[p]){var y=e(A.style,n,{root:!1,parentSelectors:a}),Z=$(y,1),G=Z[0];C[p]="@keyframes ".concat(A.getName(l)).concat(G)}}function f(A){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return A.forEach(function(y){Array.isArray(y)?f(y,p):y&&p.push(y)}),p}var b=f(Array.isArray(t)?t:[t]);return b.forEach(function(A){var p=typeof A=="string"&&!r?{}:A;if(typeof p=="string")I+="".concat(p,`
`);else if(p._keyframe)m(p);else{var y=u.reduce(function(Z,G){var v;return(G==null||(v=G.visit)===null||v===void 0?void 0:v.call(G,Z))||Z},p);Object.keys(y).forEach(function(Z){var G=y[Z];if(gt(G)==="object"&&G&&(Z!=="animationName"||!G._keyframe)&&!eQ(G)){var v=!1,B=Z.trim(),R=!1;(r||o)&&l?B.startsWith("@")?v=!0:B==="&"?B=NB("",l,g):B=NB(Z,l,g):r&&!l&&(B==="&"||B==="")&&(B="",R=!0);var X=e(G,n,{root:R,injectHash:v,parentSelectors:[].concat(Yt(a),[B])}),W=$(X,2),V=W[0],Y=W[1];C=te(te({},C),Y),I+="".concat(B).concat(V)}else{let H=function(w,x){var J=w.replace(/[A-Z]/g,function(S){return"-".concat(S.toLowerCase())}),F=x;!XU[w]&&typeof F=="number"&&F!==0&&(F="".concat(F,"px")),w==="animationName"&&x!==null&&x!==void 0&&x._keyframe&&(m(x),F=x.getName(l)),I+="".concat(J,":").concat(F,";")};var K,M=(K=G==null?void 0:G.value)!==null&&K!==void 0?K:G;gt(G)==="object"&&G!==null&&G!==void 0&&G[kx]&&Array.isArray(M)?M.forEach(function(w){H(Z,w)}):H(Z,M)}})}}),r?s&&(I&&(I="@layer ".concat(s.name," {").concat(I,"}")),s.dependencies&&(C["@layer ".concat(s.name)]=s.dependencies.map(function(A){return"@layer ".concat(A,", ").concat(s.name,";")}).join(`
`))):I="{".concat(I,"}"),[I,C]};function Vx(e,t){return eu("".concat(e.join("%")).concat(t))}function nQ(){return null}var wx="style";function ab(e,t){var n=e.token,i=e.path,r=e.hashId,o=e.layer,a=e.nonce,l=e.clientOnly,s=e.order,g=s===void 0?0:s,c=h.useContext($h),u=c.autoClear;c.mock;var I=c.defaultCache,C=c.hashPriority,m=c.container,f=c.ssrInline,b=c.transformers,A=c.linters,p=c.cache,y=c.layer,Z=n._tokenKey,G=[Z];y&&G.push("layer"),G.push.apply(G,Yt(i));var v=nb,B=tZ(wx,G,function(){var Y=G.join("|");if(OU(Y)){var K=qU(Y),M=$(K,2),H=M[0],w=M[1];if(H)return[H,Z,w,{},l,g]}var x=t(),J=tQ(x,{hashId:r,hashPriority:C,layer:y?o:void 0,path:i.join("-"),transformers:b,linters:A}),F=$(J,2),S=F[0],E=F[1],N=kd(S),k=Vx(G,N);return[N,Z,k,E,l,g]},function(Y,K){var M=$(Y,3),H=M[2];(K||u)&&nb&&tu(H,{mark:mr})},function(Y){var K=$(Y,4),M=K[0];K[1];var H=K[2],w=K[3];if(v&&M!==Rx){var x={mark:mr,prepend:y?!1:"queue",attachTo:m,priority:g},J=typeof a=="function"?a():a;J&&(x.csp={nonce:J});var F=[],S=[];Object.keys(w).forEach(function(N){N.startsWith("@layer")?F.push(N):S.push(N)}),F.forEach(function(N){io(kd(w[N]),"_layer-".concat(N),te(te({},x),{},{prepend:!0}))});var E=io(M,H,x);E[Qo]=p.instanceId,E.setAttribute(Js,Z),S.forEach(function(N){io(kd(w[N]),"_effect-".concat(N),x)})}}),R=$(B,3),X=R[0],W=R[1],V=R[2];return function(Y){var K;if(!f||v||!I)K=h.createElement(nQ,null);else{var M;K=h.createElement("style",Qe({},(M={},se(M,Js,W),se(M,mr,V),M),{dangerouslySetInnerHTML:{__html:X}}))}return h.createElement(h.Fragment,null,K,Y)}}var iQ=function(t,n,i){var r=$(t,6),o=r[0],a=r[1],l=r[2],s=r[3],g=r[4],c=r[5],u=i||{},I=u.plain;if(g)return null;var C=o,m={"data-rc-order":"prependQueue","data-rc-priority":"".concat(c)};return C=RC(o,a,l,m,I),s&&Object.keys(s).forEach(function(f){if(!n[f]){n[f]=!0;var b=kd(s[f]),A=RC(b,a,"_effect-".concat(f),m,I);f.startsWith("@layer")?C=A+C:C+=A}}),[c,l,C]},xx="cssVar",rQ=function(t,n){var i=t.key,r=t.prefix,o=t.unitless,a=t.ignore,l=t.token,s=t.scope,g=s===void 0?"":s,c=h.useContext($h),u=c.cache.instanceId,I=c.container,C=l._tokenKey,m=[].concat(Yt(t.path),[i,g,C]),f=tZ(xx,m,function(){var b=n(),A=px(b,i,{prefix:r,unitless:o,ignore:a,scope:g}),p=$(A,2),y=p[0],Z=p[1],G=Vx(m,Z);return[y,Z,G,i]},function(b){var A=$(b,3),p=A[2];nb&&tu(p,{mark:mr})},function(b){var A=$(b,3),p=A[1],y=A[2];if(p){var Z=io(p,y,{mark:mr,prepend:"queue",attachTo:I,priority:-999});Z[Qo]=u,Z.setAttribute(Js,i)}});return f},oQ=function(t,n,i){var r=$(t,4),o=r[1],a=r[2],l=r[3],s=i||{},g=s.plain;if(!o)return null;var c=-999,u={"data-rc-order":"prependQueue","data-rc-priority":"".concat(c)},I=RC(o,l,a,u,g);return[c,a,I]},xg;xg={},se(xg,wx,iQ),se(xg,bx,xU),se(xg,xx,oQ);var Ni=function(){function e(t,n){Zi(this,e),se(this,"name",void 0),se(this,"style",void 0),se(this,"_keyframe",!0),this.name=t,this.style=n}return vi(e,[{key:"getName",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return n?"".concat(n,"-").concat(this.name):this.name}}]),e}();function Jl(e){return e.notSplit=!0,e}Jl(["borderTop","borderBottom"]),Jl(["borderTop"]),Jl(["borderBottom"]),Jl(["borderLeft","borderRight"]),Jl(["borderLeft"]),Jl(["borderRight"]);var rZ=h.createContext({});function aQ(e){return j1(e)||ux(e)||Ly(e)||U1()}function lb(e,t){for(var n=e,i=0;i<t.length;i+=1){if(n==null)return;n=n[t[i]]}return n}function Xx(e,t,n,i){if(!t.length)return n;var r=aQ(t),o=r[0],a=r.slice(1),l;return!e&&typeof o=="number"?l=[]:Array.isArray(e)?l=Yt(e):l=te({},e),i&&n===void 0&&a.length===1?delete l[o][a[0]]:l[o]=Xx(l[o],a,n,i),l}function NA(e,t,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return t.length&&i&&n===void 0&&!lb(e,t.slice(0,-1))?e:Xx(e,t,n,i)}function lQ(e){return gt(e)==="object"&&e!==null&&Object.getPrototypeOf(e)===Object.prototype}function HB(e){return Array.isArray(e)?[]:{}}var sQ=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function gQ(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=HB(t[0]);return t.forEach(function(r){function o(a,l){var s=new Set(l),g=lb(r,a),c=Array.isArray(g);if(c||lQ(g)){if(!s.has(g)){s.add(g);var u=lb(i,a);c?i=NA(i,a,[]):(!u||gt(u)!=="object")&&(i=NA(i,a,HB(g))),sQ(g).forEach(function(I){o([].concat(Yt(a),[I]),s)})}}else i=NA(i,a,g)}o([])}),i}const cQ=h.createContext({}),uQ=h.createContext(void 0);var IQ={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},dQ={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0},CQ=te(te({},dQ),{},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",dateFormat:"M/D/YYYY",dateTimeFormat:"M/D/YYYY HH:mm:ss",previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"});const Jx={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},FB={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},CQ),timePickerLocale:Object.assign({},Jx)},Si="${label} is not a valid ${type}",nm={locale:"en",Pagination:IQ,DatePicker:FB,TimePicker:Jx,Calendar:FB,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",deselectAll:"Deselect all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand",collapse:"Collapse"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:Si,method:Si,array:Si,object:Si,number:Si,date:Si,boolean:Si,integer:Si,float:Si,regexp:Si,email:Si,url:Si,hex:Si},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"},ColorPicker:{presetEmpty:"Empty",transparent:"Transparent",singleColor:"Single",gradientColor:"Gradient"}};Object.assign({},nm.Modal);let Vd=[];const KB=()=>Vd.reduce((e,t)=>Object.assign(Object.assign({},e),t),nm.Modal);function hQ(e){if(e){const t=Object.assign({},e);return Vd.push(t),KB(),()=>{Vd=Vd.filter(n=>n!==t),KB()}}Object.assign({},nm.Modal)}const Yx=h.createContext(void 0),mQ="internalMark",AQ=e=>{const{locale:t={},children:n,_ANT_MARK__:i}=e;h.useEffect(()=>hQ(t==null?void 0:t.Modal),[t]);const r=h.useMemo(()=>Object.assign(Object.assign({},t),{exist:!0}),[t]);return h.createElement(Yx.Provider,{value:r},n)},Wn=Math.round;function HA(e,t){const n=e.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],i=n.map(r=>parseFloat(r));for(let r=0;r<3;r+=1)i[r]=t(i[r]||0,n[r]||"",r);return n[3]?i[3]=n[3].includes("%")?i[3]/100:i[3]:i[3]=1,i}const EB=(e,t,n)=>n===0?e:e/100;function Xg(e,t){const n=t||255;return e>n?n:e<0?0:e}class an{constructor(t){se(this,"isValid",!0),se(this,"r",0),se(this,"g",0),se(this,"b",0),se(this,"a",1),se(this,"_h",void 0),se(this,"_s",void 0),se(this,"_l",void 0),se(this,"_v",void 0),se(this,"_max",void 0),se(this,"_min",void 0),se(this,"_brightness",void 0);function n(i){return i[0]in t&&i[1]in t&&i[2]in t}if(t)if(typeof t=="string"){let r=function(o){return i.startsWith(o)};const i=t.trim();/^#?[A-F\d]{3,8}$/i.test(i)?this.fromHexString(i):r("rgb")?this.fromRgbString(i):r("hsl")?this.fromHslString(i):(r("hsv")||r("hsb"))&&this.fromHsvString(i)}else if(t instanceof an)this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this._h=t._h,this._s=t._s,this._l=t._l,this._v=t._v;else if(n("rgb"))this.r=Xg(t.r),this.g=Xg(t.g),this.b=Xg(t.b),this.a=typeof t.a=="number"?Xg(t.a,1):1;else if(n("hsl"))this.fromHsl(t);else if(n("hsv"))this.fromHsv(t);else throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(t))}setR(t){return this._sc("r",t)}setG(t){return this._sc("g",t)}setB(t){return this._sc("b",t)}setA(t){return this._sc("a",t,1)}setHue(t){const n=this.toHsv();return n.h=t,this._c(n)}getLuminance(){function t(o){const a=o/255;return a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4)}const n=t(this.r),i=t(this.g),r=t(this.b);return .2126*n+.7152*i+.0722*r}getHue(){if(typeof this._h>"u"){const t=this.getMax()-this.getMin();t===0?this._h=0:this._h=Wn(60*(this.r===this.getMax()?(this.g-this.b)/t+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/t+2:(this.r-this.g)/t+4))}return this._h}getSaturation(){if(typeof this._s>"u"){const t=this.getMax()-this.getMin();t===0?this._s=0:this._s=t/this.getMax()}return this._s}getLightness(){return typeof this._l>"u"&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return typeof this._v>"u"&&(this._v=this.getMax()/255),this._v}getBrightness(){return typeof this._brightness>"u"&&(this._brightness=(this.r*299+this.g*587+this.b*114)/1e3),this._brightness}darken(t=10){const n=this.getHue(),i=this.getSaturation();let r=this.getLightness()-t/100;return r<0&&(r=0),this._c({h:n,s:i,l:r,a:this.a})}lighten(t=10){const n=this.getHue(),i=this.getSaturation();let r=this.getLightness()+t/100;return r>1&&(r=1),this._c({h:n,s:i,l:r,a:this.a})}mix(t,n=50){const i=this._c(t),r=n/100,o=l=>(i[l]-this[l])*r+this[l],a={r:Wn(o("r")),g:Wn(o("g")),b:Wn(o("b")),a:Wn(o("a")*100)/100};return this._c(a)}tint(t=10){return this.mix({r:255,g:255,b:255,a:1},t)}shade(t=10){return this.mix({r:0,g:0,b:0,a:1},t)}onBackground(t){const n=this._c(t),i=this.a+n.a*(1-this.a),r=o=>Wn((this[o]*this.a+n[o]*n.a*(1-this.a))/i);return this._c({r:r("r"),g:r("g"),b:r("b"),a:i})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}clone(){return this._c(this)}toHexString(){let t="#";const n=(this.r||0).toString(16);t+=n.length===2?n:"0"+n;const i=(this.g||0).toString(16);t+=i.length===2?i:"0"+i;const r=(this.b||0).toString(16);if(t+=r.length===2?r:"0"+r,typeof this.a=="number"&&this.a>=0&&this.a<1){const o=Wn(this.a*255).toString(16);t+=o.length===2?o:"0"+o}return t}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const t=this.getHue(),n=Wn(this.getSaturation()*100),i=Wn(this.getLightness()*100);return this.a!==1?`hsla(${t},${n}%,${i}%,${this.a})`:`hsl(${t},${n}%,${i}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return this.a!==1?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(t,n,i){const r=this.clone();return r[t]=Xg(n,i),r}_c(t){return new this.constructor(t)}getMax(){return typeof this._max>"u"&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return typeof this._min>"u"&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(t){const n=t.replace("#","");function i(r,o){return parseInt(n[r]+n[o||r],16)}n.length<6?(this.r=i(0),this.g=i(1),this.b=i(2),this.a=n[3]?i(3)/255:1):(this.r=i(0,1),this.g=i(2,3),this.b=i(4,5),this.a=n[6]?i(6,7)/255:1)}fromHsl({h:t,s:n,l:i,a:r}){if(this._h=t%360,this._s=n,this._l=i,this.a=typeof r=="number"?r:1,n<=0){const I=Wn(i*255);this.r=I,this.g=I,this.b=I}let o=0,a=0,l=0;const s=t/60,g=(1-Math.abs(2*i-1))*n,c=g*(1-Math.abs(s%2-1));s>=0&&s<1?(o=g,a=c):s>=1&&s<2?(o=c,a=g):s>=2&&s<3?(a=g,l=c):s>=3&&s<4?(a=c,l=g):s>=4&&s<5?(o=c,l=g):s>=5&&s<6&&(o=g,l=c);const u=i-g/2;this.r=Wn((o+u)*255),this.g=Wn((a+u)*255),this.b=Wn((l+u)*255)}fromHsv({h:t,s:n,v:i,a:r}){this._h=t%360,this._s=n,this._v=i,this.a=typeof r=="number"?r:1;const o=Wn(i*255);if(this.r=o,this.g=o,this.b=o,n<=0)return;const a=t/60,l=Math.floor(a),s=a-l,g=Wn(i*(1-n)*255),c=Wn(i*(1-n*s)*255),u=Wn(i*(1-n*(1-s))*255);switch(l){case 0:this.g=u,this.b=g;break;case 1:this.r=c,this.b=g;break;case 2:this.r=g,this.b=u;break;case 3:this.r=g,this.g=c;break;case 4:this.r=u,this.g=g;break;case 5:default:this.g=g,this.b=c;break}}fromHsvString(t){const n=HA(t,EB);this.fromHsv({h:n[0],s:n[1],v:n[2],a:n[3]})}fromHslString(t){const n=HA(t,EB);this.fromHsl({h:n[0],s:n[1],l:n[2],a:n[3]})}fromRgbString(t){const n=HA(t,(i,r)=>r.includes("%")?Wn(i/100*255):i);this.r=n[0],this.g=n[1],this.b=n[2],this.a=n[3]}}var KI=2,MB=.16,fQ=.05,pQ=.05,bQ=.15,Nx=5,Hx=4,yQ=[{index:7,amount:15},{index:6,amount:25},{index:5,amount:30},{index:5,amount:45},{index:5,amount:65},{index:5,amount:85},{index:4,amount:90},{index:3,amount:95},{index:2,amount:97},{index:1,amount:98}];function zB(e,t,n){var i;return Math.round(e.h)>=60&&Math.round(e.h)<=240?i=n?Math.round(e.h)-KI*t:Math.round(e.h)+KI*t:i=n?Math.round(e.h)+KI*t:Math.round(e.h)-KI*t,i<0?i+=360:i>=360&&(i-=360),i}function LB(e,t,n){if(e.h===0&&e.s===0)return e.s;var i;return n?i=e.s-MB*t:t===Hx?i=e.s+MB:i=e.s+fQ*t,i>1&&(i=1),n&&t===Nx&&i>.1&&(i=.1),i<.06&&(i=.06),Math.round(i*100)/100}function DB(e,t,n){var i;return n?i=e.v+pQ*t:i=e.v-bQ*t,i=Math.max(0,Math.min(1,i)),Math.round(i*100)/100}function ru(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[],i=new an(e),r=i.toHsv(),o=Nx;o>0;o-=1){var a=new an({h:zB(r,o,!0),s:LB(r,o,!0),v:DB(r,o,!0)});n.push(a)}n.push(i);for(var l=1;l<=Hx;l+=1){var s=new an({h:zB(r,l),s:LB(r,l),v:DB(r,l)});n.push(s)}return t.theme==="dark"?yQ.map(function(g){var c=g.index,u=g.amount;return new an(t.backgroundColor||"#141414").mix(n[c],u).toHexString()}):n.map(function(g){return g.toHexString()})}var FA={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},sb=["#fff1f0","#ffccc7","#ffa39e","#ff7875","#ff4d4f","#f5222d","#cf1322","#a8071a","#820014","#5c0011"];sb.primary=sb[5];var gb=["#fff2e8","#ffd8bf","#ffbb96","#ff9c6e","#ff7a45","#fa541c","#d4380d","#ad2102","#871400","#610b00"];gb.primary=gb[5];var cb=["#fff7e6","#ffe7ba","#ffd591","#ffc069","#ffa940","#fa8c16","#d46b08","#ad4e00","#873800","#612500"];cb.primary=cb[5];var ub=["#fffbe6","#fff1b8","#ffe58f","#ffd666","#ffc53d","#faad14","#d48806","#ad6800","#874d00","#613400"];ub.primary=ub[5];var Ib=["#feffe6","#ffffb8","#fffb8f","#fff566","#ffec3d","#fadb14","#d4b106","#ad8b00","#876800","#614700"];Ib.primary=Ib[5];var db=["#fcffe6","#f4ffb8","#eaff8f","#d3f261","#bae637","#a0d911","#7cb305","#5b8c00","#3f6600","#254000"];db.primary=db[5];var Cb=["#f6ffed","#d9f7be","#b7eb8f","#95de64","#73d13d","#52c41a","#389e0d","#237804","#135200","#092b00"];Cb.primary=Cb[5];var hb=["#e6fffb","#b5f5ec","#87e8de","#5cdbd3","#36cfc9","#13c2c2","#08979c","#006d75","#00474f","#002329"];hb.primary=hb[5];var WC=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];WC.primary=WC[5];var mb=["#f0f5ff","#d6e4ff","#adc6ff","#85a5ff","#597ef7","#2f54eb","#1d39c4","#10239e","#061178","#030852"];mb.primary=mb[5];var Ab=["#f9f0ff","#efdbff","#d3adf7","#b37feb","#9254de","#722ed1","#531dab","#391085","#22075e","#120338"];Ab.primary=Ab[5];var fb=["#fff0f6","#ffd6e7","#ffadd2","#ff85c0","#f759ab","#eb2f96","#c41d7f","#9e1068","#780650","#520339"];fb.primary=fb[5];var pb=["#a6a6a6","#999999","#8c8c8c","#808080","#737373","#666666","#404040","#1a1a1a","#000000","#000000"];pb.primary=pb[5];var KA={red:sb,volcano:gb,orange:cb,gold:ub,yellow:Ib,lime:db,green:Cb,cyan:hb,blue:WC,geekblue:mb,purple:Ab,magenta:fb,grey:pb};const Fx={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},ou=Object.assign(Object.assign({},Fx),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0});function ZQ(e,t){let{generateColorPalettes:n,generateNeutralColorPalettes:i}=t;const{colorSuccess:r,colorWarning:o,colorError:a,colorInfo:l,colorPrimary:s,colorBgBase:g,colorTextBase:c}=e,u=n(s),I=n(r),C=n(o),m=n(a),f=n(l),b=i(g,c),A=e.colorLink||e.colorInfo,p=n(A),y=new an(m[1]).mix(new an(m[3]),50).toHexString();return Object.assign(Object.assign({},b),{colorPrimaryBg:u[1],colorPrimaryBgHover:u[2],colorPrimaryBorder:u[3],colorPrimaryBorderHover:u[4],colorPrimaryHover:u[5],colorPrimary:u[6],colorPrimaryActive:u[7],colorPrimaryTextHover:u[8],colorPrimaryText:u[9],colorPrimaryTextActive:u[10],colorSuccessBg:I[1],colorSuccessBgHover:I[2],colorSuccessBorder:I[3],colorSuccessBorderHover:I[4],colorSuccessHover:I[4],colorSuccess:I[6],colorSuccessActive:I[7],colorSuccessTextHover:I[8],colorSuccessText:I[9],colorSuccessTextActive:I[10],colorErrorBg:m[1],colorErrorBgHover:m[2],colorErrorBgFilledHover:y,colorErrorBgActive:m[3],colorErrorBorder:m[3],colorErrorBorderHover:m[4],colorErrorHover:m[5],colorError:m[6],colorErrorActive:m[7],colorErrorTextHover:m[8],colorErrorText:m[9],colorErrorTextActive:m[10],colorWarningBg:C[1],colorWarningBgHover:C[2],colorWarningBorder:C[3],colorWarningBorderHover:C[4],colorWarningHover:C[4],colorWarning:C[6],colorWarningActive:C[7],colorWarningTextHover:C[8],colorWarningText:C[9],colorWarningTextActive:C[10],colorInfoBg:f[1],colorInfoBgHover:f[2],colorInfoBorder:f[3],colorInfoBorderHover:f[4],colorInfoHover:f[4],colorInfo:f[6],colorInfoActive:f[7],colorInfoTextHover:f[8],colorInfoText:f[9],colorInfoTextActive:f[10],colorLinkHover:p[4],colorLink:p[6],colorLinkActive:p[7],colorBgMask:new an("#000").setA(.45).toRgbString(),colorWhite:"#fff"})}const vQ=e=>{let t=e,n=e,i=e,r=e;return e<6&&e>=5?t=e+1:e<16&&e>=6?t=e+2:e>=16&&(t=16),e<7&&e>=5?n=4:e<8&&e>=7?n=5:e<14&&e>=8?n=6:e<16&&e>=14?n=7:e>=16&&(n=8),e<6&&e>=2?i=1:e>=6&&(i=2),e>4&&e<8?r=4:e>=8&&(r=6),{borderRadius:e,borderRadiusXS:i,borderRadiusSM:n,borderRadiusLG:t,borderRadiusOuter:r}};function GQ(e){const{motionUnit:t,motionBase:n,borderRadius:i,lineWidth:r}=e;return Object.assign({motionDurationFast:`${(n+t).toFixed(1)}s`,motionDurationMid:`${(n+t*2).toFixed(1)}s`,motionDurationSlow:`${(n+t*3).toFixed(1)}s`,lineWidthBold:r+1},vQ(i))}const SQ=e=>{const{controlHeight:t}=e;return{controlHeightSM:t*.75,controlHeightXS:t*.5,controlHeightLG:t*1.25}};function wd(e){return(e+8)/e}function BQ(e){const t=new Array(10).fill(null).map((n,i)=>{const r=i-1,o=e*Math.pow(Math.E,r/5),a=i>1?Math.floor(o):Math.ceil(o);return Math.floor(a/2)*2});return t[1]=e,t.map(n=>({size:n,lineHeight:wd(n)}))}const RQ=e=>{const t=BQ(e),n=t.map(c=>c.size),i=t.map(c=>c.lineHeight),r=n[1],o=n[0],a=n[2],l=i[1],s=i[0],g=i[2];return{fontSizeSM:o,fontSize:r,fontSizeLG:a,fontSizeXL:n[3],fontSizeHeading1:n[6],fontSizeHeading2:n[5],fontSizeHeading3:n[4],fontSizeHeading4:n[3],fontSizeHeading5:n[2],lineHeight:l,lineHeightLG:g,lineHeightSM:s,fontHeight:Math.round(l*r),fontHeightLG:Math.round(g*a),fontHeightSM:Math.round(s*o),lineHeightHeading1:i[6],lineHeightHeading2:i[5],lineHeightHeading3:i[4],lineHeightHeading4:i[3],lineHeightHeading5:i[2]}};function WQ(e){const{sizeUnit:t,sizeStep:n}=e;return{sizeXXL:t*(n+8),sizeXL:t*(n+4),sizeLG:t*(n+2),sizeMD:t*(n+1),sizeMS:t*n,size:t*n,sizeSM:t*(n-1),sizeXS:t*(n-2),sizeXXS:t*(n-3)}}const Li=(e,t)=>new an(e).setA(t).toRgbString(),Jg=(e,t)=>new an(e).darken(t).toHexString(),kQ=e=>{const t=ru(e);return{1:t[0],2:t[1],3:t[2],4:t[3],5:t[4],6:t[5],7:t[6],8:t[4],9:t[5],10:t[6]}},VQ=(e,t)=>{const n=e||"#fff",i=t||"#000";return{colorBgBase:n,colorTextBase:i,colorText:Li(i,.88),colorTextSecondary:Li(i,.65),colorTextTertiary:Li(i,.45),colorTextQuaternary:Li(i,.25),colorFill:Li(i,.15),colorFillSecondary:Li(i,.06),colorFillTertiary:Li(i,.04),colorFillQuaternary:Li(i,.02),colorBgSolid:Li(i,1),colorBgSolidHover:Li(i,.75),colorBgSolidActive:Li(i,.95),colorBgLayout:Jg(n,4),colorBgContainer:Jg(n,0),colorBgElevated:Jg(n,0),colorBgSpotlight:Li(i,.85),colorBgBlur:"transparent",colorBorder:Jg(n,15),colorBorderSecondary:Jg(n,6)}};function wQ(e){FA.pink=FA.magenta,KA.pink=KA.magenta;const t=Object.keys(Fx).map(n=>{const i=e[n]===FA[n]?KA[n]:ru(e[n]);return new Array(10).fill(1).reduce((r,o,a)=>(r[`${n}-${a+1}`]=i[a],r[`${n}${a+1}`]=i[a],r),{})}).reduce((n,i)=>(n=Object.assign(Object.assign({},n),i),n),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),t),ZQ(e,{generateColorPalettes:kQ,generateNeutralColorPalettes:VQ})),RQ(e.fontSize)),WQ(e)),SQ(e)),GQ(e))}const Kx=tb(wQ),bb={token:ou,override:{override:ou},hashed:!0},Ex=ce.createContext(bb),kC="ant",im="anticon",xQ=(e,t)=>t||(e?`${kC}-${e}`:kC),Pt=h.createContext({getPrefixCls:xQ,iconPrefixCls:im}),XQ=`-ant-${Date.now()}-${Math.random()}`;function JQ(e,t){const n={},i=(a,l)=>{let s=a.clone();return s=(l==null?void 0:l(s))||s,s.toRgbString()},r=(a,l)=>{const s=new an(a),g=ru(s.toRgbString());n[`${l}-color`]=i(s),n[`${l}-color-disabled`]=g[1],n[`${l}-color-hover`]=g[4],n[`${l}-color-active`]=g[6],n[`${l}-color-outline`]=s.clone().setA(.2).toRgbString(),n[`${l}-color-deprecated-bg`]=g[0],n[`${l}-color-deprecated-border`]=g[2]};if(t.primaryColor){r(t.primaryColor,"primary");const a=new an(t.primaryColor),l=ru(a.toRgbString());l.forEach((g,c)=>{n[`primary-${c+1}`]=g}),n["primary-color-deprecated-l-35"]=i(a,g=>g.lighten(35)),n["primary-color-deprecated-l-20"]=i(a,g=>g.lighten(20)),n["primary-color-deprecated-t-20"]=i(a,g=>g.tint(20)),n["primary-color-deprecated-t-50"]=i(a,g=>g.tint(50)),n["primary-color-deprecated-f-12"]=i(a,g=>g.setA(g.a*.12));const s=new an(l[0]);n["primary-color-active-deprecated-f-30"]=i(s,g=>g.setA(g.a*.3)),n["primary-color-active-deprecated-d-02"]=i(s,g=>g.darken(2))}return t.successColor&&r(t.successColor,"success"),t.warningColor&&r(t.warningColor,"warning"),t.errorColor&&r(t.errorColor,"error"),t.infoColor&&r(t.infoColor,"info"),`
  :root {
    ${Object.keys(n).map(a=>`--${e}-${a}: ${n[a]};`).join(`
`)}
  }
  `.trim()}function YQ(e,t){const n=JQ(e,t);Yi()&&io(n,`${XQ}-dynamic-theme`)}const VC=h.createContext(!1),NQ=e=>{let{children:t,disabled:n}=e;const i=h.useContext(VC);return h.createElement(VC.Provider,{value:n??i},t)},Hs=h.createContext(void 0),HQ=e=>{let{children:t,size:n}=e;const i=h.useContext(Hs);return h.createElement(Hs.Provider,{value:n||i},t)};function FQ(){const e=h.useContext(VC),t=h.useContext(Hs);return{componentDisabled:e,componentSize:t}}var Mx=vi(function e(){Zi(this,e)}),zx="CALC_UNIT",KQ=new RegExp(zx,"g");function EA(e){return typeof e=="number"?"".concat(e).concat(zx):e}var EQ=function(e){fl(n,e);var t=pl(n);function n(i,r){var o;Zi(this,n),o=t.call(this),se(qa(o),"result",""),se(qa(o),"unitlessCssVar",void 0),se(qa(o),"lowPriority",void 0);var a=gt(i);return o.unitlessCssVar=r,i instanceof n?o.result="(".concat(i.result,")"):a==="number"?o.result=EA(i):a==="string"&&(o.result=i),o}return vi(n,[{key:"add",value:function(r){return r instanceof n?this.result="".concat(this.result," + ").concat(r.getResult()):(typeof r=="number"||typeof r=="string")&&(this.result="".concat(this.result," + ").concat(EA(r))),this.lowPriority=!0,this}},{key:"sub",value:function(r){return r instanceof n?this.result="".concat(this.result," - ").concat(r.getResult()):(typeof r=="number"||typeof r=="string")&&(this.result="".concat(this.result," - ").concat(EA(r))),this.lowPriority=!0,this}},{key:"mul",value:function(r){return this.lowPriority&&(this.result="(".concat(this.result,")")),r instanceof n?this.result="".concat(this.result," * ").concat(r.getResult(!0)):(typeof r=="number"||typeof r=="string")&&(this.result="".concat(this.result," * ").concat(r)),this.lowPriority=!1,this}},{key:"div",value:function(r){return this.lowPriority&&(this.result="(".concat(this.result,")")),r instanceof n?this.result="".concat(this.result," / ").concat(r.getResult(!0)):(typeof r=="number"||typeof r=="string")&&(this.result="".concat(this.result," / ").concat(r)),this.lowPriority=!1,this}},{key:"getResult",value:function(r){return this.lowPriority||r?"(".concat(this.result,")"):this.result}},{key:"equal",value:function(r){var o=this,a=r||{},l=a.unit,s=!0;return typeof l=="boolean"?s=l:Array.from(this.unitlessCssVar).some(function(g){return o.result.includes(g)})&&(s=!1),this.result=this.result.replace(KQ,s?"px":""),typeof this.lowPriority<"u"?"calc(".concat(this.result,")"):this.result}}]),n}(Mx),MQ=function(e){fl(n,e);var t=pl(n);function n(i){var r;return Zi(this,n),r=t.call(this),se(qa(r),"result",0),i instanceof n?r.result=i.result:typeof i=="number"&&(r.result=i),r}return vi(n,[{key:"add",value:function(r){return r instanceof n?this.result+=r.result:typeof r=="number"&&(this.result+=r),this}},{key:"sub",value:function(r){return r instanceof n?this.result-=r.result:typeof r=="number"&&(this.result-=r),this}},{key:"mul",value:function(r){return r instanceof n?this.result*=r.result:typeof r=="number"&&(this.result*=r),this}},{key:"div",value:function(r){return r instanceof n?this.result/=r.result:typeof r=="number"&&(this.result/=r),this}},{key:"equal",value:function(){return this.result}}]),n}(Mx),zQ=function(t,n){var i=t==="css"?EQ:MQ;return function(r){return new i(r,n)}},TB=function(t,n){return"".concat([n,t.replace(/([A-Z]+)([A-Z][a-z]+)/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2")].filter(Boolean).join("-"))};function oi(e){var t=h.useRef();t.current=e;var n=h.useCallback(function(){for(var i,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(i=t.current)===null||i===void 0?void 0:i.call.apply(i,[t].concat(o))},[]);return n}function au(e){var t=h.useRef(!1),n=h.useState(e),i=$(n,2),r=i[0],o=i[1];h.useEffect(function(){return t.current=!1,function(){t.current=!0}},[]);function a(l,s){s&&t.current||o(l)}return[r,a]}function MA(e){return e!==void 0}function As(e,t){var n=t||{},i=n.defaultValue,r=n.value,o=n.onChange,a=n.postState,l=au(function(){return MA(r)?r:MA(i)?typeof i=="function"?i():i:typeof e=="function"?e():e}),s=$(l,2),g=s[0],c=s[1],u=r!==void 0?r:g,I=a?a(u):u,C=oi(o),m=au([u]),f=$(m,2),b=f[0],A=f[1];ib(function(){var y=b[0];g!==y&&C(g,y)},[b]),ib(function(){MA(r)||c(r)},[r]);var p=oi(function(y,Z){c(y,Z),A([u],Z)});return[I,p]}function jB(e,t,n,i){var r=te({},t[e]);if(i!=null&&i.deprecatedTokens){var o=i.deprecatedTokens;o.forEach(function(l){var s=$(l,2),g=s[0],c=s[1];if(r!=null&&r[g]||r!=null&&r[c]){var u;(u=r[c])!==null&&u!==void 0||(r[c]=r==null?void 0:r[g])}})}var a=te(te({},n),r);return Object.keys(a).forEach(function(l){a[l]===t[l]&&delete a[l]}),a}var Lx=typeof CSSINJS_STATISTIC<"u",yb=!0;function nr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!Lx)return Object.assign.apply(Object,[{}].concat(t));yb=!1;var i={};return t.forEach(function(r){if(gt(r)==="object"){var o=Object.keys(r);o.forEach(function(a){Object.defineProperty(i,a,{configurable:!0,enumerable:!0,get:function(){return r[a]}})})}}),yb=!0,i}var UB={};function LQ(){}var DQ=function(t){var n,i=t,r=LQ;return Lx&&typeof Proxy<"u"&&(n=new Set,i=new Proxy(t,{get:function(a,l){if(yb){var s;(s=n)===null||s===void 0||s.add(l)}return a[l]}}),r=function(a,l){var s;UB[a]={global:Array.from(n),component:te(te({},(s=UB[a])===null||s===void 0?void 0:s.component),l)}}),{token:i,keys:n,flush:r}};function QB(e,t,n){if(typeof n=="function"){var i;return n(nr(t,(i=t[e])!==null&&i!==void 0?i:{}))}return n??{}}function TQ(e){return e==="js"?{max:Math.max,min:Math.min}:{max:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return"max(".concat(i.map(function(o){return Ve(o)}).join(","),")")},min:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return"min(".concat(i.map(function(o){return Ve(o)}).join(","),")")}}}var jQ=1e3*60*10,UQ=function(){function e(){Zi(this,e),se(this,"map",new Map),se(this,"objectIDMap",new WeakMap),se(this,"nextID",0),se(this,"lastAccessBeat",new Map),se(this,"accessBeat",0)}return vi(e,[{key:"set",value:function(n,i){this.clear();var r=this.getCompositeKey(n);this.map.set(r,i),this.lastAccessBeat.set(r,Date.now())}},{key:"get",value:function(n){var i=this.getCompositeKey(n),r=this.map.get(i);return this.lastAccessBeat.set(i,Date.now()),this.accessBeat+=1,r}},{key:"getCompositeKey",value:function(n){var i=this,r=n.map(function(o){return o&&gt(o)==="object"?"obj_".concat(i.getObjectID(o)):"".concat(gt(o),"_").concat(o)});return r.join("|")}},{key:"getObjectID",value:function(n){if(this.objectIDMap.has(n))return this.objectIDMap.get(n);var i=this.nextID;return this.objectIDMap.set(n,i),this.nextID+=1,i}},{key:"clear",value:function(){var n=this;if(this.accessBeat>1e4){var i=Date.now();this.lastAccessBeat.forEach(function(r,o){i-r>jQ&&(n.map.delete(o),n.lastAccessBeat.delete(o))}),this.accessBeat=0}}}]),e}(),PB=new UQ;function QQ(e,t){return ce.useMemo(function(){var n=PB.get(t);if(n)return n;var i=e();return PB.set(t,i),i},t)}var PQ=function(){return{}};function _Q(e){var t=e.useCSP,n=t===void 0?PQ:t,i=e.useToken,r=e.usePrefix,o=e.getResetStyles,a=e.getCommonStyle,l=e.getCompUnitless;function s(I,C,m,f){var b=Array.isArray(I)?I[0]:I;function A(R){return"".concat(String(b)).concat(R.slice(0,1).toUpperCase()).concat(R.slice(1))}var p=(f==null?void 0:f.unitless)||{},y=typeof l=="function"?l(I):{},Z=te(te({},y),{},se({},A("zIndexPopup"),!0));Object.keys(p).forEach(function(R){Z[A(R)]=p[R]});var G=te(te({},f),{},{unitless:Z,prefixToken:A}),v=c(I,C,m,G),B=g(b,m,G);return function(R){var X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R,W=v(R,X),V=$(W,2),Y=V[1],K=B(X),M=$(K,2),H=M[0],w=M[1];return[H,Y,w]}}function g(I,C,m){var f=m.unitless,b=m.injectStyle,A=b===void 0?!0:b,p=m.prefixToken,y=m.ignore,Z=function(B){var R=B.rootCls,X=B.cssVar,W=X===void 0?{}:X,V=i(),Y=V.realToken;return rQ({path:[I],prefix:W.prefix,key:W.key,unitless:f,ignore:y,token:Y,scope:R},function(){var K=QB(I,Y,C),M=jB(I,Y,K,{deprecatedTokens:m==null?void 0:m.deprecatedTokens});return Object.keys(K).forEach(function(H){M[p(H)]=M[H],delete M[H]}),M}),null},G=function(B){var R=i(),X=R.cssVar;return[function(W){return A&&X?ce.createElement(ce.Fragment,null,ce.createElement(Z,{rootCls:B,cssVar:X,component:I}),W):W},X==null?void 0:X.key]};return G}function c(I,C,m){var f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},b=Array.isArray(I)?I:[I,I],A=$(b,1),p=A[0],y=b.join("-"),Z=e.layer||{name:"antd"};return function(G){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:G,B=i(),R=B.theme,X=B.realToken,W=B.hashId,V=B.token,Y=B.cssVar,K=r(),M=K.rootPrefixCls,H=K.iconPrefixCls,w=n(),x=Y?"css":"js",J=QQ(function(){var z=new Set;return Y&&Object.keys(f.unitless||{}).forEach(function(L){z.add(Sd(L,Y.prefix)),z.add(Sd(L,TB(p,Y.prefix)))}),zQ(x,z)},[x,p,Y==null?void 0:Y.prefix]),F=TQ(x),S=F.max,E=F.min,N={theme:R,token:V,hashId:W,nonce:function(){return w.nonce},clientOnly:f.clientOnly,layer:Z,order:f.order||-999};typeof o=="function"&&ab(te(te({},N),{},{clientOnly:!1,path:["Shared",M]}),function(){return o(V,{prefix:{rootPrefixCls:M,iconPrefixCls:H},csp:w})});var k=ab(te(te({},N),{},{path:[y,G,H]}),function(){if(f.injectStyle===!1)return[];var z=DQ(V),L=z.token,D=z.flush,j=QB(p,X,m),ne=".".concat(G),ie=jB(p,X,j,{deprecatedTokens:f.deprecatedTokens});Y&&j&&gt(j)==="object"&&Object.keys(j).forEach(function(Q){j[Q]="var(".concat(Sd(Q,TB(p,Y.prefix)),")")});var ae=nr(L,{componentCls:ne,prefixCls:G,iconCls:".".concat(H),antCls:".".concat(M),calc:J,max:S,min:E},Y?j:ie),Re=C(ae,{hashId:W,prefixCls:G,rootPrefixCls:M,iconPrefixCls:H});D(p,ie);var de=typeof a=="function"?a(ae,G,v,f.resetFont):null;return[f.resetStyle===!1?null:de,Re]});return[k,W]}}function u(I,C,m){var f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},b=c(I,C,m,te({resetStyle:!1,order:-998},f)),A=function(y){var Z=y.prefixCls,G=y.rootCls,v=G===void 0?Z:G;return b(Z,v),null};return A}return{genStyleHooks:s,genSubStyleComponent:u,genComponentStyleHook:c}}const Dx=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"],OQ="5.23.0";function zA(e){return e>=0&&e<=255}function EI(e,t){const{r:n,g:i,b:r,a:o}=new an(e).toRgb();if(o<1)return e;const{r:a,g:l,b:s}=new an(t).toRgb();for(let g=.01;g<=1;g+=.01){const c=Math.round((n-a*(1-g))/g),u=Math.round((i-l*(1-g))/g),I=Math.round((r-s*(1-g))/g);if(zA(c)&&zA(u)&&zA(I))return new an({r:c,g:u,b:I,a:Math.round(g*100)/100}).toRgbString()}return new an({r:n,g:i,b:r,a:1}).toRgbString()}var qQ=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Tx(e){const{override:t}=e,n=qQ(e,["override"]),i=Object.assign({},t);Object.keys(ou).forEach(I=>{delete i[I]});const r=Object.assign(Object.assign({},n),i),o=480,a=576,l=768,s=992,g=1200,c=1600;if(r.motion===!1){const I="0s";r.motionDurationFast=I,r.motionDurationMid=I,r.motionDurationSlow=I}return Object.assign(Object.assign(Object.assign({},r),{colorFillContent:r.colorFillSecondary,colorFillContentHover:r.colorFill,colorFillAlter:r.colorFillQuaternary,colorBgContainerDisabled:r.colorFillTertiary,colorBorderBg:r.colorBgContainer,colorSplit:EI(r.colorBorderSecondary,r.colorBgContainer),colorTextPlaceholder:r.colorTextQuaternary,colorTextDisabled:r.colorTextQuaternary,colorTextHeading:r.colorText,colorTextLabel:r.colorTextSecondary,colorTextDescription:r.colorTextTertiary,colorTextLightSolid:r.colorWhite,colorHighlight:r.colorError,colorBgTextHover:r.colorFillSecondary,colorBgTextActive:r.colorFill,colorIcon:r.colorTextTertiary,colorIconHover:r.colorText,colorErrorOutline:EI(r.colorErrorBg,r.colorBgContainer),colorWarningOutline:EI(r.colorWarningBg,r.colorBgContainer),fontSizeIcon:r.fontSizeSM,lineWidthFocus:r.lineWidth*3,lineWidth:r.lineWidth,controlOutlineWidth:r.lineWidth*2,controlInteractiveSize:r.controlHeight/2,controlItemBgHover:r.colorFillTertiary,controlItemBgActive:r.colorPrimaryBg,controlItemBgActiveHover:r.colorPrimaryBgHover,controlItemBgActiveDisabled:r.colorFill,controlTmpOutline:r.colorFillQuaternary,controlOutline:EI(r.colorPrimaryBg,r.colorBgContainer),lineType:r.lineType,borderRadius:r.borderRadius,borderRadiusXS:r.borderRadiusXS,borderRadiusSM:r.borderRadiusSM,borderRadiusLG:r.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:r.sizeXXS,paddingXS:r.sizeXS,paddingSM:r.sizeSM,padding:r.size,paddingMD:r.sizeMD,paddingLG:r.sizeLG,paddingXL:r.sizeXL,paddingContentHorizontalLG:r.sizeLG,paddingContentVerticalLG:r.sizeMS,paddingContentHorizontal:r.sizeMS,paddingContentVertical:r.sizeSM,paddingContentHorizontalSM:r.size,paddingContentVerticalSM:r.sizeXS,marginXXS:r.sizeXXS,marginXS:r.sizeXS,marginSM:r.sizeSM,margin:r.size,marginMD:r.sizeMD,marginLG:r.sizeLG,marginXL:r.sizeXL,marginXXL:r.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:o,screenXSMin:o,screenXSMax:a-1,screenSM:a,screenSMMin:a,screenSMMax:l-1,screenMD:l,screenMDMin:l,screenMDMax:s-1,screenLG:s,screenLGMin:s,screenLGMax:g-1,screenXL:g,screenXLMin:g,screenXLMax:c-1,screenXXL:c,screenXXLMin:c,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new an("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new an("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new an("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),i)}var _B=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const jx={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},$Q={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},eP={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},Ux=(e,t,n)=>{const i=n.getDerivativeToken(e),{override:r}=t,o=_B(t,["override"]);let a=Object.assign(Object.assign({},i),{override:r});return a=Tx(a),o&&Object.entries(o).forEach(l=>{let[s,g]=l;const{theme:c}=g,u=_B(g,["theme"]);let I=u;c&&(I=Ux(Object.assign(Object.assign({},a),u),{override:u},c)),a[s]=I}),a};function $s(){const{token:e,hashed:t,theme:n,override:i,cssVar:r}=ce.useContext(Ex),o=`${OQ}-${t||""}`,a=n||Kx,[l,s,g]=wU(a,[ou,e],{salt:o,override:i,getComputedToken:Ux,formatToken:Tx,cssVar:r&&{prefix:r.prefix,key:r.key,unitless:jx,ignore:$Q,preserve:eP}});return[a,g,t?s:"",l,r]}const oZ={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},Ju=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{boxSizing:"border-box",margin:0,padding:0,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,listStyle:"none",fontFamily:t?"inherit":e.fontFamily}},Qx=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),rm=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),tP=e=>({a:{color:e.colorLink,textDecoration:e.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive},"&:active, &:hover":{textDecoration:e.linkHoverDecoration,outline:0},"&:focus":{textDecoration:e.linkFocusDecoration,outline:0},"&[disabled]":{color:e.colorTextDisabled,cursor:"not-allowed"}}}),nP=(e,t,n,i)=>{const r=`[class^="${t}"], [class*=" ${t}"]`,o=n?`.${n}`:r,a={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let l={};return i!==!1&&(l={fontFamily:e.fontFamily,fontSize:e.fontSize}),{[o]:Object.assign(Object.assign(Object.assign({},l),a),{[r]:a})}},aZ=(e,t)=>({outline:`${Ve(e.lineWidthFocus)} solid ${e.colorPrimaryBorder}`,outlineOffset:t??1,transition:"outline-offset 0s, outline 0s"}),wC=(e,t)=>({"&:focus-visible":Object.assign({},aZ(e,t))}),Px=e=>({[`.${e}`]:Object.assign(Object.assign({},Qx()),{[`.${e} .${e}-icon`]:{display:"block"}})}),{genStyleHooks:bl,genComponentStyleHook:iP,genSubStyleComponent:rP}=_Q({usePrefix:()=>{const{getPrefixCls:e,iconPrefixCls:t}=h.useContext(Pt);return{rootPrefixCls:e(),iconPrefixCls:t}},useToken:()=>{const[e,t,n,i,r]=$s();return{theme:e,realToken:t,hashId:n,token:i,cssVar:r}},useCSP:()=>{const{csp:e}=h.useContext(Pt);return e??{}},getResetStyles:(e,t)=>{var n;return[{"&":tP(e)},Px((n=t==null?void 0:t.prefix.iconPrefixCls)!==null&&n!==void 0?n:im)]},getCommonStyle:nP,getCompUnitless:()=>jx}),oP=(e,t)=>{const[n,i]=$s();return ab({theme:n,token:i,hashId:"",path:["ant-design-icons",e],nonce:()=>t==null?void 0:t.nonce,layer:{name:"antd"}},()=>[Px(e)])},aP=Object.assign({},qC),{useId:OB}=aP,lP=()=>"",sP=typeof OB>"u"?lP:OB;function gP(e,t,n){var i;const r=e||{},o=r.inherit===!1||!t?Object.assign(Object.assign({},bb),{hashed:(i=t==null?void 0:t.hashed)!==null&&i!==void 0?i:bb.hashed,cssVar:t==null?void 0:t.cssVar}):t,a=sP();return _h(()=>{var l,s;if(!e)return t;const g=Object.assign({},o.components);Object.keys(e.components||{}).forEach(I=>{g[I]=Object.assign(Object.assign({},g[I]),e.components[I])});const c=`css-var-${a.replace(/:/g,"")}`,u=((l=r.cssVar)!==null&&l!==void 0?l:o.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:n==null?void 0:n.prefixCls},typeof o.cssVar=="object"?o.cssVar:{}),typeof r.cssVar=="object"?r.cssVar:{}),{key:typeof r.cssVar=="object"&&((s=r.cssVar)===null||s===void 0?void 0:s.key)||c});return Object.assign(Object.assign(Object.assign({},o),r),{token:Object.assign(Object.assign({},o.token),r.token),components:g,cssVar:u})},[r,o],(l,s)=>l.some((g,c)=>{const u=s[c];return!$y(g,u,!0)}))}var cP=["children"],_x=h.createContext({});function uP(e){var t=e.children,n=Zt(e,cP);return h.createElement(_x.Provider,{value:n},t)}var IP=function(e){fl(n,e);var t=pl(n);function n(){return Zi(this,n),t.apply(this,arguments)}return vi(n,[{key:"render",value:function(){return this.props.children}}]),n}(h.Component);function dP(e){var t=h.useReducer(function(l){return l+1},0),n=$(t,2),i=n[1],r=h.useRef(e),o=oi(function(){return r.current}),a=oi(function(l){r.current=typeof l=="function"?l(r.current):l,i()});return[o,a]}var Vo="none",MI="appear",zI="enter",LI="leave",qB="none",gr="prepare",rs="start",os="active",lZ="end",Ox="prepared";function $B(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit".concat(e)]="webkit".concat(t),n["Moz".concat(e)]="moz".concat(t),n["ms".concat(e)]="MS".concat(t),n["O".concat(e)]="o".concat(t.toLowerCase()),n}function CP(e,t){var n={animationend:$B("Animation","AnimationEnd"),transitionend:$B("Transition","TransitionEnd")};return e&&("AnimationEvent"in t||delete n.animationend.animation,"TransitionEvent"in t||delete n.transitionend.transition),n}var hP=CP(Yi(),typeof window<"u"?window:{}),qx={};if(Yi()){var mP=document.createElement("div");qx=mP.style}var DI={};function $x(e){if(DI[e])return DI[e];var t=hP[e];if(t)for(var n=Object.keys(t),i=n.length,r=0;r<i;r+=1){var o=n[r];if(Object.prototype.hasOwnProperty.call(t,o)&&o in qx)return DI[e]=t[o],DI[e]}return""}var eX=$x("animationend"),tX=$x("transitionend"),nX=!!(eX&&tX),eR=eX||"animationend",tR=tX||"transitionend";function nR(e,t){if(!e)return null;if(gt(e)==="object"){var n=t.replace(/-\w/g,function(i){return i[1].toUpperCase()});return e[n]}return"".concat(e,"-").concat(t)}const AP=function(e){var t=h.useRef();function n(r){r&&(r.removeEventListener(tR,e),r.removeEventListener(eR,e))}function i(r){t.current&&t.current!==r&&n(t.current),r&&r!==t.current&&(r.addEventListener(tR,e),r.addEventListener(eR,e),t.current=r)}return h.useEffect(function(){return function(){n(t.current)}},[]),[i,n]};var iX=Yi()?h.useLayoutEffect:h.useEffect;const fP=function(){var e=h.useRef(null);function t(){On.cancel(e.current)}function n(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;t();var o=On(function(){r<=1?i({isCanceled:function(){return o!==e.current}}):n(i,r-1)});e.current=o}return h.useEffect(function(){return function(){t()}},[]),[n,t]};var pP=[gr,rs,os,lZ],bP=[gr,Ox],rX=!1,yP=!0;function oX(e){return e===os||e===lZ}const ZP=function(e,t,n){var i=au(qB),r=$(i,2),o=r[0],a=r[1],l=fP(),s=$(l,2),g=s[0],c=s[1];function u(){a(gr,!0)}var I=t?bP:pP;return iX(function(){if(o!==qB&&o!==lZ){var C=I.indexOf(o),m=I[C+1],f=n(o);f===rX?a(m,!0):m&&g(function(b){function A(){b.isCanceled()||a(m,!0)}f===!0?A():Promise.resolve(f).then(A)})}},[e,o]),h.useEffect(function(){return function(){c()}},[]),[u,o]};function vP(e,t,n,i){var r=i.motionEnter,o=r===void 0?!0:r,a=i.motionAppear,l=a===void 0?!0:a,s=i.motionLeave,g=s===void 0?!0:s,c=i.motionDeadline,u=i.motionLeaveImmediately,I=i.onAppearPrepare,C=i.onEnterPrepare,m=i.onLeavePrepare,f=i.onAppearStart,b=i.onEnterStart,A=i.onLeaveStart,p=i.onAppearActive,y=i.onEnterActive,Z=i.onLeaveActive,G=i.onAppearEnd,v=i.onEnterEnd,B=i.onLeaveEnd,R=i.onVisibleChanged,X=au(),W=$(X,2),V=W[0],Y=W[1],K=dP(Vo),M=$(K,2),H=M[0],w=M[1],x=au(null),J=$(x,2),F=J[0],S=J[1],E=H(),N=h.useRef(!1),k=h.useRef(null);function z(){return n()}var L=h.useRef(!1);function D(){w(Vo),S(null,!0)}var j=oi(function(We){var ze=H();if(ze!==Vo){var Ge=z();if(!(We&&!We.deadline&&We.target!==Ge)){var it=L.current,Pe;ze===MI&&it?Pe=G==null?void 0:G(Ge,We):ze===zI&&it?Pe=v==null?void 0:v(Ge,We):ze===LI&&it&&(Pe=B==null?void 0:B(Ge,We)),it&&Pe!==!1&&D()}}}),ne=AP(j),ie=$(ne,1),ae=ie[0],Re=function(ze){switch(ze){case MI:return se(se(se({},gr,I),rs,f),os,p);case zI:return se(se(se({},gr,C),rs,b),os,y);case LI:return se(se(se({},gr,m),rs,A),os,Z);default:return{}}},de=h.useMemo(function(){return Re(E)},[E]),Q=ZP(E,!e,function(We){if(We===gr){var ze=de[gr];return ze?ze(z()):rX}if(Ae in de){var Ge;S(((Ge=de[Ae])===null||Ge===void 0?void 0:Ge.call(de,z(),null))||null)}return Ae===os&&E!==Vo&&(ae(z()),c>0&&(clearTimeout(k.current),k.current=setTimeout(function(){j({deadline:!0})},c))),Ae===Ox&&D(),yP}),O=$(Q,2),me=O[0],Ae=O[1],De=oX(Ae);L.current=De;var ke=h.useRef(null);iX(function(){if(!(N.current&&ke.current===t)){Y(t);var We=N.current;N.current=!0;var ze;!We&&t&&l&&(ze=MI),We&&t&&o&&(ze=zI),(We&&!t&&g||!We&&u&&!t&&g)&&(ze=LI);var Ge=Re(ze);ze&&(e||Ge[gr])?(w(ze),me()):w(Vo),ke.current=t}},[t]),h.useEffect(function(){(E===MI&&!l||E===zI&&!o||E===LI&&!g)&&w(Vo)},[l,o,g]),h.useEffect(function(){return function(){N.current=!1,clearTimeout(k.current)}},[]);var xe=h.useRef(!1);h.useEffect(function(){V&&(xe.current=!0),V!==void 0&&E===Vo&&((xe.current||V)&&(R==null||R(V)),xe.current=!0)},[V,E]);var Ee=F;return de[gr]&&Ae===rs&&(Ee=te({transition:"none"},Ee)),[E,Ae,Ee,V??t]}function GP(e){var t=e;gt(e)==="object"&&(t=e.transitionSupport);function n(r,o){return!!(r.motionName&&t&&o!==!1)}var i=h.forwardRef(function(r,o){var a=r.visible,l=a===void 0?!0:a,s=r.removeOnLeave,g=s===void 0?!0:s,c=r.forceRender,u=r.children,I=r.motionName,C=r.leavedClassName,m=r.eventProps,f=h.useContext(_x),b=f.motion,A=n(r,b),p=h.useRef(),y=h.useRef();function Z(){try{return p.current instanceof HTMLElement?p.current:Gd(y.current)}catch{return null}}var G=vP(A,l,Z,r),v=$(G,4),B=v[0],R=v[1],X=v[2],W=v[3],V=h.useRef(W);W&&(V.current=!0);var Y=h.useCallback(function(J){p.current=J,_y(o,J)},[o]),K,M=te(te({},m),{},{visible:l});if(!u)K=null;else if(B===Vo)W?K=u(te({},M),Y):!g&&V.current&&C?K=u(te(te({},M),{},{className:C}),Y):c||!g&&!C?K=u(te(te({},M),{},{style:{display:"none"}}),Y):K=null;else{var H;R===gr?H="prepare":oX(R)?H="active":R===rs&&(H="start");var w=nR(I,"".concat(B,"-").concat(H));K=u(te(te({},M),{},{className:he(nR(I,B),se(se({},w,w&&H),I,typeof I=="string")),style:X}),Y)}if(h.isValidElement(K)&&Al(K)){var x=Os(K);x||(K=h.cloneElement(K,{ref:Y}))}return h.createElement(IP,{ref:y},K)});return i.displayName="CSSMotion",i}const yl=GP(nX);var Zb="add",vb="keep",Gb="remove",LA="removed";function SP(e){var t;return e&&gt(e)==="object"&&"key"in e?t=e:t={key:e},te(te({},t),{},{key:String(t.key)})}function Sb(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return e.map(SP)}function BP(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=[],i=0,r=t.length,o=Sb(e),a=Sb(t);o.forEach(function(g){for(var c=!1,u=i;u<r;u+=1){var I=a[u];if(I.key===g.key){i<u&&(n=n.concat(a.slice(i,u).map(function(C){return te(te({},C),{},{status:Zb})})),i=u),n.push(te(te({},I),{},{status:vb})),i+=1,c=!0;break}}c||n.push(te(te({},g),{},{status:Gb}))}),i<r&&(n=n.concat(a.slice(i).map(function(g){return te(te({},g),{},{status:Zb})})));var l={};n.forEach(function(g){var c=g.key;l[c]=(l[c]||0)+1});var s=Object.keys(l).filter(function(g){return l[g]>1});return s.forEach(function(g){n=n.filter(function(c){var u=c.key,I=c.status;return u!==g||I!==Gb}),n.forEach(function(c){c.key===g&&(c.status=vb)})}),n}var RP=["component","children","onVisibleChanged","onAllRemoved"],WP=["status"],kP=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function VP(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yl,n=function(i){fl(o,i);var r=pl(o);function o(){var a;Zi(this,o);for(var l=arguments.length,s=new Array(l),g=0;g<l;g++)s[g]=arguments[g];return a=r.call.apply(r,[this].concat(s)),se(qa(a),"state",{keyEntities:[]}),se(qa(a),"removeKey",function(c){a.setState(function(u){var I=u.keyEntities.map(function(C){return C.key!==c?C:te(te({},C),{},{status:LA})});return{keyEntities:I}},function(){var u=a.state.keyEntities,I=u.filter(function(C){var m=C.status;return m!==LA}).length;I===0&&a.props.onAllRemoved&&a.props.onAllRemoved()})}),a}return vi(o,[{key:"render",value:function(){var l=this,s=this.state.keyEntities,g=this.props,c=g.component,u=g.children,I=g.onVisibleChanged;g.onAllRemoved;var C=Zt(g,RP),m=c||h.Fragment,f={};return kP.forEach(function(b){f[b]=C[b],delete C[b]}),delete C.keys,h.createElement(m,C,s.map(function(b,A){var p=b.status,y=Zt(b,WP),Z=p===Zb||p===vb;return h.createElement(t,Qe({},f,{key:y.key,visible:Z,eventProps:y,onVisibleChanged:function(v){I==null||I(v,{key:y.key}),v||l.removeKey(y.key)}}),function(G,v){return u(te(te({},G),{},{index:A}),v)})}))}}],[{key:"getDerivedStateFromProps",value:function(l,s){var g=l.keys,c=s.keyEntities,u=Sb(g),I=BP(c,u);return{keyEntities:I.filter(function(C){var m=c.find(function(f){var b=f.key;return C.key===b});return!(m&&m.status===LA&&C.status===Gb)})}}}]),o}(h.Component);return se(n,"defaultProps",{component:"div"}),n}const wP=VP(nX);function xP(e){const{children:t}=e,[,n]=$s(),{motion:i}=n,r=h.useRef(!1);return r.current=r.current||i===!1,r.current?h.createElement(uP,{motion:i},t):t}const XP=()=>null;var JP=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const YP=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let xC,aX,lX,sX;function xd(){return xC||kC}function NP(){return aX||im}function HP(e){return Object.keys(e).some(t=>t.endsWith("Color"))}const FP=e=>{const{prefixCls:t,iconPrefixCls:n,theme:i,holderRender:r}=e;t!==void 0&&(xC=t),n!==void 0&&(aX=n),"holderRender"in e&&(sX=r),i&&(HP(i)?YQ(xd(),i):lX=i)},KP=()=>({getPrefixCls:(e,t)=>t||(e?`${xd()}-${e}`:xd()),getIconPrefixCls:NP,getRootPrefixCls:()=>xC||xd(),getTheme:()=>lX,holderRender:sX}),EP=e=>{const{children:t,csp:n,autoInsertSpaceInButton:i,alert:r,anchor:o,form:a,locale:l,componentSize:s,direction:g,space:c,splitter:u,virtual:I,dropdownMatchSelectWidth:C,popupMatchSelectWidth:m,popupOverflow:f,legacyLocale:b,parentContext:A,iconPrefixCls:p,theme:y,componentDisabled:Z,segmented:G,statistic:v,spin:B,calendar:R,carousel:X,cascader:W,collapse:V,typography:Y,checkbox:K,descriptions:M,divider:H,drawer:w,skeleton:x,steps:J,image:F,layout:S,list:E,mentions:N,modal:k,progress:z,result:L,slider:D,breadcrumb:j,menu:ne,pagination:ie,input:ae,textArea:Re,empty:de,badge:Q,radio:O,rate:me,switch:Ae,transfer:De,avatar:ke,message:xe,tag:Ee,table:We,card:ze,tabs:Ge,timeline:it,timePicker:Pe,upload:U,notification:oe,tree:P,colorPicker:re,datePicker:ve,rangePicker:Fe,flex:Te,wave:Xe,dropdown:Ye,warning:qe,tour:$e,tooltip:et,popover:Oe,popconfirm:xt,floatButtonGroup:Dt,variant:Ht,inputNumber:at,treeSelect:je}=e,Ke=h.useCallback((Ze,Ce)=>{const{prefixCls:we}=e;if(Ce)return Ce;const Se=we||A.getPrefixCls("");return Ze?`${Se}-${Ze}`:Se},[A.getPrefixCls,e.prefixCls]),rt=p||A.iconPrefixCls||im,Be=n||A.csp;oP(rt,Be);const fe=gP(y,A.theme,{prefixCls:Ke("")}),be={csp:Be,autoInsertSpaceInButton:i,alert:r,anchor:o,locale:l||b,direction:g,space:c,splitter:u,virtual:I,popupMatchSelectWidth:m??C,popupOverflow:f,getPrefixCls:Ke,iconPrefixCls:rt,theme:fe,segmented:G,statistic:v,spin:B,calendar:R,carousel:X,cascader:W,collapse:V,typography:Y,checkbox:K,descriptions:M,divider:H,drawer:w,skeleton:x,steps:J,image:F,input:ae,textArea:Re,layout:S,list:E,mentions:N,modal:k,progress:z,result:L,slider:D,breadcrumb:j,menu:ne,pagination:ie,empty:de,badge:Q,radio:O,rate:me,switch:Ae,transfer:De,avatar:ke,message:xe,tag:Ee,table:We,card:ze,tabs:Ge,timeline:it,timePicker:Pe,upload:U,notification:oe,tree:P,colorPicker:re,datePicker:ve,rangePicker:Fe,flex:Te,wave:Xe,dropdown:Ye,warning:qe,tour:$e,tooltip:et,popover:Oe,popconfirm:xt,floatButtonGroup:Dt,variant:Ht,inputNumber:at,treeSelect:je},T=Object.assign({},A);Object.keys(be).forEach(Ze=>{be[Ze]!==void 0&&(T[Ze]=be[Ze])}),YP.forEach(Ze=>{const Ce=e[Ze];Ce&&(T[Ze]=Ce)}),typeof i<"u"&&(T.button=Object.assign({autoInsertSpace:i},T.button));const ee=_h(()=>T,T,(Ze,Ce)=>{const we=Object.keys(Ze),Se=Object.keys(Ce);return we.length!==Se.length||we.some(lt=>Ze[lt]!==Ce[lt])}),le=h.useMemo(()=>({prefixCls:rt,csp:Be}),[rt,Be]);let q=h.createElement(h.Fragment,null,h.createElement(XP,{dropdownMatchSelectWidth:C}),t);const ge=h.useMemo(()=>{var Ze,Ce,we,Se;return gQ(((Ze=nm.Form)===null||Ze===void 0?void 0:Ze.defaultValidateMessages)||{},((we=(Ce=ee.locale)===null||Ce===void 0?void 0:Ce.Form)===null||we===void 0?void 0:we.defaultValidateMessages)||{},((Se=ee.form)===null||Se===void 0?void 0:Se.validateMessages)||{},(a==null?void 0:a.validateMessages)||{})},[ee,a==null?void 0:a.validateMessages]);Object.keys(ge).length>0&&(q=h.createElement(uQ.Provider,{value:ge},q)),l&&(q=h.createElement(AQ,{locale:l,_ANT_MARK__:mQ},q)),(rt||Be)&&(q=h.createElement(rZ.Provider,{value:le},q)),s&&(q=h.createElement(HQ,{size:s},q)),q=h.createElement(xP,null,q);const pe=h.useMemo(()=>{const Ze=fe||{},{algorithm:Ce,token:we,components:Se,cssVar:lt}=Ze,Rt=JP(Ze,["algorithm","token","components","cssVar"]),cn=Ce&&(!Array.isArray(Ce)||Ce.length>0)?tb(Ce):Kx,Le={};Object.entries(Se||{}).forEach(st=>{let[Xt,Jt]=st;const _t=Object.assign({},Jt);"algorithm"in _t&&(_t.algorithm===!0?_t.theme=cn:(Array.isArray(_t.algorithm)||typeof _t.algorithm=="function")&&(_t.theme=tb(_t.algorithm)),delete _t.algorithm),Le[Xt]=_t});const ct=Object.assign(Object.assign({},ou),we);return Object.assign(Object.assign({},Rt),{theme:cn,token:ct,components:Le,override:Object.assign({override:ct},Le),cssVar:lt})},[fe]);return y&&(q=h.createElement(Ex.Provider,{value:pe},q)),ee.warning&&(q=h.createElement(cQ.Provider,{value:ee.warning},q)),Z!==void 0&&(q=h.createElement(NQ,{disabled:Z},q)),h.createElement(Pt.Provider,{value:ee},q)},eg=e=>{const t=h.useContext(Pt),n=h.useContext(Yx);return h.createElement(EP,Object.assign({parentContext:t,legacyLocale:n},e))};eg.ConfigContext=Pt;eg.SizeContext=Hs;eg.config=FP;eg.useConfig=FQ;Object.defineProperty(eg,"SizeContext",{get:()=>Hs});var MP={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"};function gX(e){var t;return e==null||(t=e.getRootNode)===null||t===void 0?void 0:t.call(e)}function zP(e){return gX(e)instanceof ShadowRoot}function XC(e){return zP(e)?gX(e):null}function LP(e){return e.replace(/-(.)/g,function(t,n){return n.toUpperCase()})}function DP(e,t){ml(e,"[@ant-design/icons] ".concat(t))}function iR(e){return gt(e)==="object"&&typeof e.name=="string"&&typeof e.theme=="string"&&(gt(e.icon)==="object"||typeof e.icon=="function")}function rR(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(e).reduce(function(t,n){var i=e[n];switch(n){case"class":t.className=i,delete t.class;break;default:delete t[n],t[LP(n)]=i}return t},{})}function Bb(e,t,n){return n?ce.createElement(e.tag,te(te({key:t},rR(e.attrs)),n),(e.children||[]).map(function(i,r){return Bb(i,"".concat(t,"-").concat(e.tag,"-").concat(r))})):ce.createElement(e.tag,te({key:t},rR(e.attrs)),(e.children||[]).map(function(i,r){return Bb(i,"".concat(t,"-").concat(e.tag,"-").concat(r))}))}function cX(e){return ru(e)[0]}function uX(e){return e?Array.isArray(e)?e:[e]:[]}var TP=`
.anticon {
  display: inline-flex;
  align-items: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,jP=function(t){var n=h.useContext(rZ),i=n.csp,r=n.prefixCls,o=TP;r&&(o=o.replace(/anticon/g,r)),h.useEffect(function(){var a=t.current,l=XC(a);io(o,"@ant-design-icons",{prepend:!0,csp:i,attachTo:l})},[])},UP=["icon","className","onClick","style","primaryColor","secondaryColor"],pc={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function QP(e){var t=e.primaryColor,n=e.secondaryColor;pc.primaryColor=t,pc.secondaryColor=n||cX(t),pc.calculated=!!n}function PP(){return te({},pc)}var tg=function(t){var n=t.icon,i=t.className,r=t.onClick,o=t.style,a=t.primaryColor,l=t.secondaryColor,s=Zt(t,UP),g=h.useRef(),c=pc;if(a&&(c={primaryColor:a,secondaryColor:l||cX(a)}),jP(g),DP(iR(n),"icon should be icon definiton, but got ".concat(n)),!iR(n))return null;var u=n;return u&&typeof u.icon=="function"&&(u=te(te({},u),{},{icon:u.icon(c.primaryColor,c.secondaryColor)})),Bb(u.icon,"svg-".concat(u.name),te(te({className:i,onClick:r,style:o,"data-icon":u.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},s),{},{ref:g}))};tg.displayName="IconReact";tg.getTwoToneColors=PP;tg.setTwoToneColors=QP;function IX(e){var t=uX(e),n=$(t,2),i=n[0],r=n[1];return tg.setTwoToneColors({primaryColor:i,secondaryColor:r})}function _P(){var e=tg.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor}var OP=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];IX(WC.primary);var Gr=h.forwardRef(function(e,t){var n=e.className,i=e.icon,r=e.spin,o=e.rotate,a=e.tabIndex,l=e.onClick,s=e.twoToneColor,g=Zt(e,OP),c=h.useContext(rZ),u=c.prefixCls,I=u===void 0?"anticon":u,C=c.rootClassName,m=he(C,I,se(se({},"".concat(I,"-").concat(i.name),!!i.name),"".concat(I,"-spin"),!!r||i.name==="loading"),n),f=a;f===void 0&&l&&(f=-1);var b=o?{msTransform:"rotate(".concat(o,"deg)"),transform:"rotate(".concat(o,"deg)")}:void 0,A=uX(s),p=$(A,2),y=p[0],Z=p[1];return h.createElement("span",Qe({role:"img","aria-label":i.name},g,{ref:t,tabIndex:f,onClick:l,className:m}),h.createElement(tg,{icon:i,primaryColor:y,secondaryColor:Z,style:b}))});Gr.displayName="AntdIcon";Gr.getTwoToneColor=_P;Gr.setTwoToneColor=IX;var qP=function(t,n){return h.createElement(Gr,Qe({},t,{ref:n,icon:MP}))},$P=h.forwardRef(qP),e_={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"},t_=function(t,n){return h.createElement(Gr,Qe({},t,{ref:n,icon:e_}))},n_=h.forwardRef(t_),i_={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"},r_=function(t,n){return h.createElement(Gr,Qe({},t,{ref:n,icon:i_}))},dX=h.forwardRef(r_),o_={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},a_=function(t,n){return h.createElement(Gr,Qe({},t,{ref:n,icon:o_}))},l_=h.forwardRef(a_),s_={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},g_=function(t,n){return h.createElement(Gr,Qe({},t,{ref:n,icon:s_}))},c_=h.forwardRef(g_),u_=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,I_=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,d_="".concat(u_," ").concat(I_).split(/[\s\n]+/),C_="aria-",h_="data-";function oR(e,t){return e.indexOf(t)===0}function m_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n;t===!1?n={aria:!0,data:!0,attr:!0}:t===!0?n={aria:!0}:n=te({},t);var i={};return Object.keys(e).forEach(function(r){(n.aria&&(r==="role"||oR(r,C_))||n.data&&oR(r,h_)||n.attr&&d_.includes(r))&&(i[r]=e[r])}),i}function A_(e){return e&&ce.isValidElement(e)&&e.type===ce.Fragment}const f_=(e,t,n)=>ce.isValidElement(e)?ce.cloneElement(e,typeof n=="function"?n(e.props||{}):n):t;function sZ(e,t){return f_(e,e,t)}const gZ=e=>{const[,,,,t]=$s();return t?`${e}-css-var`:""};var Je={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(t){var n=t.keyCode;if(t.altKey&&!t.ctrlKey||t.metaKey||n>=Je.F1&&n<=Je.F12)return!1;switch(n){case Je.ALT:case Je.CAPS_LOCK:case Je.CONTEXT_MENU:case Je.CTRL:case Je.DOWN:case Je.END:case Je.ESC:case Je.HOME:case Je.INSERT:case Je.LEFT:case Je.MAC_FF_META:case Je.META:case Je.NUMLOCK:case Je.NUM_CENTER:case Je.PAGE_DOWN:case Je.PAGE_UP:case Je.PAUSE:case Je.PRINT_SCREEN:case Je.RIGHT:case Je.SHIFT:case Je.UP:case Je.WIN_KEY:case Je.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(t){if(t>=Je.ZERO&&t<=Je.NINE||t>=Je.NUM_ZERO&&t<=Je.NUM_MULTIPLY||t>=Je.A&&t<=Je.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&t===0)return!0;switch(t){case Je.SPACE:case Je.QUESTION_MARK:case Je.NUM_PLUS:case Je.NUM_MINUS:case Je.NUM_PERIOD:case Je.NUM_DIVISION:case Je.SEMICOLON:case Je.DASH:case Je.EQUALS:case Je.COMMA:case Je.PERIOD:case Je.SLASH:case Je.APOSTROPHE:case Je.SINGLE_QUOTE:case Je.OPEN_SQUARE_BRACKET:case Je.BACKSLASH:case Je.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},CX=h.forwardRef(function(e,t){var n=e.prefixCls,i=e.style,r=e.className,o=e.duration,a=o===void 0?4.5:o,l=e.showProgress,s=e.pauseOnHover,g=s===void 0?!0:s,c=e.eventKey,u=e.content,I=e.closable,C=e.closeIcon,m=C===void 0?"x":C,f=e.props,b=e.onClick,A=e.onNoticeClose,p=e.times,y=e.hovering,Z=h.useState(!1),G=$(Z,2),v=G[0],B=G[1],R=h.useState(0),X=$(R,2),W=X[0],V=X[1],Y=h.useState(0),K=$(Y,2),M=K[0],H=K[1],w=y||v,x=a>0&&l,J=function(){A(c)},F=function(L){(L.key==="Enter"||L.code==="Enter"||L.keyCode===Je.ENTER)&&J()};h.useEffect(function(){if(!w&&a>0){var z=Date.now()-M,L=setTimeout(function(){J()},a*1e3-M);return function(){g&&clearTimeout(L),H(Date.now()-z)}}},[a,w,p]),h.useEffect(function(){if(!w&&x&&(g||M===0)){var z=performance.now(),L,D=function j(){cancelAnimationFrame(L),L=requestAnimationFrame(function(ne){var ie=ne+M-z,ae=Math.min(ie/(a*1e3),1);V(ae*100),ae<1&&j()})};return D(),function(){g&&cancelAnimationFrame(L)}}},[a,M,w,x,p]);var S=h.useMemo(function(){return gt(I)==="object"&&I!==null?I:I?{closeIcon:m}:{}},[I,m]),E=m_(S,!0),N=100-(!W||W<0?0:W>100?100:W),k="".concat(n,"-notice");return h.createElement("div",Qe({},f,{ref:t,className:he(k,r,se({},"".concat(k,"-closable"),I)),style:i,onMouseEnter:function(L){var D;B(!0),f==null||(D=f.onMouseEnter)===null||D===void 0||D.call(f,L)},onMouseLeave:function(L){var D;B(!1),f==null||(D=f.onMouseLeave)===null||D===void 0||D.call(f,L)},onClick:b}),h.createElement("div",{className:"".concat(k,"-content")},u),I&&h.createElement("a",Qe({tabIndex:0,className:"".concat(k,"-close"),onKeyDown:F,"aria-label":"Close"},E,{onClick:function(L){L.preventDefault(),L.stopPropagation(),J()}}),S.closeIcon),x&&h.createElement("progress",{className:"".concat(k,"-progress"),max:"100",value:N},N+"%"))}),hX=ce.createContext({}),p_=function(t){var n=t.children,i=t.classNames;return ce.createElement(hX.Provider,{value:{classNames:i}},n)},aR=8,lR=3,sR=16,b_=function(t){var n={offset:aR,threshold:lR,gap:sR};if(t&&gt(t)==="object"){var i,r,o;n.offset=(i=t.offset)!==null&&i!==void 0?i:aR,n.threshold=(r=t.threshold)!==null&&r!==void 0?r:lR,n.gap=(o=t.gap)!==null&&o!==void 0?o:sR}return[!!t,n]},y_=["className","style","classNames","styles"],Z_=function(t){var n=t.configList,i=t.placement,r=t.prefixCls,o=t.className,a=t.style,l=t.motion,s=t.onAllNoticeRemoved,g=t.onNoticeClose,c=t.stack,u=h.useContext(hX),I=u.classNames,C=h.useRef({}),m=h.useState(null),f=$(m,2),b=f[0],A=f[1],p=h.useState([]),y=$(p,2),Z=y[0],G=y[1],v=n.map(function(w){return{config:w,key:String(w.key)}}),B=b_(c),R=$(B,2),X=R[0],W=R[1],V=W.offset,Y=W.threshold,K=W.gap,M=X&&(Z.length>0||v.length<=Y),H=typeof l=="function"?l(i):l;return h.useEffect(function(){X&&Z.length>1&&G(function(w){return w.filter(function(x){return v.some(function(J){var F=J.key;return x===F})})})},[Z,v,X]),h.useEffect(function(){var w;if(X&&C.current[(w=v[v.length-1])===null||w===void 0?void 0:w.key]){var x;A(C.current[(x=v[v.length-1])===null||x===void 0?void 0:x.key])}},[v,X]),ce.createElement(wP,Qe({key:i,className:he(r,"".concat(r,"-").concat(i),I==null?void 0:I.list,o,se(se({},"".concat(r,"-stack"),!!X),"".concat(r,"-stack-expanded"),M)),style:a,keys:v,motionAppear:!0},H,{onAllRemoved:function(){s(i)}}),function(w,x){var J=w.config,F=w.className,S=w.style,E=w.index,N=J,k=N.key,z=N.times,L=String(k),D=J,j=D.className,ne=D.style,ie=D.classNames,ae=D.styles,Re=Zt(D,y_),de=v.findIndex(function(it){return it.key===L}),Q={};if(X){var O=v.length-1-(de>-1?de:E-1),me=i==="top"||i==="bottom"?"-50%":"0";if(O>0){var Ae,De,ke;Q.height=M?(Ae=C.current[L])===null||Ae===void 0?void 0:Ae.offsetHeight:b==null?void 0:b.offsetHeight;for(var xe=0,Ee=0;Ee<O;Ee++){var We;xe+=((We=C.current[v[v.length-1-Ee].key])===null||We===void 0?void 0:We.offsetHeight)+K}var ze=(M?xe:O*V)*(i.startsWith("top")?1:-1),Ge=!M&&b!==null&&b!==void 0&&b.offsetWidth&&(De=C.current[L])!==null&&De!==void 0&&De.offsetWidth?((b==null?void 0:b.offsetWidth)-V*2*(O<3?O:3))/((ke=C.current[L])===null||ke===void 0?void 0:ke.offsetWidth):1;Q.transform="translate3d(".concat(me,", ").concat(ze,"px, 0) scaleX(").concat(Ge,")")}else Q.transform="translate3d(".concat(me,", 0, 0)")}return ce.createElement("div",{ref:x,className:he("".concat(r,"-notice-wrapper"),F,ie==null?void 0:ie.wrapper),style:te(te(te({},S),Q),ae==null?void 0:ae.wrapper),onMouseEnter:function(){return G(function(Pe){return Pe.includes(L)?Pe:[].concat(Yt(Pe),[L])})},onMouseLeave:function(){return G(function(Pe){return Pe.filter(function(U){return U!==L})})}},ce.createElement(CX,Qe({},Re,{ref:function(Pe){de>-1?C.current[L]=Pe:delete C.current[L]},prefixCls:r,classNames:ie,styles:ae,className:he(j,I==null?void 0:I.notice),style:ne,times:z,key:k,eventKey:k,onNoticeClose:g,hovering:X&&Z.length>0})))})},v_=h.forwardRef(function(e,t){var n=e.prefixCls,i=n===void 0?"rc-notification":n,r=e.container,o=e.motion,a=e.maxCount,l=e.className,s=e.style,g=e.onAllRemoved,c=e.stack,u=e.renderNotifications,I=h.useState([]),C=$(I,2),m=C[0],f=C[1],b=function(X){var W,V=m.find(function(Y){return Y.key===X});V==null||(W=V.onClose)===null||W===void 0||W.call(V),f(function(Y){return Y.filter(function(K){return K.key!==X})})};h.useImperativeHandle(t,function(){return{open:function(X){f(function(W){var V=Yt(W),Y=V.findIndex(function(H){return H.key===X.key}),K=te({},X);if(Y>=0){var M;K.times=(((M=W[Y])===null||M===void 0?void 0:M.times)||0)+1,V[Y]=K}else K.times=0,V.push(K);return a>0&&V.length>a&&(V=V.slice(-a)),V})},close:function(X){b(X)},destroy:function(){f([])}}});var A=h.useState({}),p=$(A,2),y=p[0],Z=p[1];h.useEffect(function(){var R={};m.forEach(function(X){var W=X.placement,V=W===void 0?"topRight":W;V&&(R[V]=R[V]||[],R[V].push(X))}),Object.keys(y).forEach(function(X){R[X]=R[X]||[]}),Z(R)},[m]);var G=function(X){Z(function(W){var V=te({},W),Y=V[X]||[];return Y.length||delete V[X],V})},v=h.useRef(!1);if(h.useEffect(function(){Object.keys(y).length>0?v.current=!0:v.current&&(g==null||g(),v.current=!1)},[y]),!r)return null;var B=Object.keys(y);return _i.createPortal(h.createElement(h.Fragment,null,B.map(function(R){var X=y[R],W=h.createElement(Z_,{key:R,configList:X,placement:R,prefixCls:i,className:l==null?void 0:l(R),style:s==null?void 0:s(R),motion:o,onNoticeClose:b,onAllNoticeRemoved:G,stack:c});return u?u(W,{prefixCls:i,key:R}):W})),r)}),G_=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","stack","renderNotifications"],S_=function(){return document.body},gR=0;function B_(){for(var e={},t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach(function(r){r&&Object.keys(r).forEach(function(o){var a=r[o];a!==void 0&&(e[o]=a)})}),e}function R_(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.getContainer,n=t===void 0?S_:t,i=e.motion,r=e.prefixCls,o=e.maxCount,a=e.className,l=e.style,s=e.onAllRemoved,g=e.stack,c=e.renderNotifications,u=Zt(e,G_),I=h.useState(),C=$(I,2),m=C[0],f=C[1],b=h.useRef(),A=h.createElement(v_,{container:m,ref:b,prefixCls:r,motion:i,maxCount:o,className:a,style:l,onAllRemoved:s,stack:g,renderNotifications:c}),p=h.useState([]),y=$(p,2),Z=y[0],G=y[1],v=h.useMemo(function(){return{open:function(R){var X=B_(u,R);(X.key===null||X.key===void 0)&&(X.key="rc-notification-".concat(gR),gR+=1),G(function(W){return[].concat(Yt(W),[{type:"open",config:X}])})},close:function(R){G(function(X){return[].concat(Yt(X),[{type:"close",key:R}])})},destroy:function(){G(function(R){return[].concat(Yt(R),[{type:"destroy"}])})}}},[]);return h.useEffect(function(){f(n())}),h.useEffect(function(){b.current&&Z.length&&(Z.forEach(function(B){switch(B.type){case"open":b.current.open(B.config);break;case"close":b.current.close(B.key);break;case"destroy":b.current.destroy();break}}),G(function(B){return B.filter(function(R){return!Z.includes(R)})}))},[Z]),[v,A]}var W_={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},k_=function(t,n){return h.createElement(Gr,Qe({},t,{ref:n,icon:W_}))},mX=h.forwardRef(k_);const V_=100,w_=10,x_=V_*w_,X_=e=>{const{componentCls:t,iconCls:n,boxShadow:i,colorText:r,colorSuccess:o,colorError:a,colorWarning:l,colorInfo:s,fontSizeLG:g,motionEaseInOutCirc:c,motionDurationSlow:u,marginXS:I,paddingXS:C,borderRadiusLG:m,zIndexPopup:f,contentPadding:b,contentBg:A}=e,p=`${t}-notice`,y=new Ni("MessageMoveIn",{"0%":{padding:0,transform:"translateY(-100%)",opacity:0},"100%":{padding:C,transform:"translateY(0)",opacity:1}}),Z=new Ni("MessageMoveOut",{"0%":{maxHeight:e.height,padding:C,opacity:1},"100%":{maxHeight:0,padding:0,opacity:0}}),G={padding:C,textAlign:"center",[`${t}-custom-content`]:{display:"flex",alignItems:"center"},[`${t}-custom-content > ${n}`]:{marginInlineEnd:I,fontSize:g},[`${p}-content`]:{display:"inline-block",padding:b,background:A,borderRadius:m,boxShadow:i,pointerEvents:"all"},[`${t}-success > ${n}`]:{color:o},[`${t}-error > ${n}`]:{color:a},[`${t}-warning > ${n}`]:{color:l},[`${t}-info > ${n},
      ${t}-loading > ${n}`]:{color:s}};return[{[t]:Object.assign(Object.assign({},Ju(e)),{color:r,position:"fixed",top:I,width:"100%",pointerEvents:"none",zIndex:f,[`${t}-move-up`]:{animationFillMode:"forwards"},[`
        ${t}-move-up-appear,
        ${t}-move-up-enter
      `]:{animationName:y,animationDuration:u,animationPlayState:"paused",animationTimingFunction:c},[`
        ${t}-move-up-appear${t}-move-up-appear-active,
        ${t}-move-up-enter${t}-move-up-enter-active
      `]:{animationPlayState:"running"},[`${t}-move-up-leave`]:{animationName:Z,animationDuration:u,animationPlayState:"paused",animationTimingFunction:c},[`${t}-move-up-leave${t}-move-up-leave-active`]:{animationPlayState:"running"},"&-rtl":{direction:"rtl",span:{direction:"rtl"}}})},{[t]:{[`${p}-wrapper`]:Object.assign({},G)}},{[`${t}-notice-pure-panel`]:Object.assign(Object.assign({},G),{padding:0,textAlign:"start"})}]},J_=e=>({zIndexPopup:e.zIndexPopupBase+x_+10,contentBg:e.colorBgElevated,contentPadding:`${(e.controlHeightLG-e.fontSize*e.lineHeight)/2}px ${e.paddingSM}px`}),AX=bl("Message",e=>{const t=nr(e,{height:150});return[X_(t)]},J_);var Y_=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const N_={info:h.createElement(c_,null),success:h.createElement($P,null),error:h.createElement(n_,null),warning:h.createElement(l_,null),loading:h.createElement(mX,null)},fX=e=>{let{prefixCls:t,type:n,icon:i,children:r}=e;return h.createElement("div",{className:he(`${t}-custom-content`,`${t}-${n}`)},i||N_[n],h.createElement("span",null,r))},H_=e=>{const{prefixCls:t,className:n,type:i,icon:r,content:o}=e,a=Y_(e,["prefixCls","className","type","icon","content"]),{getPrefixCls:l}=h.useContext(Pt),s=t||l("message"),g=gZ(s),[c,u,I]=AX(s,g);return c(h.createElement(CX,Object.assign({},a,{prefixCls:s,className:he(n,u,`${s}-notice-pure-panel`,I,g),eventKey:"pure",duration:null,content:h.createElement(fX,{prefixCls:s,type:i,icon:r},o)})))};function F_(e,t){return{motionName:t??`${e}-move-up`}}function cZ(e){let t;const n=new Promise(r=>{t=e(()=>{r(!0)})}),i=()=>{t==null||t()};return i.then=(r,o)=>n.then(r,o),i.promise=n,i}var K_=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const E_=8,M_=3,z_=e=>{let{children:t,prefixCls:n}=e;const i=gZ(n),[r,o,a]=AX(n,i);return r(h.createElement(p_,{classNames:{list:he(o,a,i)}},t))},L_=(e,t)=>{let{prefixCls:n,key:i}=t;return h.createElement(z_,{prefixCls:n,key:i},e)},D_=h.forwardRef((e,t)=>{const{top:n,prefixCls:i,getContainer:r,maxCount:o,duration:a=M_,rtl:l,transitionName:s,onAllRemoved:g}=e,{getPrefixCls:c,getPopupContainer:u,message:I,direction:C}=h.useContext(Pt),m=i||c("message"),f=()=>({left:"50%",transform:"translateX(-50%)",top:n??E_}),b=()=>he({[`${m}-rtl`]:l??C==="rtl"}),A=()=>F_(m,s),p=h.createElement("span",{className:`${m}-close-x`},h.createElement(dX,{className:`${m}-close-icon`})),[y,Z]=R_({prefixCls:m,style:f,className:b,motion:A,closable:!1,closeIcon:p,duration:a,getContainer:()=>(r==null?void 0:r())||(u==null?void 0:u())||document.body,maxCount:o,onAllRemoved:g,renderNotifications:L_});return h.useImperativeHandle(t,()=>Object.assign(Object.assign({},y),{prefixCls:m,message:I})),Z});let cR=0;function pX(e){const t=h.useRef(null);return[h.useMemo(()=>{const i=s=>{var g;(g=t.current)===null||g===void 0||g.close(s)},r=s=>{if(!t.current){const v=()=>{};return v.then=()=>{},v}const{open:g,prefixCls:c,message:u}=t.current,I=`${c}-notice`,{content:C,icon:m,type:f,key:b,className:A,style:p,onClose:y}=s,Z=K_(s,["content","icon","type","key","className","style","onClose"]);let G=b;return G==null&&(cR+=1,G=`antd-message-${cR}`),cZ(v=>(g(Object.assign(Object.assign({},Z),{key:G,content:h.createElement(fX,{prefixCls:c,type:f,icon:m},C),placement:"top",className:he(f&&`${I}-${f}`,A,u==null?void 0:u.className),style:Object.assign(Object.assign({},u==null?void 0:u.style),p),onClose:()=>{y==null||y(),v()}})),()=>{i(G)}))},a={open:r,destroy:s=>{var g;s!==void 0?i(s):(g=t.current)===null||g===void 0||g.destroy()}};return["info","success","warning","error","loading"].forEach(s=>{const g=(c,u,I)=>{let C;c&&typeof c=="object"&&"content"in c?C=c:C={content:c};let m,f;typeof u=="function"?f=u:(m=u,f=I);const b=Object.assign(Object.assign({onClose:f,duration:m},C),{type:s});return r(b)};a[s]=g}),a},[]),h.createElement(D_,Object.assign({key:"message-holder"},e,{ref:t}))]}function T_(e){return pX(e)}function lu(){lu=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(w,x,J){w[x]=J.value},o=typeof Symbol=="function"?Symbol:{},a=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function g(w,x,J){return Object.defineProperty(w,x,{value:J,enumerable:!0,configurable:!0,writable:!0}),w[x]}try{g({},"")}catch{g=function(J,F,S){return J[F]=S}}function c(w,x,J,F){var S=x&&x.prototype instanceof A?x:A,E=Object.create(S.prototype),N=new M(F||[]);return r(E,"_invoke",{value:W(w,J,N)}),E}function u(w,x,J){try{return{type:"normal",arg:w.call(x,J)}}catch(F){return{type:"throw",arg:F}}}t.wrap=c;var I="suspendedStart",C="suspendedYield",m="executing",f="completed",b={};function A(){}function p(){}function y(){}var Z={};g(Z,a,function(){return this});var G=Object.getPrototypeOf,v=G&&G(G(H([])));v&&v!==n&&i.call(v,a)&&(Z=v);var B=y.prototype=A.prototype=Object.create(Z);function R(w){["next","throw","return"].forEach(function(x){g(w,x,function(J){return this._invoke(x,J)})})}function X(w,x){function J(S,E,N,k){var z=u(w[S],w,E);if(z.type!=="throw"){var L=z.arg,D=L.value;return D&&gt(D)=="object"&&i.call(D,"__await")?x.resolve(D.__await).then(function(j){J("next",j,N,k)},function(j){J("throw",j,N,k)}):x.resolve(D).then(function(j){L.value=j,N(L)},function(j){return J("throw",j,N,k)})}k(z.arg)}var F;r(this,"_invoke",{value:function(E,N){function k(){return new x(function(z,L){J(E,N,z,L)})}return F=F?F.then(k,k):k()}})}function W(w,x,J){var F=I;return function(S,E){if(F===m)throw Error("Generator is already running");if(F===f){if(S==="throw")throw E;return{value:e,done:!0}}for(J.method=S,J.arg=E;;){var N=J.delegate;if(N){var k=V(N,J);if(k){if(k===b)continue;return k}}if(J.method==="next")J.sent=J._sent=J.arg;else if(J.method==="throw"){if(F===I)throw F=f,J.arg;J.dispatchException(J.arg)}else J.method==="return"&&J.abrupt("return",J.arg);F=m;var z=u(w,x,J);if(z.type==="normal"){if(F=J.done?f:C,z.arg===b)continue;return{value:z.arg,done:J.done}}z.type==="throw"&&(F=f,J.method="throw",J.arg=z.arg)}}}function V(w,x){var J=x.method,F=w.iterator[J];if(F===e)return x.delegate=null,J==="throw"&&w.iterator.return&&(x.method="return",x.arg=e,V(w,x),x.method==="throw")||J!=="return"&&(x.method="throw",x.arg=new TypeError("The iterator does not provide a '"+J+"' method")),b;var S=u(F,w.iterator,x.arg);if(S.type==="throw")return x.method="throw",x.arg=S.arg,x.delegate=null,b;var E=S.arg;return E?E.done?(x[w.resultName]=E.value,x.next=w.nextLoc,x.method!=="return"&&(x.method="next",x.arg=e),x.delegate=null,b):E:(x.method="throw",x.arg=new TypeError("iterator result is not an object"),x.delegate=null,b)}function Y(w){var x={tryLoc:w[0]};1 in w&&(x.catchLoc=w[1]),2 in w&&(x.finallyLoc=w[2],x.afterLoc=w[3]),this.tryEntries.push(x)}function K(w){var x=w.completion||{};x.type="normal",delete x.arg,w.completion=x}function M(w){this.tryEntries=[{tryLoc:"root"}],w.forEach(Y,this),this.reset(!0)}function H(w){if(w||w===""){var x=w[a];if(x)return x.call(w);if(typeof w.next=="function")return w;if(!isNaN(w.length)){var J=-1,F=function S(){for(;++J<w.length;)if(i.call(w,J))return S.value=w[J],S.done=!1,S;return S.value=e,S.done=!0,S};return F.next=F}}throw new TypeError(gt(w)+" is not iterable")}return p.prototype=y,r(B,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:p,configurable:!0}),p.displayName=g(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(w){var x=typeof w=="function"&&w.constructor;return!!x&&(x===p||(x.displayName||x.name)==="GeneratorFunction")},t.mark=function(w){return Object.setPrototypeOf?Object.setPrototypeOf(w,y):(w.__proto__=y,g(w,s,"GeneratorFunction")),w.prototype=Object.create(B),w},t.awrap=function(w){return{__await:w}},R(X.prototype),g(X.prototype,l,function(){return this}),t.AsyncIterator=X,t.async=function(w,x,J,F,S){S===void 0&&(S=Promise);var E=new X(c(w,x,J,F),S);return t.isGeneratorFunction(x)?E:E.next().then(function(N){return N.done?N.value:E.next()})},R(B),g(B,s,"Generator"),g(B,a,function(){return this}),g(B,"toString",function(){return"[object Generator]"}),t.keys=function(w){var x=Object(w),J=[];for(var F in x)J.push(F);return J.reverse(),function S(){for(;J.length;){var E=J.pop();if(E in x)return S.value=E,S.done=!1,S}return S.done=!0,S}},t.values=H,M.prototype={constructor:M,reset:function(x){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(K),!x)for(var J in this)J.charAt(0)==="t"&&i.call(this,J)&&!isNaN(+J.slice(1))&&(this[J]=e)},stop:function(){this.done=!0;var x=this.tryEntries[0].completion;if(x.type==="throw")throw x.arg;return this.rval},dispatchException:function(x){if(this.done)throw x;var J=this;function F(L,D){return N.type="throw",N.arg=x,J.next=L,D&&(J.method="next",J.arg=e),!!D}for(var S=this.tryEntries.length-1;S>=0;--S){var E=this.tryEntries[S],N=E.completion;if(E.tryLoc==="root")return F("end");if(E.tryLoc<=this.prev){var k=i.call(E,"catchLoc"),z=i.call(E,"finallyLoc");if(k&&z){if(this.prev<E.catchLoc)return F(E.catchLoc,!0);if(this.prev<E.finallyLoc)return F(E.finallyLoc)}else if(k){if(this.prev<E.catchLoc)return F(E.catchLoc,!0)}else{if(!z)throw Error("try statement without catch or finally");if(this.prev<E.finallyLoc)return F(E.finallyLoc)}}}},abrupt:function(x,J){for(var F=this.tryEntries.length-1;F>=0;--F){var S=this.tryEntries[F];if(S.tryLoc<=this.prev&&i.call(S,"finallyLoc")&&this.prev<S.finallyLoc){var E=S;break}}E&&(x==="break"||x==="continue")&&E.tryLoc<=J&&J<=E.finallyLoc&&(E=null);var N=E?E.completion:{};return N.type=x,N.arg=J,E?(this.method="next",this.next=E.finallyLoc,b):this.complete(N)},complete:function(x,J){if(x.type==="throw")throw x.arg;return x.type==="break"||x.type==="continue"?this.next=x.arg:x.type==="return"?(this.rval=this.arg=x.arg,this.method="return",this.next="end"):x.type==="normal"&&J&&(this.next=J),b},finish:function(x){for(var J=this.tryEntries.length-1;J>=0;--J){var F=this.tryEntries[J];if(F.finallyLoc===x)return this.complete(F.completion,F.afterLoc),K(F),b}},catch:function(x){for(var J=this.tryEntries.length-1;J>=0;--J){var F=this.tryEntries[J];if(F.tryLoc===x){var S=F.completion;if(S.type==="throw"){var E=S.arg;K(F)}return E}}throw Error("illegal catch attempt")},delegateYield:function(x,J,F){return this.delegate={iterator:H(x),resultName:J,nextLoc:F},this.method==="next"&&(this.arg=e),b}},t}function uR(e,t,n,i,r,o,a){try{var l=e[o](a),s=l.value}catch(g){return void n(g)}l.done?t(s):Promise.resolve(s).then(i,r)}function bX(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function a(s){uR(o,i,r,a,l,"next",s)}function l(s){uR(o,i,r,a,l,"throw",s)}a(void 0)})}}var Yu=te({},t9),j_=Yu.version,DA=Yu.render,U_=Yu.unmountComponentAtNode,om;try{var Q_=Number((j_||"").split(".")[0]);Q_>=18&&(om=Yu.createRoot)}catch{}function IR(e){var t=Yu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;t&&gt(t)==="object"&&(t.usingClientEntryPoint=e)}var JC="__rc_react_root__";function P_(e,t){IR(!0);var n=t[JC]||om(t);IR(!1),n.render(e),t[JC]=n}function __(e,t){DA==null||DA(e,t)}function O_(e,t){if(om){P_(e,t);return}__(e,t)}function q_(e){return Rb.apply(this,arguments)}function Rb(){return Rb=bX(lu().mark(function e(t){return lu().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.resolve().then(function(){var r;(r=t[JC])===null||r===void 0||r.unmount(),delete t[JC]}));case 1:case"end":return i.stop()}},e)})),Rb.apply(this,arguments)}function $_(e){U_(e)}function eO(e){return Wb.apply(this,arguments)}function Wb(){return Wb=bX(lu().mark(function e(t){return lu().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(om===void 0){i.next=2;break}return i.abrupt("return",q_(t));case 2:$_(t);case 3:case"end":return i.stop()}},e)})),Wb.apply(this,arguments)}const tO=(e,t)=>(O_(e,t),()=>eO(t));let nO=tO;function yX(){return nO}const iO=(e,t,n)=>`${e}-${t}`,uZ=function(e){if(!e)return!1;if(e instanceof Element){if(e.offsetParent)return!0;if(e.getBBox){var t=e.getBBox(),n=t.width,i=t.height;if(n||i)return!0}if(e.getBoundingClientRect){var r=e.getBoundingClientRect(),o=r.width,a=r.height;if(o||a)return!0}}return!1},rO=e=>{const{componentCls:t,colorPrimary:n}=e;return{[t]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${n})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${e.motionEaseOutCirc}`,`opacity 2s ${e.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow ${e.motionDurationSlow} ${e.motionEaseInOut}`,`opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`].join(",")}}}}},oO=iP("Wave",e=>[rO(e)]),ZX=`${kC}-wave-target`;function TA(e){return e&&e!=="#fff"&&e!=="#ffffff"&&e!=="rgb(255, 255, 255)"&&e!=="rgba(255, 255, 255, 1)"&&!/rgba\((?:\d*, ){3}0\)/.test(e)&&e!=="transparent"}function aO(e){const{borderTopColor:t,borderColor:n,backgroundColor:i}=getComputedStyle(e);return TA(t)?t:TA(n)?n:TA(i)?i:null}function jA(e){return Number.isNaN(e)?0:e}const lO=e=>{const{className:t,target:n,component:i,registerUnmount:r}=e,o=h.useRef(null),a=h.useRef(null);h.useEffect(()=>{a.current=r()},[]);const[l,s]=h.useState(null),[g,c]=h.useState([]),[u,I]=h.useState(0),[C,m]=h.useState(0),[f,b]=h.useState(0),[A,p]=h.useState(0),[y,Z]=h.useState(!1),G={left:u,top:C,width:f,height:A,borderRadius:g.map(R=>`${R}px`).join(" ")};l&&(G["--wave-color"]=l);function v(){const R=getComputedStyle(n);s(aO(n));const X=R.position==="static",{borderLeftWidth:W,borderTopWidth:V}=R;I(X?n.offsetLeft:jA(-parseFloat(W))),m(X?n.offsetTop:jA(-parseFloat(V))),b(n.offsetWidth),p(n.offsetHeight);const{borderTopLeftRadius:Y,borderTopRightRadius:K,borderBottomLeftRadius:M,borderBottomRightRadius:H}=R;c([Y,K,H,M].map(w=>jA(parseFloat(w))))}if(h.useEffect(()=>{if(n){const R=On(()=>{v(),Z(!0)});let X;return typeof ResizeObserver<"u"&&(X=new ResizeObserver(v),X.observe(n)),()=>{On.cancel(R),X==null||X.disconnect()}}},[]),!y)return null;const B=(i==="Checkbox"||i==="Radio")&&(n==null?void 0:n.classList.contains(ZX));return h.createElement(yl,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(R,X)=>{var W,V;if(X.deadline||X.propertyName==="opacity"){const Y=(W=o.current)===null||W===void 0?void 0:W.parentElement;(V=a.current)===null||V===void 0||V.call(a).then(()=>{Y==null||Y.remove()})}return!1}},(R,X)=>{let{className:W}=R;return h.createElement("div",{ref:Ps(o,X),className:he(t,W,{"wave-quick":B}),style:G})})},sO=(e,t)=>{var n;const{component:i}=t;if(i==="Checkbox"&&!(!((n=e.querySelector("input"))===null||n===void 0)&&n.checked))return;const r=document.createElement("div");r.style.position="absolute",r.style.left="0px",r.style.top="0px",e==null||e.insertBefore(r,e==null?void 0:e.firstChild);const o=yX();let a=null;function l(){return a}a=o(h.createElement(lO,Object.assign({},t,{target:e,registerUnmount:l})),r)},gO=(e,t,n)=>{const{wave:i}=h.useContext(Pt),[,r,o]=$s(),a=oi(g=>{const c=e.current;if(i!=null&&i.disabled||!c)return;const u=c.querySelector(`.${ZX}`)||c,{showEffect:I}=i||{};(I||sO)(u,{className:t,token:r,component:n,event:g,hashId:o})}),l=h.useRef(null);return g=>{On.cancel(l.current),l.current=On(()=>{a(g)})}},cO=e=>{const{children:t,disabled:n,component:i}=e,{getPrefixCls:r}=h.useContext(Pt),o=h.useRef(null),a=r("wave"),[,l]=oO(a),s=gO(o,he(a,l),i);if(ce.useEffect(()=>{const c=o.current;if(!c||c.nodeType!==1||n)return;const u=I=>{!uZ(I.target)||!c.getAttribute||c.getAttribute("disabled")||c.disabled||c.className.includes("disabled")||c.className.includes("-leave")||s(I)};return c.addEventListener("click",u,!0),()=>{c.removeEventListener("click",u,!0)}},[n]),!ce.isValidElement(t))return t??null;const g=Al(t)?Ps(Os(t),o):o;return sZ(t,{ref:g})},am=e=>{const t=ce.useContext(Hs);return ce.useMemo(()=>e?typeof e=="string"?e??t:e instanceof Function?e(t):t:t,[e,t])},uO=e=>{const{componentCls:t}=e;return{[t]:{"&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"}}}},IO=e=>{const{componentCls:t,antCls:n}=e;return{[t]:{display:"inline-flex","&-rtl":{direction:"rtl"},"&-vertical":{flexDirection:"column"},"&-align":{flexDirection:"column","&-center":{alignItems:"center"},"&-start":{alignItems:"flex-start"},"&-end":{alignItems:"flex-end"},"&-baseline":{alignItems:"baseline"}},[`${t}-item:empty`]:{display:"none"},[`${t}-item > ${n}-badge-not-a-wrapper:only-child`]:{display:"block"}}}},dO=e=>{const{componentCls:t}=e;return{[t]:{"&-gap-row-small":{rowGap:e.spaceGapSmallSize},"&-gap-row-middle":{rowGap:e.spaceGapMiddleSize},"&-gap-row-large":{rowGap:e.spaceGapLargeSize},"&-gap-col-small":{columnGap:e.spaceGapSmallSize},"&-gap-col-middle":{columnGap:e.spaceGapMiddleSize},"&-gap-col-large":{columnGap:e.spaceGapLargeSize}}}},vX=bl("Space",e=>{const t=nr(e,{spaceGapSmallSize:e.paddingXS,spaceGapMiddleSize:e.padding,spaceGapLargeSize:e.paddingLG});return[IO(t),dO(t),uO(t)]},()=>({}),{resetStyle:!1});var GX=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const IZ=h.createContext(null),CO=(e,t)=>{const n=h.useContext(IZ),i=h.useMemo(()=>{if(!n)return"";const{compactDirection:r,isFirstItem:o,isLastItem:a}=n,l=r==="vertical"?"-vertical-":"-";return he(`${e}-compact${l}item`,{[`${e}-compact${l}first-item`]:o,[`${e}-compact${l}last-item`]:a,[`${e}-compact${l}item-rtl`]:t==="rtl"})},[e,t,n]);return{compactSize:n==null?void 0:n.compactSize,compactDirection:n==null?void 0:n.compactDirection,compactItemClassnames:i}},hO=e=>{var{children:t}=e,n=GX(e,["children"]);return h.createElement(IZ.Provider,{value:n},t)},mO=e=>{const{getPrefixCls:t,direction:n}=h.useContext(Pt),{size:i,direction:r,block:o,prefixCls:a,className:l,rootClassName:s,children:g}=e,c=GX(e,["size","direction","block","prefixCls","className","rootClassName","children"]),u=am(y=>i??y),I=t("space-compact",a),[C,m]=vX(I),f=he(I,m,{[`${I}-rtl`]:n==="rtl",[`${I}-block`]:o,[`${I}-vertical`]:r==="vertical"},l,s),b=h.useContext(IZ),A=sl(g),p=h.useMemo(()=>A.map((y,Z)=>{const G=(y==null?void 0:y.key)||`${I}-item-${Z}`;return h.createElement(hO,{key:G,compactSize:u,compactDirection:r,isFirstItem:Z===0&&(!b||(b==null?void 0:b.isFirstItem)),isLastItem:Z===A.length-1&&(!b||(b==null?void 0:b.isLastItem))},y)}),[i,A,b]);return A.length===0?null:C(h.createElement("div",Object.assign({className:f},c),p))};var AO=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const SX=h.createContext(void 0),fO=e=>{const{getPrefixCls:t,direction:n}=h.useContext(Pt),{prefixCls:i,size:r,className:o}=e,a=AO(e,["prefixCls","size","className"]),l=t("btn-group",i),[,,s]=$s();let g="";switch(r){case"large":g="lg";break;case"small":g="sm";break}const c=he(l,{[`${l}-${g}`]:g,[`${l}-rtl`]:n==="rtl"},o,s);return h.createElement(SX.Provider,{value:r},h.createElement("div",Object.assign({},a,{className:c})))},dR=/^[\u4E00-\u9FA5]{2}$/,kb=dR.test.bind(dR);function CR(e){return typeof e=="string"}function UA(e){return e==="text"||e==="link"}function pO(e,t){if(e==null)return;const n=t?" ":"";return typeof e!="string"&&typeof e!="number"&&CR(e.type)&&kb(e.props.children)?sZ(e,{children:e.props.children.split("").join(n)}):CR(e)?kb(e)?ce.createElement("span",null,e.split("").join(n)):ce.createElement("span",null,e):A_(e)?ce.createElement("span",null,e):e}function bO(e,t){let n=!1;const i=[];return ce.Children.forEach(e,r=>{const o=typeof r,a=o==="string"||o==="number";if(n&&a){const l=i.length-1,s=i[l];i[l]=`${s}${r}`}else i.push(r);n=a}),ce.Children.map(i,r=>pO(r,t))}["default","primary","danger"].concat(Yt(Dx));const Vb=h.forwardRef((e,t)=>{const{className:n,style:i,children:r,prefixCls:o}=e,a=he(`${o}-icon`,n);return ce.createElement("span",{ref:t,className:a,style:i},r)}),hR=h.forwardRef((e,t)=>{const{prefixCls:n,className:i,style:r,iconClassName:o}=e,a=he(`${n}-loading-icon`,i);return ce.createElement(Vb,{prefixCls:n,className:a,style:r,ref:t},ce.createElement(mX,{className:o}))}),QA=()=>({width:0,opacity:0,transform:"scale(0)"}),PA=e=>({width:e.scrollWidth,opacity:1,transform:"scale(1)"}),yO=e=>{const{prefixCls:t,loading:n,existIcon:i,className:r,style:o,mount:a}=e,l=!!n;return i?ce.createElement(hR,{prefixCls:t,className:r,style:o}):ce.createElement(yl,{visible:l,motionName:`${t}-loading-icon-motion`,motionAppear:!a,motionEnter:!a,motionLeave:!a,removeOnLeave:!0,onAppearStart:QA,onAppearActive:PA,onEnterStart:QA,onEnterActive:PA,onLeaveStart:PA,onLeaveActive:QA},(s,g)=>{let{className:c,style:u}=s;const I=Object.assign(Object.assign({},o),u);return ce.createElement(hR,{prefixCls:t,className:he(r,c),style:I,ref:g})})},mR=(e,t)=>({[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineEndColor:t}}},"&:not(:first-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineStartColor:t}}}}}),ZO=e=>{const{componentCls:t,fontSize:n,lineWidth:i,groupBorderColor:r,colorErrorHover:o}=e;return{[`${t}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${t}`]:{"&:not(:last-child)":{[`&, & > ${t}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:e.calc(i).mul(-1).equal(),[`&, & > ${t}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[t]:{position:"relative",zIndex:1,"&:hover, &:focus, &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${t}-icon-only`]:{fontSize:n}},mR(`${t}-primary`,r),mR(`${t}-danger`,o)]}};var vO=["b"],GO=["v"],_A=function(t){return Math.round(Number(t||0))},SO=function(t){if(t instanceof an)return t;if(t&&gt(t)==="object"&&"h"in t&&"b"in t){var n=t,i=n.b,r=Zt(n,vO);return te(te({},r),{},{v:i})}return typeof t=="string"&&/hsb/.test(t)?t.replace(/hsb/,"hsv"):t},su=function(e){fl(n,e);var t=pl(n);function n(i){return Zi(this,n),t.call(this,SO(i))}return vi(n,[{key:"toHsbString",value:function(){var r=this.toHsb(),o=_A(r.s*100),a=_A(r.b*100),l=_A(r.h),s=r.a,g="hsb(".concat(l,", ").concat(o,"%, ").concat(a,"%)"),c="hsba(".concat(l,", ").concat(o,"%, ").concat(a,"%, ").concat(s.toFixed(s===0?0:2),")");return s===1?g:c}},{key:"toHsb",value:function(){var r=this.toHsv(),o=r.v,a=Zt(r,GO);return te(te({},a),{},{b:o,a:this.a})}}]),n}(an),BO=function(t){return t instanceof su?t:new su(t)};BO("#1677ff");const RO=(e,t)=>(e==null?void 0:e.replace(/[^\w/]/g,"").slice(0,t?8:6))||"",WO=(e,t)=>e?RO(e,t):"";let kO=function(){function e(t){Zi(this,e);var n;if(this.cleared=!1,t instanceof e){this.metaColor=t.metaColor.clone(),this.colors=(n=t.colors)===null||n===void 0?void 0:n.map(r=>({color:new e(r.color),percent:r.percent})),this.cleared=t.cleared;return}const i=Array.isArray(t);i&&t.length?(this.colors=t.map(r=>{let{color:o,percent:a}=r;return{color:new e(o),percent:a}}),this.metaColor=new su(this.colors[0].color.metaColor)):this.metaColor=new su(i?"":t),(!t||i&&!this.colors)&&(this.metaColor=this.metaColor.setA(0),this.cleared=!0)}return vi(e,[{key:"toHsb",value:function(){return this.metaColor.toHsb()}},{key:"toHsbString",value:function(){return this.metaColor.toHsbString()}},{key:"toHex",value:function(){return WO(this.toHexString(),this.metaColor.a<1)}},{key:"toHexString",value:function(){return this.metaColor.toHexString()}},{key:"toRgb",value:function(){return this.metaColor.toRgb()}},{key:"toRgbString",value:function(){return this.metaColor.toRgbString()}},{key:"isGradient",value:function(){return!!this.colors&&!this.cleared}},{key:"getColors",value:function(){return this.colors||[{color:this,percent:0}]}},{key:"toCssString",value:function(){const{colors:n}=this;return n?`linear-gradient(90deg, ${n.map(r=>`${r.color.toRgbString()} ${r.percent}%`).join(", ")})`:this.metaColor.toRgbString()}},{key:"equals",value:function(n){return!n||this.isGradient()!==n.isGradient()?!1:this.isGradient()?this.colors.length===n.colors.length&&this.colors.every((i,r)=>{const o=n.colors[r];return i.percent===o.percent&&i.color.equals(o.color)}):this.toHexString()===n.toHexString()}}])}();const VO=e=>({animationDuration:e,animationFillMode:"both"}),wO=e=>({animationDuration:e,animationFillMode:"both"}),xO=function(e,t,n,i){const o=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${o}${e}-enter,
      ${o}${e}-appear
    `]:Object.assign(Object.assign({},VO(i)),{animationPlayState:"paused"}),[`${o}${e}-leave`]:Object.assign(Object.assign({},wO(i)),{animationPlayState:"paused"}),[`
      ${o}${e}-enter${e}-enter-active,
      ${o}${e}-appear${e}-appear-active
    `]:{animationName:t,animationPlayState:"running"},[`${o}${e}-leave${e}-leave-active`]:{animationName:n,animationPlayState:"running",pointerEvents:"none"}}},XO=new Ni("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),JO=new Ni("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),YO=new Ni("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),NO=new Ni("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),HO=new Ni("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),FO=new Ni("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),KO=new Ni("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),EO=new Ni("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),MO={"slide-up":{inKeyframes:XO,outKeyframes:JO},"slide-down":{inKeyframes:YO,outKeyframes:NO},"slide-left":{inKeyframes:HO,outKeyframes:FO},"slide-right":{inKeyframes:KO,outKeyframes:EO}},AR=(e,t)=>{const{antCls:n}=e,i=`${n}-${t}`,{inKeyframes:r,outKeyframes:o}=MO[t];return[xO(i,r,o,e.motionDurationMid),{[`
      ${i}-enter,
      ${i}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:e.motionEaseOutQuint,"&-prepare":{transform:"scale(1)"}},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInQuint}}]},zO=(e,t)=>{const{r:n,g:i,b:r,a:o}=e.toRgb(),a=new su(e.toRgbString()).onBackground(t).toHsv();return o<=.5?a.v>.5:n*.299+i*.587+r*.114>192},BX=e=>{const{paddingInline:t,onlyIconSize:n}=e;return nr(e,{buttonPaddingHorizontal:t,buttonPaddingVertical:0,buttonIconOnlyFontSize:n})},RX=e=>{var t,n,i,r,o,a;const l=(t=e.contentFontSize)!==null&&t!==void 0?t:e.fontSize,s=(n=e.contentFontSizeSM)!==null&&n!==void 0?n:e.fontSize,g=(i=e.contentFontSizeLG)!==null&&i!==void 0?i:e.fontSizeLG,c=(r=e.contentLineHeight)!==null&&r!==void 0?r:wd(l),u=(o=e.contentLineHeightSM)!==null&&o!==void 0?o:wd(s),I=(a=e.contentLineHeightLG)!==null&&a!==void 0?a:wd(g),C=zO(new kO(e.colorBgSolid),"#fff")?"#000":"#fff";return{fontWeight:400,defaultShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlTmpOutline}`,primaryShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlOutline}`,dangerShadow:`0 ${e.controlOutlineWidth}px 0 ${e.colorErrorOutline}`,primaryColor:e.colorTextLightSolid,dangerColor:e.colorTextLightSolid,borderColorDisabled:e.colorBorder,defaultGhostColor:e.colorBgContainer,ghostBg:"transparent",defaultGhostBorderColor:e.colorBgContainer,paddingInline:e.paddingContentHorizontal-e.lineWidth,paddingInlineLG:e.paddingContentHorizontal-e.lineWidth,paddingInlineSM:8-e.lineWidth,onlyIconSize:e.fontSizeLG,onlyIconSizeSM:e.fontSizeLG-2,onlyIconSizeLG:e.fontSizeLG+2,groupBorderColor:e.colorPrimaryHover,linkHoverBg:"transparent",textTextColor:e.colorText,textTextHoverColor:e.colorText,textTextActiveColor:e.colorText,textHoverBg:e.colorFillTertiary,defaultColor:e.colorText,defaultBg:e.colorBgContainer,defaultBorderColor:e.colorBorder,defaultBorderColorDisabled:e.colorBorder,defaultHoverBg:e.colorBgContainer,defaultHoverColor:e.colorPrimaryHover,defaultHoverBorderColor:e.colorPrimaryHover,defaultActiveBg:e.colorBgContainer,defaultActiveColor:e.colorPrimaryActive,defaultActiveBorderColor:e.colorPrimaryActive,solidTextColor:C,contentFontSize:l,contentFontSizeSM:s,contentFontSizeLG:g,contentLineHeight:c,contentLineHeightSM:u,contentLineHeightLG:I,paddingBlock:Math.max((e.controlHeight-l*c)/2-e.lineWidth,0),paddingBlockSM:Math.max((e.controlHeightSM-s*u)/2-e.lineWidth,0),paddingBlockLG:Math.max((e.controlHeightLG-g*I)/2-e.lineWidth,0)}},LO=e=>{const{componentCls:t,iconCls:n,fontWeight:i,opacityLoading:r,motionDurationSlow:o,motionEaseInOut:a,marginXS:l,calc:s}=e;return{[t]:{outline:"none",position:"relative",display:"inline-flex",gap:e.marginXS,alignItems:"center",justifyContent:"center",fontWeight:i,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",background:"transparent",border:`${Ve(e.lineWidth)} ${e.lineType} transparent`,cursor:"pointer",transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",color:e.colorText,"&:disabled > *":{pointerEvents:"none"},[`${t}-icon > svg`]:Qx(),"> a":{color:"currentColor"},"&:not(:disabled)":wC(e),[`&${t}-two-chinese-chars::first-letter`]:{letterSpacing:"0.34em"},[`&${t}-two-chinese-chars > *:not(${n})`]:{marginInlineEnd:"-0.34em",letterSpacing:"0.34em"},[`&${t}-icon-only`]:{paddingInline:0,[`&${t}-compact-item`]:{flex:"none"},[`&${t}-round`]:{width:"auto"}},[`&${t}-loading`]:{opacity:r,cursor:"default"},[`${t}-loading-icon`]:{transition:["width","opacity","margin"].map(g=>`${g} ${o} ${a}`).join(",")},[`&:not(${t}-icon-end)`]:{[`${t}-loading-icon-motion`]:{"&-appear-start, &-enter-start":{marginInlineEnd:s(l).mul(-1).equal()},"&-appear-active, &-enter-active":{marginInlineEnd:0},"&-leave-start":{marginInlineEnd:0},"&-leave-active":{marginInlineEnd:s(l).mul(-1).equal()}}},"&-icon-end":{flexDirection:"row-reverse",[`${t}-loading-icon-motion`]:{"&-appear-start, &-enter-start":{marginInlineStart:s(l).mul(-1).equal()},"&-appear-active, &-enter-active":{marginInlineStart:0},"&-leave-start":{marginInlineStart:0},"&-leave-active":{marginInlineStart:s(l).mul(-1).equal()}}}}}},WX=(e,t,n)=>({[`&:not(:disabled):not(${e}-disabled)`]:{"&:hover":t,"&:active":n}}),DO=e=>({minWidth:e.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),TO=e=>({borderRadius:e.controlHeight,paddingInlineStart:e.calc(e.controlHeight).div(2).equal(),paddingInlineEnd:e.calc(e.controlHeight).div(2).equal()}),jO=e=>({cursor:"not-allowed",borderColor:e.borderColorDisabled,color:e.colorTextDisabled,background:e.colorBgContainerDisabled,boxShadow:"none"}),dZ=(e,t,n,i,r,o,a,l)=>({[`&${e}-background-ghost`]:Object.assign(Object.assign({color:n||void 0,background:t,borderColor:i||void 0,boxShadow:"none"},WX(e,Object.assign({background:t},a),Object.assign({background:t},l))),{"&:disabled":{cursor:"not-allowed",color:r||void 0,borderColor:o||void 0}})}),UO=e=>({[`&:disabled, &${e.componentCls}-disabled`]:Object.assign({},jO(e))}),QO=e=>({[`&:disabled, &${e.componentCls}-disabled`]:{cursor:"not-allowed",color:e.colorTextDisabled}}),lm=(e,t,n,i)=>{const o=i&&["link","text"].includes(i)?QO:UO;return Object.assign(Object.assign({},o(e)),WX(e.componentCls,t,n))},sm=(e,t,n,i,r)=>({[`&${e.componentCls}-variant-solid`]:Object.assign({color:t,background:n},lm(e,i,r))}),gm=(e,t,n,i,r)=>({[`&${e.componentCls}-variant-outlined, &${e.componentCls}-variant-dashed`]:Object.assign({borderColor:t,background:n},lm(e,i,r))}),cm=e=>({[`&${e.componentCls}-variant-dashed`]:{borderStyle:"dashed"}}),um=(e,t,n,i)=>({[`&${e.componentCls}-variant-filled`]:Object.assign({boxShadow:"none",background:t},lm(e,n,i))}),Ia=(e,t,n,i,r)=>({[`&${e.componentCls}-variant-${n}`]:Object.assign({color:t,boxShadow:"none"},lm(e,i,r,n))}),PO=e=>{const{componentCls:t}=e;return Dx.reduce((n,i)=>{const r=e[`${i}6`],o=e[`${i}1`],a=e[`${i}5`],l=e[`${i}2`],s=e[`${i}3`],g=e[`${i}7`],c=`0 ${e.controlOutlineWidth} 0 ${e[`${i}1`]}`;return Object.assign(Object.assign({},n),{[`&${t}-color-${i}`]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:r,boxShadow:c},sm(e,e.colorTextLightSolid,r,{background:a},{background:g})),gm(e,r,e.colorBgContainer,{color:a,borderColor:a,background:e.colorBgContainer},{color:g,borderColor:g,background:e.colorBgContainer})),cm(e)),um(e,o,{background:l},{background:s})),Ia(e,r,"link",{color:a},{color:g})),Ia(e,r,"text",{color:a,background:o},{color:g,background:s}))})},{})},_O=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.defaultColor,boxShadow:e.defaultShadow},sm(e,e.solidTextColor,e.colorBgSolid,{color:e.solidTextColor,background:e.colorBgSolidHover},{color:e.solidTextColor,background:e.colorBgSolidActive})),cm(e)),um(e,e.colorFillTertiary,{background:e.colorFillSecondary},{background:e.colorFill})),Ia(e,e.textTextColor,"link",{color:e.colorLinkHover,background:e.linkHoverBg},{color:e.colorLinkActive})),dZ(e.componentCls,e.ghostBg,e.defaultGhostColor,e.defaultGhostBorderColor,e.colorTextDisabled,e.colorBorder)),OO=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.colorPrimary,boxShadow:e.primaryShadow},gm(e,e.colorPrimary,e.colorBgContainer,{color:e.colorPrimaryTextHover,borderColor:e.colorPrimaryHover,background:e.colorBgContainer},{color:e.colorPrimaryTextActive,borderColor:e.colorPrimaryActive,background:e.colorBgContainer})),cm(e)),um(e,e.colorPrimaryBg,{background:e.colorPrimaryBgHover},{background:e.colorPrimaryBorder})),Ia(e,e.colorLink,"text",{color:e.colorPrimaryTextHover,background:e.colorPrimaryBg},{color:e.colorPrimaryTextActive,background:e.colorPrimaryBorder})),dZ(e.componentCls,e.ghostBg,e.colorPrimary,e.colorPrimary,e.colorTextDisabled,e.colorBorder,{color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),qO=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.colorError,boxShadow:e.dangerShadow},sm(e,e.dangerColor,e.colorError,{background:e.colorErrorHover},{background:e.colorErrorActive})),gm(e,e.colorError,e.colorBgContainer,{color:e.colorErrorHover,borderColor:e.colorErrorBorderHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),cm(e)),um(e,e.colorErrorBg,{background:e.colorErrorBgFilledHover},{background:e.colorErrorBgActive})),Ia(e,e.colorError,"text",{color:e.colorErrorHover,background:e.colorErrorBg},{color:e.colorErrorHover,background:e.colorErrorBgActive})),Ia(e,e.colorError,"link",{color:e.colorErrorHover},{color:e.colorErrorActive})),dZ(e.componentCls,e.ghostBg,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder,{color:e.colorErrorHover,borderColor:e.colorErrorHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),$O=e=>{const{componentCls:t}=e;return Object.assign({[`${t}-color-default`]:_O(e),[`${t}-color-primary`]:OO(e),[`${t}-color-dangerous`]:qO(e)},PO(e))},e4=e=>Object.assign(Object.assign(Object.assign(Object.assign({},gm(e,e.defaultBorderColor,e.defaultBg,{color:e.defaultHoverColor,borderColor:e.defaultHoverBorderColor,background:e.defaultHoverBg},{color:e.defaultActiveColor,borderColor:e.defaultActiveBorderColor,background:e.defaultActiveBg})),Ia(e,e.textTextColor,"text",{color:e.textTextHoverColor,background:e.textHoverBg},{color:e.textTextActiveColor,background:e.colorBgTextActive})),sm(e,e.primaryColor,e.colorPrimary,{background:e.colorPrimaryHover,color:e.primaryColor},{background:e.colorPrimaryActive,color:e.primaryColor})),Ia(e,e.colorLink,"link",{color:e.colorLinkHover,background:e.linkHoverBg},{color:e.colorLinkActive})),CZ=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:n,controlHeight:i,fontSize:r,borderRadius:o,buttonPaddingHorizontal:a,iconCls:l,buttonPaddingVertical:s,buttonIconOnlyFontSize:g}=e;return[{[t]:{fontSize:r,height:i,padding:`${Ve(s)} ${Ve(a)}`,borderRadius:o,[`&${n}-icon-only`]:{width:i,[l]:{fontSize:g,verticalAlign:"calc(-0.125em - 1px)"}}}},{[`${n}${n}-circle${t}`]:DO(e)},{[`${n}${n}-round${t}`]:TO(e)}]},t4=e=>{const t=nr(e,{fontSize:e.contentFontSize});return CZ(t,e.componentCls)},n4=e=>{const t=nr(e,{controlHeight:e.controlHeightSM,fontSize:e.contentFontSizeSM,padding:e.paddingXS,buttonPaddingHorizontal:e.paddingInlineSM,buttonPaddingVertical:0,borderRadius:e.borderRadiusSM,buttonIconOnlyFontSize:e.onlyIconSizeSM});return CZ(t,`${e.componentCls}-sm`)},i4=e=>{const t=nr(e,{controlHeight:e.controlHeightLG,fontSize:e.contentFontSizeLG,buttonPaddingHorizontal:e.paddingInlineLG,buttonPaddingVertical:0,borderRadius:e.borderRadiusLG,buttonIconOnlyFontSize:e.onlyIconSizeLG});return CZ(t,`${e.componentCls}-lg`)},r4=e=>{const{componentCls:t}=e;return{[t]:{[`&${t}-block`]:{width:"100%"}}}},o4=bl("Button",e=>{const t=BX(e);return[LO(t),t4(t),n4(t),i4(t),r4(t),$O(t),e4(t),ZO(t)]},RX,{unitless:{fontWeight:!0,contentLineHeight:!0,contentLineHeightSM:!0,contentLineHeightLG:!0}});function a4(e,t,n){const{focusElCls:i,focus:r,borderElCls:o}=n,a=o?"> *":"",l=["hover",r?"focus":null,"active"].filter(Boolean).map(s=>`&:${s} ${a}`).join(",");return{[`&-item:not(${t}-last-item)`]:{marginInlineEnd:e.calc(e.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[l]:{zIndex:2}},i?{[`&${i}`]:{zIndex:2}}:{}),{[`&[disabled] ${a}`]:{zIndex:0}})}}function l4(e,t,n){const{borderElCls:i}=n,r=i?`> ${i}`:"";return{[`&-item:not(${t}-first-item):not(${t}-last-item) ${r}`]:{borderRadius:0},[`&-item:not(${t}-last-item)${t}-first-item`]:{[`& ${r}, &${e}-sm ${r}, &${e}-lg ${r}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${t}-first-item)${t}-last-item`]:{[`& ${r}, &${e}-sm ${r}, &${e}-lg ${r}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function s4(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:n}=e,i=`${n}-compact`;return{[i]:Object.assign(Object.assign({},a4(e,i,t)),l4(n,i,t))}}function g4(e,t){return{[`&-item:not(${t}-last-item)`]:{marginBottom:e.calc(e.lineWidth).mul(-1).equal()},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function c4(e,t){return{[`&-item:not(${t}-first-item):not(${t}-last-item)`]:{borderRadius:0},[`&-item${t}-first-item:not(${t}-last-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${t}-last-item:not(${t}-first-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function u4(e){const t=`${e.componentCls}-compact-vertical`;return{[t]:Object.assign(Object.assign({},g4(e,t)),c4(e.componentCls,t))}}const I4=e=>{const{componentCls:t,colorPrimaryHover:n,lineWidth:i,calc:r}=e,o=r(i).mul(-1).equal(),a=l=>({[`${t}-compact${l?"-vertical":""}-item${t}-primary:not([disabled])`]:{"& + &::before":{position:"absolute",top:l?o:0,insetInlineStart:l?0:o,backgroundColor:n,content:'""',width:l?"100%":i,height:l?i:"100%"}}});return Object.assign(Object.assign({},a()),a(!0))},d4=rP(["Button","compact"],e=>{const t=BX(e);return[s4(t),u4(t),I4(t)]},RX);var C4=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function h4(e){if(typeof e=="object"&&e){let t=e==null?void 0:e.delay;return t=!Number.isNaN(t)&&typeof t=="number"?t:0,{loading:t<=0,delay:t}}return{loading:!!e,delay:0}}const m4={default:["default","outlined"],primary:["primary","solid"],dashed:["default","dashed"],link:["primary","link"],text:["default","text"]},A4=ce.forwardRef((e,t)=>{var n,i,r,o;const{loading:a=!1,prefixCls:l,color:s,variant:g,type:c,danger:u=!1,shape:I="default",size:C,styles:m,disabled:f,className:b,rootClassName:A,children:p,icon:y,iconPosition:Z="start",ghost:G=!1,block:v=!1,htmlType:B="button",classNames:R,style:X={},autoInsertSpace:W,autoFocus:V}=e,Y=C4(e,["loading","prefixCls","color","variant","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","iconPosition","ghost","block","htmlType","classNames","style","autoInsertSpace","autoFocus"]),K=c||"default",[M,H]=h.useMemo(()=>{if(s&&g)return[s,g];const Xe=m4[K]||[];return u?["danger",Xe[1]]:Xe},[c,s,g,u]),x=M==="danger"?"dangerous":M,{getPrefixCls:J,direction:F,button:S}=h.useContext(Pt),E=(n=W??(S==null?void 0:S.autoInsertSpace))!==null&&n!==void 0?n:!0,N=J("btn",l),[k,z,L]=o4(N),D=h.useContext(VC),j=f??D,ne=h.useContext(SX),ie=h.useMemo(()=>h4(a),[a]),[ae,Re]=h.useState(ie.loading),[de,Q]=h.useState(!1),O=h.useRef(null),me=_s(t,O),Ae=h.Children.count(p)===1&&!y&&!UA(H),De=h.useRef(!0);ce.useEffect(()=>(De.current=!1,()=>{De.current=!0}),[]),h.useEffect(()=>{let Xe=null;ie.delay>0?Xe=setTimeout(()=>{Xe=null,Re(!0)},ie.delay):Re(ie.loading);function Ye(){Xe&&(clearTimeout(Xe),Xe=null)}return Ye},[ie]),h.useEffect(()=>{if(!O.current||!E)return;const Xe=O.current.textContent||"";Ae&&kb(Xe)?de||Q(!0):de&&Q(!1)}),h.useEffect(()=>{V&&O.current&&O.current.focus()},[]);const ke=ce.useCallback(Xe=>{var Ye;if(ae||j){Xe.preventDefault();return}(Ye=e.onClick)===null||Ye===void 0||Ye.call(e,Xe)},[e.onClick,ae,j]),{compactSize:xe,compactItemClassnames:Ee}=CO(N,F),We={large:"lg",small:"sm",middle:void 0},ze=am(Xe=>{var Ye,qe;return(qe=(Ye=C??xe)!==null&&Ye!==void 0?Ye:ne)!==null&&qe!==void 0?qe:Xe}),Ge=ze&&(i=We[ze])!==null&&i!==void 0?i:"",it=ae?"loading":y,Pe=pa(Y,["navigate"]),U=he(N,z,L,{[`${N}-${I}`]:I!=="default"&&I,[`${N}-${K}`]:K,[`${N}-dangerous`]:u,[`${N}-color-${x}`]:x,[`${N}-variant-${H}`]:H,[`${N}-${Ge}`]:Ge,[`${N}-icon-only`]:!p&&p!==0&&!!it,[`${N}-background-ghost`]:G&&!UA(H),[`${N}-loading`]:ae,[`${N}-two-chinese-chars`]:de&&E&&!ae,[`${N}-block`]:v,[`${N}-rtl`]:F==="rtl",[`${N}-icon-end`]:Z==="end"},Ee,b,A,S==null?void 0:S.className),oe=Object.assign(Object.assign({},S==null?void 0:S.style),X),P=he(R==null?void 0:R.icon,(r=S==null?void 0:S.classNames)===null||r===void 0?void 0:r.icon),re=Object.assign(Object.assign({},(m==null?void 0:m.icon)||{}),((o=S==null?void 0:S.styles)===null||o===void 0?void 0:o.icon)||{}),ve=y&&!ae?ce.createElement(Vb,{prefixCls:N,className:P,style:re},y):typeof a=="object"&&a.icon?ce.createElement(Vb,{prefixCls:N,className:P,style:re},a.icon):ce.createElement(yO,{existIcon:!!y,prefixCls:N,loading:ae,mount:De.current}),Fe=p||p===0?bO(p,Ae&&E):null;if(Pe.href!==void 0)return k(ce.createElement("a",Object.assign({},Pe,{className:he(U,{[`${N}-disabled`]:j}),href:j?void 0:Pe.href,style:oe,onClick:ke,ref:me,tabIndex:j?-1:0}),ve,Fe));let Te=ce.createElement("button",Object.assign({},Y,{type:B,className:U,style:oe,onClick:ke,disabled:j,ref:me}),ve,Fe,Ee&&ce.createElement(d4,{prefixCls:N}));return UA(H)||(Te=ce.createElement(cO,{component:"Button",disabled:ae},Te)),k(Te)}),hZ=A4;hZ.Group=fO;hZ.__ANT_BUTTON=!0;var kX=h.createContext(null),fR=[];function f4(e,t){var n=h.useState(function(){if(!Yi())return null;var m=document.createElement("div");return m}),i=$(n,1),r=i[0],o=h.useRef(!1),a=h.useContext(kX),l=h.useState(fR),s=$(l,2),g=s[0],c=s[1],u=a||(o.current?void 0:function(m){c(function(f){var b=[m].concat(Yt(f));return b})});function I(){r.parentElement||document.body.appendChild(r),o.current=!0}function C(){var m;(m=r.parentElement)===null||m===void 0||m.removeChild(r),o.current=!1}return Kn(function(){return e?a?a(I):I():C(),C},[e]),Kn(function(){g.length&&(g.forEach(function(m){return m()}),c(fR))},[g]),[r,u]}function p4(e){var t="rc-scrollbar-measure-".concat(Math.random().toString(36).substring(7)),n=document.createElement("div");n.id=t;var i=n.style;i.position="absolute",i.left="0",i.top="0",i.width="100px",i.height="100px",i.overflow="scroll";var r,o;if(e){var a=getComputedStyle(e);i.scrollbarColor=a.scrollbarColor,i.scrollbarWidth=a.scrollbarWidth;var l=getComputedStyle(e,"::-webkit-scrollbar"),s=parseInt(l.width,10),g=parseInt(l.height,10);try{var c=s?"width: ".concat(l.width,";"):"",u=g?"height: ".concat(l.height,";"):"";io(`
#`.concat(t,`::-webkit-scrollbar {
`).concat(c,`
`).concat(u,`
}`),t)}catch(m){console.error(m),r=s,o=g}}document.body.appendChild(n);var I=e&&r&&!isNaN(r)?r:n.offsetWidth-n.clientWidth,C=e&&o&&!isNaN(o)?o:n.offsetHeight-n.clientHeight;return document.body.removeChild(n),tu(t),{width:I,height:C}}function b4(e){return typeof document>"u"||!e||!(e instanceof Element)?{width:0,height:0}:p4(e)}function y4(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var Z4="rc-util-locker-".concat(Date.now()),pR=0;function v4(e){var t=!!e,n=h.useState(function(){return pR+=1,"".concat(Z4,"_").concat(pR)}),i=$(n,1),r=i[0];Kn(function(){if(t){var o=b4(document.body).width,a=y4();io(`
html body {
  overflow-y: hidden;
  `.concat(a?"width: calc(100% - ".concat(o,"px);"):"",`
}`),r)}else tu(r);return function(){tu(r)}},[t,r])}var G4=!1;function S4(e){return G4}var bR=function(t){return t===!1?!1:!Yi()||!t?null:typeof t=="string"?document.querySelector(t):typeof t=="function"?t():t},VX=h.forwardRef(function(e,t){var n=e.open,i=e.autoLock,r=e.getContainer;e.debug;var o=e.autoDestroy,a=o===void 0?!0:o,l=e.children,s=h.useState(n),g=$(s,2),c=g[0],u=g[1],I=c||n;h.useEffect(function(){(a||n)&&u(n)},[n,a]);var C=h.useState(function(){return bR(r)}),m=$(C,2),f=m[0],b=m[1];h.useEffect(function(){var V=bR(r);b(V??null)});var A=f4(I&&!f),p=$(A,2),y=p[0],Z=p[1],G=f??y;v4(i&&n&&Yi()&&(G===y||G===document.body));var v=null;if(l&&Al(l)&&t){var B=l;v=B.ref}var R=_s(v,t);if(!I||!Yi()||f===void 0)return null;var X=G===!1||S4(),W=l;return t&&(W=h.cloneElement(l,{ref:R})),h.createElement(kX.Provider,{value:Z},X?W:_i.createPortal(W,G))});function B4(){var e=te({},qC);return e.useId}var yR=0,ZR=B4();const R4=ZR?function(t){var n=ZR();return t||n}:function(t){var n=h.useState("ssr-id"),i=$(n,2),r=i[0],o=i[1];return h.useEffect(function(){var a=yR;yR+=1,o("rc_unique_".concat(a))},[]),t||r},Im=e=>{const{prefixCls:t,className:n,style:i,size:r,shape:o}=e,a=he({[`${t}-lg`]:r==="large",[`${t}-sm`]:r==="small"}),l=he({[`${t}-circle`]:o==="circle",[`${t}-square`]:o==="square",[`${t}-round`]:o==="round"}),s=h.useMemo(()=>typeof r=="number"?{width:r,height:r,lineHeight:`${r}px`}:{},[r]);return h.createElement("span",{className:he(t,a,l,n),style:Object.assign(Object.assign({},s),i)})},W4=new Ni("ant-skeleton-loading",{"0%":{backgroundPosition:"100% 50%"},"100%":{backgroundPosition:"0 50%"}}),dm=e=>({height:e,lineHeight:Ve(e)}),fs=e=>Object.assign({width:e},dm(e)),k4=e=>({background:e.skeletonLoadingBackground,backgroundSize:"400% 100%",animationName:W4,animationDuration:e.skeletonLoadingMotionDuration,animationTimingFunction:"ease",animationIterationCount:"infinite"}),OA=(e,t)=>Object.assign({width:t(e).mul(5).equal(),minWidth:t(e).mul(5).equal()},dm(e)),V4=e=>{const{skeletonAvatarCls:t,gradientFromColor:n,controlHeight:i,controlHeightLG:r,controlHeightSM:o}=e;return{[t]:Object.assign({display:"inline-block",verticalAlign:"top",background:n},fs(i)),[`${t}${t}-circle`]:{borderRadius:"50%"},[`${t}${t}-lg`]:Object.assign({},fs(r)),[`${t}${t}-sm`]:Object.assign({},fs(o))}},w4=e=>{const{controlHeight:t,borderRadiusSM:n,skeletonInputCls:i,controlHeightLG:r,controlHeightSM:o,gradientFromColor:a,calc:l}=e;return{[i]:Object.assign({display:"inline-block",verticalAlign:"top",background:a,borderRadius:n},OA(t,l)),[`${i}-lg`]:Object.assign({},OA(r,l)),[`${i}-sm`]:Object.assign({},OA(o,l))}},vR=e=>Object.assign({width:e},dm(e)),x4=e=>{const{skeletonImageCls:t,imageSizeBase:n,gradientFromColor:i,borderRadiusSM:r,calc:o}=e;return{[t]:Object.assign(Object.assign({display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"middle",background:i,borderRadius:r},vR(o(n).mul(2).equal())),{[`${t}-path`]:{fill:"#bfbfbf"},[`${t}-svg`]:Object.assign(Object.assign({},vR(n)),{maxWidth:o(n).mul(4).equal(),maxHeight:o(n).mul(4).equal()}),[`${t}-svg${t}-svg-circle`]:{borderRadius:"50%"}}),[`${t}${t}-circle`]:{borderRadius:"50%"}}},qA=(e,t,n)=>{const{skeletonButtonCls:i}=e;return{[`${n}${i}-circle`]:{width:t,minWidth:t,borderRadius:"50%"},[`${n}${i}-round`]:{borderRadius:t}}},$A=(e,t)=>Object.assign({width:t(e).mul(2).equal(),minWidth:t(e).mul(2).equal()},dm(e)),X4=e=>{const{borderRadiusSM:t,skeletonButtonCls:n,controlHeight:i,controlHeightLG:r,controlHeightSM:o,gradientFromColor:a,calc:l}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({[n]:Object.assign({display:"inline-block",verticalAlign:"top",background:a,borderRadius:t,width:l(i).mul(2).equal(),minWidth:l(i).mul(2).equal()},$A(i,l))},qA(e,i,n)),{[`${n}-lg`]:Object.assign({},$A(r,l))}),qA(e,r,`${n}-lg`)),{[`${n}-sm`]:Object.assign({},$A(o,l))}),qA(e,o,`${n}-sm`))},J4=e=>{const{componentCls:t,skeletonAvatarCls:n,skeletonTitleCls:i,skeletonParagraphCls:r,skeletonButtonCls:o,skeletonInputCls:a,skeletonImageCls:l,controlHeight:s,controlHeightLG:g,controlHeightSM:c,gradientFromColor:u,padding:I,marginSM:C,borderRadius:m,titleHeight:f,blockRadius:b,paragraphLiHeight:A,controlHeightXS:p,paragraphMarginTop:y}=e;return{[t]:{display:"table",width:"100%",[`${t}-header`]:{display:"table-cell",paddingInlineEnd:I,verticalAlign:"top",[n]:Object.assign({display:"inline-block",verticalAlign:"top",background:u},fs(s)),[`${n}-circle`]:{borderRadius:"50%"},[`${n}-lg`]:Object.assign({},fs(g)),[`${n}-sm`]:Object.assign({},fs(c))},[`${t}-content`]:{display:"table-cell",width:"100%",verticalAlign:"top",[i]:{width:"100%",height:f,background:u,borderRadius:b,[`+ ${r}`]:{marginBlockStart:c}},[r]:{padding:0,"> li":{width:"100%",height:A,listStyle:"none",background:u,borderRadius:b,"+ li":{marginBlockStart:p}}},[`${r}> li:last-child:not(:first-child):not(:nth-child(2))`]:{width:"61%"}},[`&-round ${t}-content`]:{[`${i}, ${r} > li`]:{borderRadius:m}}},[`${t}-with-avatar ${t}-content`]:{[i]:{marginBlockStart:C,[`+ ${r}`]:{marginBlockStart:y}}},[`${t}${t}-element`]:Object.assign(Object.assign(Object.assign(Object.assign({display:"inline-block",width:"auto"},X4(e)),V4(e)),w4(e)),x4(e)),[`${t}${t}-block`]:{width:"100%",[o]:{width:"100%"},[a]:{width:"100%"}},[`${t}${t}-active`]:{[`
        ${i},
        ${r} > li,
        ${n},
        ${o},
        ${a},
        ${l}
      `]:Object.assign({},k4(e))}}},Y4=e=>{const{colorFillContent:t,colorFill:n}=e,i=t,r=n;return{color:i,colorGradientEnd:r,gradientFromColor:i,gradientToColor:r,titleHeight:e.controlHeight/2,blockRadius:e.borderRadiusSM,paragraphMarginTop:e.marginLG+e.marginXXS,paragraphLiHeight:e.controlHeight/2}},ng=bl("Skeleton",e=>{const{componentCls:t,calc:n}=e,i=nr(e,{skeletonAvatarCls:`${t}-avatar`,skeletonTitleCls:`${t}-title`,skeletonParagraphCls:`${t}-paragraph`,skeletonButtonCls:`${t}-button`,skeletonInputCls:`${t}-input`,skeletonImageCls:`${t}-image`,imageSizeBase:n(e.controlHeight).mul(1.5).equal(),borderRadius:100,skeletonLoadingBackground:`linear-gradient(90deg, ${e.gradientFromColor} 25%, ${e.gradientToColor} 37%, ${e.gradientFromColor} 63%)`,skeletonLoadingMotionDuration:"1.4s"});return[J4(i)]},Y4,{deprecatedTokens:[["color","gradientFromColor"],["colorGradientEnd","gradientToColor"]]}),N4=e=>{const{prefixCls:t,className:n,rootClassName:i,active:r,shape:o="circle",size:a="default"}=e,{getPrefixCls:l}=h.useContext(Pt),s=l("skeleton",t),[g,c,u]=ng(s),I=pa(e,["prefixCls","className"]),C=he(s,`${s}-element`,{[`${s}-active`]:r},n,i,c,u);return g(h.createElement("div",{className:C},h.createElement(Im,Object.assign({prefixCls:`${s}-avatar`,shape:o,size:a},I))))},H4=e=>{const{prefixCls:t,className:n,rootClassName:i,active:r,block:o=!1,size:a="default"}=e,{getPrefixCls:l}=h.useContext(Pt),s=l("skeleton",t),[g,c,u]=ng(s),I=pa(e,["prefixCls"]),C=he(s,`${s}-element`,{[`${s}-active`]:r,[`${s}-block`]:o},n,i,c,u);return g(h.createElement("div",{className:C},h.createElement(Im,Object.assign({prefixCls:`${s}-button`,size:a},I))))},F4="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",K4=e=>{const{prefixCls:t,className:n,rootClassName:i,style:r,active:o}=e,{getPrefixCls:a}=h.useContext(Pt),l=a("skeleton",t),[s,g,c]=ng(l),u=he(l,`${l}-element`,{[`${l}-active`]:o},n,i,g,c);return s(h.createElement("div",{className:u},h.createElement("div",{className:he(`${l}-image`,n),style:r},h.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:`${l}-image-svg`},h.createElement("title",null,"Image placeholder"),h.createElement("path",{d:F4,className:`${l}-image-path`})))))},E4=e=>{const{prefixCls:t,className:n,rootClassName:i,active:r,block:o,size:a="default"}=e,{getPrefixCls:l}=h.useContext(Pt),s=l("skeleton",t),[g,c,u]=ng(s),I=pa(e,["prefixCls"]),C=he(s,`${s}-element`,{[`${s}-active`]:r,[`${s}-block`]:o},n,i,c,u);return g(h.createElement("div",{className:C},h.createElement(Im,Object.assign({prefixCls:`${s}-input`,size:a},I))))},M4=e=>{const{prefixCls:t,className:n,rootClassName:i,style:r,active:o,children:a}=e,{getPrefixCls:l}=h.useContext(Pt),s=l("skeleton",t),[g,c,u]=ng(s),I=he(s,`${s}-element`,{[`${s}-active`]:o},c,n,i,u);return g(h.createElement("div",{className:I},h.createElement("div",{className:he(`${s}-image`,n),style:r},a)))},z4=(e,t)=>{const{width:n,rows:i=2}=t;if(Array.isArray(n))return n[e];if(i-1===e)return n},L4=e=>{const{prefixCls:t,className:n,style:i,rows:r}=e,o=Yt(new Array(r)).map((a,l)=>h.createElement("li",{key:l,style:{width:z4(l,e)}}));return h.createElement("ul",{className:he(t,n),style:i},o)},D4=e=>{let{prefixCls:t,className:n,width:i,style:r}=e;return h.createElement("h3",{className:he(t,n),style:Object.assign({width:i},r)})};function ef(e){return e&&typeof e=="object"?e:{}}function T4(e,t){return e&&!t?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function j4(e,t){return!e&&t?{width:"38%"}:e&&t?{width:"50%"}:{}}function U4(e,t){const n={};return(!e||!t)&&(n.width="61%"),!e&&t?n.rows=3:n.rows=2,n}const ig=e=>{const{prefixCls:t,loading:n,className:i,rootClassName:r,style:o,children:a,avatar:l=!1,title:s=!0,paragraph:g=!0,active:c,round:u}=e,{getPrefixCls:I,direction:C,skeleton:m}=h.useContext(Pt),f=I("skeleton",t),[b,A,p]=ng(f);if(n||!("loading"in e)){const y=!!l,Z=!!s,G=!!g;let v;if(y){const X=Object.assign(Object.assign({prefixCls:`${f}-avatar`},T4(Z,G)),ef(l));v=h.createElement("div",{className:`${f}-header`},h.createElement(Im,Object.assign({},X)))}let B;if(Z||G){let X;if(Z){const V=Object.assign(Object.assign({prefixCls:`${f}-title`},j4(y,G)),ef(s));X=h.createElement(D4,Object.assign({},V))}let W;if(G){const V=Object.assign(Object.assign({prefixCls:`${f}-paragraph`},U4(y,Z)),ef(g));W=h.createElement(L4,Object.assign({},V))}B=h.createElement("div",{className:`${f}-content`},X,W)}const R=he(f,{[`${f}-with-avatar`]:y,[`${f}-active`]:c,[`${f}-rtl`]:C==="rtl",[`${f}-round`]:u},m==null?void 0:m.className,i,r,A,p);return b(h.createElement("div",{className:R,style:Object.assign(Object.assign({},m==null?void 0:m.style),o)},v,B))}return a??null};ig.Button=H4;ig.Avatar=N4;ig.Input=E4;ig.Image=K4;ig.Node=M4;const Q4=ce.createContext({}),wX=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e==null?void 0:e.substr(0,4))};var P4=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],Yl=void 0;function _4(e,t){var n=e.prefixCls,i=e.invalidate,r=e.item,o=e.renderItem,a=e.responsive,l=e.responsiveDisabled,s=e.registerSize,g=e.itemKey,c=e.className,u=e.style,I=e.children,C=e.display,m=e.order,f=e.component,b=f===void 0?"div":f,A=Zt(e,P4),p=a&&!C;function y(R){s(g,R)}h.useEffect(function(){return function(){y(null)}},[]);var Z=o&&r!==Yl?o(r,{index:m}):I,G;i||(G={opacity:p?0:1,height:p?0:Yl,overflowY:p?"hidden":Yl,order:a?m:Yl,pointerEvents:p?"none":Yl,position:p?"absolute":Yl});var v={};p&&(v["aria-hidden"]=!0);var B=h.createElement(b,Qe({className:he(!i&&n,c),style:te(te({},G),u)},v,A,{ref:t}),Z);return a&&(B=h.createElement(oa,{onResize:function(X){var W=X.offsetWidth;y(W)},disabled:l},B)),B}var bc=h.forwardRef(_4);bc.displayName="Item";function O4(e){if(typeof MessageChannel>"u")On(e);else{var t=new MessageChannel;t.port1.onmessage=function(){return e()},t.port2.postMessage(void 0)}}function q4(){var e=h.useRef(null),t=function(i){e.current||(e.current=[],O4(function(){_i.unstable_batchedUpdates(function(){e.current.forEach(function(r){r()}),e.current=null})})),e.current.push(i)};return t}function Yg(e,t){var n=h.useState(t),i=$(n,2),r=i[0],o=i[1],a=oi(function(l){e(function(){o(l)})});return[r,a]}var YC=ce.createContext(null),$4=["component"],e8=["className"],t8=["className"],n8=function(t,n){var i=h.useContext(YC);if(!i){var r=t.component,o=r===void 0?"div":r,a=Zt(t,$4);return h.createElement(o,Qe({},a,{ref:n}))}var l=i.className,s=Zt(i,e8),g=t.className,c=Zt(t,t8);return h.createElement(YC.Provider,{value:null},h.createElement(bc,Qe({ref:n,className:he(l,g)},s,c)))},xX=h.forwardRef(n8);xX.displayName="RawItem";var i8=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],XX="responsive",JX="invalidate";function r8(e){return"+ ".concat(e.length," ...")}function o8(e,t){var n=e.prefixCls,i=n===void 0?"rc-overflow":n,r=e.data,o=r===void 0?[]:r,a=e.renderItem,l=e.renderRawItem,s=e.itemKey,g=e.itemWidth,c=g===void 0?10:g,u=e.ssr,I=e.style,C=e.className,m=e.maxCount,f=e.renderRest,b=e.renderRawRest,A=e.suffix,p=e.component,y=p===void 0?"div":p,Z=e.itemComponent,G=e.onVisibleChange,v=Zt(e,i8),B=u==="full",R=q4(),X=Yg(R,null),W=$(X,2),V=W[0],Y=W[1],K=V||0,M=Yg(R,new Map),H=$(M,2),w=H[0],x=H[1],J=Yg(R,0),F=$(J,2),S=F[0],E=F[1],N=Yg(R,0),k=$(N,2),z=k[0],L=k[1],D=Yg(R,0),j=$(D,2),ne=j[0],ie=j[1],ae=h.useState(null),Re=$(ae,2),de=Re[0],Q=Re[1],O=h.useState(null),me=$(O,2),Ae=me[0],De=me[1],ke=h.useMemo(function(){return Ae===null&&B?Number.MAX_SAFE_INTEGER:Ae||0},[Ae,V]),xe=h.useState(!1),Ee=$(xe,2),We=Ee[0],ze=Ee[1],Ge="".concat(i,"-item"),it=Math.max(S,z),Pe=m===XX,U=o.length&&Pe,oe=m===JX,P=U||typeof m=="number"&&o.length>m,re=h.useMemo(function(){var fe=o;return U?V===null&&B?fe=o:fe=o.slice(0,Math.min(o.length,K/c)):typeof m=="number"&&(fe=o.slice(0,m)),fe},[o,c,V,m,U]),ve=h.useMemo(function(){return U?o.slice(ke+1):o.slice(re.length)},[o,re,U,ke]),Fe=h.useCallback(function(fe,be){var T;return typeof s=="function"?s(fe):(T=s&&(fe==null?void 0:fe[s]))!==null&&T!==void 0?T:be},[s]),Te=h.useCallback(a||function(fe){return fe},[a]);function Xe(fe,be,T){Ae===fe&&(be===void 0||be===de)||(De(fe),T||(ze(fe<o.length-1),G==null||G(fe)),be!==void 0&&Q(be))}function Ye(fe,be){Y(be.clientWidth)}function qe(fe,be){x(function(T){var ee=new Map(T);return be===null?ee.delete(fe):ee.set(fe,be),ee})}function $e(fe,be){L(be),E(z)}function et(fe,be){ie(be)}function Oe(fe){return w.get(Fe(re[fe],fe))}Kn(function(){if(K&&typeof it=="number"&&re){var fe=ne,be=re.length,T=be-1;if(!be){Xe(0,null);return}for(var ee=0;ee<be;ee+=1){var le=Oe(ee);if(B&&(le=le||0),le===void 0){Xe(ee-1,void 0,!0);break}if(fe+=le,T===0&&fe<=K||ee===T-1&&fe+Oe(T)<=K){Xe(T,null);break}else if(fe+it>K){Xe(ee-1,fe-le-ne+z);break}}A&&Oe(0)+ne>K&&Q(null)}},[K,w,z,ne,Fe,re]);var xt=We&&!!ve.length,Dt={};de!==null&&U&&(Dt={position:"absolute",left:de,top:0});var Ht={prefixCls:Ge,responsive:U,component:Z,invalidate:oe},at=l?function(fe,be){var T=Fe(fe,be);return h.createElement(YC.Provider,{key:T,value:te(te({},Ht),{},{order:be,item:fe,itemKey:T,registerSize:qe,display:be<=ke})},l(fe,be))}:function(fe,be){var T=Fe(fe,be);return h.createElement(bc,Qe({},Ht,{order:be,key:T,item:fe,renderItem:Te,itemKey:T,registerSize:qe,display:be<=ke}))},je={order:xt?ke:Number.MAX_SAFE_INTEGER,className:"".concat(Ge,"-rest"),registerSize:$e,display:xt},Ke=f||r8,rt=b?h.createElement(YC.Provider,{value:te(te({},Ht),je)},b(ve)):h.createElement(bc,Qe({},Ht,je),typeof Ke=="function"?Ke(ve):Ke),Be=h.createElement(y,Qe({className:he(!oe&&i,C),style:I,ref:t},v),re.map(at),P?rt:null,A&&h.createElement(bc,Qe({},Ht,{responsive:Pe,responsiveDisabled:!U,order:ke,className:"".concat(Ge,"-suffix"),registerSize:et,display:!0,style:Dt}),A));return Pe?h.createElement(oa,{onResize:Ye,disabled:!U},Be):Be}var ro=h.forwardRef(o8);ro.displayName="Overflow";ro.Item=xX;ro.RESPONSIVE=XX;ro.INVALIDATE=JX;function a8(e){var t=e.prefixCls,n=e.align,i=e.arrow,r=e.arrowPos,o=i||{},a=o.className,l=o.content,s=r.x,g=s===void 0?0:s,c=r.y,u=c===void 0?0:c,I=h.useRef();if(!n||!n.points)return null;var C={position:"absolute"};if(n.autoArrow!==!1){var m=n.points[0],f=n.points[1],b=m[0],A=m[1],p=f[0],y=f[1];b===p||!["t","b"].includes(b)?C.top=u:b==="t"?C.top=0:C.bottom=0,A===y||!["l","r"].includes(A)?C.left=g:A==="l"?C.left=0:C.right=0}return h.createElement("div",{ref:I,className:he("".concat(t,"-arrow"),a),style:C},l)}function l8(e){var t=e.prefixCls,n=e.open,i=e.zIndex,r=e.mask,o=e.motion;return r?h.createElement(yl,Qe({},o,{motionAppear:!0,visible:n,removeOnLeave:!0}),function(a){var l=a.className;return h.createElement("div",{style:{zIndex:i},className:he("".concat(t,"-mask"),l)})}):null}var s8=h.memo(function(e){var t=e.children;return t},function(e,t){return t.cache}),g8=h.forwardRef(function(e,t){var n=e.popup,i=e.className,r=e.prefixCls,o=e.style,a=e.target,l=e.onVisibleChanged,s=e.open,g=e.keepDom,c=e.fresh,u=e.onClick,I=e.mask,C=e.arrow,m=e.arrowPos,f=e.align,b=e.motion,A=e.maskMotion,p=e.forceRender,y=e.getPopupContainer,Z=e.autoDestroy,G=e.portal,v=e.zIndex,B=e.onMouseEnter,R=e.onMouseLeave,X=e.onPointerEnter,W=e.onPointerDownCapture,V=e.ready,Y=e.offsetX,K=e.offsetY,M=e.offsetR,H=e.offsetB,w=e.onAlign,x=e.onPrepare,J=e.stretch,F=e.targetWidth,S=e.targetHeight,E=typeof n=="function"?n():n,N=s||g,k=(y==null?void 0:y.length)>0,z=h.useState(!y||!k),L=$(z,2),D=L[0],j=L[1];if(Kn(function(){!D&&k&&a&&j(!0)},[D,k,a]),!D)return null;var ne="auto",ie={left:"-1000vw",top:"-1000vh",right:ne,bottom:ne};if(V||!s){var ae,Re=f.points,de=f.dynamicInset||((ae=f._experimental)===null||ae===void 0?void 0:ae.dynamicInset),Q=de&&Re[0][1]==="r",O=de&&Re[0][0]==="b";Q?(ie.right=M,ie.left=ne):(ie.left=Y,ie.right=ne),O?(ie.bottom=H,ie.top=ne):(ie.top=K,ie.bottom=ne)}var me={};return J&&(J.includes("height")&&S?me.height=S:J.includes("minHeight")&&S&&(me.minHeight=S),J.includes("width")&&F?me.width=F:J.includes("minWidth")&&F&&(me.minWidth=F)),s||(me.pointerEvents="none"),h.createElement(G,{open:p||N,getContainer:y&&function(){return y(a)},autoDestroy:Z},h.createElement(l8,{prefixCls:r,open:s,zIndex:v,mask:I,motion:A}),h.createElement(oa,{onResize:w,disabled:!s},function(Ae){return h.createElement(yl,Qe({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:p,leavedClassName:"".concat(r,"-hidden")},b,{onAppearPrepare:x,onEnterPrepare:x,visible:s,onVisibleChanged:function(ke){var xe;b==null||(xe=b.onVisibleChanged)===null||xe===void 0||xe.call(b,ke),l(ke)}}),function(De,ke){var xe=De.className,Ee=De.style,We=he(r,xe,i);return h.createElement("div",{ref:Ps(Ae,t,ke),className:We,style:te(te(te(te({"--arrow-x":"".concat(m.x||0,"px"),"--arrow-y":"".concat(m.y||0,"px")},ie),me),Ee),{},{boxSizing:"border-box",zIndex:v},o),onMouseEnter:B,onMouseLeave:R,onPointerEnter:X,onClick:u,onPointerDownCapture:W},C&&h.createElement(a8,{prefixCls:r,arrow:C,arrowPos:m,align:f}),h.createElement(s8,{cache:!s&&!c},E))})}))}),c8=h.forwardRef(function(e,t){var n=e.children,i=e.getTriggerDOMNode,r=Al(n),o=h.useCallback(function(l){_y(t,i?i(l):l)},[i]),a=_s(o,Os(n));return r?h.cloneElement(n,{ref:a}):n}),GR=h.createContext(null);function SR(e){return e?Array.isArray(e)?e:[e]:[]}function u8(e,t,n,i){return h.useMemo(function(){var r=SR(n??t),o=SR(i??t),a=new Set(r),l=new Set(o);return e&&(a.has("hover")&&(a.delete("hover"),a.add("click")),l.has("hover")&&(l.delete("hover"),l.add("click"))),[a,l]},[e,t,n,i])}function I8(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return n?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}function d8(e,t,n,i){for(var r=n.points,o=Object.keys(e),a=0;a<o.length;a+=1){var l,s=o[a];if(I8((l=e[s])===null||l===void 0?void 0:l.points,r,i))return"".concat(t,"-placement-").concat(s)}return""}function BR(e,t,n,i){return t||(n?{motionName:"".concat(e,"-").concat(n)}:i?{motionName:i}:null)}function Nu(e){return e.ownerDocument.defaultView}function wb(e){for(var t=[],n=e==null?void 0:e.parentElement,i=["hidden","scroll","clip","auto"];n;){var r=Nu(n).getComputedStyle(n),o=r.overflowX,a=r.overflowY,l=r.overflow;[o,a,l].some(function(s){return i.includes(s)})&&t.push(n),n=n.parentElement}return t}function gu(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(e)?t:e}function Ng(e){return gu(parseFloat(e),0)}function RR(e,t){var n=te({},e);return(t||[]).forEach(function(i){if(!(i instanceof HTMLBodyElement||i instanceof HTMLHtmlElement)){var r=Nu(i).getComputedStyle(i),o=r.overflow,a=r.overflowClipMargin,l=r.borderTopWidth,s=r.borderBottomWidth,g=r.borderLeftWidth,c=r.borderRightWidth,u=i.getBoundingClientRect(),I=i.offsetHeight,C=i.clientHeight,m=i.offsetWidth,f=i.clientWidth,b=Ng(l),A=Ng(s),p=Ng(g),y=Ng(c),Z=gu(Math.round(u.width/m*1e3)/1e3),G=gu(Math.round(u.height/I*1e3)/1e3),v=(m-f-p-y)*Z,B=(I-C-b-A)*G,R=b*G,X=A*G,W=p*Z,V=y*Z,Y=0,K=0;if(o==="clip"){var M=Ng(a);Y=M*Z,K=M*G}var H=u.x+W-Y,w=u.y+R-K,x=H+u.width+2*Y-W-V-v,J=w+u.height+2*K-R-X-B;n.left=Math.max(n.left,H),n.top=Math.max(n.top,w),n.right=Math.min(n.right,x),n.bottom=Math.min(n.bottom,J)}}),n}function WR(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n="".concat(t),i=n.match(/^(.*)\%$/);return i?e*(parseFloat(i[1])/100):parseFloat(n)}function kR(e,t){var n=t||[],i=$(n,2),r=i[0],o=i[1];return[WR(e.width,r),WR(e.height,o)]}function VR(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[e[0],e[1]]}function Nl(e,t){var n=t[0],i=t[1],r,o;return n==="t"?o=e.y:n==="b"?o=e.y+e.height:o=e.y+e.height/2,i==="l"?r=e.x:i==="r"?r=e.x+e.width:r=e.x+e.width/2,{x:r,y:o}}function Go(e,t){var n={t:"b",b:"t",l:"r",r:"l"};return e.map(function(i,r){return r===t?n[i]||"c":i}).join("")}function C8(e,t,n,i,r,o,a){var l=h.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:r[i]||{}}),s=$(l,2),g=s[0],c=s[1],u=h.useRef(0),I=h.useMemo(function(){return t?wb(t):[]},[t]),C=h.useRef({}),m=function(){C.current={}};e||m();var f=oi(function(){if(t&&n&&e){let Mi=function(Bl,yo){var Zo=arguments.length>2&&arguments[2]!==void 0?arguments[2]:it,Cg=z.x+Bl,Ou=z.y+yo,Hm=Cg+Q,Fm=Ou+de,Km=Math.max(Cg,Zo.left),He=Math.max(Ou,Zo.top),_e=Math.min(Hm,Zo.right),qt=Math.min(Fm,Zo.bottom);return Math.max(0,(_e-Km)*(qt-He))},_u=function(){Le=z.y+T,ct=Le+de,st=z.x+be,Xt=st+Q};var p,y,Z,G,v=t,B=v.ownerDocument,R=Nu(v),X=R.getComputedStyle(v),W=X.width,V=X.height,Y=X.position,K=v.style.left,M=v.style.top,H=v.style.right,w=v.style.bottom,x=v.style.overflow,J=te(te({},r[i]),o),F=B.createElement("div");(p=v.parentElement)===null||p===void 0||p.appendChild(F),F.style.left="".concat(v.offsetLeft,"px"),F.style.top="".concat(v.offsetTop,"px"),F.style.position=Y,F.style.height="".concat(v.offsetHeight,"px"),F.style.width="".concat(v.offsetWidth,"px"),v.style.left="0",v.style.top="0",v.style.right="auto",v.style.bottom="auto",v.style.overflow="hidden";var S;if(Array.isArray(n))S={x:n[0],y:n[1],width:0,height:0};else{var E,N,k=n.getBoundingClientRect();k.x=(E=k.x)!==null&&E!==void 0?E:k.left,k.y=(N=k.y)!==null&&N!==void 0?N:k.top,S={x:k.x,y:k.y,width:k.width,height:k.height}}var z=v.getBoundingClientRect();z.x=(y=z.x)!==null&&y!==void 0?y:z.left,z.y=(Z=z.y)!==null&&Z!==void 0?Z:z.top;var L=B.documentElement,D=L.clientWidth,j=L.clientHeight,ne=L.scrollWidth,ie=L.scrollHeight,ae=L.scrollTop,Re=L.scrollLeft,de=z.height,Q=z.width,O=S.height,me=S.width,Ae={left:0,top:0,right:D,bottom:j},De={left:-Re,top:-ae,right:ne-Re,bottom:ie-ae},ke=J.htmlRegion,xe="visible",Ee="visibleFirst";ke!=="scroll"&&ke!==Ee&&(ke=xe);var We=ke===Ee,ze=RR(De,I),Ge=RR(Ae,I),it=ke===xe?Ge:ze,Pe=We?Ge:it;v.style.left="auto",v.style.top="auto",v.style.right="0",v.style.bottom="0";var U=v.getBoundingClientRect();v.style.left=K,v.style.top=M,v.style.right=H,v.style.bottom=w,v.style.overflow=x,(G=v.parentElement)===null||G===void 0||G.removeChild(F);var oe=gu(Math.round(Q/parseFloat(W)*1e3)/1e3),P=gu(Math.round(de/parseFloat(V)*1e3)/1e3);if(oe===0||P===0||$c(n)&&!uZ(n))return;var re=J.offset,ve=J.targetOffset,Fe=kR(z,re),Te=$(Fe,2),Xe=Te[0],Ye=Te[1],qe=kR(S,ve),$e=$(qe,2),et=$e[0],Oe=$e[1];S.x-=et,S.y-=Oe;var xt=J.points||[],Dt=$(xt,2),Ht=Dt[0],at=Dt[1],je=VR(at),Ke=VR(Ht),rt=Nl(S,je),Be=Nl(z,Ke),fe=te({},J),be=rt.x-Be.x+Xe,T=rt.y-Be.y+Ye,ee=Mi(be,T),le=Mi(be,T,Ge),q=Nl(S,["t","l"]),ge=Nl(z,["t","l"]),pe=Nl(S,["b","r"]),Ze=Nl(z,["b","r"]),Ce=J.overflow||{},we=Ce.adjustX,Se=Ce.adjustY,lt=Ce.shiftX,Rt=Ce.shiftY,cn=function(yo){return typeof yo=="boolean"?yo:yo>=0},Le,ct,st,Xt;_u();var Jt=cn(Se),_t=Ke[0]===je[0];if(Jt&&Ke[0]==="t"&&(ct>Pe.bottom||C.current.bt)){var Ot=T;_t?Ot-=de-O:Ot=q.y-Ze.y-Ye;var rr=Mi(be,Ot),At=Mi(be,Ot,Ge);rr>ee||rr===ee&&(!We||At>=le)?(C.current.bt=!0,T=Ot,Ye=-Ye,fe.points=[Go(Ke,0),Go(je,0)]):C.current.bt=!1}if(Jt&&Ke[0]==="b"&&(Le<Pe.top||C.current.tb)){var Me=T;_t?Me+=de-O:Me=pe.y-ge.y-Ye;var Ct=Mi(be,Me),St=Mi(be,Me,Ge);Ct>ee||Ct===ee&&(!We||St>=le)?(C.current.tb=!0,T=Me,Ye=-Ye,fe.points=[Go(Ke,0),Go(je,0)]):C.current.tb=!1}var Bn=cn(we),bn=Ke[1]===je[1];if(Bn&&Ke[1]==="l"&&(Xt>Pe.right||C.current.rl)){var Ln=be;bn?Ln-=Q-me:Ln=q.x-Ze.x-Xe;var mn=Mi(Ln,T),ti=Mi(Ln,T,Ge);mn>ee||mn===ee&&(!We||ti>=le)?(C.current.rl=!0,be=Ln,Xe=-Xe,fe.points=[Go(Ke,1),Go(je,1)]):C.current.rl=!1}if(Bn&&Ke[1]==="r"&&(st<Pe.left||C.current.lr)){var Rn=be;bn?Rn+=Q-me:Rn=pe.x-ge.x-Xe;var ho=Mi(Rn,T),mo=Mi(Rn,T,Ge);ho>ee||ho===ee&&(!We||mo>=le)?(C.current.lr=!0,be=Rn,Xe=-Xe,fe.points=[Go(Ke,1),Go(je,1)]):C.current.lr=!1}_u();var ni=lt===!0?0:lt;typeof ni=="number"&&(st<Ge.left&&(be-=st-Ge.left-Xe,S.x+me<Ge.left+ni&&(be+=S.x-Ge.left+me-ni)),Xt>Ge.right&&(be-=Xt-Ge.right-Xe,S.x>Ge.right-ni&&(be+=S.x-Ge.right+ni)));var ii=Rt===!0?0:Rt;typeof ii=="number"&&(Le<Ge.top&&(T-=Le-Ge.top-Ye,S.y+O<Ge.top+ii&&(T+=S.y-Ge.top+O-ii)),ct>Ge.bottom&&(T-=ct-Ge.bottom-Ye,S.y>Ge.bottom-ii&&(T+=S.y-Ge.bottom+ii)));var Ao=z.x+be,fo=Ao+Q,Ei=z.y+T,Ig=Ei+de,Ft=S.x,yt=Ft+me,Bt=S.y,Nn=Bt+O,Hn=Math.max(Ao,Ft),po=Math.min(fo,yt),bo=(Hn+po)/2,dg=bo-Ao,Sl=Math.max(Ei,Bt),Ga=Math.min(Ig,Nn),Mr=(Sl+Ga)/2,Sa=Mr-Ei;a==null||a(t,fe);var Ba=U.right-z.x-(be+z.width),Br=U.bottom-z.y-(T+z.height);oe===1&&(be=Math.round(be),Ba=Math.round(Ba)),P===1&&(T=Math.round(T),Br=Math.round(Br));var Nm={ready:!0,offsetX:be/oe,offsetY:T/P,offsetR:Ba/oe,offsetB:Br/P,arrowX:dg/oe,arrowY:Sa/P,scaleX:oe,scaleY:P,align:fe};c(Nm)}}),b=function(){u.current+=1;var y=u.current;Promise.resolve().then(function(){u.current===y&&f()})},A=function(){c(function(y){return te(te({},y),{},{ready:!1})})};return Kn(A,[i]),Kn(function(){e||A()},[e]),[g.ready,g.offsetX,g.offsetY,g.offsetR,g.offsetB,g.arrowX,g.arrowY,g.scaleX,g.scaleY,g.align,b]}function h8(e,t,n,i,r){Kn(function(){if(e&&t&&n){let u=function(){i(),r()};var o=t,a=n,l=wb(o),s=wb(a),g=Nu(a),c=new Set([g].concat(Yt(l),Yt(s)));return c.forEach(function(I){I.addEventListener("scroll",u,{passive:!0})}),g.addEventListener("resize",u,{passive:!0}),i(),function(){c.forEach(function(I){I.removeEventListener("scroll",u),g.removeEventListener("resize",u)})}}},[e,t,n])}function m8(e,t,n,i,r,o,a,l){var s=h.useRef(e);s.current=e;var g=h.useRef(!1);h.useEffect(function(){if(t&&i&&(!r||o)){var u=function(){g.current=!1},I=function(b){var A;s.current&&!a(((A=b.composedPath)===null||A===void 0||(A=A.call(b))===null||A===void 0?void 0:A[0])||b.target)&&!g.current&&l(!1)},C=Nu(i);C.addEventListener("pointerdown",u,!0),C.addEventListener("mousedown",I,!0),C.addEventListener("contextmenu",I,!0);var m=XC(n);return m&&(m.addEventListener("mousedown",I,!0),m.addEventListener("contextmenu",I,!0)),function(){C.removeEventListener("pointerdown",u,!0),C.removeEventListener("mousedown",I,!0),C.removeEventListener("contextmenu",I,!0),m&&(m.removeEventListener("mousedown",I,!0),m.removeEventListener("contextmenu",I,!0))}}},[t,n,i,r,o]);function c(){g.current=!0}return c}var A8=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function f8(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:VX,t=h.forwardRef(function(n,i){var r=n.prefixCls,o=r===void 0?"rc-trigger-popup":r,a=n.children,l=n.action,s=l===void 0?"hover":l,g=n.showAction,c=n.hideAction,u=n.popupVisible,I=n.defaultPopupVisible,C=n.onPopupVisibleChange,m=n.afterPopupVisibleChange,f=n.mouseEnterDelay,b=n.mouseLeaveDelay,A=b===void 0?.1:b,p=n.focusDelay,y=n.blurDelay,Z=n.mask,G=n.maskClosable,v=G===void 0?!0:G,B=n.getPopupContainer,R=n.forceRender,X=n.autoDestroy,W=n.destroyPopupOnHide,V=n.popup,Y=n.popupClassName,K=n.popupStyle,M=n.popupPlacement,H=n.builtinPlacements,w=H===void 0?{}:H,x=n.popupAlign,J=n.zIndex,F=n.stretch,S=n.getPopupClassNameFromAlign,E=n.fresh,N=n.alignPoint,k=n.onPopupClick,z=n.onPopupAlign,L=n.arrow,D=n.popupMotion,j=n.maskMotion,ne=n.popupTransitionName,ie=n.popupAnimation,ae=n.maskTransitionName,Re=n.maskAnimation,de=n.className,Q=n.getTriggerDOMNode,O=Zt(n,A8),me=X||W||!1,Ae=h.useState(!1),De=$(Ae,2),ke=De[0],xe=De[1];Kn(function(){xe(wX())},[]);var Ee=h.useRef({}),We=h.useContext(GR),ze=h.useMemo(function(){return{registerSubPopup:function(_e,qt){Ee.current[_e]=qt,We==null||We.registerSubPopup(_e,qt)}}},[We]),Ge=R4(),it=h.useState(null),Pe=$(it,2),U=Pe[0],oe=Pe[1],P=h.useRef(null),re=oi(function(He){P.current=He,$c(He)&&U!==He&&oe(He),We==null||We.registerSubPopup(Ge,He)}),ve=h.useState(null),Fe=$(ve,2),Te=Fe[0],Xe=Fe[1],Ye=h.useRef(null),qe=oi(function(He){$c(He)&&Te!==He&&(Xe(He),Ye.current=He)}),$e=h.Children.only(a),et=($e==null?void 0:$e.props)||{},Oe={},xt=oi(function(He){var _e,qt,yn=Te;return(yn==null?void 0:yn.contains(He))||((_e=XC(yn))===null||_e===void 0?void 0:_e.host)===He||He===yn||(U==null?void 0:U.contains(He))||((qt=XC(U))===null||qt===void 0?void 0:qt.host)===He||He===U||Object.values(Ee.current).some(function(un){return(un==null?void 0:un.contains(He))||He===un})}),Dt=BR(o,D,ie,ne),Ht=BR(o,j,Re,ae),at=h.useState(I||!1),je=$(at,2),Ke=je[0],rt=je[1],Be=u??Ke,fe=oi(function(He){u===void 0&&rt(He)});Kn(function(){rt(u||!1)},[u]);var be=h.useRef(Be);be.current=Be;var T=h.useRef([]);T.current=[];var ee=oi(function(He){var _e;fe(He),((_e=T.current[T.current.length-1])!==null&&_e!==void 0?_e:Be)!==He&&(T.current.push(He),C==null||C(He))}),le=h.useRef(),q=function(){clearTimeout(le.current)},ge=function(_e){var qt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;q(),qt===0?ee(_e):le.current=setTimeout(function(){ee(_e)},qt*1e3)};h.useEffect(function(){return q},[]);var pe=h.useState(!1),Ze=$(pe,2),Ce=Ze[0],we=Ze[1];Kn(function(He){(!He||Be)&&we(!0)},[Be]);var Se=h.useState(null),lt=$(Se,2),Rt=lt[0],cn=lt[1],Le=h.useState(null),ct=$(Le,2),st=ct[0],Xt=ct[1],Jt=function(_e){Xt([_e.clientX,_e.clientY])},_t=C8(Be,U,N&&st!==null?st:Te,M,w,x,z),Ot=$(_t,11),rr=Ot[0],At=Ot[1],Me=Ot[2],Ct=Ot[3],St=Ot[4],Bn=Ot[5],bn=Ot[6],Ln=Ot[7],mn=Ot[8],ti=Ot[9],Rn=Ot[10],ho=u8(ke,s,g,c),mo=$(ho,2),ni=mo[0],ii=mo[1],Ao=ni.has("click"),fo=ii.has("click")||ii.has("contextMenu"),Ei=oi(function(){Ce||Rn()}),Ig=function(){be.current&&N&&fo&&ge(!1)};h8(Be,Te,U,Ei,Ig),Kn(function(){Ei()},[st,M]),Kn(function(){Be&&!(w!=null&&w[M])&&Ei()},[JSON.stringify(x)]);var Ft=h.useMemo(function(){var He=d8(w,o,ti,N);return he(He,S==null?void 0:S(ti))},[ti,S,w,o,N]);h.useImperativeHandle(i,function(){return{nativeElement:Ye.current,popupElement:P.current,forceAlign:Ei}});var yt=h.useState(0),Bt=$(yt,2),Nn=Bt[0],Hn=Bt[1],po=h.useState(0),bo=$(po,2),dg=bo[0],Sl=bo[1],Ga=function(){if(F&&Te){var _e=Te.getBoundingClientRect();Hn(_e.width),Sl(_e.height)}},Mr=function(){Ga(),Ei()},Sa=function(_e){we(!1),Rn(),m==null||m(_e)},Ba=function(){return new Promise(function(_e){Ga(),cn(function(){return _e})})};Kn(function(){Rt&&(Rn(),Rt(),cn(null))},[Rt]);function Br(He,_e,qt,yn){Oe[He]=function(un){var qu;yn==null||yn(un),ge(_e,qt);for(var Em=arguments.length,lv=new Array(Em>1?Em-1:0),$u=1;$u<Em;$u++)lv[$u-1]=arguments[$u];(qu=et[He])===null||qu===void 0||qu.call.apply(qu,[et,un].concat(lv))}}(Ao||fo)&&(Oe.onClick=function(He){var _e;be.current&&fo?ge(!1):!be.current&&Ao&&(Jt(He),ge(!0));for(var qt=arguments.length,yn=new Array(qt>1?qt-1:0),un=1;un<qt;un++)yn[un-1]=arguments[un];(_e=et.onClick)===null||_e===void 0||_e.call.apply(_e,[et,He].concat(yn))});var Nm=m8(Be,fo,Te,U,Z,v,xt,ge),Mi=ni.has("hover"),_u=ii.has("hover"),Bl,yo;Mi&&(Br("onMouseEnter",!0,f,function(He){Jt(He)}),Br("onPointerEnter",!0,f,function(He){Jt(He)}),Bl=function(_e){(Be||Ce)&&U!==null&&U!==void 0&&U.contains(_e.target)&&ge(!0,f)},N&&(Oe.onMouseMove=function(He){var _e;(_e=et.onMouseMove)===null||_e===void 0||_e.call(et,He)})),_u&&(Br("onMouseLeave",!1,A),Br("onPointerLeave",!1,A),yo=function(){ge(!1,A)}),ni.has("focus")&&Br("onFocus",!0,p),ii.has("focus")&&Br("onBlur",!1,y),ni.has("contextMenu")&&(Oe.onContextMenu=function(He){var _e;be.current&&ii.has("contextMenu")?ge(!1):(Jt(He),ge(!0)),He.preventDefault();for(var qt=arguments.length,yn=new Array(qt>1?qt-1:0),un=1;un<qt;un++)yn[un-1]=arguments[un];(_e=et.onContextMenu)===null||_e===void 0||_e.call.apply(_e,[et,He].concat(yn))}),de&&(Oe.className=he(et.className,de));var Zo=te(te({},et),Oe),Cg={},Ou=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];Ou.forEach(function(He){O[He]&&(Cg[He]=function(){for(var _e,qt=arguments.length,yn=new Array(qt),un=0;un<qt;un++)yn[un]=arguments[un];(_e=Zo[He])===null||_e===void 0||_e.call.apply(_e,[Zo].concat(yn)),O[He].apply(O,yn)})});var Hm=h.cloneElement($e,te(te({},Zo),Cg)),Fm={x:Bn,y:bn},Km=L?te({},L!==!0?L:{}):null;return h.createElement(h.Fragment,null,h.createElement(oa,{disabled:!Be,ref:qe,onResize:Mr},h.createElement(c8,{getTriggerDOMNode:Q},Hm)),h.createElement(GR.Provider,{value:ze},h.createElement(g8,{portal:e,ref:re,prefixCls:o,popup:V,className:he(Y,Ft),style:K,target:Te,onMouseEnter:Bl,onMouseLeave:yo,onPointerEnter:Bl,zIndex:J,open:Be,keepDom:Ce,fresh:E,onClick:k,onPointerDownCapture:Nm,mask:Z,motion:Dt,maskMotion:Ht,onVisibleChanged:Sa,onPrepare:Ba,forceRender:R,autoDestroy:me,getPopupContainer:B,align:ti,arrow:Km,arrowPos:Fm,ready:rr,offsetX:At,offsetY:Me,offsetR:Ct,offsetB:St,onAlign:Ei,stretch:F,targetWidth:Nn/Ln,targetHeight:dg/mn})))});return t}const YX=f8(VX);var p8=Je.ESC,b8=Je.TAB;function y8(e){var t=e.visible,n=e.triggerRef,i=e.onVisibleChange,r=e.autoFocus,o=e.overlayRef,a=h.useRef(!1),l=function(){if(t){var u,I;(u=n.current)===null||u===void 0||(I=u.focus)===null||I===void 0||I.call(u),i==null||i(!1)}},s=function(){var u;return(u=o.current)!==null&&u!==void 0&&u.focus?(o.current.focus(),a.current=!0,!0):!1},g=function(u){switch(u.keyCode){case p8:l();break;case b8:{var I=!1;a.current||(I=s()),I?u.preventDefault():l();break}}};h.useEffect(function(){return t?(window.addEventListener("keydown",g),r&&On(s,3),function(){window.removeEventListener("keydown",g),a.current=!1}):function(){a.current=!1}},[t])}var Z8=h.forwardRef(function(e,t){var n=e.overlay,i=e.arrow,r=e.prefixCls,o=h.useMemo(function(){var l;return typeof n=="function"?l=n():l=n,l},[n]),a=Ps(t,Os(o));return ce.createElement(ce.Fragment,null,i&&ce.createElement("div",{className:"".concat(r,"-arrow")}),ce.cloneElement(o,{ref:Al(o)?a:void 0}))}),Hl={adjustX:1,adjustY:1},Fl=[0,0],v8={topLeft:{points:["bl","tl"],overflow:Hl,offset:[0,-4],targetOffset:Fl},top:{points:["bc","tc"],overflow:Hl,offset:[0,-4],targetOffset:Fl},topRight:{points:["br","tr"],overflow:Hl,offset:[0,-4],targetOffset:Fl},bottomLeft:{points:["tl","bl"],overflow:Hl,offset:[0,4],targetOffset:Fl},bottom:{points:["tc","bc"],overflow:Hl,offset:[0,4],targetOffset:Fl},bottomRight:{points:["tr","br"],overflow:Hl,offset:[0,4],targetOffset:Fl}},G8=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function S8(e,t){var n,i=e.arrow,r=i===void 0?!1:i,o=e.prefixCls,a=o===void 0?"rc-dropdown":o,l=e.transitionName,s=e.animation,g=e.align,c=e.placement,u=c===void 0?"bottomLeft":c,I=e.placements,C=I===void 0?v8:I,m=e.getPopupContainer,f=e.showAction,b=e.hideAction,A=e.overlayClassName,p=e.overlayStyle,y=e.visible,Z=e.trigger,G=Z===void 0?["hover"]:Z,v=e.autoFocus,B=e.overlay,R=e.children,X=e.onVisibleChange,W=Zt(e,G8),V=ce.useState(),Y=$(V,2),K=Y[0],M=Y[1],H="visible"in e?y:K,w=ce.useRef(null),x=ce.useRef(null),J=ce.useRef(null);ce.useImperativeHandle(t,function(){return w.current});var F=function(ne){M(ne),X==null||X(ne)};y8({visible:H,triggerRef:J,onVisibleChange:F,autoFocus:v,overlayRef:x});var S=function(ne){var ie=e.onOverlayClick;M(!1),ie&&ie(ne)},E=function(){return ce.createElement(Z8,{ref:x,overlay:B,prefixCls:a,arrow:r})},N=function(){return typeof B=="function"?E:E()},k=function(){var ne=e.minOverlayWidthMatchTrigger,ie=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?ne:!ie},z=function(){var ne=e.openClassName;return ne!==void 0?ne:"".concat(a,"-open")},L=ce.cloneElement(R,{className:he((n=R.props)===null||n===void 0?void 0:n.className,H&&z()),ref:Al(R)?Ps(J,Os(R)):void 0}),D=b;return!D&&G.indexOf("contextMenu")!==-1&&(D=["click"]),ce.createElement(YX,Qe({builtinPlacements:C},W,{prefixCls:a,ref:w,popupClassName:he(A,se({},"".concat(a,"-show-arrow"),r)),popupStyle:p,action:G,showAction:f,hideAction:D,popupPlacement:u,popupAlign:g,popupTransitionName:l,popupAnimation:s,popupVisible:H,stretch:k()?"minWidth":"",popup:N(),onPopupVisibleChange:F,onPopupClick:S,getPopupContainer:m}),L)}const B8=ce.forwardRef(S8);var NX=h.createContext(null);function HX(e,t){return e===void 0?null:"".concat(e,"-").concat(t)}function FX(e){var t=h.useContext(NX);return HX(t,e)}var R8=["children","locked"],br=h.createContext(null);function W8(e,t){var n=te({},e);return Object.keys(t).forEach(function(i){var r=t[i];r!==void 0&&(n[i]=r)}),n}function cu(e){var t=e.children,n=e.locked,i=Zt(e,R8),r=h.useContext(br),o=_h(function(){return W8(r,i)},[r,i],function(a,l){return!n&&(a[0]!==l[0]||!$y(a[1],l[1],!0))});return h.createElement(br.Provider,{value:o},t)}var k8=[],KX=h.createContext(null);function Cm(){return h.useContext(KX)}var EX=h.createContext(k8);function Hu(e){var t=h.useContext(EX);return h.useMemo(function(){return e!==void 0?[].concat(Yt(t),[e]):t},[t,e])}var MX=h.createContext(null),mZ=h.createContext({});function wR(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(uZ(e)){var n=e.nodeName.toLowerCase(),i=["input","select","textarea","button"].includes(n)||e.isContentEditable||n==="a"&&!!e.getAttribute("href"),r=e.getAttribute("tabindex"),o=Number(r),a=null;return r&&!Number.isNaN(o)?a=o:i&&a===null&&(a=0),i&&e.disabled&&(a=null),a!==null&&(a>=0||t&&a<0)}return!1}function V8(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=Yt(e.querySelectorAll("*")).filter(function(i){return wR(i,t)});return wR(e,t)&&n.unshift(e),n}var xb=Je.LEFT,Xb=Je.RIGHT,Jb=Je.UP,Xd=Je.DOWN,Jd=Je.ENTER,zX=Je.ESC,Hg=Je.HOME,Fg=Je.END,xR=[Jb,Xd,xb,Xb];function w8(e,t,n,i){var r,o="prev",a="next",l="children",s="parent";if(e==="inline"&&i===Jd)return{inlineTrigger:!0};var g=se(se({},Jb,o),Xd,a),c=se(se(se(se({},xb,n?a:o),Xb,n?o:a),Xd,l),Jd,l),u=se(se(se(se(se(se({},Jb,o),Xd,a),Jd,l),zX,s),xb,n?l:s),Xb,n?s:l),I={inline:g,horizontal:c,vertical:u,inlineSub:g,horizontalSub:u,verticalSub:u},C=(r=I["".concat(e).concat(t?"":"Sub")])===null||r===void 0?void 0:r[i];switch(C){case o:return{offset:-1,sibling:!0};case a:return{offset:1,sibling:!0};case s:return{offset:-1,sibling:!1};case l:return{offset:1,sibling:!1};default:return null}}function x8(e){for(var t=e;t;){if(t.getAttribute("data-menu-list"))return t;t=t.parentElement}return null}function X8(e,t){for(var n=e||document.activeElement;n;){if(t.has(n))return n;n=n.parentElement}return null}function AZ(e,t){var n=V8(e,!0);return n.filter(function(i){return t.has(i)})}function XR(e,t,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(!e)return null;var r=AZ(e,t),o=r.length,a=r.findIndex(function(l){return n===l});return i<0?a===-1?a=o-1:a-=1:i>0&&(a+=1),a=(a+o)%o,r[a]}var Yb=function(t,n){var i=new Set,r=new Map,o=new Map;return t.forEach(function(a){var l=document.querySelector("[data-menu-id='".concat(HX(n,a),"']"));l&&(i.add(l),o.set(l,a),r.set(a,l))}),{elements:i,key2element:r,element2key:o}};function J8(e,t,n,i,r,o,a,l,s,g){var c=h.useRef(),u=h.useRef();u.current=t;var I=function(){On.cancel(c.current)};return h.useEffect(function(){return function(){I()}},[]),function(C){var m=C.which;if([].concat(xR,[Jd,zX,Hg,Fg]).includes(m)){var f=o(),b=Yb(f,i),A=b,p=A.elements,y=A.key2element,Z=A.element2key,G=y.get(t),v=X8(G,p),B=Z.get(v),R=w8(e,a(B,!0).length===1,n,m);if(!R&&m!==Hg&&m!==Fg)return;(xR.includes(m)||[Hg,Fg].includes(m))&&C.preventDefault();var X=function(x){if(x){var J=x,F=x.querySelector("a");F!=null&&F.getAttribute("href")&&(J=F);var S=Z.get(x);l(S),I(),c.current=On(function(){u.current===S&&J.focus()})}};if([Hg,Fg].includes(m)||R.sibling||!v){var W;!v||e==="inline"?W=r.current:W=x8(v);var V,Y=AZ(W,p);m===Hg?V=Y[0]:m===Fg?V=Y[Y.length-1]:V=XR(W,p,v,R.offset),X(V)}else if(R.inlineTrigger)s(B);else if(R.offset>0)s(B,!0),I(),c.current=On(function(){b=Yb(f,i);var w=v.getAttribute("aria-controls"),x=document.getElementById(w),J=XR(x,b.elements);X(J)},5);else if(R.offset<0){var K=a(B,!0),M=K[K.length-2],H=y.get(M);s(M,!1),X(H)}}g==null||g(C)}}function Y8(e){Promise.resolve().then(e)}var fZ="__RC_UTIL_PATH_SPLIT__",JR=function(t){return t.join(fZ)},N8=function(t){return t.split(fZ)},Nb="rc-menu-more";function H8(){var e=h.useState({}),t=$(e,2),n=t[1],i=h.useRef(new Map),r=h.useRef(new Map),o=h.useState([]),a=$(o,2),l=a[0],s=a[1],g=h.useRef(0),c=h.useRef(!1),u=function(){c.current||n({})},I=h.useCallback(function(y,Z){var G=JR(Z);r.current.set(G,y),i.current.set(y,G),g.current+=1;var v=g.current;Y8(function(){v===g.current&&u()})},[]),C=h.useCallback(function(y,Z){var G=JR(Z);r.current.delete(G),i.current.delete(y)},[]),m=h.useCallback(function(y){s(y)},[]),f=h.useCallback(function(y,Z){var G=i.current.get(y)||"",v=N8(G);return Z&&l.includes(v[0])&&v.unshift(Nb),v},[l]),b=h.useCallback(function(y,Z){return y.filter(function(G){return G!==void 0}).some(function(G){var v=f(G,!0);return v.includes(Z)})},[f]),A=function(){var Z=Yt(i.current.keys());return l.length&&Z.push(Nb),Z},p=h.useCallback(function(y){var Z="".concat(i.current.get(y)).concat(fZ),G=new Set;return Yt(r.current.keys()).forEach(function(v){v.startsWith(Z)&&G.add(r.current.get(v))}),G},[]);return h.useEffect(function(){return function(){c.current=!0}},[]),{registerPath:I,unregisterPath:C,refreshOverflowKeys:m,isSubPathKey:b,getKeyPath:f,getKeys:A,getSubPathKeys:p}}function ec(e){var t=h.useRef(e);t.current=e;var n=h.useCallback(function(){for(var i,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(i=t.current)===null||i===void 0?void 0:i.call.apply(i,[t].concat(o))},[]);return e?n:void 0}var F8=Math.random().toFixed(5).toString().slice(2),YR=0;function K8(e){var t=As(e,{value:e}),n=$(t,2),i=n[0],r=n[1];return h.useEffect(function(){YR+=1;var o="".concat(F8,"-").concat(YR);r("rc-menu-uuid-".concat(o))},[]),i}function LX(e,t,n,i){var r=h.useContext(br),o=r.activeKey,a=r.onActive,l=r.onInactive,s={active:o===e};return t||(s.onMouseEnter=function(g){n==null||n({key:e,domEvent:g}),a(e)},s.onMouseLeave=function(g){i==null||i({key:e,domEvent:g}),l(e)}),s}function DX(e){var t=h.useContext(br),n=t.mode,i=t.rtl,r=t.inlineIndent;if(n!=="inline")return null;var o=e;return i?{paddingRight:o*r}:{paddingLeft:o*r}}function TX(e){var t=e.icon,n=e.props,i=e.children,r;return t===null||t===!1?null:(typeof t=="function"?r=h.createElement(t,te({},n)):typeof t!="boolean"&&(r=t),r||i||null)}var E8=["item"];function NC(e){var t=e.item,n=Zt(e,E8);return Object.defineProperty(n,"item",{get:function(){return ml(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),t}}),n}var M8=["title","attribute","elementRef"],z8=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],L8=["active"],D8=function(e){fl(n,e);var t=pl(n);function n(){return Zi(this,n),t.apply(this,arguments)}return vi(n,[{key:"render",value:function(){var r=this.props,o=r.title,a=r.attribute,l=r.elementRef,s=Zt(r,M8),g=pa(s,["eventKey","popupClassName","popupOffset","onTitleClick"]);return ml(!a,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),h.createElement(ro.Item,Qe({},a,{title:typeof o=="string"?o:void 0},g,{ref:l}))}}]),n}(h.Component),T8=h.forwardRef(function(e,t){var n=e.style,i=e.className,r=e.eventKey;e.warnKey;var o=e.disabled,a=e.itemIcon,l=e.children,s=e.role,g=e.onMouseEnter,c=e.onMouseLeave,u=e.onClick,I=e.onKeyDown,C=e.onFocus,m=Zt(e,z8),f=FX(r),b=h.useContext(br),A=b.prefixCls,p=b.onItemClick,y=b.disabled,Z=b.overflowDisabled,G=b.itemIcon,v=b.selectedKeys,B=b.onActive,R=h.useContext(mZ),X=R._internalRenderMenuItem,W="".concat(A,"-item"),V=h.useRef(),Y=h.useRef(),K=y||o,M=_s(t,Y),H=Hu(r),w=function(ie){return{key:r,keyPath:Yt(H).reverse(),item:V.current,domEvent:ie}},x=a||G,J=LX(r,K,g,c),F=J.active,S=Zt(J,L8),E=v.includes(r),N=DX(H.length),k=function(ie){if(!K){var ae=w(ie);u==null||u(NC(ae)),p(ae)}},z=function(ie){if(I==null||I(ie),ie.which===Je.ENTER){var ae=w(ie);u==null||u(NC(ae)),p(ae)}},L=function(ie){B(r),C==null||C(ie)},D={};e.role==="option"&&(D["aria-selected"]=E);var j=h.createElement(D8,Qe({ref:V,elementRef:M,role:s===null?"none":s||"menuitem",tabIndex:o?null:-1,"data-menu-id":Z&&f?null:f},pa(m,["extra"]),S,D,{component:"li","aria-disabled":o,style:te(te({},N),n),className:he(W,se(se(se({},"".concat(W,"-active"),F),"".concat(W,"-selected"),E),"".concat(W,"-disabled"),K),i),onClick:k,onKeyDown:z,onFocus:L}),l,h.createElement(TX,{props:te(te({},e),{},{isSelected:E}),icon:x}));return X&&(j=X(j,e,{selected:E})),j});function j8(e,t){var n=e.eventKey,i=Cm(),r=Hu(n);return h.useEffect(function(){if(i)return i.registerPath(n,r),function(){i.unregisterPath(n,r)}},[r]),i?null:h.createElement(T8,Qe({},e,{ref:t}))}const hm=h.forwardRef(j8);var U8=["className","children"],Q8=function(t,n){var i=t.className,r=t.children,o=Zt(t,U8),a=h.useContext(br),l=a.prefixCls,s=a.mode,g=a.rtl;return h.createElement("ul",Qe({className:he(l,g&&"".concat(l,"-rtl"),"".concat(l,"-sub"),"".concat(l,"-").concat(s==="inline"?"inline":"vertical"),i),role:"menu"},o,{"data-menu-list":!0,ref:n}),r)},pZ=h.forwardRef(Q8);pZ.displayName="SubMenuList";function bZ(e,t){return sl(e).map(function(n,i){if(h.isValidElement(n)){var r,o,a=n.key,l=(r=(o=n.props)===null||o===void 0?void 0:o.eventKey)!==null&&r!==void 0?r:a,s=l==null;s&&(l="tmp_key-".concat([].concat(Yt(t),[i]).join("-")));var g={key:l,eventKey:l};return h.cloneElement(n,g)}return n})}var Un={adjustX:1,adjustY:1},P8={topLeft:{points:["bl","tl"],overflow:Un},topRight:{points:["br","tr"],overflow:Un},bottomLeft:{points:["tl","bl"],overflow:Un},bottomRight:{points:["tr","br"],overflow:Un},leftTop:{points:["tr","tl"],overflow:Un},leftBottom:{points:["br","bl"],overflow:Un},rightTop:{points:["tl","tr"],overflow:Un},rightBottom:{points:["bl","br"],overflow:Un}},_8={topLeft:{points:["bl","tl"],overflow:Un},topRight:{points:["br","tr"],overflow:Un},bottomLeft:{points:["tl","bl"],overflow:Un},bottomRight:{points:["tr","br"],overflow:Un},rightTop:{points:["tr","tl"],overflow:Un},rightBottom:{points:["br","bl"],overflow:Un},leftTop:{points:["tl","tr"],overflow:Un},leftBottom:{points:["bl","br"],overflow:Un}};function jX(e,t,n){if(t)return t;if(n)return n[e]||n.other}var O8={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function q8(e){var t=e.prefixCls,n=e.visible,i=e.children,r=e.popup,o=e.popupStyle,a=e.popupClassName,l=e.popupOffset,s=e.disabled,g=e.mode,c=e.onVisibleChange,u=h.useContext(br),I=u.getPopupContainer,C=u.rtl,m=u.subMenuOpenDelay,f=u.subMenuCloseDelay,b=u.builtinPlacements,A=u.triggerSubMenuAction,p=u.forceSubMenuRender,y=u.rootClassName,Z=u.motion,G=u.defaultMotions,v=h.useState(!1),B=$(v,2),R=B[0],X=B[1],W=te(C?te({},_8):te({},P8),b),V=O8[g],Y=jX(g,Z,G),K=h.useRef(Y);g!=="inline"&&(K.current=Y);var M=te(te({},K.current),{},{leavedClassName:"".concat(t,"-hidden"),removeOnLeave:!1,motionAppear:!0}),H=h.useRef();return h.useEffect(function(){return H.current=On(function(){X(n)}),function(){On.cancel(H.current)}},[n]),h.createElement(YX,{prefixCls:t,popupClassName:he("".concat(t,"-popup"),se({},"".concat(t,"-rtl"),C),a,y),stretch:g==="horizontal"?"minWidth":null,getPopupContainer:I,builtinPlacements:W,popupPlacement:V,popupVisible:R,popup:r,popupStyle:o,popupAlign:l&&{offset:l},action:s?[]:[A],mouseEnterDelay:m,mouseLeaveDelay:f,onPopupVisibleChange:c,forceRender:p,popupMotion:M,fresh:!0},i)}function $8(e){var t=e.id,n=e.open,i=e.keyPath,r=e.children,o="inline",a=h.useContext(br),l=a.prefixCls,s=a.forceSubMenuRender,g=a.motion,c=a.defaultMotions,u=a.mode,I=h.useRef(!1);I.current=u===o;var C=h.useState(!I.current),m=$(C,2),f=m[0],b=m[1],A=I.current?n:!1;h.useEffect(function(){I.current&&b(!1)},[u]);var p=te({},jX(o,g,c));i.length>1&&(p.motionAppear=!1);var y=p.onVisibleChanged;return p.onVisibleChanged=function(Z){return!I.current&&!Z&&b(!0),y==null?void 0:y(Z)},f?null:h.createElement(cu,{mode:o,locked:!I.current},h.createElement(yl,Qe({visible:A},p,{forceRender:s,removeOnLeave:!1,leavedClassName:"".concat(l,"-hidden")}),function(Z){var G=Z.className,v=Z.style;return h.createElement(pZ,{id:t,className:G,style:v},r)}))}var e7=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","popupStyle","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],t7=["active"],n7=h.forwardRef(function(e,t){var n=e.style,i=e.className,r=e.title,o=e.eventKey;e.warnKey;var a=e.disabled,l=e.internalPopupClose,s=e.children,g=e.itemIcon,c=e.expandIcon,u=e.popupClassName,I=e.popupOffset,C=e.popupStyle,m=e.onClick,f=e.onMouseEnter,b=e.onMouseLeave,A=e.onTitleClick,p=e.onTitleMouseEnter,y=e.onTitleMouseLeave,Z=Zt(e,e7),G=FX(o),v=h.useContext(br),B=v.prefixCls,R=v.mode,X=v.openKeys,W=v.disabled,V=v.overflowDisabled,Y=v.activeKey,K=v.selectedKeys,M=v.itemIcon,H=v.expandIcon,w=v.onItemClick,x=v.onOpenChange,J=v.onActive,F=h.useContext(mZ),S=F._internalRenderSubMenuItem,E=h.useContext(MX),N=E.isSubPathKey,k=Hu(),z="".concat(B,"-submenu"),L=W||a,D=h.useRef(),j=h.useRef(),ne=g??M,ie=c??H,ae=X.includes(o),Re=!V&&ae,de=N(K,o),Q=LX(o,L,p,y),O=Q.active,me=Zt(Q,t7),Ae=h.useState(!1),De=$(Ae,2),ke=De[0],xe=De[1],Ee=function(qe){L||xe(qe)},We=function(qe){Ee(!0),f==null||f({key:o,domEvent:qe})},ze=function(qe){Ee(!1),b==null||b({key:o,domEvent:qe})},Ge=h.useMemo(function(){return O||(R!=="inline"?ke||N([Y],o):!1)},[R,O,Y,ke,o,N]),it=DX(k.length),Pe=function(qe){L||(A==null||A({key:o,domEvent:qe}),R==="inline"&&x(o,!ae))},U=ec(function(Ye){m==null||m(NC(Ye)),w(Ye)}),oe=function(qe){R!=="inline"&&x(o,qe)},P=function(){J(o)},re=G&&"".concat(G,"-popup"),ve=h.createElement("div",Qe({role:"menuitem",style:it,className:"".concat(z,"-title"),tabIndex:L?null:-1,ref:D,title:typeof r=="string"?r:null,"data-menu-id":V&&G?null:G,"aria-expanded":Re,"aria-haspopup":!0,"aria-controls":re,"aria-disabled":L,onClick:Pe,onFocus:P},me),r,h.createElement(TX,{icon:R!=="horizontal"?ie:void 0,props:te(te({},e),{},{isOpen:Re,isSubMenu:!0})},h.createElement("i",{className:"".concat(z,"-arrow")}))),Fe=h.useRef(R);if(R!=="inline"&&k.length>1?Fe.current="vertical":Fe.current=R,!V){var Te=Fe.current;ve=h.createElement(q8,{mode:Te,prefixCls:z,visible:!l&&Re&&R!=="inline",popupClassName:u,popupOffset:I,popupStyle:C,popup:h.createElement(cu,{mode:Te==="horizontal"?"vertical":Te},h.createElement(pZ,{id:re,ref:j},s)),disabled:L,onVisibleChange:oe},ve)}var Xe=h.createElement(ro.Item,Qe({ref:t,role:"none"},Z,{component:"li",style:n,className:he(z,"".concat(z,"-").concat(R),i,se(se(se(se({},"".concat(z,"-open"),Re),"".concat(z,"-active"),Ge),"".concat(z,"-selected"),de),"".concat(z,"-disabled"),L)),onMouseEnter:We,onMouseLeave:ze}),ve,!V&&h.createElement($8,{id:re,open:Re,keyPath:k},s));return S&&(Xe=S(Xe,e,{selected:de,active:Ge,open:Re,disabled:L})),h.createElement(cu,{onItemClick:U,mode:R==="horizontal"?"vertical":R,itemIcon:ne,expandIcon:ie},Xe)}),yZ=h.forwardRef(function(e,t){var n=e.eventKey,i=e.children,r=Hu(n),o=bZ(i,r),a=Cm();h.useEffect(function(){if(a)return a.registerPath(n,r),function(){a.unregisterPath(n,r)}},[r]);var l;return a?l=o:l=h.createElement(n7,Qe({ref:t},e),o),h.createElement(EX.Provider,{value:r},l)});function UX(e){var t=e.className,n=e.style,i=h.useContext(br),r=i.prefixCls,o=Cm();return o?null:h.createElement("li",{role:"separator",className:he("".concat(r,"-item-divider"),t),style:n})}var i7=["className","title","eventKey","children"],r7=h.forwardRef(function(e,t){var n=e.className,i=e.title;e.eventKey;var r=e.children,o=Zt(e,i7),a=h.useContext(br),l=a.prefixCls,s="".concat(l,"-item-group");return h.createElement("li",Qe({ref:t,role:"presentation"},o,{onClick:function(c){return c.stopPropagation()},className:he(s,n)}),h.createElement("div",{role:"presentation",className:"".concat(s,"-title"),title:typeof i=="string"?i:void 0},i),h.createElement("ul",{role:"group",className:"".concat(s,"-list")},r))}),QX=h.forwardRef(function(e,t){var n=e.eventKey,i=e.children,r=Hu(n),o=bZ(i,r),a=Cm();return a?o:h.createElement(r7,Qe({ref:t},pa(e,["warnKey"])),o)}),o7=["label","children","key","type","extra"];function Hb(e,t,n){var i=t.item,r=t.group,o=t.submenu,a=t.divider;return(e||[]).map(function(l,s){if(l&&gt(l)==="object"){var g=l,c=g.label,u=g.children,I=g.key,C=g.type,m=g.extra,f=Zt(g,o7),b=I??"tmp-".concat(s);return u||C==="group"?C==="group"?h.createElement(r,Qe({key:b},f,{title:c}),Hb(u,t,n)):h.createElement(o,Qe({key:b},f,{title:c}),Hb(u,t,n)):C==="divider"?h.createElement(a,Qe({key:b},f)):h.createElement(i,Qe({key:b},f,{extra:m}),c,(!!m||m===0)&&h.createElement("span",{className:"".concat(n,"-item-extra")},m))}return null}).filter(function(l){return l})}function NR(e,t,n,i,r){var o=e,a=te({divider:UX,item:hm,group:QX,submenu:yZ},i);return t&&(o=Hb(t,a,r)),bZ(o,n)}var a7=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem","_internalComponents"],xa=[],l7=h.forwardRef(function(e,t){var n,i=e,r=i.prefixCls,o=r===void 0?"rc-menu":r,a=i.rootClassName,l=i.style,s=i.className,g=i.tabIndex,c=g===void 0?0:g,u=i.items,I=i.children,C=i.direction,m=i.id,f=i.mode,b=f===void 0?"vertical":f,A=i.inlineCollapsed,p=i.disabled,y=i.disabledOverflow,Z=i.subMenuOpenDelay,G=Z===void 0?.1:Z,v=i.subMenuCloseDelay,B=v===void 0?.1:v,R=i.forceSubMenuRender,X=i.defaultOpenKeys,W=i.openKeys,V=i.activeKey,Y=i.defaultActiveFirst,K=i.selectable,M=K===void 0?!0:K,H=i.multiple,w=H===void 0?!1:H,x=i.defaultSelectedKeys,J=i.selectedKeys,F=i.onSelect,S=i.onDeselect,E=i.inlineIndent,N=E===void 0?24:E,k=i.motion,z=i.defaultMotions,L=i.triggerSubMenuAction,D=L===void 0?"hover":L,j=i.builtinPlacements,ne=i.itemIcon,ie=i.expandIcon,ae=i.overflowedIndicator,Re=ae===void 0?"...":ae,de=i.overflowedIndicatorPopupClassName,Q=i.getPopupContainer,O=i.onClick,me=i.onOpenChange,Ae=i.onKeyDown;i.openAnimation,i.openTransitionName;var De=i._internalRenderMenuItem,ke=i._internalRenderSubMenuItem,xe=i._internalComponents,Ee=Zt(i,a7),We=h.useMemo(function(){return[NR(I,u,xa,xe,o),NR(I,u,xa,{},o)]},[I,u,xe]),ze=$(We,2),Ge=ze[0],it=ze[1],Pe=h.useState(!1),U=$(Pe,2),oe=U[0],P=U[1],re=h.useRef(),ve=K8(m),Fe=C==="rtl",Te=As(X,{value:W,postState:function(yt){return yt||xa}}),Xe=$(Te,2),Ye=Xe[0],qe=Xe[1],$e=function(yt){var Bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;function Nn(){qe(yt),me==null||me(yt)}Bt?_i.flushSync(Nn):Nn()},et=h.useState(Ye),Oe=$(et,2),xt=Oe[0],Dt=Oe[1],Ht=h.useRef(!1),at=h.useMemo(function(){return(b==="inline"||b==="vertical")&&A?["vertical",A]:[b,!1]},[b,A]),je=$(at,2),Ke=je[0],rt=je[1],Be=Ke==="inline",fe=h.useState(Ke),be=$(fe,2),T=be[0],ee=be[1],le=h.useState(rt),q=$(le,2),ge=q[0],pe=q[1];h.useEffect(function(){ee(Ke),pe(rt),Ht.current&&(Be?qe(xt):$e(xa))},[Ke,rt]);var Ze=h.useState(0),Ce=$(Ze,2),we=Ce[0],Se=Ce[1],lt=we>=Ge.length-1||T!=="horizontal"||y;h.useEffect(function(){Be&&Dt(Ye)},[Ye]),h.useEffect(function(){return Ht.current=!0,function(){Ht.current=!1}},[]);var Rt=H8(),cn=Rt.registerPath,Le=Rt.unregisterPath,ct=Rt.refreshOverflowKeys,st=Rt.isSubPathKey,Xt=Rt.getKeyPath,Jt=Rt.getKeys,_t=Rt.getSubPathKeys,Ot=h.useMemo(function(){return{registerPath:cn,unregisterPath:Le}},[cn,Le]),rr=h.useMemo(function(){return{isSubPathKey:st}},[st]);h.useEffect(function(){ct(lt?xa:Ge.slice(we+1).map(function(Ft){return Ft.key}))},[we,lt]);var At=As(V||Y&&((n=Ge[0])===null||n===void 0?void 0:n.key),{value:V}),Me=$(At,2),Ct=Me[0],St=Me[1],Bn=ec(function(Ft){St(Ft)}),bn=ec(function(){St(void 0)});h.useImperativeHandle(t,function(){return{list:re.current,focus:function(yt){var Bt,Nn=Jt(),Hn=Yb(Nn,ve),po=Hn.elements,bo=Hn.key2element,dg=Hn.element2key,Sl=AZ(re.current,po),Ga=Ct??(Sl[0]?dg.get(Sl[0]):(Bt=Ge.find(function(Ba){return!Ba.props.disabled}))===null||Bt===void 0?void 0:Bt.key),Mr=bo.get(Ga);if(Ga&&Mr){var Sa;Mr==null||(Sa=Mr.focus)===null||Sa===void 0||Sa.call(Mr,yt)}}}});var Ln=As(x||[],{value:J,postState:function(yt){return Array.isArray(yt)?yt:yt==null?xa:[yt]}}),mn=$(Ln,2),ti=mn[0],Rn=mn[1],ho=function(yt){if(M){var Bt=yt.key,Nn=ti.includes(Bt),Hn;w?Nn?Hn=ti.filter(function(bo){return bo!==Bt}):Hn=[].concat(Yt(ti),[Bt]):Hn=[Bt],Rn(Hn);var po=te(te({},yt),{},{selectedKeys:Hn});Nn?S==null||S(po):F==null||F(po)}!w&&Ye.length&&T!=="inline"&&$e(xa)},mo=ec(function(Ft){O==null||O(NC(Ft)),ho(Ft)}),ni=ec(function(Ft,yt){var Bt=Ye.filter(function(Hn){return Hn!==Ft});if(yt)Bt.push(Ft);else if(T!=="inline"){var Nn=_t(Ft);Bt=Bt.filter(function(Hn){return!Nn.has(Hn)})}$y(Ye,Bt,!0)||$e(Bt,!0)}),ii=function(yt,Bt){var Nn=Bt??!Ye.includes(yt);ni(yt,Nn)},Ao=J8(T,Ct,Fe,ve,re,Jt,Xt,St,ii,Ae);h.useEffect(function(){P(!0)},[]);var fo=h.useMemo(function(){return{_internalRenderMenuItem:De,_internalRenderSubMenuItem:ke}},[De,ke]),Ei=T!=="horizontal"||y?Ge:Ge.map(function(Ft,yt){return h.createElement(cu,{key:Ft.key,overflowDisabled:yt>we},Ft)}),Ig=h.createElement(ro,Qe({id:m,ref:re,prefixCls:"".concat(o,"-overflow"),component:"ul",itemComponent:hm,className:he(o,"".concat(o,"-root"),"".concat(o,"-").concat(T),s,se(se({},"".concat(o,"-inline-collapsed"),ge),"".concat(o,"-rtl"),Fe),a),dir:C,style:l,role:"menu",tabIndex:c,data:Ei,renderRawItem:function(yt){return yt},renderRawRest:function(yt){var Bt=yt.length,Nn=Bt?Ge.slice(-Bt):null;return h.createElement(yZ,{eventKey:Nb,title:Re,disabled:lt,internalPopupClose:Bt===0,popupClassName:de},Nn)},maxCount:T!=="horizontal"||y?ro.INVALIDATE:ro.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(yt){Se(yt)},onKeyDown:Ao},Ee));return h.createElement(mZ.Provider,{value:fo},h.createElement(NX.Provider,{value:ve},h.createElement(cu,{prefixCls:o,rootClassName:a,mode:T,openKeys:Ye,rtl:Fe,disabled:p,motion:oe?k:null,defaultMotions:oe?z:null,activeKey:Ct,onActive:Bn,onInactive:bn,selectedKeys:ti,inlineIndent:N,subMenuOpenDelay:G,subMenuCloseDelay:B,forceSubMenuRender:R,builtinPlacements:j,triggerSubMenuAction:D,getPopupContainer:Q,itemIcon:ne,expandIcon:ie,onItemClick:mo,onOpenChange:ni},h.createElement(MX.Provider,{value:rr},Ig),h.createElement("div",{style:{display:"none"},"aria-hidden":!0},h.createElement(KX.Provider,{value:Ot},it)))))}),Fu=l7;Fu.Item=hm;Fu.SubMenu=yZ;Fu.ItemGroup=QX;Fu.Divider=UX;var s7={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"},g7=function(t,n){return h.createElement(Gr,Qe({},t,{ref:n,icon:s7}))},c7=h.forwardRef(g7),u7={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},I7=function(t,n){return h.createElement(Gr,Qe({},t,{ref:n,icon:u7}))},d7=h.forwardRef(I7);const mm=h.createContext(null);var C7=function(t){var n=t.activeTabOffset,i=t.horizontal,r=t.rtl,o=t.indicator,a=o===void 0?{}:o,l=a.size,s=a.align,g=s===void 0?"center":s,c=h.useState(),u=$(c,2),I=u[0],C=u[1],m=h.useRef(),f=ce.useCallback(function(A){return typeof l=="function"?l(A):typeof l=="number"?l:A},[l]);function b(){On.cancel(m.current)}return h.useEffect(function(){var A={};if(n)if(i){A.width=f(n.width);var p=r?"right":"left";g==="start"&&(A[p]=n[p]),g==="center"&&(A[p]=n[p]+n.width/2,A.transform=r?"translateX(50%)":"translateX(-50%)"),g==="end"&&(A[p]=n[p]+n.width,A.transform="translateX(-100%)")}else A.height=f(n.height),g==="start"&&(A.top=n.top),g==="center"&&(A.top=n.top+n.height/2,A.transform="translateY(-50%)"),g==="end"&&(A.top=n.top+n.height,A.transform="translateY(-100%)");return b(),m.current=On(function(){C(A)}),b},[n,i,r,g,f]),{style:I}},HR={width:0,height:0,left:0,top:0};function h7(e,t,n){return h.useMemo(function(){for(var i,r=new Map,o=t.get((i=e[0])===null||i===void 0?void 0:i.key)||HR,a=o.left+o.width,l=0;l<e.length;l+=1){var s=e[l].key,g=t.get(s);if(!g){var c;g=t.get((c=e[l-1])===null||c===void 0?void 0:c.key)||HR}var u=r.get(s)||te({},g);u.right=a-u.left-u.width,r.set(s,u)}return r},[e.map(function(i){return i.key}).join("_"),t,n])}function FR(e,t){var n=h.useRef(e),i=h.useState({}),r=$(i,2),o=r[1];function a(l){var s=typeof l=="function"?l(n.current):l;s!==n.current&&t(s,n.current),n.current=s,o({})}return[n.current,a]}var m7=.1,KR=.01,Yd=20,ER=Math.pow(.995,Yd);function A7(e,t){var n=h.useState(),i=$(n,2),r=i[0],o=i[1],a=h.useState(0),l=$(a,2),s=l[0],g=l[1],c=h.useState(0),u=$(c,2),I=u[0],C=u[1],m=h.useState(),f=$(m,2),b=f[0],A=f[1],p=h.useRef();function y(X){var W=X.touches[0],V=W.screenX,Y=W.screenY;o({x:V,y:Y}),window.clearInterval(p.current)}function Z(X){if(r){var W=X.touches[0],V=W.screenX,Y=W.screenY;o({x:V,y:Y});var K=V-r.x,M=Y-r.y;t(K,M);var H=Date.now();g(H),C(H-s),A({x:K,y:M})}}function G(){if(r&&(o(null),A(null),b)){var X=b.x/I,W=b.y/I,V=Math.abs(X),Y=Math.abs(W);if(Math.max(V,Y)<m7)return;var K=X,M=W;p.current=window.setInterval(function(){if(Math.abs(K)<KR&&Math.abs(M)<KR){window.clearInterval(p.current);return}K*=ER,M*=ER,t(K*Yd,M*Yd)},Yd)}}var v=h.useRef();function B(X){var W=X.deltaX,V=X.deltaY,Y=0,K=Math.abs(W),M=Math.abs(V);K===M?Y=v.current==="x"?W:V:K>M?(Y=W,v.current="x"):(Y=V,v.current="y"),t(-Y,-Y)&&X.preventDefault()}var R=h.useRef(null);R.current={onTouchStart:y,onTouchMove:Z,onTouchEnd:G,onWheel:B},h.useEffect(function(){function X(K){R.current.onTouchStart(K)}function W(K){R.current.onTouchMove(K)}function V(K){R.current.onTouchEnd(K)}function Y(K){R.current.onWheel(K)}return document.addEventListener("touchmove",W,{passive:!1}),document.addEventListener("touchend",V,{passive:!0}),e.current.addEventListener("touchstart",X,{passive:!0}),e.current.addEventListener("wheel",Y,{passive:!1}),function(){document.removeEventListener("touchmove",W),document.removeEventListener("touchend",V)}},[])}function PX(e){var t=h.useState(0),n=$(t,2),i=n[0],r=n[1],o=h.useRef(0),a=h.useRef();return a.current=e,ib(function(){var l;(l=a.current)===null||l===void 0||l.call(a)},[i]),function(){o.current===i&&(o.current+=1,r(o.current))}}function f7(e){var t=h.useRef([]),n=h.useState({}),i=$(n,2),r=i[1],o=h.useRef(typeof e=="function"?e():e),a=PX(function(){var s=o.current;t.current.forEach(function(g){s=g(s)}),t.current=[],o.current=s,r({})});function l(s){t.current.push(s),a()}return[o.current,l]}var MR={width:0,height:0,left:0,top:0,right:0};function p7(e,t,n,i,r,o,a){var l=a.tabs,s=a.tabPosition,g=a.rtl,c,u,I;return["top","bottom"].includes(s)?(c="width",u=g?"right":"left",I=Math.abs(n)):(c="height",u="top",I=-n),h.useMemo(function(){if(!l.length)return[0,0];for(var C=l.length,m=C,f=0;f<C;f+=1){var b=e.get(l[f].key)||MR;if(Math.floor(b[u]+b[c])>Math.floor(I+t)){m=f-1;break}}for(var A=0,p=C-1;p>=0;p-=1){var y=e.get(l[p].key)||MR;if(y[u]<I){A=p+1;break}}return A>=m?[0,0]:[A,m]},[e,t,i,r,o,I,s,l.map(function(C){return C.key}).join("_"),g])}function zR(e){var t;return e instanceof Map?(t={},e.forEach(function(n,i){t[i]=n})):t=e,JSON.stringify(t)}var b7="TABS_DQ";function _X(e){return String(e).replace(/"/g,b7)}function ZZ(e,t,n,i){return!(!n||i||e===!1||e===void 0&&(t===!1||t===null))}var OX=h.forwardRef(function(e,t){var n=e.prefixCls,i=e.editable,r=e.locale,o=e.style;return!i||i.showAdd===!1?null:h.createElement("button",{ref:t,type:"button",className:"".concat(n,"-nav-add"),style:o,"aria-label":(r==null?void 0:r.addAriaLabel)||"Add tab",onClick:function(l){i.onEdit("add",{event:l})}},i.addIcon||"+")}),LR=h.forwardRef(function(e,t){var n=e.position,i=e.prefixCls,r=e.extra;if(!r)return null;var o,a={};return gt(r)==="object"&&!h.isValidElement(r)?a=r:a.right=r,n==="right"&&(o=a.right),n==="left"&&(o=a.left),o?h.createElement("div",{className:"".concat(i,"-extra-content"),ref:t},o):null}),y7=h.forwardRef(function(e,t){var n=e.prefixCls,i=e.id,r=e.tabs,o=e.locale,a=e.mobile,l=e.more,s=l===void 0?{}:l,g=e.style,c=e.className,u=e.editable,I=e.tabBarGutter,C=e.rtl,m=e.removeAriaLabel,f=e.onTabClick,b=e.getPopupContainer,A=e.popupClassName,p=h.useState(!1),y=$(p,2),Z=y[0],G=y[1],v=h.useState(null),B=$(v,2),R=B[0],X=B[1],W=s.icon,V=W===void 0?"More":W,Y="".concat(i,"-more-popup"),K="".concat(n,"-dropdown"),M=R!==null?"".concat(Y,"-").concat(R):null,H=o==null?void 0:o.dropdownAriaLabel;function w(k,z){k.preventDefault(),k.stopPropagation(),u.onEdit("remove",{key:z,event:k})}var x=h.createElement(Fu,{onClick:function(z){var L=z.key,D=z.domEvent;f(L,D),G(!1)},prefixCls:"".concat(K,"-menu"),id:Y,tabIndex:-1,role:"listbox","aria-activedescendant":M,selectedKeys:[R],"aria-label":H!==void 0?H:"expanded dropdown"},r.map(function(k){var z=k.closable,L=k.disabled,D=k.closeIcon,j=k.key,ne=k.label,ie=ZZ(z,D,u,L);return h.createElement(hm,{key:j,id:"".concat(Y,"-").concat(j),role:"option","aria-controls":i&&"".concat(i,"-panel-").concat(j),disabled:L},h.createElement("span",null,ne),ie&&h.createElement("button",{type:"button","aria-label":m||"remove",tabIndex:0,className:"".concat(K,"-menu-item-remove"),onClick:function(Re){Re.stopPropagation(),w(Re,j)}},D||u.removeIcon||"×"))}));function J(k){for(var z=r.filter(function(ie){return!ie.disabled}),L=z.findIndex(function(ie){return ie.key===R})||0,D=z.length,j=0;j<D;j+=1){L=(L+k+D)%D;var ne=z[L];if(!ne.disabled){X(ne.key);return}}}function F(k){var z=k.which;if(!Z){[Je.DOWN,Je.SPACE,Je.ENTER].includes(z)&&(G(!0),k.preventDefault());return}switch(z){case Je.UP:J(-1),k.preventDefault();break;case Je.DOWN:J(1),k.preventDefault();break;case Je.ESC:G(!1);break;case Je.SPACE:case Je.ENTER:R!==null&&f(R,k);break}}h.useEffect(function(){var k=document.getElementById(M);k&&k.scrollIntoView&&k.scrollIntoView(!1)},[R]),h.useEffect(function(){Z||X(null)},[Z]);var S=se({},C?"marginRight":"marginLeft",I);r.length||(S.visibility="hidden",S.order=1);var E=he(se({},"".concat(K,"-rtl"),C)),N=a?null:h.createElement(B8,Qe({prefixCls:K,overlay:x,visible:r.length?Z:!1,onVisibleChange:G,overlayClassName:he(E,A),mouseEnterDelay:.1,mouseLeaveDelay:.1,getPopupContainer:b},s),h.createElement("button",{type:"button",className:"".concat(n,"-nav-more"),style:S,tabIndex:-1,"aria-hidden":"true","aria-haspopup":"listbox","aria-controls":Y,id:"".concat(i,"-more"),"aria-expanded":Z,onKeyDown:F},V));return h.createElement("div",{className:he("".concat(n,"-nav-operations"),c),style:g,ref:t},N,h.createElement(OX,{prefixCls:n,locale:o,editable:u}))});const Z7=h.memo(y7,function(e,t){return t.tabMoving});var v7=function(t){var n=t.prefixCls,i=t.id,r=t.active,o=t.focus,a=t.tab,l=a.key,s=a.label,g=a.disabled,c=a.closeIcon,u=a.icon,I=t.closable,C=t.renderWrapper,m=t.removeAriaLabel,f=t.editable,b=t.onClick,A=t.onFocus,p=t.onBlur,y=t.onKeyDown,Z=t.onMouseDown,G=t.onMouseUp,v=t.style,B=t.tabCount,R=t.currentPosition,X="".concat(n,"-tab"),W=ZZ(I,c,f,g);function V(w){g||b(w)}function Y(w){w.preventDefault(),w.stopPropagation(),f.onEdit("remove",{key:l,event:w})}var K=h.useMemo(function(){return u&&typeof s=="string"?h.createElement("span",null,s):s},[s,u]),M=h.useRef(null);h.useEffect(function(){o&&M.current&&M.current.focus()},[o]);var H=h.createElement("div",{key:l,"data-node-key":_X(l),className:he(X,se(se(se(se({},"".concat(X,"-with-remove"),W),"".concat(X,"-active"),r),"".concat(X,"-disabled"),g),"".concat(X,"-focus"),o)),style:v,onClick:V},h.createElement("div",{ref:M,role:"tab","aria-selected":r,id:i&&"".concat(i,"-tab-").concat(l),className:"".concat(X,"-btn"),"aria-controls":i&&"".concat(i,"-panel-").concat(l),"aria-disabled":g,tabIndex:g?null:r?0:-1,onClick:function(x){x.stopPropagation(),V(x)},onKeyDown:y,onMouseDown:Z,onMouseUp:G,onFocus:A,onBlur:p},o&&h.createElement("div",{"aria-live":"polite",style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0}},"Tab ".concat(R," of ").concat(B)),u&&h.createElement("span",{className:"".concat(X,"-icon")},u),s&&K),W&&h.createElement("button",{type:"button","aria-label":m||"remove",tabIndex:r?0:-1,className:"".concat(X,"-remove"),onClick:function(x){x.stopPropagation(),Y(x)}},c||f.removeIcon||"×"));return C?C(H):H},G7=function(t,n){var i=t.offsetWidth,r=t.offsetHeight,o=t.offsetTop,a=t.offsetLeft,l=t.getBoundingClientRect(),s=l.width,g=l.height,c=l.left,u=l.top;return Math.abs(s-i)<1?[s,g,c-n.left,u-n.top]:[i,r,a,o]},Kl=function(t){var n=t.current||{},i=n.offsetWidth,r=i===void 0?0:i,o=n.offsetHeight,a=o===void 0?0:o;if(t.current){var l=t.current.getBoundingClientRect(),s=l.width,g=l.height;if(Math.abs(s-r)<1)return[s,g]}return[r,a]},TI=function(t,n){return t[n?0:1]},DR=h.forwardRef(function(e,t){var n=e.className,i=e.style,r=e.id,o=e.animated,a=e.activeKey,l=e.rtl,s=e.extra,g=e.editable,c=e.locale,u=e.tabPosition,I=e.tabBarGutter,C=e.children,m=e.onTabClick,f=e.onTabScroll,b=e.indicator,A=h.useContext(mm),p=A.prefixCls,y=A.tabs,Z=h.useRef(null),G=h.useRef(null),v=h.useRef(null),B=h.useRef(null),R=h.useRef(null),X=h.useRef(null),W=h.useRef(null),V=u==="top"||u==="bottom",Y=FR(0,function(At,Me){V&&f&&f({direction:At>Me?"left":"right"})}),K=$(Y,2),M=K[0],H=K[1],w=FR(0,function(At,Me){!V&&f&&f({direction:At>Me?"top":"bottom"})}),x=$(w,2),J=x[0],F=x[1],S=h.useState([0,0]),E=$(S,2),N=E[0],k=E[1],z=h.useState([0,0]),L=$(z,2),D=L[0],j=L[1],ne=h.useState([0,0]),ie=$(ne,2),ae=ie[0],Re=ie[1],de=h.useState([0,0]),Q=$(de,2),O=Q[0],me=Q[1],Ae=f7(new Map),De=$(Ae,2),ke=De[0],xe=De[1],Ee=h7(y,ke,D[0]),We=TI(N,V),ze=TI(D,V),Ge=TI(ae,V),it=TI(O,V),Pe=Math.floor(We)<Math.floor(ze+Ge),U=Pe?We-it:We-Ge,oe="".concat(p,"-nav-operations-hidden"),P=0,re=0;V&&l?(P=0,re=Math.max(0,ze-U)):(P=Math.min(0,U-ze),re=0);function ve(At){return At<P?P:At>re?re:At}var Fe=h.useRef(null),Te=h.useState(),Xe=$(Te,2),Ye=Xe[0],qe=Xe[1];function $e(){qe(Date.now())}function et(){Fe.current&&clearTimeout(Fe.current)}A7(B,function(At,Me){function Ct(St,Bn){St(function(bn){var Ln=ve(bn+Bn);return Ln})}return Pe?(V?Ct(H,At):Ct(F,Me),et(),$e(),!0):!1}),h.useEffect(function(){return et(),Ye&&(Fe.current=setTimeout(function(){qe(0)},100)),et},[Ye]);var Oe=p7(Ee,U,V?M:J,ze,Ge,it,te(te({},e),{},{tabs:y})),xt=$(Oe,2),Dt=xt[0],Ht=xt[1],at=oi(function(){var At=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a,Me=Ee.get(At)||{width:0,height:0,left:0,right:0,top:0};if(V){var Ct=M;l?Me.right<M?Ct=Me.right:Me.right+Me.width>M+U&&(Ct=Me.right+Me.width-U):Me.left<-M?Ct=-Me.left:Me.left+Me.width>-M+U&&(Ct=-(Me.left+Me.width-U)),F(0),H(ve(Ct))}else{var St=J;Me.top<-J?St=-Me.top:Me.top+Me.height>-J+U&&(St=-(Me.top+Me.height-U)),H(0),F(ve(St))}}),je=h.useState(),Ke=$(je,2),rt=Ke[0],Be=Ke[1],fe=h.useState(!1),be=$(fe,2),T=be[0],ee=be[1],le=y.filter(function(At){return!At.disabled}).map(function(At){return At.key}),q=function(Me){var Ct=le.indexOf(rt||a),St=le.length,Bn=(Ct+Me+St)%St,bn=le[Bn];Be(bn)},ge=function(Me){var Ct=Me.code,St=l&&V,Bn=le[0],bn=le[le.length-1];switch(Ct){case"ArrowLeft":{V&&q(St?1:-1);break}case"ArrowRight":{V&&q(St?-1:1);break}case"ArrowUp":{Me.preventDefault(),V||q(-1);break}case"ArrowDown":{Me.preventDefault(),V||q(1);break}case"Home":{Me.preventDefault(),Be(Bn);break}case"End":{Me.preventDefault(),Be(bn);break}case"Enter":case"Space":{Me.preventDefault(),m(rt,Me);break}case"Backspace":case"Delete":{var Ln=le.indexOf(rt),mn=y.find(function(Rn){return Rn.key===rt}),ti=ZZ(mn==null?void 0:mn.closable,mn==null?void 0:mn.closeIcon,g,mn==null?void 0:mn.disabled);ti&&(Me.preventDefault(),Me.stopPropagation(),g.onEdit("remove",{key:rt,event:Me}),Ln===le.length-1?q(-1):q(1));break}}},pe={};V?pe[l?"marginRight":"marginLeft"]=I:pe.marginTop=I;var Ze=y.map(function(At,Me){var Ct=At.key;return h.createElement(v7,{id:r,prefixCls:p,key:Ct,tab:At,style:Me===0?void 0:pe,closable:At.closable,editable:g,active:Ct===a,focus:Ct===rt,renderWrapper:C,removeAriaLabel:c==null?void 0:c.removeAriaLabel,tabCount:le.length,currentPosition:Me+1,onClick:function(Bn){m(Ct,Bn)},onKeyDown:ge,onFocus:function(){T||Be(Ct),at(Ct),$e(),B.current&&(l||(B.current.scrollLeft=0),B.current.scrollTop=0)},onBlur:function(){Be(void 0)},onMouseDown:function(){ee(!0)},onMouseUp:function(){ee(!1)}})}),Ce=function(){return xe(function(){var Me,Ct=new Map,St=(Me=R.current)===null||Me===void 0?void 0:Me.getBoundingClientRect();return y.forEach(function(Bn){var bn,Ln=Bn.key,mn=(bn=R.current)===null||bn===void 0?void 0:bn.querySelector('[data-node-key="'.concat(_X(Ln),'"]'));if(mn){var ti=G7(mn,St),Rn=$(ti,4),ho=Rn[0],mo=Rn[1],ni=Rn[2],ii=Rn[3];Ct.set(Ln,{width:ho,height:mo,left:ni,top:ii})}}),Ct})};h.useEffect(function(){Ce()},[y.map(function(At){return At.key}).join("_")]);var we=PX(function(){var At=Kl(Z),Me=Kl(G),Ct=Kl(v);k([At[0]-Me[0]-Ct[0],At[1]-Me[1]-Ct[1]]);var St=Kl(W);Re(St);var Bn=Kl(X);me(Bn);var bn=Kl(R);j([bn[0]-St[0],bn[1]-St[1]]),Ce()}),Se=y.slice(0,Dt),lt=y.slice(Ht+1),Rt=[].concat(Yt(Se),Yt(lt)),cn=Ee.get(a),Le=C7({activeTabOffset:cn,horizontal:V,indicator:b,rtl:l}),ct=Le.style;h.useEffect(function(){at()},[a,P,re,zR(cn),zR(Ee),V]),h.useEffect(function(){we()},[l]);var st=!!Rt.length,Xt="".concat(p,"-nav-wrap"),Jt,_t,Ot,rr;return V?l?(_t=M>0,Jt=M!==re):(Jt=M<0,_t=M!==P):(Ot=J<0,rr=J!==P),h.createElement(oa,{onResize:we},h.createElement("div",{ref:_s(t,Z),role:"tablist","aria-orientation":V?"horizontal":"vertical",className:he("".concat(p,"-nav"),n),style:i,onKeyDown:function(){$e()}},h.createElement(LR,{ref:G,position:"left",extra:s,prefixCls:p}),h.createElement(oa,{onResize:we},h.createElement("div",{className:he(Xt,se(se(se(se({},"".concat(Xt,"-ping-left"),Jt),"".concat(Xt,"-ping-right"),_t),"".concat(Xt,"-ping-top"),Ot),"".concat(Xt,"-ping-bottom"),rr)),ref:B},h.createElement(oa,{onResize:we},h.createElement("div",{ref:R,className:"".concat(p,"-nav-list"),style:{transform:"translate(".concat(M,"px, ").concat(J,"px)"),transition:Ye?"none":void 0}},Ze,h.createElement(OX,{ref:W,prefixCls:p,locale:c,editable:g,style:te(te({},Ze.length===0?void 0:pe),{},{visibility:st?"hidden":null})}),h.createElement("div",{className:he("".concat(p,"-ink-bar"),se({},"".concat(p,"-ink-bar-animated"),o.inkBar)),style:ct}))))),h.createElement(Z7,Qe({},e,{removeAriaLabel:c==null?void 0:c.removeAriaLabel,ref:X,prefixCls:p,tabs:Rt,className:!st&&oe,tabMoving:!!Ye})),h.createElement(LR,{ref:v,position:"right",extra:s,prefixCls:p})))}),qX=h.forwardRef(function(e,t){var n=e.prefixCls,i=e.className,r=e.style,o=e.id,a=e.active,l=e.tabKey,s=e.children;return h.createElement("div",{id:o&&"".concat(o,"-panel-").concat(l),role:"tabpanel",tabIndex:a?0:-1,"aria-labelledby":o&&"".concat(o,"-tab-").concat(l),"aria-hidden":!a,style:r,className:he(n,a&&"".concat(n,"-active"),i),ref:t},s)}),S7=["renderTabBar"],B7=["label","key"],R7=function(t){var n=t.renderTabBar,i=Zt(t,S7),r=h.useContext(mm),o=r.tabs;if(n){var a=te(te({},i),{},{panes:o.map(function(l){var s=l.label,g=l.key,c=Zt(l,B7);return h.createElement(qX,Qe({tab:s,key:g,tabKey:g},c))})});return n(a,DR)}return h.createElement(DR,i)},W7=["key","forceRender","style","className","destroyInactiveTabPane"],k7=function(t){var n=t.id,i=t.activeKey,r=t.animated,o=t.tabPosition,a=t.destroyInactiveTabPane,l=h.useContext(mm),s=l.prefixCls,g=l.tabs,c=r.tabPane,u="".concat(s,"-tabpane");return h.createElement("div",{className:he("".concat(s,"-content-holder"))},h.createElement("div",{className:he("".concat(s,"-content"),"".concat(s,"-content-").concat(o),se({},"".concat(s,"-content-animated"),c))},g.map(function(I){var C=I.key,m=I.forceRender,f=I.style,b=I.className,A=I.destroyInactiveTabPane,p=Zt(I,W7),y=C===i;return h.createElement(yl,Qe({key:C,visible:y,forceRender:m,removeOnLeave:!!(a||A),leavedClassName:"".concat(u,"-hidden")},r.tabPaneMotion),function(Z,G){var v=Z.style,B=Z.className;return h.createElement(qX,Qe({},p,{prefixCls:u,id:n,tabKey:C,animated:c,active:y,style:te(te({},f),v),className:he(b,B),ref:G}))})})))};function V7(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{inkBar:!0,tabPane:!1},t;return e===!1?t={inkBar:!1,tabPane:!1}:e===!0?t={inkBar:!0,tabPane:!1}:t=te({inkBar:!0},gt(e)==="object"?e:{}),t.tabPaneMotion&&t.tabPane===void 0&&(t.tabPane=!0),!t.tabPaneMotion&&t.tabPane&&(t.tabPane=!1),t}var w7=["id","prefixCls","className","items","direction","activeKey","defaultActiveKey","editable","animated","tabPosition","tabBarGutter","tabBarStyle","tabBarExtraContent","locale","more","destroyInactiveTabPane","renderTabBar","onChange","onTabClick","onTabScroll","getPopupContainer","popupClassName","indicator"],TR=0,x7=h.forwardRef(function(e,t){var n=e.id,i=e.prefixCls,r=i===void 0?"rc-tabs":i,o=e.className,a=e.items,l=e.direction,s=e.activeKey,g=e.defaultActiveKey,c=e.editable,u=e.animated,I=e.tabPosition,C=I===void 0?"top":I,m=e.tabBarGutter,f=e.tabBarStyle,b=e.tabBarExtraContent,A=e.locale,p=e.more,y=e.destroyInactiveTabPane,Z=e.renderTabBar,G=e.onChange,v=e.onTabClick,B=e.onTabScroll,R=e.getPopupContainer,X=e.popupClassName,W=e.indicator,V=Zt(e,w7),Y=h.useMemo(function(){return(a||[]).filter(function(O){return O&&gt(O)==="object"&&"key"in O})},[a]),K=l==="rtl",M=V7(u),H=h.useState(!1),w=$(H,2),x=w[0],J=w[1];h.useEffect(function(){J(wX())},[]);var F=As(function(){var O;return(O=Y[0])===null||O===void 0?void 0:O.key},{value:s,defaultValue:g}),S=$(F,2),E=S[0],N=S[1],k=h.useState(function(){return Y.findIndex(function(O){return O.key===E})}),z=$(k,2),L=z[0],D=z[1];h.useEffect(function(){var O=Y.findIndex(function(Ae){return Ae.key===E});if(O===-1){var me;O=Math.max(0,Math.min(L,Y.length-1)),N((me=Y[O])===null||me===void 0?void 0:me.key)}D(O)},[Y.map(function(O){return O.key}).join("_"),E,L]);var j=As(null,{value:n}),ne=$(j,2),ie=ne[0],ae=ne[1];h.useEffect(function(){n||(ae("rc-tabs-".concat(TR)),TR+=1)},[]);function Re(O,me){v==null||v(O,me);var Ae=O!==E;N(O),Ae&&(G==null||G(O))}var de={id:ie,activeKey:E,animated:M,tabPosition:C,rtl:K,mobile:x},Q=te(te({},de),{},{editable:c,locale:A,more:p,tabBarGutter:m,onTabClick:Re,onTabScroll:B,extra:b,style:f,panes:null,getPopupContainer:R,popupClassName:X,indicator:W});return h.createElement(mm.Provider,{value:{tabs:Y,prefixCls:r}},h.createElement("div",Qe({ref:t,id:n,className:he(r,"".concat(r,"-").concat(C),se(se(se({},"".concat(r,"-mobile"),x),"".concat(r,"-editable"),c),"".concat(r,"-rtl"),K),o)},V),h.createElement(R7,Qe({},Q,{renderTabBar:Z})),h.createElement(k7,Qe({destroyInactiveTabPane:y},de,{animated:M}))))});const X7={motionAppear:!1,motionEnter:!0,motionLeave:!0};function J7(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{inkBar:!0,tabPane:!1},n;return t===!1?n={inkBar:!1,tabPane:!1}:t===!0?n={inkBar:!0,tabPane:!0}:n=Object.assign({inkBar:!0},typeof t=="object"?t:{}),n.tabPane&&(n.tabPaneMotion=Object.assign(Object.assign({},X7),{motionName:iO(e,"switch")})),n}var Y7=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function N7(e){return e.filter(t=>t)}function H7(e,t){if(e)return e;const n=sl(t).map(i=>{if(h.isValidElement(i)){const{key:r,props:o}=i,a=o||{},{tab:l}=a,s=Y7(a,["tab"]);return Object.assign(Object.assign({key:String(r)},s),{label:l})}return null});return N7(n)}const F7=e=>{const{componentCls:t,motionDurationSlow:n}=e;return[{[t]:{[`${t}-switch`]:{"&-appear, &-enter":{transition:"none","&-start":{opacity:0},"&-active":{opacity:1,transition:`opacity ${n}`}},"&-leave":{position:"absolute",transition:"none",inset:0,"&-start":{opacity:1},"&-active":{opacity:0,transition:`opacity ${n}`}}}}},[AR(e,"slide-up"),AR(e,"slide-down")]]},K7=e=>{const{componentCls:t,tabsCardPadding:n,cardBg:i,cardGutter:r,colorBorderSecondary:o,itemSelectedColor:a}=e;return{[`${t}-card`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab`]:{margin:0,padding:n,background:i,border:`${Ve(e.lineWidth)} ${e.lineType} ${o}`,transition:`all ${e.motionDurationSlow} ${e.motionEaseInOut}`},[`${t}-tab-active`]:{color:a,background:e.colorBgContainer},[`${t}-tab-focus`]:Object.assign({},aZ(e,-3)),[`${t}-ink-bar`]:{visibility:"hidden"},[`& ${t}-tab${t}-tab-focus ${t}-tab-btn`]:{outline:"none"}},[`&${t}-top, &${t}-bottom`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab + ${t}-tab`]:{marginLeft:{_skip_check_:!0,value:Ve(r)}}}},[`&${t}-top`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab`]:{borderRadius:`${Ve(e.borderRadiusLG)} ${Ve(e.borderRadiusLG)} 0 0`},[`${t}-tab-active`]:{borderBottomColor:e.colorBgContainer}}},[`&${t}-bottom`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab`]:{borderRadius:`0 0 ${Ve(e.borderRadiusLG)} ${Ve(e.borderRadiusLG)}`},[`${t}-tab-active`]:{borderTopColor:e.colorBgContainer}}},[`&${t}-left, &${t}-right`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab + ${t}-tab`]:{marginTop:Ve(r)}}},[`&${t}-left`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab`]:{borderRadius:{_skip_check_:!0,value:`${Ve(e.borderRadiusLG)} 0 0 ${Ve(e.borderRadiusLG)}`}},[`${t}-tab-active`]:{borderRightColor:{_skip_check_:!0,value:e.colorBgContainer}}}},[`&${t}-right`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab`]:{borderRadius:{_skip_check_:!0,value:`0 ${Ve(e.borderRadiusLG)} ${Ve(e.borderRadiusLG)} 0`}},[`${t}-tab-active`]:{borderLeftColor:{_skip_check_:!0,value:e.colorBgContainer}}}}}}},E7=e=>{const{componentCls:t,itemHoverColor:n,dropdownEdgeChildVerticalPadding:i}=e;return{[`${t}-dropdown`]:Object.assign(Object.assign({},Ju(e)),{position:"absolute",top:-9999,left:{_skip_check_:!0,value:-9999},zIndex:e.zIndexPopup,display:"block","&-hidden":{display:"none"},[`${t}-dropdown-menu`]:{maxHeight:e.tabsDropdownHeight,margin:0,padding:`${Ve(i)} 0`,overflowX:"hidden",overflowY:"auto",textAlign:{_skip_check_:!0,value:"left"},listStyleType:"none",backgroundColor:e.colorBgContainer,backgroundClip:"padding-box",borderRadius:e.borderRadiusLG,outline:"none",boxShadow:e.boxShadowSecondary,"&-item":Object.assign(Object.assign({},oZ),{display:"flex",alignItems:"center",minWidth:e.tabsDropdownWidth,margin:0,padding:`${Ve(e.paddingXXS)} ${Ve(e.paddingSM)}`,color:e.colorText,fontWeight:"normal",fontSize:e.fontSize,lineHeight:e.lineHeight,cursor:"pointer",transition:`all ${e.motionDurationSlow}`,"> span":{flex:1,whiteSpace:"nowrap"},"&-remove":{flex:"none",marginLeft:{_skip_check_:!0,value:e.marginSM},color:e.colorTextDescription,fontSize:e.fontSizeSM,background:"transparent",border:0,cursor:"pointer","&:hover":{color:n}},"&:hover":{background:e.controlItemBgHover},"&-disabled":{"&, &:hover":{color:e.colorTextDisabled,background:"transparent",cursor:"not-allowed"}}})}})}},M7=e=>{const{componentCls:t,margin:n,colorBorderSecondary:i,horizontalMargin:r,verticalItemPadding:o,verticalItemMargin:a,calc:l}=e;return{[`${t}-top, ${t}-bottom`]:{flexDirection:"column",[`> ${t}-nav, > div > ${t}-nav`]:{margin:r,"&::before":{position:"absolute",right:{_skip_check_:!0,value:0},left:{_skip_check_:!0,value:0},borderBottom:`${Ve(e.lineWidth)} ${e.lineType} ${i}`,content:"''"},[`${t}-ink-bar`]:{height:e.lineWidthBold,"&-animated":{transition:`width ${e.motionDurationSlow}, left ${e.motionDurationSlow},
            right ${e.motionDurationSlow}`}},[`${t}-nav-wrap`]:{"&::before, &::after":{top:0,bottom:0,width:e.controlHeight},"&::before":{left:{_skip_check_:!0,value:0},boxShadow:e.boxShadowTabsOverflowLeft},"&::after":{right:{_skip_check_:!0,value:0},boxShadow:e.boxShadowTabsOverflowRight},[`&${t}-nav-wrap-ping-left::before`]:{opacity:1},[`&${t}-nav-wrap-ping-right::after`]:{opacity:1}}}},[`${t}-top`]:{[`> ${t}-nav,
        > div > ${t}-nav`]:{"&::before":{bottom:0},[`${t}-ink-bar`]:{bottom:0}}},[`${t}-bottom`]:{[`> ${t}-nav, > div > ${t}-nav`]:{order:1,marginTop:n,marginBottom:0,"&::before":{top:0},[`${t}-ink-bar`]:{top:0}},[`> ${t}-content-holder, > div > ${t}-content-holder`]:{order:0}},[`${t}-left, ${t}-right`]:{[`> ${t}-nav, > div > ${t}-nav`]:{flexDirection:"column",minWidth:l(e.controlHeight).mul(1.25).equal(),[`${t}-tab`]:{padding:o,textAlign:"center"},[`${t}-tab + ${t}-tab`]:{margin:a},[`${t}-nav-wrap`]:{flexDirection:"column","&::before, &::after":{right:{_skip_check_:!0,value:0},left:{_skip_check_:!0,value:0},height:e.controlHeight},"&::before":{top:0,boxShadow:e.boxShadowTabsOverflowTop},"&::after":{bottom:0,boxShadow:e.boxShadowTabsOverflowBottom},[`&${t}-nav-wrap-ping-top::before`]:{opacity:1},[`&${t}-nav-wrap-ping-bottom::after`]:{opacity:1}},[`${t}-ink-bar`]:{width:e.lineWidthBold,"&-animated":{transition:`height ${e.motionDurationSlow}, top ${e.motionDurationSlow}`}},[`${t}-nav-list, ${t}-nav-operations`]:{flex:"1 0 auto",flexDirection:"column"}}},[`${t}-left`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-ink-bar`]:{right:{_skip_check_:!0,value:0}}},[`> ${t}-content-holder, > div > ${t}-content-holder`]:{marginLeft:{_skip_check_:!0,value:Ve(l(e.lineWidth).mul(-1).equal())},borderLeft:{_skip_check_:!0,value:`${Ve(e.lineWidth)} ${e.lineType} ${e.colorBorder}`},[`> ${t}-content > ${t}-tabpane`]:{paddingLeft:{_skip_check_:!0,value:e.paddingLG}}}},[`${t}-right`]:{[`> ${t}-nav, > div > ${t}-nav`]:{order:1,[`${t}-ink-bar`]:{left:{_skip_check_:!0,value:0}}},[`> ${t}-content-holder, > div > ${t}-content-holder`]:{order:0,marginRight:{_skip_check_:!0,value:l(e.lineWidth).mul(-1).equal()},borderRight:{_skip_check_:!0,value:`${Ve(e.lineWidth)} ${e.lineType} ${e.colorBorder}`},[`> ${t}-content > ${t}-tabpane`]:{paddingRight:{_skip_check_:!0,value:e.paddingLG}}}}}},z7=e=>{const{componentCls:t,cardPaddingSM:n,cardPaddingLG:i,horizontalItemPaddingSM:r,horizontalItemPaddingLG:o}=e;return{[t]:{"&-small":{[`> ${t}-nav`]:{[`${t}-tab`]:{padding:r,fontSize:e.titleFontSizeSM}}},"&-large":{[`> ${t}-nav`]:{[`${t}-tab`]:{padding:o,fontSize:e.titleFontSizeLG}}}},[`${t}-card`]:{[`&${t}-small`]:{[`> ${t}-nav`]:{[`${t}-tab`]:{padding:n}},[`&${t}-bottom`]:{[`> ${t}-nav ${t}-tab`]:{borderRadius:`0 0 ${Ve(e.borderRadius)} ${Ve(e.borderRadius)}`}},[`&${t}-top`]:{[`> ${t}-nav ${t}-tab`]:{borderRadius:`${Ve(e.borderRadius)} ${Ve(e.borderRadius)} 0 0`}},[`&${t}-right`]:{[`> ${t}-nav ${t}-tab`]:{borderRadius:{_skip_check_:!0,value:`0 ${Ve(e.borderRadius)} ${Ve(e.borderRadius)} 0`}}},[`&${t}-left`]:{[`> ${t}-nav ${t}-tab`]:{borderRadius:{_skip_check_:!0,value:`${Ve(e.borderRadius)} 0 0 ${Ve(e.borderRadius)}`}}}},[`&${t}-large`]:{[`> ${t}-nav`]:{[`${t}-tab`]:{padding:i}}}}}},L7=e=>{const{componentCls:t,itemActiveColor:n,itemHoverColor:i,iconCls:r,tabsHorizontalItemMargin:o,horizontalItemPadding:a,itemSelectedColor:l,itemColor:s}=e,g=`${t}-tab`;return{[g]:{position:"relative",WebkitTouchCallout:"none",WebkitTapHighlightColor:"transparent",display:"inline-flex",alignItems:"center",padding:a,fontSize:e.titleFontSize,background:"transparent",border:0,outline:"none",cursor:"pointer",color:s,"&-btn, &-remove":{"&:focus:not(:focus-visible), &:active":{color:n}},"&-btn":{outline:"none",transition:`all ${e.motionDurationSlow}`,[`${g}-icon:not(:last-child)`]:{marginInlineEnd:e.marginSM}},"&-remove":Object.assign({flex:"none",marginRight:{_skip_check_:!0,value:e.calc(e.marginXXS).mul(-1).equal()},marginLeft:{_skip_check_:!0,value:e.marginXS},color:e.colorTextDescription,fontSize:e.fontSizeSM,background:"transparent",border:"none",outline:"none",cursor:"pointer",transition:`all ${e.motionDurationSlow}`,"&:hover":{color:e.colorTextHeading}},wC(e)),"&:hover":{color:i},[`&${g}-active ${g}-btn`]:{color:l,textShadow:e.tabsActiveTextShadow},[`&${g}-focus ${g}-btn`]:Object.assign({},aZ(e)),[`&${g}-disabled`]:{color:e.colorTextDisabled,cursor:"not-allowed"},[`&${g}-disabled ${g}-btn, &${g}-disabled ${t}-remove`]:{"&:focus, &:active":{color:e.colorTextDisabled}},[`& ${g}-remove ${r}`]:{margin:0},[`${r}:not(:last-child)`]:{marginRight:{_skip_check_:!0,value:e.marginSM}}},[`${g} + ${g}`]:{margin:{_skip_check_:!0,value:o}}}},D7=e=>{const{componentCls:t,tabsHorizontalItemMarginRTL:n,iconCls:i,cardGutter:r,calc:o}=e;return{[`${t}-rtl`]:{direction:"rtl",[`${t}-nav`]:{[`${t}-tab`]:{margin:{_skip_check_:!0,value:n},[`${t}-tab:last-of-type`]:{marginLeft:{_skip_check_:!0,value:0}},[i]:{marginRight:{_skip_check_:!0,value:0},marginLeft:{_skip_check_:!0,value:Ve(e.marginSM)}},[`${t}-tab-remove`]:{marginRight:{_skip_check_:!0,value:Ve(e.marginXS)},marginLeft:{_skip_check_:!0,value:Ve(o(e.marginXXS).mul(-1).equal())},[i]:{margin:0}}}},[`&${t}-left`]:{[`> ${t}-nav`]:{order:1},[`> ${t}-content-holder`]:{order:0}},[`&${t}-right`]:{[`> ${t}-nav`]:{order:0},[`> ${t}-content-holder`]:{order:1}},[`&${t}-card${t}-top, &${t}-card${t}-bottom`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-tab + ${t}-tab`]:{marginRight:{_skip_check_:!0,value:r},marginLeft:{_skip_check_:!0,value:0}}}}},[`${t}-dropdown-rtl`]:{direction:"rtl"},[`${t}-menu-item`]:{[`${t}-dropdown-rtl`]:{textAlign:{_skip_check_:!0,value:"right"}}}}},T7=e=>{const{componentCls:t,tabsCardPadding:n,cardHeight:i,cardGutter:r,itemHoverColor:o,itemActiveColor:a,colorBorderSecondary:l}=e;return{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},Ju(e)),{display:"flex",[`> ${t}-nav, > div > ${t}-nav`]:{position:"relative",display:"flex",flex:"none",alignItems:"center",[`${t}-nav-wrap`]:{position:"relative",display:"flex",flex:"auto",alignSelf:"stretch",overflow:"hidden",whiteSpace:"nowrap",transform:"translate(0)","&::before, &::after":{position:"absolute",zIndex:1,opacity:0,transition:`opacity ${e.motionDurationSlow}`,content:"''",pointerEvents:"none"}},[`${t}-nav-list`]:{position:"relative",display:"flex",transition:`opacity ${e.motionDurationSlow}`},[`${t}-nav-operations`]:{display:"flex",alignSelf:"stretch"},[`${t}-nav-operations-hidden`]:{position:"absolute",visibility:"hidden",pointerEvents:"none"},[`${t}-nav-more`]:{position:"relative",padding:n,background:"transparent",border:0,color:e.colorText,"&::after":{position:"absolute",right:{_skip_check_:!0,value:0},bottom:0,left:{_skip_check_:!0,value:0},height:e.calc(e.controlHeightLG).div(8).equal(),transform:"translateY(100%)",content:"''"}},[`${t}-nav-add`]:Object.assign({minWidth:i,marginLeft:{_skip_check_:!0,value:r},padding:Ve(e.paddingXS),background:"transparent",border:`${Ve(e.lineWidth)} ${e.lineType} ${l}`,borderRadius:`${Ve(e.borderRadiusLG)} ${Ve(e.borderRadiusLG)} 0 0`,outline:"none",cursor:"pointer",color:e.colorText,transition:`all ${e.motionDurationSlow} ${e.motionEaseInOut}`,"&:hover":{color:o},"&:active, &:focus:not(:focus-visible)":{color:a}},wC(e,-3))},[`${t}-extra-content`]:{flex:"none"},[`${t}-ink-bar`]:{position:"absolute",background:e.inkBarColor,pointerEvents:"none"}}),L7(e)),{[`${t}-content`]:{position:"relative",width:"100%"},[`${t}-content-holder`]:{flex:"auto",minWidth:0,minHeight:0},[`${t}-tabpane`]:Object.assign(Object.assign({},wC(e)),{"&-hidden":{display:"none"}})}),[`${t}-centered`]:{[`> ${t}-nav, > div > ${t}-nav`]:{[`${t}-nav-wrap`]:{[`&:not([class*='${t}-nav-wrap-ping']) > ${t}-nav-list`]:{margin:"auto"}}}}}},j7=e=>{const t=e.controlHeightLG;return{zIndexPopup:e.zIndexPopupBase+50,cardBg:e.colorFillAlter,cardHeight:t,cardPadding:`${(t-Math.round(e.fontSize*e.lineHeight))/2-e.lineWidth}px ${e.padding}px`,cardPaddingSM:`${e.paddingXXS*1.5}px ${e.padding}px`,cardPaddingLG:`${e.paddingXS}px ${e.padding}px ${e.paddingXXS*1.5}px`,titleFontSize:e.fontSize,titleFontSizeLG:e.fontSizeLG,titleFontSizeSM:e.fontSize,inkBarColor:e.colorPrimary,horizontalMargin:`0 0 ${e.margin}px 0`,horizontalItemGutter:32,horizontalItemMargin:"",horizontalItemMarginRTL:"",horizontalItemPadding:`${e.paddingSM}px 0`,horizontalItemPaddingSM:`${e.paddingXS}px 0`,horizontalItemPaddingLG:`${e.padding}px 0`,verticalItemPadding:`${e.paddingXS}px ${e.paddingLG}px`,verticalItemMargin:`${e.margin}px 0 0 0`,itemColor:e.colorText,itemSelectedColor:e.colorPrimary,itemHoverColor:e.colorPrimaryHover,itemActiveColor:e.colorPrimaryActive,cardGutter:e.marginXXS/2}},U7=bl("Tabs",e=>{const t=nr(e,{tabsCardPadding:e.cardPadding,dropdownEdgeChildVerticalPadding:e.paddingXXS,tabsActiveTextShadow:"0 0 0.25px currentcolor",tabsDropdownHeight:200,tabsDropdownWidth:120,tabsHorizontalItemMargin:`0 0 0 ${Ve(e.horizontalItemGutter)}`,tabsHorizontalItemMarginRTL:`0 0 0 ${Ve(e.horizontalItemGutter)}`});return[z7(t),D7(t),M7(t),E7(t),K7(t),T7(t),F7(t)]},j7),Q7=()=>null;var P7=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const $X=e=>{var t,n,i,r,o,a,l,s,g,c,u;const{type:I,className:C,rootClassName:m,size:f,onEdit:b,hideAdd:A,centered:p,addIcon:y,removeIcon:Z,moreIcon:G,more:v,popupClassName:B,children:R,items:X,animated:W,style:V,indicatorSize:Y,indicator:K}=e,M=P7(e,["type","className","rootClassName","size","onEdit","hideAdd","centered","addIcon","removeIcon","moreIcon","more","popupClassName","children","items","animated","style","indicatorSize","indicator"]),{prefixCls:H}=M,{direction:w,tabs:x,getPrefixCls:J,getPopupContainer:F}=h.useContext(Pt),S=J("tabs",H),E=gZ(S),[N,k,z]=U7(S,E);let L;I==="editable-card"&&(L={onEdit:(de,Q)=>{let{key:O,event:me}=Q;b==null||b(de==="add"?me:O,de)},removeIcon:(t=Z??(x==null?void 0:x.removeIcon))!==null&&t!==void 0?t:h.createElement(dX,null),addIcon:(y??(x==null?void 0:x.addIcon))||h.createElement(d7,null),showAdd:A!==!0});const D=J(),j=am(f),ne=H7(X,R),ie=J7(S,W),ae=Object.assign(Object.assign({},x==null?void 0:x.style),V),Re={align:(n=K==null?void 0:K.align)!==null&&n!==void 0?n:(i=x==null?void 0:x.indicator)===null||i===void 0?void 0:i.align,size:(l=(o=(r=K==null?void 0:K.size)!==null&&r!==void 0?r:Y)!==null&&o!==void 0?o:(a=x==null?void 0:x.indicator)===null||a===void 0?void 0:a.size)!==null&&l!==void 0?l:x==null?void 0:x.indicatorSize};return N(h.createElement(x7,Object.assign({direction:w,getPopupContainer:F},M,{items:ne,className:he({[`${S}-${j}`]:j,[`${S}-card`]:["card","editable-card"].includes(I),[`${S}-editable-card`]:I==="editable-card",[`${S}-centered`]:p},x==null?void 0:x.className,C,m,k,z,E),popupClassName:he(B,k,z,E),style:ae,editable:L,more:Object.assign({icon:(u=(c=(g=(s=x==null?void 0:x.more)===null||s===void 0?void 0:s.icon)!==null&&g!==void 0?g:x==null?void 0:x.moreIcon)!==null&&c!==void 0?c:G)!==null&&u!==void 0?u:h.createElement(c7,null),transitionName:`${D}-slide-up`},v),prefixCls:S,animated:ie,indicator:Re})))};$X.TabPane=Q7;var _7=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const eJ=e=>{var{prefixCls:t,className:n,hoverable:i=!0}=e,r=_7(e,["prefixCls","className","hoverable"]);const{getPrefixCls:o}=h.useContext(Pt),a=o("card",t),l=he(`${a}-grid`,n,{[`${a}-grid-hoverable`]:i});return h.createElement("div",Object.assign({},r,{className:l}))},O7=e=>{const{antCls:t,componentCls:n,headerHeight:i,headerPadding:r,tabsMarginBottom:o}=e;return Object.assign(Object.assign({display:"flex",justifyContent:"center",flexDirection:"column",minHeight:i,marginBottom:-1,padding:`0 ${Ve(r)}`,color:e.colorTextHeading,fontWeight:e.fontWeightStrong,fontSize:e.headerFontSize,background:e.headerBg,borderBottom:`${Ve(e.lineWidth)} ${e.lineType} ${e.colorBorderSecondary}`,borderRadius:`${Ve(e.borderRadiusLG)} ${Ve(e.borderRadiusLG)} 0 0`},rm()),{"&-wrapper":{width:"100%",display:"flex",alignItems:"center"},"&-title":Object.assign(Object.assign({display:"inline-block",flex:1},oZ),{[`
          > ${n}-typography,
          > ${n}-typography-edit-content
        `]:{insetInlineStart:0,marginTop:0,marginBottom:0}}),[`${t}-tabs-top`]:{clear:"both",marginBottom:o,color:e.colorText,fontWeight:"normal",fontSize:e.fontSize,"&-bar":{borderBottom:`${Ve(e.lineWidth)} ${e.lineType} ${e.colorBorderSecondary}`}}})},q7=e=>{const{cardPaddingBase:t,colorBorderSecondary:n,cardShadow:i,lineWidth:r}=e;return{width:"33.33%",padding:t,border:0,borderRadius:0,boxShadow:`
      ${Ve(r)} 0 0 0 ${n},
      0 ${Ve(r)} 0 0 ${n},
      ${Ve(r)} ${Ve(r)} 0 0 ${n},
      ${Ve(r)} 0 0 0 ${n} inset,
      0 ${Ve(r)} 0 0 ${n} inset;
    `,transition:`all ${e.motionDurationMid}`,"&-hoverable:hover":{position:"relative",zIndex:1,boxShadow:i}}},$7=e=>{const{componentCls:t,iconCls:n,actionsLiMargin:i,cardActionsIconSize:r,colorBorderSecondary:o,actionsBg:a}=e;return Object.assign(Object.assign({margin:0,padding:0,listStyle:"none",background:a,borderTop:`${Ve(e.lineWidth)} ${e.lineType} ${o}`,display:"flex",borderRadius:`0 0 ${Ve(e.borderRadiusLG)} ${Ve(e.borderRadiusLG)}`},rm()),{"& > li":{margin:i,color:e.colorTextDescription,textAlign:"center","> span":{position:"relative",display:"block",minWidth:e.calc(e.cardActionsIconSize).mul(2).equal(),fontSize:e.fontSize,lineHeight:e.lineHeight,cursor:"pointer","&:hover":{color:e.colorPrimary,transition:`color ${e.motionDurationMid}`},[`a:not(${t}-btn), > ${n}`]:{display:"inline-block",width:"100%",color:e.colorTextDescription,lineHeight:Ve(e.fontHeight),transition:`color ${e.motionDurationMid}`,"&:hover":{color:e.colorPrimary}},[`> ${n}`]:{fontSize:r,lineHeight:Ve(e.calc(r).mul(e.lineHeight).equal())}},"&:not(:last-child)":{borderInlineEnd:`${Ve(e.lineWidth)} ${e.lineType} ${o}`}}})},eq=e=>Object.assign(Object.assign({margin:`${Ve(e.calc(e.marginXXS).mul(-1).equal())} 0`,display:"flex"},rm()),{"&-avatar":{paddingInlineEnd:e.padding},"&-detail":{overflow:"hidden",flex:1,"> div:not(:last-child)":{marginBottom:e.marginXS}},"&-title":Object.assign({color:e.colorTextHeading,fontWeight:e.fontWeightStrong,fontSize:e.fontSizeLG},oZ),"&-description":{color:e.colorTextDescription}}),tq=e=>{const{componentCls:t,colorFillAlter:n,headerPadding:i,bodyPadding:r}=e;return{[`${t}-head`]:{padding:`0 ${Ve(i)}`,background:n,"&-title":{fontSize:e.fontSize}},[`${t}-body`]:{padding:`${Ve(e.padding)} ${Ve(r)}`}}},nq=e=>{const{componentCls:t}=e;return{overflow:"hidden",[`${t}-body`]:{userSelect:"none"}}},iq=e=>{const{componentCls:t,cardShadow:n,cardHeadPadding:i,colorBorderSecondary:r,boxShadowTertiary:o,bodyPadding:a,extraColor:l}=e;return{[t]:Object.assign(Object.assign({},Ju(e)),{position:"relative",background:e.colorBgContainer,borderRadius:e.borderRadiusLG,[`&:not(${t}-bordered)`]:{boxShadow:o},[`${t}-head`]:O7(e),[`${t}-extra`]:{marginInlineStart:"auto",color:l,fontWeight:"normal",fontSize:e.fontSize},[`${t}-body`]:Object.assign({padding:a,borderRadius:`0 0 ${Ve(e.borderRadiusLG)} ${Ve(e.borderRadiusLG)}`},rm()),[`${t}-grid`]:q7(e),[`${t}-cover`]:{"> *":{display:"block",width:"100%",borderRadius:`${Ve(e.borderRadiusLG)} ${Ve(e.borderRadiusLG)} 0 0`}},[`${t}-actions`]:$7(e),[`${t}-meta`]:eq(e)}),[`${t}-bordered`]:{border:`${Ve(e.lineWidth)} ${e.lineType} ${r}`,[`${t}-cover`]:{marginTop:-1,marginInlineStart:-1,marginInlineEnd:-1}},[`${t}-hoverable`]:{cursor:"pointer",transition:`box-shadow ${e.motionDurationMid}, border-color ${e.motionDurationMid}`,"&:hover":{borderColor:"transparent",boxShadow:n}},[`${t}-contain-grid`]:{borderRadius:`${Ve(e.borderRadiusLG)} ${Ve(e.borderRadiusLG)} 0 0 `,[`${t}-body`]:{display:"flex",flexWrap:"wrap"},[`&:not(${t}-loading) ${t}-body`]:{marginBlockStart:e.calc(e.lineWidth).mul(-1).equal(),marginInlineStart:e.calc(e.lineWidth).mul(-1).equal(),padding:0}},[`${t}-contain-tabs`]:{[`> div${t}-head`]:{minHeight:0,[`${t}-head-title, ${t}-extra`]:{paddingTop:i}}},[`${t}-type-inner`]:tq(e),[`${t}-loading`]:nq(e),[`${t}-rtl`]:{direction:"rtl"}}},rq=e=>{const{componentCls:t,bodyPaddingSM:n,headerPaddingSM:i,headerHeightSM:r,headerFontSizeSM:o}=e;return{[`${t}-small`]:{[`> ${t}-head`]:{minHeight:r,padding:`0 ${Ve(i)}`,fontSize:o,[`> ${t}-head-wrapper`]:{[`> ${t}-extra`]:{fontSize:e.fontSize}}},[`> ${t}-body`]:{padding:n}},[`${t}-small${t}-contain-tabs`]:{[`> ${t}-head`]:{[`${t}-head-title, ${t}-extra`]:{paddingTop:0,display:"flex",alignItems:"center"}}}}},oq=e=>{var t,n;return{headerBg:"transparent",headerFontSize:e.fontSizeLG,headerFontSizeSM:e.fontSize,headerHeight:e.fontSizeLG*e.lineHeightLG+e.padding*2,headerHeightSM:e.fontSize*e.lineHeight+e.paddingXS*2,actionsBg:e.colorBgContainer,actionsLiMargin:`${e.paddingSM}px 0`,tabsMarginBottom:-e.padding-e.lineWidth,extraColor:e.colorText,bodyPaddingSM:12,headerPaddingSM:12,bodyPadding:(t=e.bodyPadding)!==null&&t!==void 0?t:e.paddingLG,headerPadding:(n=e.headerPadding)!==null&&n!==void 0?n:e.paddingLG}},aq=bl("Card",e=>{const t=nr(e,{cardShadow:e.boxShadowCard,cardHeadPadding:e.padding,cardPaddingBase:e.paddingLG,cardActionsIconSize:e.fontSize});return[iq(t),rq(t)]},oq);var jR=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const lq=e=>{const{actionClasses:t,actions:n=[],actionStyle:i}=e;return h.createElement("ul",{className:t,style:i},n.map((r,o)=>{const a=`action-${o}`;return h.createElement("li",{style:{width:`${100/n.length}%`},key:a},h.createElement("span",null,r))}))},sq=h.forwardRef((e,t)=>{const{prefixCls:n,className:i,rootClassName:r,style:o,extra:a,headStyle:l={},bodyStyle:s={},title:g,loading:c,bordered:u=!0,size:I,type:C,cover:m,actions:f,tabList:b,children:A,activeTabKey:p,defaultActiveTabKey:y,tabBarExtraContent:Z,hoverable:G,tabProps:v={},classNames:B,styles:R}=e,X=jR(e,["prefixCls","className","rootClassName","style","extra","headStyle","bodyStyle","title","loading","bordered","size","type","cover","actions","tabList","children","activeTabKey","defaultActiveTabKey","tabBarExtraContent","hoverable","tabProps","classNames","styles"]),{getPrefixCls:W,direction:V,card:Y}=h.useContext(Pt),K=ke=>{var xe;(xe=e.onTabChange)===null||xe===void 0||xe.call(e,ke)},M=ke=>{var xe;return he((xe=Y==null?void 0:Y.classNames)===null||xe===void 0?void 0:xe[ke],B==null?void 0:B[ke])},H=ke=>{var xe;return Object.assign(Object.assign({},(xe=Y==null?void 0:Y.styles)===null||xe===void 0?void 0:xe[ke]),R==null?void 0:R[ke])},w=h.useMemo(()=>{let ke=!1;return h.Children.forEach(A,xe=>{(xe==null?void 0:xe.type)===eJ&&(ke=!0)}),ke},[A]),x=W("card",n),[J,F,S]=aq(x),E=h.createElement(ig,{loading:!0,active:!0,paragraph:{rows:4},title:!1},A),N=p!==void 0,k=Object.assign(Object.assign({},v),{[N?"activeKey":"defaultActiveKey"]:N?p:y,tabBarExtraContent:Z});let z;const L=am(I),D=!L||L==="default"?"large":L,j=b?h.createElement($X,Object.assign({size:D},k,{className:`${x}-head-tabs`,onChange:K,items:b.map(ke=>{var{tab:xe}=ke,Ee=jR(ke,["tab"]);return Object.assign({label:xe},Ee)})})):null;if(g||a||j){const ke=he(`${x}-head`,M("header")),xe=he(`${x}-head-title`,M("title")),Ee=he(`${x}-extra`,M("extra")),We=Object.assign(Object.assign({},l),H("header"));z=h.createElement("div",{className:ke,style:We},h.createElement("div",{className:`${x}-head-wrapper`},g&&h.createElement("div",{className:xe,style:H("title")},g),a&&h.createElement("div",{className:Ee,style:H("extra")},a)),j)}const ne=he(`${x}-cover`,M("cover")),ie=m?h.createElement("div",{className:ne,style:H("cover")},m):null,ae=he(`${x}-body`,M("body")),Re=Object.assign(Object.assign({},s),H("body")),de=h.createElement("div",{className:ae,style:Re},c?E:A),Q=he(`${x}-actions`,M("actions")),O=f!=null&&f.length?h.createElement(lq,{actionClasses:Q,actionStyle:H("actions"),actions:f}):null,me=pa(X,["onTabChange"]),Ae=he(x,Y==null?void 0:Y.className,{[`${x}-loading`]:c,[`${x}-bordered`]:u,[`${x}-hoverable`]:G,[`${x}-contain-grid`]:w,[`${x}-contain-tabs`]:b==null?void 0:b.length,[`${x}-${L}`]:L,[`${x}-type-${C}`]:!!C,[`${x}-rtl`]:V==="rtl"},i,r,F,S),De=Object.assign(Object.assign({},Y==null?void 0:Y.style),o);return J(h.createElement("div",Object.assign({ref:t},me,{className:Ae,style:De}),z,ie,de,O))});var gq=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const cq=e=>{const{prefixCls:t,className:n,avatar:i,title:r,description:o}=e,a=gq(e,["prefixCls","className","avatar","title","description"]),{getPrefixCls:l}=h.useContext(Pt),s=l("card",t),g=he(`${s}-meta`,n),c=i?h.createElement("div",{className:`${s}-meta-avatar`},i):null,u=r?h.createElement("div",{className:`${s}-meta-title`},r):null,I=o?h.createElement("div",{className:`${s}-meta-description`},o):null,C=u||I?h.createElement("div",{className:`${s}-meta-detail`},u,I):null;return h.createElement("div",Object.assign({},a,{className:g}),c,C)},HC=sq;HC.Grid=eJ;HC.Meta=cq;function uq(e,t,n){var i=n||{},r=i.noTrailing,o=r===void 0?!1:r,a=i.noLeading,l=a===void 0?!1:a,s=i.debounceMode,g=s===void 0?void 0:s,c,u=!1,I=0;function C(){c&&clearTimeout(c)}function m(b){var A=b||{},p=A.upcomingOnly,y=p===void 0?!1:p;C(),u=!y}function f(){for(var b=arguments.length,A=new Array(b),p=0;p<b;p++)A[p]=arguments[p];var y=this,Z=Date.now()-I;if(u)return;function G(){I=Date.now(),t.apply(y,A)}function v(){c=void 0}!l&&g&&!c&&G(),C(),g===void 0&&Z>e?l?(I=Date.now(),o||(c=setTimeout(g?v:G,e))):G():o!==!0&&(c=setTimeout(g?v:G,g===void 0?e-Z:e))}return f.cancel=m,f}function Iq(e,t,n){var i={},r=i.atBegin,o=r===void 0?!1:r;return uq(e,t,{debounceMode:o!==!1})}function UR(e){return["small","middle","large"].includes(e)}function QR(e){return e?typeof e=="number"&&!Number.isNaN(e):!1}const tJ=ce.createContext({latestIndex:0}),dq=tJ.Provider,Cq=e=>{let{className:t,index:n,children:i,split:r,style:o}=e;const{latestIndex:a}=h.useContext(tJ);return i==null?null:h.createElement(h.Fragment,null,h.createElement("div",{className:t,style:o},i),n<a&&r&&h.createElement("span",{className:`${t}-split`},r))};var hq=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const mq=h.forwardRef((e,t)=>{var n,i,r;const{getPrefixCls:o,space:a,direction:l}=h.useContext(Pt),{size:s=(n=a==null?void 0:a.size)!==null&&n!==void 0?n:"small",align:g,className:c,rootClassName:u,children:I,direction:C="horizontal",prefixCls:m,split:f,style:b,wrap:A=!1,classNames:p,styles:y}=e,Z=hq(e,["size","align","className","rootClassName","children","direction","prefixCls","split","style","wrap","classNames","styles"]),[G,v]=Array.isArray(s)?s:[s,s],B=UR(v),R=UR(G),X=QR(v),W=QR(G),V=sl(I,{keepEmpty:!0}),Y=g===void 0&&C==="horizontal"?"center":g,K=o("space",m),[M,H,w]=vX(K),x=he(K,a==null?void 0:a.className,H,`${K}-${C}`,{[`${K}-rtl`]:l==="rtl",[`${K}-align-${Y}`]:Y,[`${K}-gap-row-${v}`]:B,[`${K}-gap-col-${G}`]:R},c,u,w),J=he(`${K}-item`,(i=p==null?void 0:p.item)!==null&&i!==void 0?i:(r=a==null?void 0:a.classNames)===null||r===void 0?void 0:r.item);let F=0;const S=V.map((k,z)=>{var L,D;k!=null&&(F=z);const j=(k==null?void 0:k.key)||`${J}-${z}`;return h.createElement(Cq,{className:J,key:j,index:z,split:f,style:(L=y==null?void 0:y.item)!==null&&L!==void 0?L:(D=a==null?void 0:a.styles)===null||D===void 0?void 0:D.item},k)}),E=h.useMemo(()=>({latestIndex:F}),[F]);if(V.length===0)return null;const N={};return A&&(N.flexWrap="wrap"),!R&&W&&(N.columnGap=G),!B&&X&&(N.rowGap=v),M(h.createElement("div",Object.assign({ref:t,className:x,style:Object.assign(Object.assign(Object.assign({},N),a==null?void 0:a.style),b)},Z),h.createElement(dq,{value:E},S)))}),nJ=mq;nJ.Compact=mO;const FC=100,iJ=FC/5,rJ=FC/2-iJ/2,tf=rJ*2*Math.PI,PR=50,_R=e=>{const{dotClassName:t,style:n,hasCircleCls:i}=e;return h.createElement("circle",{className:he(`${t}-circle`,{[`${t}-circle-bg`]:i}),r:rJ,cx:PR,cy:PR,strokeWidth:iJ,style:n})},Aq=e=>{let{percent:t,prefixCls:n}=e;const i=`${n}-dot`,r=`${i}-holder`,o=`${r}-hidden`,[a,l]=h.useState(!1);Kn(()=>{t!==0&&l(!0)},[t!==0]);const s=Math.max(Math.min(t,100),0);if(!a)return null;const g={strokeDashoffset:`${tf/4}`,strokeDasharray:`${tf*s/100} ${tf*(100-s)/100}`};return h.createElement("span",{className:he(r,`${i}-progress`,s<=0&&o)},h.createElement("svg",{viewBox:`0 0 ${FC} ${FC}`,role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":s},h.createElement(_R,{dotClassName:i,hasCircleCls:!0}),h.createElement(_R,{dotClassName:i,style:g})))};function fq(e){const{prefixCls:t,percent:n=0}=e,i=`${t}-dot`,r=`${i}-holder`,o=`${r}-hidden`;return h.createElement(h.Fragment,null,h.createElement("span",{className:he(r,n>0&&o)},h.createElement("span",{className:he(i,`${t}-dot-spin`)},[1,2,3,4].map(a=>h.createElement("i",{className:`${t}-dot-item`,key:a})))),h.createElement(Aq,{prefixCls:t,percent:n}))}function pq(e){const{prefixCls:t,indicator:n,percent:i}=e,r=`${t}-dot`;return n&&h.isValidElement(n)?sZ(n,{className:he(n.props.className,r),percent:i}):h.createElement(fq,{prefixCls:t,percent:i})}const bq=new Ni("antSpinMove",{to:{opacity:1}}),yq=new Ni("antRotate",{to:{transform:"rotate(405deg)"}}),Zq=e=>{const{componentCls:t,calc:n}=e;return{[t]:Object.assign(Object.assign({},Ju(e)),{position:"absolute",display:"none",color:e.colorPrimary,fontSize:0,textAlign:"center",verticalAlign:"middle",opacity:0,transition:`transform ${e.motionDurationSlow} ${e.motionEaseInOutCirc}`,"&-spinning":{position:"relative",display:"inline-block",opacity:1},[`${t}-text`]:{fontSize:e.fontSize,paddingTop:n(n(e.dotSize).sub(e.fontSize)).div(2).add(2).equal()},"&-fullscreen":{position:"fixed",width:"100vw",height:"100vh",backgroundColor:e.colorBgMask,zIndex:e.zIndexPopupBase,inset:0,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",opacity:0,visibility:"hidden",transition:`all ${e.motionDurationMid}`,"&-show":{opacity:1,visibility:"visible"},[t]:{[`${t}-dot-holder`]:{color:e.colorWhite},[`${t}-text`]:{color:e.colorTextLightSolid}}},"&-nested-loading":{position:"relative",[`> div > ${t}`]:{position:"absolute",top:0,insetInlineStart:0,zIndex:4,display:"block",width:"100%",height:"100%",maxHeight:e.contentHeight,[`${t}-dot`]:{position:"absolute",top:"50%",insetInlineStart:"50%",margin:n(e.dotSize).mul(-1).div(2).equal()},[`${t}-text`]:{position:"absolute",top:"50%",width:"100%",textShadow:`0 1px 2px ${e.colorBgContainer}`},[`&${t}-show-text ${t}-dot`]:{marginTop:n(e.dotSize).div(2).mul(-1).sub(10).equal()},"&-sm":{[`${t}-dot`]:{margin:n(e.dotSizeSM).mul(-1).div(2).equal()},[`${t}-text`]:{paddingTop:n(n(e.dotSizeSM).sub(e.fontSize)).div(2).add(2).equal()},[`&${t}-show-text ${t}-dot`]:{marginTop:n(e.dotSizeSM).div(2).mul(-1).sub(10).equal()}},"&-lg":{[`${t}-dot`]:{margin:n(e.dotSizeLG).mul(-1).div(2).equal()},[`${t}-text`]:{paddingTop:n(n(e.dotSizeLG).sub(e.fontSize)).div(2).add(2).equal()},[`&${t}-show-text ${t}-dot`]:{marginTop:n(e.dotSizeLG).div(2).mul(-1).sub(10).equal()}}},[`${t}-container`]:{position:"relative",transition:`opacity ${e.motionDurationSlow}`,"&::after":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:"100%",height:"100%",background:e.colorBgContainer,opacity:0,transition:`all ${e.motionDurationSlow}`,content:'""',pointerEvents:"none"}},[`${t}-blur`]:{clear:"both",opacity:.5,userSelect:"none",pointerEvents:"none","&::after":{opacity:.4,pointerEvents:"auto"}}},"&-tip":{color:e.spinDotDefault},[`${t}-dot-holder`]:{width:"1em",height:"1em",fontSize:e.dotSize,display:"inline-block",transition:`transform ${e.motionDurationSlow} ease, opacity ${e.motionDurationSlow} ease`,transformOrigin:"50% 50%",lineHeight:1,color:e.colorPrimary,"&-hidden":{transform:"scale(0.3)",opacity:0}},[`${t}-dot-progress`]:{position:"absolute",top:"50%",transform:"translate(-50%, -50%)",insetInlineStart:"50%"},[`${t}-dot`]:{position:"relative",display:"inline-block",fontSize:e.dotSize,width:"1em",height:"1em","&-item":{position:"absolute",display:"block",width:n(e.dotSize).sub(n(e.marginXXS).div(2)).div(2).equal(),height:n(e.dotSize).sub(n(e.marginXXS).div(2)).div(2).equal(),background:"currentColor",borderRadius:"100%",transform:"scale(0.75)",transformOrigin:"50% 50%",opacity:.3,animationName:bq,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"alternate","&:nth-child(1)":{top:0,insetInlineStart:0,animationDelay:"0s"},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:"0.4s"},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:"0.8s"},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:"1.2s"}},"&-spin":{transform:"rotate(45deg)",animationName:yq,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear"},"&-circle":{strokeLinecap:"round",transition:["stroke-dashoffset","stroke-dasharray","stroke","stroke-width","opacity"].map(i=>`${i} ${e.motionDurationSlow} ease`).join(","),fillOpacity:0,stroke:"currentcolor"},"&-circle-bg":{stroke:e.colorFillSecondary}},[`&-sm ${t}-dot`]:{"&, &-holder":{fontSize:e.dotSizeSM}},[`&-sm ${t}-dot-holder`]:{i:{width:n(n(e.dotSizeSM).sub(n(e.marginXXS).div(2))).div(2).equal(),height:n(n(e.dotSizeSM).sub(n(e.marginXXS).div(2))).div(2).equal()}},[`&-lg ${t}-dot`]:{"&, &-holder":{fontSize:e.dotSizeLG}},[`&-lg ${t}-dot-holder`]:{i:{width:n(n(e.dotSizeLG).sub(e.marginXXS)).div(2).equal(),height:n(n(e.dotSizeLG).sub(e.marginXXS)).div(2).equal()}},[`&${t}-show-text ${t}-text`]:{display:"block"}})}},vq=e=>{const{controlHeightLG:t,controlHeight:n}=e;return{contentHeight:400,dotSize:t/2,dotSizeSM:t*.35,dotSizeLG:n}},Gq=bl("Spin",e=>{const t=nr(e,{spinDotDefault:e.colorTextDescription});return[Zq(t)]},vq),Sq=200,OR=[[30,.05],[70,.03],[96,.01]];function Bq(e,t){const[n,i]=h.useState(0),r=h.useRef(null),o=t==="auto";return h.useEffect(()=>(o&&e&&(i(0),r.current=setInterval(()=>{i(a=>{const l=100-a;for(let s=0;s<OR.length;s+=1){const[g,c]=OR[s];if(a<=g)return a+l*c}return a})},Sq)),()=>{clearInterval(r.current)}),[o,e]),o?n:t}var Rq=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};let oJ;function Wq(e,t){return!!e&&!!t&&!Number.isNaN(Number(t))}const Fb=e=>{var t;const{prefixCls:n,spinning:i=!0,delay:r=0,className:o,rootClassName:a,size:l="default",tip:s,wrapperClassName:g,style:c,children:u,fullscreen:I=!1,indicator:C,percent:m}=e,f=Rq(e,["prefixCls","spinning","delay","className","rootClassName","size","tip","wrapperClassName","style","children","fullscreen","indicator","percent"]),{getPrefixCls:b,direction:A,spin:p}=h.useContext(Pt),y=b("spin",n),[Z,G,v]=Gq(y),[B,R]=h.useState(()=>i&&!Wq(i,r)),X=Bq(B,m);h.useEffect(()=>{if(i){const w=Iq(r,()=>{R(!0)});return w(),()=>{var x;(x=w==null?void 0:w.cancel)===null||x===void 0||x.call(w)}}R(!1)},[r,i]);const W=h.useMemo(()=>typeof u<"u"&&!I,[u,I]),V=he(y,p==null?void 0:p.className,{[`${y}-sm`]:l==="small",[`${y}-lg`]:l==="large",[`${y}-spinning`]:B,[`${y}-show-text`]:!!s,[`${y}-rtl`]:A==="rtl"},o,!I&&a,G,v),Y=he(`${y}-container`,{[`${y}-blur`]:B}),K=(t=C??(p==null?void 0:p.indicator))!==null&&t!==void 0?t:oJ,M=Object.assign(Object.assign({},p==null?void 0:p.style),c),H=h.createElement("div",Object.assign({},f,{style:M,className:V,"aria-live":"polite","aria-busy":B}),h.createElement(pq,{prefixCls:y,indicator:K,percent:X}),s&&(W||I)?h.createElement("div",{className:`${y}-text`},s):null);return Z(W?h.createElement("div",Object.assign({},f,{className:he(`${y}-nested-loading`,g,G,v)}),B&&h.createElement("div",{key:"loading"},H),h.createElement("div",{className:Y,key:"container"},u)):I?h.createElement("div",{className:he(`${y}-fullscreen`,{[`${y}-fullscreen-show`]:B},a,G,v)},H):H)};Fb.setDefaultIndicator=e=>{oJ=e};let Di=null,Ua=e=>e(),uu=[],Iu={};function qR(){const{getContainer:e,duration:t,rtl:n,maxCount:i,top:r}=Iu,o=(e==null?void 0:e())||document.body;return{getContainer:()=>o,duration:t,rtl:n,maxCount:i,top:r}}const kq=ce.forwardRef((e,t)=>{const{messageConfig:n,sync:i}=e,{getPrefixCls:r}=h.useContext(Pt),o=Iu.prefixCls||r("message"),a=h.useContext(Q4),[l,s]=pX(Object.assign(Object.assign(Object.assign({},n),{prefixCls:o}),a.message));return ce.useImperativeHandle(t,()=>{const g=Object.assign({},l);return Object.keys(g).forEach(c=>{g[c]=function(){return i(),l[c].apply(l,arguments)}}),{instance:g,sync:i}}),s}),Vq=ce.forwardRef((e,t)=>{const[n,i]=ce.useState(qR),r=()=>{i(qR)};ce.useEffect(r,[]);const o=KP(),a=o.getRootPrefixCls(),l=o.getIconPrefixCls(),s=o.getTheme(),g=ce.createElement(kq,{ref:t,sync:r,messageConfig:n});return ce.createElement(eg,{prefixCls:a,iconPrefixCls:l,theme:s},o.holderRender?o.holderRender(g):g)});function Am(){if(!Di){const e=document.createDocumentFragment(),t={fragment:e};Di=t,Ua(()=>{yX()(ce.createElement(Vq,{ref:i=>{const{instance:r,sync:o}=i||{};Promise.resolve().then(()=>{!t.instance&&r&&(t.instance=r,t.sync=o,Am())})}}),e)});return}Di.instance&&(uu.forEach(e=>{const{type:t,skipped:n}=e;if(!n)switch(t){case"open":{Ua(()=>{const i=Di.instance.open(Object.assign(Object.assign({},Iu),e.config));i==null||i.then(e.resolve),e.setCloseFn(i)});break}case"destroy":Ua(()=>{Di==null||Di.instance.destroy(e.key)});break;default:Ua(()=>{var i;const r=(i=Di.instance)[t].apply(i,Yt(e.args));r==null||r.then(e.resolve),e.setCloseFn(r)})}}),uu=[])}function wq(e){Iu=Object.assign(Object.assign({},Iu),e),Ua(()=>{var t;(t=Di==null?void 0:Di.sync)===null||t===void 0||t.call(Di)})}function xq(e){const t=cZ(n=>{let i;const r={type:"open",config:e,resolve:n,setCloseFn:o=>{i=o}};return uu.push(r),()=>{i?Ua(()=>{i()}):r.skipped=!0}});return Am(),t}function Xq(e,t){const n=cZ(i=>{let r;const o={type:e,args:t,resolve:i,setCloseFn:a=>{r=a}};return uu.push(o),()=>{r?Ua(()=>{r()}):o.skipped=!0}});return Am(),n}const Jq=e=>{uu.push({type:"destroy",key:e}),Am()},Yq=["success","info","warning","error","loading"],Nq={open:xq,destroy:Jq,config:wq,useMessage:T_,_InternalPanelDoNotUseOrYouWillBeFired:H_},wo=Nq;Yq.forEach(e=>{wo[e]=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return Xq(e,n)}});const Hq="_scanContainer_eh464_1",Fq="_scanCard_eh464_7",Kq="_scannerContainer_eh464_11",Eq="_scanner_eh464_11",Mq="_loadingContainer_eh464_36",zq="_instructionText_eh464_41",Xa={scanContainer:Hq,scanCard:Fq,scannerContainer:Kq,scanner:Eq,loadingContainer:Mq,instructionText:zq},Lq=()=>{const[e,t]=h.useState(!0),[n,i]=h.useState(!1),[r,o]=h.useState(null),[a,l]=h.useState("environment"),s=Gt();h.useEffect(()=>{(async()=>{const{data:{session:m},error:f}=await _.auth.getSession();if(f||!m){console.error("Auth error:",f),wo.error("Please login to use the scanner"),s("/login");return}o(m.user.id)})()},[s]);const g=async C=>{if(C&&!n)try{i(!0),console.log("Scan Result:",C);try{JSON.parse(C.text)}catch{throw new Error("Invalid QR code format. Expected JSON data.")}await I(C.text),wo.success("Item added to inventory successfully!"),t(!1),s("/inventory")}catch(m){console.error("Scan Error:",m),wo.error("Failed to process scan: "+m.message)}finally{i(!1)}},c=C=>{(C==null?void 0:C.name)!=="NotFoundException"&&(console.error("Camera Error:",C),(C==null?void 0:C.name)==="NotAllowedError"?wo.error("Please allow camera access to use the scanner"):(C==null?void 0:C.name)==="NotFoundError"?wo.error("No camera found on your device"):(C==null?void 0:C.name)==="NotReadableError"?wo.error("Unable to access camera. Please check if another app is using it"):wo.error("Error accessing camera: "+C.message))},u=()=>{l(C=>C==="environment"?"user":"environment")},I=async C=>{try{console.log("Raw QR Data:",C);const m=JSON.parse(C);if(console.log("Parsed Receipt Data:",m),m.store.name!=="SuperMart Grocery")throw new Error("Invalid receipt: Not from SuperMart Grocery");if(!r)throw new Error("User not authenticated");console.log("Current User ID:",r);const f=m.receipt.items.map(async A=>{const{data:p,error:y}=await _.from("ingredients").select("*").eq("id",A.id).single();if(y)throw console.error("Error fetching ingredient:",y),new Error(`Invalid ingredient ID: ${A.id}`);let Z=null;p.pred_shelf_life&&(Z=parseInt(p.pred_shelf_life));const G={user_id:r,ingredient_id:A.id,quantity:A.quantity,quantity_unit_id:p.quantity_unit_id,created_at:new Date().toISOString(),condition_id:1,days_left:Z,init_quantity:A.quantity};console.log("Preparing to insert item:",G);const{data:v,error:B}=await _.from("inventory").insert(G).select();if(B)throw console.error("Supabase Error:",B),B;return console.log("Successfully added item:",v[0]),v[0]});return await Promise.all(f)}catch(m){throw console.error("Error adding items to inventory:",m),m}};return r?d.jsx("div",{className:Xa.scanContainer,children:d.jsx(HC,{title:"Scan QR Code",className:Xa.scanCard,children:d.jsx(nJ,{direction:"vertical",style:{width:"100%"},children:n?d.jsxs("div",{className:Xa.loadingContainer,children:[d.jsx(Fb,{size:"large"}),d.jsx("p",{children:"Processing scan..."})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:Xa.scannerContainer,children:d.jsx(Uy,{delay:300,onError:c,onScan:g,constraints:{video:{facingMode:a}},style:{width:"100%",maxWidth:"500px"}})}),d.jsx("div",{style:{textAlign:"center",marginTop:"10px"},children:d.jsxs(hZ,{onClick:u,children:["Switch Camera (",a==="environment"?"Back":"Front",")"]})}),d.jsx("p",{className:Xa.instructionText,children:"Hold your QR code steady in front of the camera. Make sure there's good lighting and the code is clear."})]})})})}):d.jsx("div",{className:Xa.scanContainer,children:d.jsx(HC,{children:d.jsxs("div",{className:Xa.loadingContainer,children:[d.jsx(Fb,{size:"large"}),d.jsx("p",{children:"Checking authentication..."})]})})})},aJ=h.createContext(),rg=()=>h.useContext(aJ),Dq=({children:e})=>{const[t,n]=h.useState(null),[i,r]=h.useState([]),[o,a]=h.useState([]),[l,s]=h.useState([]),[g,c]=h.useState([]),[u,I]=h.useState([]),[C,m]=h.useState([]),[f,b]=h.useState([]),[A,p]=h.useState({categories:[],tags:[],equipment:[],cookTime:null,ingredients:[]}),[y,Z]=h.useState(!0),G=async()=>{try{const{data:L,error:D}=await _.auth.getUser();D?console.error("Error fetching user data:",D):n((L==null?void 0:L.user)||null)}catch(L){console.error("Unexpected error fetching user data:",L)}},v=async()=>{Z(!0);try{const{data:L,error:D}=await _.from("recipes").select(`
          id,
          name,
          description,
          prep_time,
          cook_time,
          image_path,
          recipe_tags:recipe_tags_recipe_id_fkey ( tags (name) ),
          recipe_equipment ( equipment (name) ),
          recipe_category ( category (name) ),
          recipe_ingredients ( ingredients (name) )
        `);if(D)console.error("Error fetching recipes:",D);else{const j=L.map(ne=>{var ie,ae,Re,de;return{...ne,tags:((ie=ne.recipe_tags)==null?void 0:ie.map(Q=>Q.tags.name))||[],equipment:((ae=ne.recipe_equipment)==null?void 0:ae.map(Q=>Q.equipment.name))||[],categories:((Re=ne.recipe_category)==null?void 0:Re.map(Q=>Q.category.name))||[],ingredients:((de=ne.recipe_ingredients)==null?void 0:de.map(Q=>Q.ingredients.name))||[]}});r(j||[])}}catch(L){console.error("Unexpected error:",L)}finally{Z(!1)}},B=async()=>{try{const{data:L,error:D}=await _.from("tags").select("id, name");D?console.error("Error fetching tags:",D):a(L||[])}catch(L){console.error("Unexpected error fetching tags:",L)}},R=async()=>{try{const{data:L,error:D}=await _.from("category").select("id, name");D?console.error("Error fetching categories:",D):s(L||[])}catch(L){console.error("Unexpected error fetching categories:",L)}},X=async()=>{try{const{data:L,error:D}=await _.from("equipment").select("id, name");D?console.error("Error fetching equipments:",D):c(L||[])}catch(L){console.error("Unexpected error fetching equipment:",L)}},W=async()=>{try{const{data:L,error:D}=await _.from("ingredients").select("id, name");D?console.error("Error fetching ingredients:",D):I(L||[])}catch(L){console.error("Unexpected error fetching ingredients:",L)}},V=async()=>{if(t)try{const{data:L,error:D}=await _.from("favorites").select("recipe_id").eq("user_id",t.id);if(D){console.error("Error fetching favorites:",D.message);return}b(L.map(j=>j.recipe_id))}catch(L){console.error("Unexpected error fetching favorites:",L.message)}},Y=L=>{p(D=>({...D,...L}))};h.useEffect(()=>{G(),v(),B(),R(),X(),W(),w(),V()},[]),h.useEffect(()=>{v()},[A]);const K=async L=>{try{const{data:D,error:j}=await _.from("recipe_ingredients").select(`
              ingredients (
                id,
                name,
                nutritional_info,
                unit:quantity_unit_id (
                  unit_tag,
                  unit_description,
                  conversion_rate_to_grams 
                )
              ),
              quantity,
              recipe_id
            `).eq("recipe_id",L);if(j)console.error("Error fetching recipe ingredients:",j);else return D||[]}catch(D){return console.error("Unexpected error fetching recipe ingredients:",D),[]}},M=async L=>{try{const{data:D,error:j}=await _.from("steps").select(`
                step_number,
                instruction,
                variations
            `).eq("recipe_id",L).order("step_number",{ascending:!0});if(j)console.error("Error fetching recipe steps:",j);else return D||[]}catch(D){return console.error("Unexpected error fetching recipe steps:",D),[]}},H=async L=>{try{const{data:D,error:j}=await _.from("meal_plan").select("id, meal_type_id, recipe_id, notes, planned_date").eq("planned_date",L);if(j)return console.error("Error fetching meal plans:",j),[];const{data:ne,error:ie}=await _.from("meal_type").select("id, name");if(ie)return console.error("Error fetching meal types:",ie),[];const ae=ne.reduce((de,Q)=>(de[Q.id]=Q.name,de),{});return D.map(de=>({...de,meal_type_name:ae[de.meal_type_id]||"Unknown"}))}catch(D){return console.error("Unexpected error fetching meal plans:",D),[]}},w=async()=>{try{const{data:L,error:D}=await _.from("meal_type").select("*");D?console.error("Error fetching meal types:",D):m(L||[])}catch(L){console.error("Unexpected error fetching meal types:",L)}},x=async L=>{try{const{data:D,error:j}=await _.from("recipes").select(`
              id,
              name,
              description,
              prep_time,
              cook_time,
              image_path,
              recipe_tags:recipe_tags_recipe_id_fkey ( tags (name) ),
              recipe_equipment ( equipment (name) ),
              recipe_category ( category (name) ),
              recipe_ingredients ( ingredients (name) )
            `).in("id",L);return j?(console.error("Error fetching recipes by IDs:",j),[]):D||[]}catch(D){return console.error("Unexpected error fetching recipes by IDs:",D),[]}},J=async(L=null)=>{try{if(!t)return console.error("User not logged in. Cannot fetch inventory."),[];const D=_.from("inventory").select(`
          id,
          user_id,
          ingredient_id,
          quantity,
          expiry_date_id,
          freshness_status_id,
          quantity_unit_id,
          init_quantity,
          days_left,
          expiry_date (
            id, 
            date
          ),
          freshness_status (
            id, 
            status_color
          ),
          unit:quantity_unit_id (
            id,
            unit_tag, 
            unit_description
          ),
          ingredients (
            id,
            name,
            nutritional_info,
            unit:quantity_unit_id (
              unit_tag,
              unit_description,
              conversion_rate_to_grams 
            )
          )
        `).eq("user_id",t.id).gt("days_left",0);L&&D.eq("ingredient_id",L);const{data:j,error:ne}=await D;return ne?(console.error("Error fetching user inventory:",ne),[]):j||[]}catch(D){return console.error("Unexpected error fetching user inventory:",D),[]}},F=async L=>{try{const{data:D,error:j}=await _.from("inventory_meal_plan_status").select("id").eq("name",L).single();return j||!D?(console.error("Error fetching status ID:",j),null):D.id}catch(D){return console.error("Unexpected error fetching status ID:",D.message),null}},S=async L=>{try{const{data:D,error:j}=await _.from("inventory_meal_plan").select("inventory_id, meal_plan_id, used_quantity, status_id").eq("meal_plan_id",L);return j?(console.error("Error fetching inventory meal plan data:",j),[]):D}catch(D){return console.error("Unexpected error fetching inventory meal plan data:",D.message),[]}},E=async L=>{try{const{data:D,error:j}=await _.from("inventory_meal_plan").select(`
          inventory_id, 
          meal_plan_id, 
          meal_plan (
            recipe_id,
            meal_type_id,
            planned_date
          ),
          used_quantity, 
          status_id, 
          inventory_meal_plan_status (
            name,
            description
          ),
          inventory (
            ingredient_id,
            quantity,
            expiry_date:expiry_date_id(
              date
            ),
            days_left,
            freshness_status_id,
            quantity_unit_id,
            init_quantity,
            condition:condition_id (
              condition
            )
          ),
          ingredients (
            id,
            name,
            nutritional_info,
            unit:quantity_unit_id (
              unit_tag,
              unit_description,
              conversion_rate_to_grams 
            )
          )
        `).in("meal_plan_id",L);return j?(console.error("Error fetching inventory meal plan data by meal_plan_id:",j),[]):D}catch(D){return console.error("Unexpected error fetching inventory meal plan data by meal_plan_id:",D.message),[]}},N=async(L,D,j)=>{try{return await Promise.all(L.map(async ne=>{if(ne.meal_plan_id)return ne;const{data:ie,error:ae}=await _.from("meal_plan").select("id").eq("planned_date",j).eq("recipe_id",D.recipe_id).limit(1).single();return ae?(console.warn(`Failed to fetch meal plan for inventory ID: ${ne.id}`,ae),{...ne,meal_plan_id:null}):{...ne,meal_plan_id:(ie==null?void 0:ie.id)||null}}))}catch(ne){return console.error("Error enriching inventory:",ne.message),[]}},k=async({mealPlanIds:L=null,plannedDate:D=null})=>{try{let j=_.from("inventory_meal_plan").select(`
        inventory_id,
        meal_plan_id,
        meal_plan (
          recipe_id,
          meal_type_id,
          planned_date
        ),
        used_quantity,
        status_id,
        inventory_meal_plan_status (name, description),
        inventory (
          ingredient_id,
          quantity,
          expiry_date:expiry_date_id (date),
          days_left,
          freshness_status_id,
          quantity_unit_id,
          init_quantity,
          condition:condition_id (condition)
        ),
        ingredients (
          id,
          name,
          nutritional_info,
          unit:quantity_unit_id (unit_tag, unit_description, conversion_rate_to_grams)
        )
      `);if(L&&(j=j.in("meal_plan_id",L)),D&&!L){const{data:ae,error:Re}=await _.from("meal_plan").select("id").eq("planned_date",D);if(Re)return console.error("Error fetching meal plans by planned date:",Re.message),[];const de=(ae==null?void 0:ae.map(Q=>Q.id))||[];if(de.length>0)j=j.in("meal_plan_id",de);else return console.warn("No meal plans found for the given date."),[]}const{data:ne,error:ie}=await j;return ie?(console.error("Error fetching inventory data:",ie.message),[]):ne||[]}catch(j){return console.error("Unexpected error fetching inventory data:",j.message),[]}},z=async L=>{if(!t){alert("Please log in to add favorites.");return}try{const{data:D,error:j}=await _.from("favorites").select("id").eq("recipe_id",L).eq("user_id",t.id).single();if(j&&j.code!=="PGRST116"){console.error("Error checking favorite status:",j.message);return}if(D){const{error:ne}=await _.from("favorites").delete().eq("id",D.id);if(ne){console.error("Error removing favorite:",ne.message);return}b(ie=>ie.filter(ae=>ae!==L))}else{const{error:ne}=await _.from("favorites").insert({recipe_id:L,user_id:t.id});if(ne){console.error("Error adding favorite:",ne.message);return}b(ie=>[...ie,L])}}catch(D){console.error("Unexpected error toggling favorite:",D.message)}};return d.jsx(aJ.Provider,{value:{userData:t,recipes:i,tags:o,categories:l,equipment:g,filters:A,ingredients:u,mealTypes:C,favorites:f,fetchRecipes:v,fetchTags:B,fetchCategories:R,fetchEquipment:X,fetchIngredients:W,fetchRecipeIngredients:K,fetchRecipeSteps:M,fetchMealPlansByDate:H,fetchRecipesByIds:x,fetchUserInventory:J,getStatusIdByName:F,fetchInventoryMealPlanData:S,fetchInventoryMealPlanByMealPlanId:E,enrichInventory:N,fetchInventoryData:k,applyFilters:Y,toggleFavorite:z,loading:y},children:e})},Tq=()=>{const e=Gt();return d.jsxs("div",{style:{padding:"20px"},children:[d.jsx("h1",{children:"Recipe Dashboard"}),d.jsx("p",{children:"Welcome to your Recipe Dashboard! Use the options below to navigate to different sections of your recipe module."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[d.jsx("button",{onClick:()=>e("/recipes/explore"),style:{padding:"10px 20px",cursor:"pointer",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"5px"},children:"Explore Recipes"}),d.jsx("button",{onClick:()=>e("/recipes/favorites"),style:{padding:"10px 20px",cursor:"pointer",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"5px"},children:"View Favorites"}),d.jsx("button",{onClick:()=>e("/recipes/calendar"),style:{padding:"10px 20px",cursor:"pointer",backgroundColor:"#FFC107",color:"white",border:"none",borderRadius:"5px"},children:"Plan Your Meals"})]})]})},ba=()=>{const e=Gt(),t=()=>{e(-1)};return d.jsx("button",{onClick:t,className:"back-button",children:"← Back"})},jq=()=>{var Re,de;const{recipes:e,filters:t,applyFilters:n,loading:i,fetchRecipes:r,mealTypes:o,userData:a,favorites:l,toggleFavorite:s}=rg(),[g,c]=h.useState([]),[u,I]=h.useState([]),[C,m]=h.useState([]),[f,b]=h.useState(""),[A,p]=h.useState(!1),[y,Z]=h.useState(!1),[G,v]=h.useState(""),[B,R]=h.useState([]);h.useState([]);const[X,W]=h.useState(null),[V,Y]=h.useState({notes:"",time:"",meal_type_id:"",planned_date:"",recipe_id:""}),K=yi(),M=Gt(),{planned_date:H,meal_type_id:w,activity_type:x}=K.state||{},J=((Re=o.find(Q=>Q.id===w))==null?void 0:Re.name)||"Unknown Meal Type",F=async()=>{try{const[{data:Q,error:O},{data:me},{data:Ae}]=await Promise.all([_.from("category").select("id, name"),_.from("tags").select("id, name"),_.from("equipment").select("id, name")]);if(O){console.error("Error fetching categories:",O);return}c(Q||[]),I(me||[]),m(Ae||[])}catch(Q){console.error("Error fetching filter options:",Q)}},S=async Q=>{if(!Q.trim()){R([]);return}try{const{data:O,error:me}=await _.from("ingredients").select("name, icon_path").ilike("name",`%${Q}%`);if(me){console.error("Error fetching ingredients:",me);return}console.log("Matching Ingredients:",O),R(O||[])}catch(O){console.error("Unexpected error:",O)}};h.useEffect(()=>{r(),F()},[]),h.useEffect(()=>{r()},[t]);const E=e.filter(Q=>{var Ee;const O=(Ee=Q.name)==null?void 0:Ee.toLowerCase().includes(f.toLowerCase()),me=t.categories.length?t.categories.some(We=>(Q.categories||[]).includes(We)):!0,Ae=t.tags.length?t.tags.some(We=>(Q.tags||[]).includes(We)):!0,De=t.equipment.length?t.equipment.some(We=>(Q.equipment||[]).includes(We)):!0,ke=t.cookTime?Q.cook_time<=t.cookTime:!0,xe=t.ingredients.length?t.ingredients.every(We=>(Q.ingredients||[]).some(ze=>ze.toLowerCase()===We.toLowerCase())):!0;return O&&me&&Ae&&De&&ke&&xe}),N=Q=>{t.ingredients.includes(Q.name)||(n({ingredients:[...t.ingredients,Q.name]}),R(O=>({...O,[Q.name]:Q.icon_path})))},k=Q=>{n({ingredients:t.ingredients.filter(O=>O!==Q)})},z=()=>{p(!1)},L=()=>t.categories.length===g.length&&t.tags.length===u.length&&t.equipment.length===C.length,D=()=>t.categories.length>0||t.tags.length>0||t.equipment.length>0,j=()=>{n({categories:g.map(Q=>Q.name),tags:u.map(Q=>Q.name),equipment:C.map(Q=>Q.name)})},ne=()=>{n({categories:[],tags:[],equipment:[]})},ie=async()=>{try{const{error:Q}=await _.from("meal_plan").insert([{user_id:a.id,recipe_id:V.recipe_id,planned_date:V.planned_date,meal_type_id:V.meal_type_id,notes:V.notes,time:V.time}]);if(Q){console.error("Error adding meal:",Q.message);return}alert("Meal successfully added!"),W(null)}catch(Q){console.error("Unexpected error adding meal:",Q.message)}},ae=Q=>{var me;const O=((me=o.find(Ae=>Ae.id===w))==null?void 0:me.default_time)||"12:00";Y({notes:"",time:O,meal_type_id:w,planned_date:H,recipe_id:Q}),W(!0)};return i?d.jsx("div",{children:"Loading recipes..."}):d.jsxs("div",{style:{padding:"20px"},children:[d.jsx(ba,{}),d.jsx("h1",{children:"Explore Recipes"}),H&&x&&w&&d.jsxs("div",{style:{marginBottom:"20px",padding:"10px",background:"#f8f9fa",borderRadius:"5px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:[d.jsx("p",{children:d.jsx("strong",{children:"Adding meal for:"})}),d.jsxs("p",{children:[d.jsx("strong",{children:"Date:"})," ",H]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Meal Type:"})," ",J]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Activity Type:"})," ",x]})]}),d.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:[d.jsx("input",{type:"text",placeholder:"Search recipes...",value:f,onChange:Q=>b(Q.target.value),style:{padding:"10px",flex:1,border:"1px solid #ccc",borderRadius:"5px"}}),d.jsx("button",{onClick:()=>p(!0),style:{padding:"10px",background:"#000",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Filters"})]}),d.jsx("div",{children:E.length>0?E.map(Q=>d.jsxs("div",{onClick:()=>M(`/recipes/recipe/${Q.id}`,{state:{planned_date:H,meal_type_id:w,recipe_id:Q.id,recipe_name:Q.name,activity_type:x}}),style:{padding:"10px",border:"1px solid #ddd",marginBottom:"10px",borderRadius:"5px",display:"flex",flexDirection:"column",cursor:"pointer"},children:[d.jsx("img",{src:`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${Q.image_path}`,alt:Q.name,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"5px",marginBottom:"10px"}}),d.jsxs("div",{children:[d.jsx("h3",{children:Q.name}),d.jsx("p",{children:Q.description}),d.jsxs("p",{children:["Prep Time: ",Q.prep_time," mins"]}),d.jsxs("p",{children:["Cook Time: ",Q.cook_time," mins"]}),d.jsx("button",{onClick:O=>{O.stopPropagation(),s(Q.id)},style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"24px"},children:l.includes(Q.id)?"❤️":"🤍"}),H&&w&&d.jsx("button",{onClick:O=>{O.stopPropagation(),ae(Q.id)},style:{padding:"10px",background:"#28a745",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",marginTop:"10px",zIndex:1e3},children:"Add to Meal"}),(Q.tags||[]).length>0&&d.jsxs("div",{style:{marginTop:"10px"},children:[d.jsx("strong",{children:"Tags:"})," ",Q.tags.map((O,me)=>d.jsx("span",{style:{background:"#ffcc00",color:"#000",padding:"5px 10px",marginRight:"5px",borderRadius:"5px",fontSize:"12px"},children:O},me))]}),(Q.equipment||[]).length>0&&d.jsxs("div",{style:{marginTop:"10px"},children:[d.jsx("strong",{children:"Equipment:"})," ",Q.equipment.map((O,me)=>d.jsx("span",{style:{background:"#000000",padding:"5px 10px",marginRight:"5px",borderRadius:"3px",fontSize:"12px"},children:O},me))]})]})]},Q.id)):d.jsx("p",{children:"No recipes found."})}),A&&d.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.8)",color:"#fff",display:"flex",flexDirection:"column",zIndex:1e3},children:[d.jsx("button",{onClick:()=>p(!1),style:{position:"absolute",top:"10px",right:"10px",background:"red",color:"#fff",border:"none",borderRadius:"50%",width:"30px",height:"30px",cursor:"pointer"},children:"X"}),d.jsx("h2",{style:{padding:"20px"},children:"Filter Options"}),d.jsxs("div",{style:{marginBottom:"20px"},children:[!D()&&d.jsx("button",{onClick:j,style:{width:"100%",padding:"10px",background:"#007BFF",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Select All"}),D()&&!L()&&d.jsxs("div",{style:{display:"flex",gap:"10px"},children:[d.jsx("button",{onClick:ne,style:{flex:1,padding:"10px",background:"#FF4136",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Clear"}),d.jsx("button",{onClick:j,style:{flex:1,padding:"10px",background:"#007BFF",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Select All"})]}),L()&&d.jsx("button",{onClick:ne,style:{width:"100%",padding:"10px",background:"#FF4136",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Deselect All"})]}),d.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px"},children:[d.jsx("button",{onClick:()=>Z(!0),style:{padding:"10px",background:"#00aaff",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},children:"+ Search Recipe by Ingredient"}),d.jsxs("div",{style:{padding:"20px"},children:[d.jsx("h3",{children:"Selected Ingredients:"}),d.jsx("div",{children:t.ingredients.length>0?t.ingredients.map((Q,O)=>d.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[d.jsx("span",{children:Q}),d.jsx("button",{onClick:()=>k(Q),style:{marginLeft:"10px",background:"red",color:"white",border:"none",borderRadius:"5px",padding:"5px",cursor:"pointer"},children:"X"})]},O)):d.jsx("p",{children:"No ingredients selected."})})]}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("h3",{children:"Category"}),g.map(Q=>d.jsxs("label",{style:{display:"block",marginBottom:"5px"},children:[d.jsx("input",{type:"checkbox",checked:t.categories.includes(Q.name),onChange:O=>{const me=O.target.checked;n({...t,categories:me?[...t.categories,Q.name]:t.categories.filter(Ae=>Ae!==Q.name)})}}),Q.name]},Q.id))]}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("h3",{children:"Tags"}),u.map(Q=>d.jsxs("label",{style:{display:"block",marginBottom:"5px"},children:[d.jsx("input",{type:"checkbox",checked:t.tags.includes(Q.name),onChange:O=>{const me=O.target.checked;n({...t,tags:me?[...t.tags,Q.name]:t.tags.filter(Ae=>Ae!==Q.name)})}})," ",Q.name]},Q.id))]}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("h3",{children:"Equipment"}),C.map(Q=>d.jsxs("label",{style:{display:"block",marginBottom:"5px"},children:[d.jsx("input",{type:"checkbox",checked:t.equipment.includes(Q.name),onChange:O=>{const me=O.target.checked;n({...t,equipment:me?[...t.equipment,Q.name]:t.equipment.filter(Ae=>Ae!==Q.name)})}})," ",Q.name]},Q.id))]}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("h3",{children:"Cooking Time"}),d.jsxs("select",{value:t.cookTime||"",onChange:Q=>n({...t,cookTime:Q.target.value?Number(Q.target.value):null}),style:{padding:"10px",borderRadius:"5px",width:"100%"},children:[d.jsx("option",{value:"",children:"Any"}),d.jsx("option",{value:"15",children:"Less than 15 mins"}),d.jsx("option",{value:"30",children:"Less than 30 mins"}),d.jsx("option",{value:"60",children:"Less than 60 mins"})]})]}),d.jsx("button",{onClick:z,style:{padding:"10px 20px",background:"#00aaff",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",width:"100%"},children:"Apply Filters"})]})]}),y&&d.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.8)",color:"#fff",display:"flex",flexDirection:"column",zIndex:1e3},children:[d.jsx("button",{onClick:()=>Z(!1),style:{position:"absolute",top:"10px",right:"10px",background:"red",color:"#fff",border:"none",borderRadius:"50%",width:"30px",height:"30px",cursor:"pointer"},children:"X"}),d.jsx("h2",{style:{padding:"20px"},children:"Search Ingredients"}),d.jsx("div",{style:{padding:"0 20px",marginBottom:"10px"},children:d.jsx("input",{type:"text",placeholder:"Type an ingredient...",value:G,onChange:Q=>{v(Q.target.value),S(Q.target.value)},style:{width:"100%",padding:"10px",borderRadius:"5px",border:"1px solid #ddd"}})}),d.jsx("div",{style:{flex:1,padding:"0 20px",overflowY:"auto"},children:B.length>0?B.map((Q,O)=>d.jsxs("div",{onClick:()=>{N(Q),console.log("Ingredient added:",Q.name),v(""),R([])},style:{display:"flex",alignItems:"center",padding:"10px",marginBottom:"5px",border:"1px solid #ddd",borderRadius:"5px",background:"#444",cursor:"pointer"},children:[d.jsx("img",{src:`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${Q.icon_path}`,alt:Q.name,style:{width:"30px",height:"30px",marginRight:"10px",borderRadius:"50%",objectFit:"cover",background:"#fff"}}),d.jsx("span",{children:Q.name})]},O)):d.jsx("p",{children:"No matching ingredients found."})}),d.jsxs("div",{style:{padding:"20px",background:"#333",borderTop:"1px solid #555"},children:[d.jsx("h3",{children:"Selected Ingredients:"}),t.ingredients.length>0?t.ingredients.map((Q,O)=>d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"5px 10px",border:"1px solid #666",borderRadius:"5px",marginBottom:"5px",background:"#555"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[Q.icon_path&&d.jsx("img",{src:`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${Q.icon_path}`,alt:Q.name,style:{width:"30px",height:"30px",marginRight:"10px",borderRadius:"50%",objectFit:"cover",background:"#fff"}}),d.jsx("span",{children:Q}),d.jsx("span",{children:Q.icon_path})]}),d.jsx("button",{onClick:()=>k(Q),style:{background:"red",color:"#fff",border:"none",borderRadius:"50%",width:"20px",height:"20px",cursor:"pointer"},children:"X"})]},O)):d.jsx("p",{children:"No ingredients selected."})]}),d.jsx("button",{onClick:()=>{Z(!1)},style:{padding:"10px 20px",background:"#00aaff",color:"#fff",border:"none",borderRadius:"5px",margin:"20px",cursor:"pointer"},children:"Find Recipes"})]}),X&&d.jsx("div",{className:"modal",children:d.jsxs("div",{className:"modal-content",children:[d.jsx("h2",{children:"Add a Meal"}),d.jsxs("p",{children:[d.jsx("strong",{children:"Meal Type:"})," ",((de=o.find(Q=>Q.id===V.meal_type_id))==null?void 0:de.name)||"Unknown"]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Planned Date:"})," ",V.planned_date]}),d.jsxs("label",{children:["Notes:",d.jsx("textarea",{value:V.notes,placeholder:"Enter additional notes (e.g., extra ingredients, instructions)",onChange:Q=>Y(O=>({...O,notes:Q.target.value})),rows:"3"})]}),d.jsxs("label",{children:["Time:",d.jsx("input",{type:"time",value:V.time,onChange:Q=>Y(O=>({...O,time:Q.target.value}))})]}),d.jsx("button",{onClick:ie,style:{marginRight:"10px"},children:"Save"}),d.jsx("button",{onClick:()=>W(null),children:"Cancel"})]})})]})},Uq=()=>{var ke,xe,Ee,We,ze,Ge,it,Pe,U,oe;const{recipes:e,fetchRecipeIngredients:t,fetchRecipeSteps:n,mealTypes:i,userData:r,toggleFavorite:o}=rg(),{id:a}=Aa(),l=Gt(),[s,g]=h.useState(null),[c,u]=h.useState([]),[I,C]=h.useState([]),[m,f]=h.useState(!0),[b,A]=h.useState(!1),[p,y]=h.useState(0),[Z,G]=h.useState(null),[v,B]=h.useState([]),[R,X]=h.useState(2),[W,V]=h.useState(1),[Y,K]=h.useState({calories:0,protein:0,carbohydrate:0,fat:0}),[M,H]=h.useState(0),x=yi().state,[J,F]=h.useState(null),[S,E]=h.useState({notes:"",time:"",meal_type_id:"",planned_date:"",recipe_id:""}),[N,k]=h.useState(!1);h.useEffect(()=>{(async()=>{const re=e.find(ve=>ve.id===parseInt(a));if(re){g(re);const ve=await t(re.id);u(ve),z(ve);const Fe=await n(re.id);if(C(Fe),r)try{const{data:Te,error:Xe}=await _.from("favorites").select("id").eq("recipe_id",re.id).eq("user_id",r.id).single();!Xe&&Te&&k(!0)}catch(Te){console.error("Error checking favorite status:",Te.message)}}else g(null);f(!1)})()},[a,e,t,n,r]);const z=P=>{let re={calories:0,protein:0,carbohydrate:0,fat:0},ve=0;P.forEach(Te=>{const{nutritional_info:Xe,unit:Ye}=Te.ingredients,{quantity:qe}=Te;console.log("nutritional_info:",Xe),console.log("quantity:",qe),console.log("unit:",Ye);let{calories:$e,protein:et,carbohydrate:Oe,fat:xt}=Xe;console.log("calories:",$e),console.log("protein (raw):",et),console.log("carbohydrate (raw):",Oe),console.log("fat (raw):",xt),et=typeof et=="string"?parseFloat(et.replace("g",""))||0:et||0,Oe=typeof Oe=="string"?parseFloat(Oe.replace("g",""))||0:Oe||0,xt=typeof xt=="string"?parseFloat(xt.replace("g",""))||0:xt||0,console.log("protein (parsed):",et),console.log("carbohydrate (parsed):",Oe),console.log("fat (parsed):",xt);const Dt=Ye.conversion_rate_to_grams;console.log("conversionRate:",Dt);let Ht=qe;if(Dt&&Dt>0)Ht*=Dt;else{console.warn(`Unit ${Ye.unit_tag} does not have a valid conversion rate.`);return}ve+=Ht;const at=Ht/100;re.calories+=$e*at,re.protein+=et*at,re.carbohydrate+=Oe*at,re.fat+=xt*at}),H(ve);const Fe={calories:(re.calories/(ve/100)).toFixed(2),protein:(re.protein/(ve/100)).toFixed(2),carbohydrate:(re.carbohydrate/(ve/100)).toFixed(2),fat:(re.fat/(ve/100)).toFixed(2)};console.log(`Total Weight of Recipe: ${ve.toFixed(2)}g`),console.log("Total Nutrition:",re),console.log("Per 100g Nutrition:",Fe),K({total:{calories:re.calories.toFixed(2),protein:re.protein.toFixed(2),carbohydrate:re.carbohydrate.toFixed(2),fat:re.fat.toFixed(2)},per100g:Fe})},L=()=>{if(b)G(p);else if(Z!==null){const P=window.confirm("Would you like to continue from your last step or start over?");y(P?Z:0)}else y(0);A(P=>!P)},D=()=>{if(p<I.length-1){const P=p+1;y(P),console.log(`Now on Step ${P+1}: ${I[P].instruction}`)}},j=()=>{if(p>0){const P=p-1;y(P),console.log(`Now on Step ${P+1}: ${I[P].instruction}`)}},ne=()=>{alert("Congratulations! You have finished cooking this recipe."),A(!1),G(null)},ie=()=>{navigator.clipboard.writeText(window.location.href),alert("Recipe link copied to clipboard!")};if(!s)return d.jsx("div",{children:"Recipe not found!"});const ae=()=>X(P=>P+1),Re=()=>{R>1&&X(P=>P-1)},de=()=>{const P=R/W;return console.log("Test ingredients:",c),c.map(re=>({...re,quantity:(re.quantity*P).toFixed(2)}))};if(m)return d.jsx("div",{children:"Loading recipe details..."});if(!s)return d.jsx("div",{children:"Recipe not found!"});const Q=async()=>{if(!x)return;const{planned_date:P,meal_type_id:re,recipe_id:ve}=x;if(window.confirm("Are you sure you want to cancel this scheduled recipe?"))try{const{error:Te}=await _.from("meal_plan").delete().eq("planned_date",P).eq("meal_type_id",re).eq("recipe_id",ve);if(Te){console.error("Error canceling schedule:",Te.message);return}alert("Schedule canceled successfully."),l(-1)}catch(Te){console.error("Unexpected error:",Te.message)}},O=i.reduce((P,re)=>(P[re.id]=re.name,P),{}),me=async()=>{try{const{error:P}=await _.from("meal_plan").insert([{user_id:r.id,recipe_id:S.recipe_id,planned_date:S.planned_date,meal_type_id:S.meal_type_id,notes:S.notes,time:S.time}]);if(P){console.error("Error adding meal:",P.message);return}alert("Meal successfully added!"),F(null)}catch(P){console.error("Unexpected error adding meal:",P.message)}},Ae=P=>{var ve;const re=((ve=i.find(Fe=>Fe.id===x.meal_type_id))==null?void 0:ve.default_time)||"12:00";E({notes:"",time:re,meal_type_id:(x==null?void 0:x.meal_type_id)||"",planned_date:(x==null?void 0:x.planned_date)||"",recipe_id:P}),F(!0)},De=async()=>{const P=await o(s.id);P.success&&k(re=>!re),alert(P.message)};return d.jsxs("div",{style:{padding:"20px"},children:[d.jsx(ba,{}),d.jsx("h1",{children:s.name}),d.jsx("button",{onClick:De,children:N?"Remove from Favorites":"Save to Favorites"}),d.jsx("button",{onClick:ie,children:"Share Recipe"}),x&&d.jsxs("div",{style:{marginBottom:"20px",padding:"10px",border:"1px solid #ccc",borderRadius:"5px"},children:[d.jsx("h2",{children:"Scheduled Meal Information"}),d.jsxs("p",{children:[d.jsx("strong",{children:"Planned Date:"})," ",new Date(x.planned_date).toLocaleDateString()]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Meal Type:"})," ",O[x.meal_type_id]||"Unknown"]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Recipe ID:"})," ",x.recipe_id]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Recipe Name:"})," ",x.recipe_name]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Activity Type:"})," ",x.activity_type]})]}),d.jsx("img",{src:`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${s.image_path}`,alt:s.name,style:{width:"300px",borderRadius:"10px",marginBottom:"20px"}}),d.jsx("p",{children:s.description}),d.jsxs("p",{children:["Prep Time: ",s.prep_time," mins"]}),d.jsxs("p",{children:["Cook Time: ",s.cook_time," mins"]}),d.jsxs("div",{children:[d.jsx("h4",{children:"Total Meal Weight"}),d.jsxs("p",{children:[(M*(R/W)).toFixed(2)," g"]})]}),d.jsx("h3",{children:"Nutrition Facts"}),d.jsxs("div",{children:[d.jsx("h4",{children:"Total Nutrition (for the entire recipe)"}),d.jsxs("ul",{children:[d.jsxs("li",{children:["Calories: ",((ke=Y.total)==null?void 0:ke.calories)||0," kcal"]}),d.jsxs("li",{children:["Protein: ",((xe=Y.total)==null?void 0:xe.protein)||0," g"]}),d.jsxs("li",{children:["Carbohydrate: ",((Ee=Y.total)==null?void 0:Ee.carbohydrate)||0," g"]}),d.jsxs("li",{children:["Fats: ",((We=Y.total)==null?void 0:We.fat)||0," g"]})]})]}),d.jsxs("div",{children:[d.jsx("h4",{children:"Per 100g Nutrition"}),d.jsxs("ul",{children:[d.jsxs("li",{children:["Calories: ",((ze=Y.per100g)==null?void 0:ze.calories)||0," kcal"]}),d.jsxs("li",{children:["Protein: ",((Ge=Y.per100g)==null?void 0:Ge.protein)||0," g"]}),d.jsxs("li",{children:["Carbohydrate: ",((it=Y.per100g)==null?void 0:it.carbohydrate)||0," g"]}),d.jsxs("li",{children:["Fats: ",((Pe=Y.per100g)==null?void 0:Pe.fat)||0," g"]})]})]}),d.jsx("p",{children:"Note: Future versions will link to the database and calculate these values dynamically."}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("button",{onClick:Re,style:{padding:"5px 10px",border:"1px solid #ccc",background:"#f5f5f5",cursor:"pointer"},children:"-"}),d.jsx("span",{style:{fontSize:"18px",fontWeight:"bold"},children:R}),d.jsx("button",{onClick:ae,style:{padding:"5px 10px",border:"1px solid #ccc",background:"#f5f5f5",cursor:"pointer"},children:"+"})]}),d.jsx("h3",{children:"Ingredients"}),d.jsx("ul",{children:de().map(P=>{var re;return d.jsxs("li",{children:[P.ingredients.name," - ",P.quantity," ",((re=P.ingredients.unit)==null?void 0:re.unit_tag)||""]},P.ingredients.id)})}),d.jsx("h3",{children:"Steps"}),d.jsx("ul",{children:I.map(P=>d.jsxs("li",{children:[d.jsxs("strong",{children:["Step ",P.step_number,":"]})," ",P.instruction]},P.step_number))}),b&&d.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.8)",color:"#fff",zIndex:1e3,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[d.jsxs("h2",{children:["Step ",p+1]}),d.jsx("p",{children:(U=I[p])==null?void 0:U.instruction}),d.jsxs("div",{style:{marginTop:"20px",display:"flex",gap:"10px"},children:[d.jsx("button",{onClick:j,style:{padding:"10px 20px",background:"#007bff",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",visibility:p===0?"hidden":"visible"},children:"Previous"}),d.jsx("button",{onClick:D,style:{padding:"10px 20px",background:"#007bff",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",visibility:p===I.length-1?"hidden":"visible"},children:"Next"}),p===I.length-1&&d.jsx("button",{onClick:ne,style:{padding:"10px 20px",background:"green",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Finish Cooking"}),d.jsx("button",{onClick:L,style:{padding:"10px 20px",background:"red",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Exit Cooking Mode"})]})]}),x?d.jsxs(d.Fragment,{children:[(x==null?void 0:x.activity_type)==="view"?d.jsxs("button",{onClick:Q,style:{padding:"12px 20px",background:"#ff4d4d",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",marginTop:"20px",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",transition:"background 0.3s ease"},onMouseEnter:P=>P.target.style.background="#e63939",onMouseLeave:P=>P.target.style.background="#ff4d4d",children:[d.jsx("span",{style:{fontSize:"20px",fontWeight:"bold"},children:"✖"}),"Cancel Schedule for"," ",new Date(x.planned_date).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})," ","(",O[x.meal_type_id]||"Unknown",")"]}):d.jsx("button",{onClick:P=>{P.stopPropagation(),Ae(s.id)},style:{padding:"10px",background:"#28a745",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",marginTop:"10px",zIndex:1e3},children:"Add to Meal"}),d.jsx("button",{onClick:()=>l("/recipes/calendar",{state:{recipeId:a,recipeName:s.name}}),style:{padding:"10px 20px",background:"orange",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",marginTop:"20px"},children:"Reschedule Another Meal"})]}):d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:L,style:{padding:"10px 20px",background:"#007bff",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",marginTop:"20px"},children:"Start Cooking Mode"}),d.jsx("button",{onClick:()=>l("/recipes/calendar",{state:{recipeId:a,recipeName:s.name}}),style:{padding:"10px 20px",background:"orange",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",marginTop:"20px"},children:"Reschedule"})]}),d.jsx("h3",{children:"Related Recipes"}),d.jsx("ul",{children:v.map(P=>d.jsxs("li",{onClick:()=>l(`/recipes/recipe/${P.id}`),children:[d.jsx("img",{src:`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${P.image_path}`,alt:P.name,style:{width:"100px",borderRadius:"10px"}}),P.name]},P.id))}),J&&d.jsx("div",{className:"modal",children:d.jsxs("div",{className:"modal-content",children:[d.jsx("h2",{children:"Add a Meal"}),d.jsxs("p",{children:[d.jsx("strong",{children:"Meal Type:"})," ",((oe=i.find(P=>P.id===S.meal_type_id))==null?void 0:oe.name)||"Unknown"]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Planned Date:"})," ",S.planned_date]}),d.jsxs("label",{children:["Notes:",d.jsx("textarea",{value:S.notes,placeholder:"Enter additional notes (e.g., extra ingredients, instructions)",onChange:P=>E(re=>({...re,notes:P.target.value})),rows:"3"})]}),d.jsxs("label",{children:["Time:",d.jsx("input",{type:"time",value:S.time,onChange:P=>E(re=>({...re,time:P.target.value}))})]}),d.jsx("button",{onClick:me,style:{marginRight:"10px"},children:"Save"}),d.jsx("button",{onClick:()=>F(null),children:"Cancel"})]})})]})};function lJ(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=lJ(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function fm(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=lJ(e))&&(i&&(i+=" "),i+=t);return i}const Qq=(e,t,n,i)=>{if(n==="length"||n==="prototype"||n==="arguments"||n==="caller")return;const r=Object.getOwnPropertyDescriptor(e,n),o=Object.getOwnPropertyDescriptor(t,n);!Pq(r,o)&&i||Object.defineProperty(e,n,o)},Pq=function(e,t){return e===void 0||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},_q=(e,t)=>{const n=Object.getPrototypeOf(t);n!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,n)},Oq=(e,t)=>`/* Wrapped ${e}*/
${t}`,qq=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),$q=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),e$=(e,t,n)=>{const i=n===""?"":`with ${n.trim()}() `,r=Oq.bind(null,i,t.toString());Object.defineProperty(r,"name",$q),Object.defineProperty(e,"toString",{...qq,value:r})},t$=(e,t,{ignoreNonConfigurable:n=!1}={})=>{const{name:i}=e;for(const r of Reflect.ownKeys(t))Qq(e,t,r,n);return _q(e,t),e$(e,t,i),e};var n$=t$,Kb={exports:{}},i$=()=>{const e={};return e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),e};(function(e,t){var n=xn&&xn.__awaiter||function(a,l,s,g){return new(s||(s=Promise))(function(c,u){function I(f){try{m(g.next(f))}catch(b){u(b)}}function C(f){try{m(g.throw(f))}catch(b){u(b)}}function m(f){f.done?c(f.value):new s(function(b){b(f.value)}).then(I,C)}m((g=g.apply(a,l||[])).next())})},i=xn&&xn.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(i$);function o(a,l="maxAge"){let s,g,c;const u=()=>n(this,void 0,void 0,function*(){if(s!==void 0)return;const m=f=>n(this,void 0,void 0,function*(){c=r.default();const b=f[1][l]-Date.now();if(b<=0){a.delete(f[0]),c.resolve();return}return s=f[0],g=setTimeout(()=>{a.delete(f[0]),c&&c.resolve()},b),typeof g.unref=="function"&&g.unref(),c.promise});try{for(const f of a)yield m(f)}catch{}s=void 0}),I=()=>{s=void 0,g!==void 0&&(clearTimeout(g),g=void 0),c!==void 0&&(c.reject(void 0),c=void 0)},C=a.set.bind(a);return a.set=(m,f)=>{a.has(m)&&a.delete(m);const b=C(m,f);return s&&s===m&&I(),u(),b},u(),a}t.default=o,e.exports=o,e.exports.default=o})(Kb,Kb.exports);var r$=Kb.exports;const o$=n$,a$=r$,nf=new WeakMap,sJ=new WeakMap,KC=(e,{cacheKey:t,cache:n=new Map,maxAge:i}={})=>{typeof i=="number"&&a$(n);const r=function(...o){const a=t?t(o):o[0],l=n.get(a);if(l)return l.data;const s=e.apply(this,o);return n.set(a,{data:s,maxAge:i?Date.now()+i:Number.POSITIVE_INFINITY}),s};return o$(r,e,{ignoreNonConfigurable:!0}),sJ.set(r,n),r};KC.decorator=(e={})=>(t,n,i)=>{const r=t[n];if(typeof r!="function")throw new TypeError("The decorated value must be a function");delete i.value,delete i.writable,i.get=function(){if(!nf.has(this)){const o=KC(r,e);return nf.set(this,o),o}return nf.get(this)}};KC.clear=e=>{const t=sJ.get(e);if(!t)throw new TypeError("Can't clear a function that was not memoized!");if(typeof t.clear!="function")throw new TypeError("The cache Map can't be cleared!");t.clear()};var l$=KC;const gJ=Es(l$);function s$(e){return typeof e=="string"}function g$(e,t,n){return n.indexOf(e)===t}function c$(e){return e.toLowerCase()===e}function $R(e){return e.indexOf(",")===-1?e:e.split(",")}function Eb(e){if(!e)return e;if(e==="C"||e==="posix"||e==="POSIX")return"en-US";if(e.indexOf(".")!==-1){var t=e.split(".")[0],n=t===void 0?"":t;return Eb(n)}if(e.indexOf("@")!==-1){var i=e.split("@")[0],n=i===void 0?"":i;return Eb(n)}if(e.indexOf("-")===-1||!c$(e))return e;var r=e.split("-"),o=r[0],a=r[1],l=a===void 0?"":a;return"".concat(o,"-").concat(l.toUpperCase())}function u$(e){var t=e===void 0?{}:e,n=t.useFallbackLocale,i=n===void 0?!0:n,r=t.fallbackLocale,o=r===void 0?"en-US":r,a=[];if(typeof navigator<"u"){for(var l=navigator.languages||[],s=[],g=0,c=l;g<c.length;g++){var u=c[g];s=s.concat($R(u))}var I=navigator.language,C=I&&$R(I);a=a.concat(s,C)}return i&&a.push(o),a.filter(s$).map(Eb).filter(g$)}var I$=gJ(u$,{cacheKey:JSON.stringify});function d$(e){return I$(e)[0]||null}var cJ=gJ(d$,{cacheKey:JSON.stringify});function Io(e,t,n){return function(r,o){o===void 0&&(o=n);var a=e(r)+o;return t(a)}}function Ku(e){return function(n){return new Date(e(n).getTime()-1)}}function Eu(e,t){return function(i){return[e(i),t(i)]}}function rn(e){if(e instanceof Date)return e.getFullYear();if(typeof e=="number")return e;var t=parseInt(e,10);if(typeof e=="string"&&!isNaN(t))return t;throw new Error("Failed to get year from date: ".concat(e,"."))}function ya(e){if(e instanceof Date)return e.getMonth();throw new Error("Failed to get month from date: ".concat(e,"."))}function pm(e){if(e instanceof Date)return e.getDate();throw new Error("Failed to get year from date: ".concat(e,"."))}function og(e){var t=rn(e),n=t+(-t+1)%100,i=new Date;return i.setFullYear(n,0,1),i.setHours(0,0,0,0),i}var C$=Io(rn,og,-100),uJ=Io(rn,og,100),vZ=Ku(uJ),h$=Io(rn,vZ,-100),IJ=Eu(og,vZ);function Za(e){var t=rn(e),n=t+(-t+1)%10,i=new Date;return i.setFullYear(n,0,1),i.setHours(0,0,0,0),i}var dJ=Io(rn,Za,-10),GZ=Io(rn,Za,10),bm=Ku(GZ),CJ=Io(rn,bm,-10),hJ=Eu(Za,bm);function ag(e){var t=rn(e),n=new Date;return n.setFullYear(t,0,1),n.setHours(0,0,0,0),n}var mJ=Io(rn,ag,-1),SZ=Io(rn,ag,1),ym=Ku(SZ),AJ=Io(rn,ym,-1),m$=Eu(ag,ym);function BZ(e,t){return function(i,r){r===void 0&&(r=t);var o=rn(i),a=ya(i)+r,l=new Date;return l.setFullYear(o,a,1),l.setHours(0,0,0,0),e(l)}}function Zl(e){var t=rn(e),n=ya(e),i=new Date;return i.setFullYear(t,n,1),i.setHours(0,0,0,0),i}var fJ=BZ(Zl,-1),RZ=BZ(Zl,1),Mu=Ku(RZ),pJ=BZ(Mu,-1),A$=Eu(Zl,Mu);function f$(e,t){return function(i,r){r===void 0&&(r=t);var o=rn(i),a=ya(i),l=pm(i)+r,s=new Date;return s.setFullYear(o,a,l),s.setHours(0,0,0,0),e(s)}}function zu(e){var t=rn(e),n=ya(e),i=pm(e),r=new Date;return r.setFullYear(t,n,i),r.setHours(0,0,0,0),r}var p$=f$(zu,1),WZ=Ku(p$),b$=Eu(zu,WZ);function bJ(e){return pm(Mu(e))}var En={GREGORY:"gregory",HEBREW:"hebrew",ISLAMIC:"islamic",ISO_8601:"iso8601"},y$={gregory:["en-CA","en-US","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-SV","es-VE","pt-BR"],hebrew:["he","he-IL"],islamic:["ar","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LY","ar-OM","ar-QA","ar-SA","ar-SD","ar-SY","ar-YE","dv","dv-MV","ps","ps-AR"]},kZ=[0,1,2,3,4,5,6],rf=new Map;function Z$(e){return function(n,i){var r=n||cJ();rf.has(r)||rf.set(r,new Map);var o=rf.get(r);return o.has(e)||o.set(e,new Intl.DateTimeFormat(r||void 0,e).format),o.get(e)(i)}}function v$(e){var t=new Date(e);return new Date(t.setHours(12))}function vl(e){return function(t,n){return Z$(e)(t,v$(n))}}var G$={day:"numeric"},S$={day:"numeric",month:"long",year:"numeric"},B$={month:"long"},R$={month:"long",year:"numeric"},W$={weekday:"short"},k$={weekday:"long"},V$={year:"numeric"},w$=vl(G$),x$=vl(S$),X$=vl(B$),yJ=vl(R$),J$=vl(W$),Y$=vl(k$),Zm=vl(V$),N$=kZ[0],H$=kZ[5],eW=kZ[6];function du(e,t){t===void 0&&(t=En.ISO_8601);var n=e.getDay();switch(t){case En.ISO_8601:return(n+6)%7;case En.ISLAMIC:return(n+1)%7;case En.HEBREW:case En.GREGORY:return n;default:throw new Error("Unsupported calendar type.")}}function F$(e){var t=og(e);return rn(t)}function K$(e){var t=Za(e);return rn(t)}function Mb(e,t){t===void 0&&(t=En.ISO_8601);var n=rn(e),i=ya(e),r=e.getDate()-du(e,t);return new Date(n,i,r)}function E$(e,t){t===void 0&&(t=En.ISO_8601);var n=t===En.GREGORY?En.GREGORY:En.ISO_8601,i=Mb(e,t),r=rn(e)+1,o,a;do o=new Date(r,0,n===En.ISO_8601?4:1),a=Mb(o,t),r-=1;while(e<a);return Math.round((i.getTime()-a.getTime())/(864e5*7))+1}function el(e,t){switch(e){case"century":return og(t);case"decade":return Za(t);case"year":return ag(t);case"month":return Zl(t);case"day":return zu(t);default:throw new Error("Invalid rangeType: ".concat(e))}}function M$(e,t){switch(e){case"century":return C$(t);case"decade":return dJ(t);case"year":return mJ(t);case"month":return fJ(t);default:throw new Error("Invalid rangeType: ".concat(e))}}function ZJ(e,t){switch(e){case"century":return uJ(t);case"decade":return GZ(t);case"year":return SZ(t);case"month":return RZ(t);default:throw new Error("Invalid rangeType: ".concat(e))}}function z$(e,t){switch(e){case"decade":return dJ(t,-100);case"year":return mJ(t,-10);case"month":return fJ(t,-12);default:throw new Error("Invalid rangeType: ".concat(e))}}function L$(e,t){switch(e){case"decade":return GZ(t,100);case"year":return SZ(t,10);case"month":return RZ(t,12);default:throw new Error("Invalid rangeType: ".concat(e))}}function vJ(e,t){switch(e){case"century":return vZ(t);case"decade":return bm(t);case"year":return ym(t);case"month":return Mu(t);case"day":return WZ(t);default:throw new Error("Invalid rangeType: ".concat(e))}}function D$(e,t){switch(e){case"century":return h$(t);case"decade":return CJ(t);case"year":return AJ(t);case"month":return pJ(t);default:throw new Error("Invalid rangeType: ".concat(e))}}function T$(e,t){switch(e){case"decade":return CJ(t,-100);case"year":return AJ(t,-10);case"month":return pJ(t,-12);default:throw new Error("Invalid rangeType: ".concat(e))}}function tW(e,t){switch(e){case"century":return IJ(t);case"decade":return hJ(t);case"year":return m$(t);case"month":return A$(t);case"day":return b$(t);default:throw new Error("Invalid rangeType: ".concat(e))}}function j$(e,t,n){var i=[t,n].sort(function(r,o){return r.getTime()-o.getTime()});return[el(e,i[0]),vJ(e,i[1])]}function GJ(e,t,n){return n.map(function(i){return(t||Zm)(e,i)}).join(" – ")}function U$(e,t,n){return GJ(e,t,IJ(n))}function SJ(e,t,n){return GJ(e,t,hJ(n))}function Q$(e){return e.getDay()===new Date().getDay()}function BJ(e,t){t===void 0&&(t=En.ISO_8601);var n=e.getDay();switch(t){case En.ISLAMIC:case En.HEBREW:return n===H$||n===eW;case En.ISO_8601:case En.GREGORY:return n===eW||n===N$;default:throw new Error("Unsupported calendar type.")}}var Wr="react-calendar__navigation";function P$(e){var t=e.activeStartDate,n=e.drillUp,i=e.formatMonthYear,r=i===void 0?yJ:i,o=e.formatYear,a=o===void 0?Zm:o,l=e.locale,s=e.maxDate,g=e.minDate,c=e.navigationAriaLabel,u=c===void 0?"":c,I=e.navigationAriaLive,C=e.navigationLabel,m=e.next2AriaLabel,f=m===void 0?"":m,b=e.next2Label,A=b===void 0?"»":b,p=e.nextAriaLabel,y=p===void 0?"":p,Z=e.nextLabel,G=Z===void 0?"›":Z,v=e.prev2AriaLabel,B=v===void 0?"":v,R=e.prev2Label,X=R===void 0?"«":R,W=e.prevAriaLabel,V=W===void 0?"":W,Y=e.prevLabel,K=Y===void 0?"‹":Y,M=e.setActiveStartDate,H=e.showDoubleView,w=e.view,x=e.views,J=x.indexOf(w)>0,F=w!=="century",S=M$(w,t),E=F?z$(w,t):void 0,N=ZJ(w,t),k=F?L$(w,t):void 0,z=function(){if(S.getFullYear()<0)return!0;var O=D$(w,t);return g&&g>=O}(),L=F&&function(){if(E.getFullYear()<0)return!0;var O=T$(w,t);return g&&g>=O}(),D=s&&s<N,j=F&&s&&s<k;function ne(){M(S,"prev")}function ie(){M(E,"prev2")}function ae(){M(N,"next")}function Re(){M(k,"next2")}function de(O){var me=function(){switch(w){case"century":return U$(l,a,O);case"decade":return SJ(l,a,O);case"year":return a(l,O);case"month":return r(l,O);default:throw new Error("Invalid view: ".concat(w,"."))}}();return C?C({date:O,label:me,locale:l||cJ()||void 0,view:w}):me}function Q(){var O="".concat(Wr,"__label");return d.jsxs("button",{"aria-label":u,"aria-live":I,className:O,disabled:!J,onClick:n,style:{flexGrow:1},type:"button",children:[d.jsx("span",{className:"".concat(O,"__labelText ").concat(O,"__labelText--from"),children:de(t)}),H?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"".concat(O,"__divider"),children:" – "}),d.jsx("span",{className:"".concat(O,"__labelText ").concat(O,"__labelText--to"),children:de(N)})]}):null]})}return d.jsxs("div",{className:Wr,children:[X!==null&&F?d.jsx("button",{"aria-label":B,className:"".concat(Wr,"__arrow ").concat(Wr,"__prev2-button"),disabled:L,onClick:ie,type:"button",children:X}):null,K!==null&&d.jsx("button",{"aria-label":V,className:"".concat(Wr,"__arrow ").concat(Wr,"__prev-button"),disabled:z,onClick:ne,type:"button",children:K}),Q(),G!==null&&d.jsx("button",{"aria-label":y,className:"".concat(Wr,"__arrow ").concat(Wr,"__next-button"),disabled:D,onClick:ae,type:"button",children:G}),A!==null&&F?d.jsx("button",{"aria-label":f,className:"".concat(Wr,"__arrow ").concat(Wr,"__next2-button"),disabled:j,onClick:Re,type:"button",children:A}):null]})}var as=function(){return as=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},as.apply(this,arguments)},_$=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function nW(e){return"".concat(e,"%")}function VZ(e){var t=e.children,n=e.className,i=e.count,r=e.direction,o=e.offset,a=e.style,l=e.wrap,s=_$(e,["children","className","count","direction","offset","style","wrap"]);return d.jsx("div",as({className:n,style:as({display:"flex",flexDirection:r,flexWrap:l?"wrap":"nowrap"},a)},s,{children:h.Children.map(t,function(g,c){var u=o&&c===0?nW(100*o/i):null;return h.cloneElement(g,as(as({},g.props),{style:{flexBasis:nW(100/i),flexShrink:0,flexGrow:0,overflow:"hidden",marginLeft:u,marginInlineStart:u,marginInlineEnd:0}}))})}))}function O$(e,t,n){return t&&t>e?t:n&&n<e?n:e}function Cu(e,t){return t[0]<=e&&t[1]>=e}function q$(e,t){return e[0]<=t[0]&&e[1]>=t[1]}function RJ(e,t){return Cu(e[0],t)||Cu(e[1],t)}function iW(e,t,n){var i=RJ(t,e),r=[];if(i){r.push(n);var o=Cu(e[0],t),a=Cu(e[1],t);o&&r.push("".concat(n,"Start")),a&&r.push("".concat(n,"End")),o&&a&&r.push("".concat(n,"BothEnds"))}return r}function $$(e){return Array.isArray(e)?e[0]!==null&&e[1]!==null:e!==null}function e6(e){if(!e)throw new Error("args is required");var t=e.value,n=e.date,i=e.hover,r="react-calendar__tile",o=[r];if(!n)return o;var a=new Date,l=function(){if(Array.isArray(n))return n;var C=e.dateType;if(!C)throw new Error("dateType is required when date is not an array of two dates");return tW(C,n)}();if(Cu(a,l)&&o.push("".concat(r,"--now")),!t||!$$(t))return o;var s=function(){if(Array.isArray(t))return t;var C=e.valueType;if(!C)throw new Error("valueType is required when value is not an array of two dates");return tW(C,t)}();q$(s,l)?o.push("".concat(r,"--active")):RJ(s,l)&&o.push("".concat(r,"--hasActive"));var g=iW(s,l,"".concat(r,"--range"));o.push.apply(o,g);var c=Array.isArray(t)?t:[t];if(i&&c.length===1){var u=i>s[0]?[s[0],i]:[i,s[0]],I=iW(u,l,"".concat(r,"--hover"));o.push.apply(o,I)}return o}function vm(e){for(var t=e.className,n=e.count,i=n===void 0?3:n,r=e.dateTransform,o=e.dateType,a=e.end,l=e.hover,s=e.offset,g=e.renderTile,c=e.start,u=e.step,I=u===void 0?1:u,C=e.value,m=e.valueType,f=[],b=c;b<=a;b+=I){var A=r(b);f.push(g({classes:e6({date:A,dateType:o,hover:l,value:C,valueType:m}),date:A}))}return d.jsx(VZ,{className:t,count:i,offset:s,wrap:!0,children:f})}function Gm(e){var t=e.activeStartDate,n=e.children,i=e.classes,r=e.date,o=e.formatAbbr,a=e.locale,l=e.maxDate,s=e.maxDateTransform,g=e.minDate,c=e.minDateTransform,u=e.onClick,I=e.onMouseOver,C=e.style,m=e.tileClassName,f=e.tileContent,b=e.tileDisabled,A=e.view,p=h.useMemo(function(){var Z={activeStartDate:t,date:r,view:A};return typeof m=="function"?m(Z):m},[t,r,m,A]),y=h.useMemo(function(){var Z={activeStartDate:t,date:r,view:A};return typeof f=="function"?f(Z):f},[t,r,f,A]);return d.jsxs("button",{className:fm(i,p),disabled:g&&c(g)>r||l&&s(l)<r||(b==null?void 0:b({activeStartDate:t,date:r,view:A})),onClick:u?function(Z){return u(r,Z)}:void 0,onFocus:I?function(){return I(r)}:void 0,onMouseOver:I?function(){return I(r)}:void 0,style:C,type:"button",children:[o?d.jsx("abbr",{"aria-label":o(a,r),children:n}):n,y]})}var zb=function(){return zb=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},zb.apply(this,arguments)},t6=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n},rW="react-calendar__century-view__decades__decade";function n6(e){var t=e.classes,n=t===void 0?[]:t,i=e.currentCentury,r=e.formatYear,o=r===void 0?Zm:r,a=t6(e,["classes","currentCentury","formatYear"]),l=a.date,s=a.locale,g=[];return n&&g.push.apply(g,n),g.push(rW),og(l).getFullYear()!==i&&g.push("".concat(rW,"--neighboringCentury")),d.jsx(Gm,zb({},a,{classes:g,maxDateTransform:bm,minDateTransform:Za,view:"century",children:SJ(s,o,l)}))}var Lb=function(){return Lb=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Lb.apply(this,arguments)},oW=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function i6(e){var t=e.activeStartDate,n=e.hover,i=e.showNeighboringCentury,r=e.value,o=e.valueType,a=oW(e,["activeStartDate","hover","showNeighboringCentury","value","valueType"]),l=F$(t),s=l+(i?119:99);return d.jsx(vm,{className:"react-calendar__century-view__decades",dateTransform:Za,dateType:"decade",end:s,hover:n,renderTile:function(g){var c=g.date,u=oW(g,["date"]);return d.jsx(n6,Lb({},a,u,{activeStartDate:t,currentCentury:l,date:c}),c.getTime())},start:l,step:10,value:r,valueType:o})}var Db=function(){return Db=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Db.apply(this,arguments)};function r6(e){function t(){return d.jsx(i6,Db({},e))}return d.jsx("div",{className:"react-calendar__century-view",children:t()})}var Tb=function(){return Tb=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Tb.apply(this,arguments)},o6=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n},aW="react-calendar__decade-view__years__year";function a6(e){var t=e.classes,n=t===void 0?[]:t,i=e.currentDecade,r=e.formatYear,o=r===void 0?Zm:r,a=o6(e,["classes","currentDecade","formatYear"]),l=a.date,s=a.locale,g=[];return n&&g.push.apply(g,n),g.push(aW),Za(l).getFullYear()!==i&&g.push("".concat(aW,"--neighboringDecade")),d.jsx(Gm,Tb({},a,{classes:g,maxDateTransform:ym,minDateTransform:ag,view:"decade",children:o(s,l)}))}var jb=function(){return jb=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},jb.apply(this,arguments)},lW=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function l6(e){var t=e.activeStartDate,n=e.hover,i=e.showNeighboringDecade,r=e.value,o=e.valueType,a=lW(e,["activeStartDate","hover","showNeighboringDecade","value","valueType"]),l=K$(t),s=l+(i?11:9);return d.jsx(vm,{className:"react-calendar__decade-view__years",dateTransform:ag,dateType:"year",end:s,hover:n,renderTile:function(g){var c=g.date,u=lW(g,["date"]);return d.jsx(a6,jb({},a,u,{activeStartDate:t,currentDecade:l,date:c}),c.getTime())},start:l,value:r,valueType:o})}var Ub=function(){return Ub=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Ub.apply(this,arguments)};function s6(e){function t(){return d.jsx(l6,Ub({},e))}return d.jsx("div",{className:"react-calendar__decade-view",children:t()})}var Qb=function(){return Qb=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Qb.apply(this,arguments)},g6=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n},sW=function(e,t,n){if(n||arguments.length===2)for(var i=0,r=t.length,o;i<r;i++)(o||!(i in t))&&(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},c6="react-calendar__year-view__months__month";function u6(e){var t=e.classes,n=t===void 0?[]:t,i=e.formatMonth,r=i===void 0?X$:i,o=e.formatMonthYear,a=o===void 0?yJ:o,l=g6(e,["classes","formatMonth","formatMonthYear"]),s=l.date,g=l.locale;return d.jsx(Gm,Qb({},l,{classes:sW(sW([],n,!0),[c6],!1),formatAbbr:a,maxDateTransform:Mu,minDateTransform:Zl,view:"year",children:r(g,s)}))}var Pb=function(){return Pb=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Pb.apply(this,arguments)},gW=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function I6(e){var t=e.activeStartDate,n=e.hover,i=e.value,r=e.valueType,o=gW(e,["activeStartDate","hover","value","valueType"]),a=0,l=11,s=rn(t);return d.jsx(vm,{className:"react-calendar__year-view__months",dateTransform:function(g){var c=new Date;return c.setFullYear(s,g,1),Zl(c)},dateType:"month",end:l,hover:n,renderTile:function(g){var c=g.date,u=gW(g,["date"]);return d.jsx(u6,Pb({},o,u,{activeStartDate:t,date:c}),c.getTime())},start:a,value:i,valueType:r})}var _b=function(){return _b=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},_b.apply(this,arguments)};function d6(e){function t(){return d.jsx(I6,_b({},e))}return d.jsx("div",{className:"react-calendar__year-view",children:t()})}var Ob=function(){return Ob=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Ob.apply(this,arguments)},C6=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n},of="react-calendar__month-view__days__day";function h6(e){var t=e.calendarType,n=e.classes,i=n===void 0?[]:n,r=e.currentMonthIndex,o=e.formatDay,a=o===void 0?w$:o,l=e.formatLongDate,s=l===void 0?x$:l,g=C6(e,["calendarType","classes","currentMonthIndex","formatDay","formatLongDate"]),c=g.date,u=g.locale,I=[];return i&&I.push.apply(I,i),I.push(of),BJ(c,t)&&I.push("".concat(of,"--weekend")),c.getMonth()!==r&&I.push("".concat(of,"--neighboringMonth")),d.jsx(Gm,Ob({},g,{classes:I,formatAbbr:s,maxDateTransform:WZ,minDateTransform:zu,view:"month",children:a(u,c)}))}var qb=function(){return qb=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},qb.apply(this,arguments)},cW=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function m6(e){var t=e.activeStartDate,n=e.calendarType,i=e.hover,r=e.showFixedNumberOfWeeks,o=e.showNeighboringMonth,a=e.value,l=e.valueType,s=cW(e,["activeStartDate","calendarType","hover","showFixedNumberOfWeeks","showNeighboringMonth","value","valueType"]),g=rn(t),c=ya(t),u=r||o,I=du(t,n),C=u?0:I,m=(u?-I:0)+1,f=function(){if(r)return m+6*7-1;var b=bJ(t);if(o){var A=new Date;A.setFullYear(g,c,b),A.setHours(0,0,0,0);var p=7-du(A,n)-1;return b+p}return b}();return d.jsx(vm,{className:"react-calendar__month-view__days",count:7,dateTransform:function(b){var A=new Date;return A.setFullYear(g,c,b),zu(A)},dateType:"day",hover:i,end:f,renderTile:function(b){var A=b.date,p=cW(b,["date"]);return d.jsx(h6,qb({},s,p,{activeStartDate:t,calendarType:n,currentMonthIndex:c,date:A}),A.getTime())},offset:C,start:m,value:a,valueType:l})}var WJ="react-calendar__month-view__weekdays",af="".concat(WJ,"__weekday");function A6(e){for(var t=e.calendarType,n=e.formatShortWeekday,i=n===void 0?J$:n,r=e.formatWeekday,o=r===void 0?Y$:r,a=e.locale,l=e.onMouseLeave,s=new Date,g=Zl(s),c=rn(g),u=ya(g),I=[],C=1;C<=7;C+=1){var m=new Date(c,u,C-du(g,t)),f=o(a,m);I.push(d.jsx("div",{className:fm(af,Q$(m)&&"".concat(af,"--current"),BJ(m,t)&&"".concat(af,"--weekend")),children:d.jsx("abbr",{"aria-label":f,title:f,children:i(a,m).replace(".","")})},C))}return d.jsx(VZ,{className:WJ,count:7,onFocus:l,onMouseOver:l,children:I})}var EC=function(){return EC=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},EC.apply(this,arguments)},uW=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n},IW="react-calendar__tile";function f6(e){var t=e.onClickWeekNumber,n=e.weekNumber,i=d.jsx("span",{children:n});if(t){var r=e.date,o=e.onClickWeekNumber,a=e.weekNumber,l=uW(e,["date","onClickWeekNumber","weekNumber"]);return d.jsx("button",EC({},l,{className:IW,onClick:function(s){return o(a,r,s)},type:"button",children:i}))}else{e.date,e.onClickWeekNumber,e.weekNumber;var l=uW(e,["date","onClickWeekNumber","weekNumber"]);return d.jsx("div",EC({},l,{className:IW,children:i}))}}function p6(e){var t=e.activeStartDate,n=e.calendarType,i=e.onClickWeekNumber,r=e.onMouseLeave,o=e.showFixedNumberOfWeeks,a=function(){if(o)return 6;var g=bJ(t),c=du(t,n),u=g-(7-c);return 1+Math.ceil(u/7)}(),l=function(){for(var g=rn(t),c=ya(t),u=pm(t),I=[],C=0;C<a;C+=1)I.push(Mb(new Date(g,c,u+C*7),n));return I}(),s=l.map(function(g){return E$(g,n)});return d.jsx(VZ,{className:"react-calendar__month-view__weekNumbers",count:a,direction:"column",onFocus:r,onMouseOver:r,style:{flexBasis:"calc(100% * (1 / 8)",flexShrink:0},children:s.map(function(g,c){var u=l[c];if(!u)throw new Error("date is not defined");return d.jsx(f6,{date:u,onClickWeekNumber:i,weekNumber:g},g)})})}var $b=function(){return $b=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},$b.apply(this,arguments)},b6=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function y6(e){if(e)for(var t=0,n=Object.entries(y$);t<n.length;t++){var i=n[t],r=i[0],o=i[1];if(o.includes(e))return r}return En.ISO_8601}function Z6(e){var t=e.activeStartDate,n=e.locale,i=e.onMouseLeave,r=e.showFixedNumberOfWeeks,o=e.calendarType,a=o===void 0?y6(n):o,l=e.formatShortWeekday,s=e.formatWeekday,g=e.onClickWeekNumber,c=e.showWeekNumbers,u=b6(e,["calendarType","formatShortWeekday","formatWeekday","onClickWeekNumber","showWeekNumbers"]);function I(){return d.jsx(A6,{calendarType:a,formatShortWeekday:l,formatWeekday:s,locale:n,onMouseLeave:i})}function C(){return c?d.jsx(p6,{activeStartDate:t,calendarType:a,onClickWeekNumber:g,onMouseLeave:i,showFixedNumberOfWeeks:r}):null}function m(){return d.jsx(m6,$b({calendarType:a},u))}var f="react-calendar__month-view";return d.jsx("div",{className:fm(f,c?"".concat(f,"--weekNumbers"):""),children:d.jsxs("div",{style:{display:"flex",alignItems:"flex-end"},children:[C(),d.jsxs("div",{style:{flexGrow:1,width:"100%"},children:[I(),m()]})]})})}var ls=function(){return ls=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},ls.apply(this,arguments)},jI="react-calendar",Nd=["century","decade","year","month"],v6=["decade","year","month","day"],wZ=new Date;wZ.setFullYear(1,0,1);wZ.setHours(0,0,0,0);var G6=new Date(864e13);function tc(e){return e instanceof Date?e:new Date(e)}function kJ(e,t){return Nd.slice(Nd.indexOf(e),Nd.indexOf(t)+1)}function S6(e,t,n){var i=kJ(t,n);return i.indexOf(e)!==-1}function xZ(e,t,n){return e&&S6(e,t,n)?e:n}function VJ(e){var t=Nd.indexOf(e);return v6[t]}function B6(e,t){var n=Array.isArray(e)?e[t]:e;if(!n)return null;var i=tc(n);if(Number.isNaN(i.getTime()))throw new Error("Invalid date: ".concat(e));return i}function wJ(e,t){var n=e.value,i=e.minDate,r=e.maxDate,o=e.maxDetail,a=B6(n,t);if(!a)return null;var l=VJ(o),s=function(){switch(t){case 0:return el(l,a);case 1:return vJ(l,a);default:throw new Error("Invalid index value: ".concat(t))}}();return O$(s,i,r)}var XZ=function(e){return wJ(e,0)},xJ=function(e){return wJ(e,1)},R6=function(e){return[XZ,xJ].map(function(t){return t(e)})};function XJ(e){var t=e.maxDate,n=e.maxDetail,i=e.minDate,r=e.minDetail,o=e.value,a=e.view,l=xZ(a,r,n),s=XZ({value:o,minDate:i,maxDate:t,maxDetail:n})||new Date;return el(l,s)}function W6(e){var t=e.activeStartDate,n=e.defaultActiveStartDate,i=e.defaultValue,r=e.defaultView,o=e.maxDate,a=e.maxDetail,l=e.minDate,s=e.minDetail,g=e.value,c=e.view,u=xZ(c,s,a),I=t||n;return I?el(u,I):XJ({maxDate:o,maxDetail:a,minDate:l,minDetail:s,value:g||i,view:c||r})}function lf(e){return e&&(!Array.isArray(e)||e.length===1)}function UI(e,t){return e instanceof Date&&t instanceof Date&&e.getTime()===t.getTime()}var k6=h.forwardRef(function(t,n){var i=t.activeStartDate,r=t.allowPartialRange,o=t.calendarType,a=t.className,l=t.defaultActiveStartDate,s=t.defaultValue,g=t.defaultView,c=t.formatDay,u=t.formatLongDate,I=t.formatMonth,C=t.formatMonthYear,m=t.formatShortWeekday,f=t.formatWeekday,b=t.formatYear,A=t.goToRangeStartOnSelect,p=A===void 0?!0:A,y=t.inputRef,Z=t.locale,G=t.maxDate,v=G===void 0?G6:G,B=t.maxDetail,R=B===void 0?"month":B,X=t.minDate,W=X===void 0?wZ:X,V=t.minDetail,Y=V===void 0?"century":V,K=t.navigationAriaLabel,M=t.navigationAriaLive,H=t.navigationLabel,w=t.next2AriaLabel,x=t.next2Label,J=t.nextAriaLabel,F=t.nextLabel,S=t.onActiveStartDateChange,E=t.onChange,N=t.onClickDay,k=t.onClickDecade,z=t.onClickMonth,L=t.onClickWeekNumber,D=t.onClickYear,j=t.onDrillDown,ne=t.onDrillUp,ie=t.onViewChange,ae=t.prev2AriaLabel,Re=t.prev2Label,de=t.prevAriaLabel,Q=t.prevLabel,O=t.returnValue,me=O===void 0?"start":O,Ae=t.selectRange,De=t.showDoubleView,ke=t.showFixedNumberOfWeeks,xe=t.showNavigation,Ee=xe===void 0?!0:xe,We=t.showNeighboringCentury,ze=t.showNeighboringDecade,Ge=t.showNeighboringMonth,it=Ge===void 0?!0:Ge,Pe=t.showWeekNumbers,U=t.tileClassName,oe=t.tileContent,P=t.tileDisabled,re=t.value,ve=t.view,Fe=h.useState(l),Te=Fe[0],Xe=Fe[1],Ye=h.useState(null),qe=Ye[0],$e=Ye[1],et=h.useState(Array.isArray(s)?s.map(function(Le){return Le!==null?tc(Le):null}):s!=null?tc(s):null),Oe=et[0],xt=et[1],Dt=h.useState(g),Ht=Dt[0],at=Dt[1],je=i||Te||W6({activeStartDate:i,defaultActiveStartDate:l,defaultValue:s,defaultView:g,maxDate:v,maxDetail:R,minDate:W,minDetail:Y,value:re,view:ve}),Ke=function(){var Le=function(){return Ae&&lf(Oe)?Oe:re!==void 0?re:Oe}();return Le?Array.isArray(Le)?Le.map(function(ct){return ct!==null?tc(ct):null}):Le!==null?tc(Le):null:null}(),rt=VJ(R),Be=xZ(ve||Ht,Y,R),fe=kJ(Y,R),be=Ae?qe:null,T=fe.indexOf(Be)<fe.length-1,ee=fe.indexOf(Be)>0,le=h.useCallback(function(Le){var ct=function(){switch(me){case"start":return XZ;case"end":return xJ;case"range":return R6;default:throw new Error("Invalid returnValue.")}}();return ct({maxDate:v,maxDetail:R,minDate:W,value:Le})},[v,R,W,me]),q=h.useCallback(function(Le,ct){Xe(Le);var st={action:ct,activeStartDate:Le,value:Ke,view:Be};S&&!UI(je,Le)&&S(st)},[je,S,Ke,Be]),ge=h.useCallback(function(Le,ct){var st=function(){switch(Be){case"century":return k;case"decade":return D;case"year":return z;case"month":return N;default:throw new Error("Invalid view: ".concat(Be,"."))}}();st&&st(Le,ct)},[N,k,z,D,Be]),pe=h.useCallback(function(Le,ct){if(T){ge(Le,ct);var st=fe[fe.indexOf(Be)+1];if(!st)throw new Error("Attempted to drill down from the lowest view.");Xe(Le),at(st);var Xt={action:"drillDown",activeStartDate:Le,value:Ke,view:st};S&&!UI(je,Le)&&S(Xt),ie&&Be!==st&&ie(Xt),j&&j(Xt)}},[je,T,S,ge,j,ie,Ke,Be,fe]),Ze=h.useCallback(function(){if(ee){var Le=fe[fe.indexOf(Be)-1];if(!Le)throw new Error("Attempted to drill up from the highest view.");var ct=el(Le,je);Xe(ct),at(Le);var st={action:"drillUp",activeStartDate:ct,value:Ke,view:Le};S&&!UI(je,ct)&&S(st),ie&&Be!==Le&&ie(st),ne&&ne(st)}},[je,ee,S,ne,ie,Ke,Be,fe]),Ce=h.useCallback(function(Le,ct){var st=Ke;ge(Le,ct);var Xt=Ae&&!lf(st),Jt;if(Ae)if(Xt)Jt=el(rt,Le);else{if(!st)throw new Error("previousValue is required");if(Array.isArray(st))throw new Error("previousValue must not be an array");Jt=j$(rt,st,Le)}else Jt=le(Le);var _t=!Ae||Xt||p?XJ({maxDate:v,maxDetail:R,minDate:W,minDetail:Y,value:Jt,view:Be}):null;ct.persist(),Xe(_t),xt(Jt);var Ot={action:"onChange",activeStartDate:_t,value:Jt,view:Be};if(S&&!UI(je,_t)&&S(Ot),E)if(Ae){var rr=lf(Jt);if(!rr)E(Jt||null,ct);else if(r){if(Array.isArray(Jt))throw new Error("value must not be an array");E([Jt||null,null],ct)}}else E(Jt||null,ct)},[je,r,le,p,v,R,W,Y,S,E,ge,Ae,Ke,rt,Be]);function we(Le){$e(Le)}function Se(){$e(null)}h.useImperativeHandle(n,function(){return{activeStartDate:je,drillDown:pe,drillUp:Ze,onChange:Ce,setActiveStartDate:q,value:Ke,view:Be}},[je,pe,Ze,Ce,q,Ke,Be]);function lt(Le){var ct=Le?ZJ(Be,je):el(Be,je),st=T?pe:Ce,Xt={activeStartDate:ct,hover:be,locale:Z,maxDate:v,minDate:W,onClick:st,onMouseOver:Ae?we:void 0,tileClassName:U,tileContent:oe,tileDisabled:P,value:Ke,valueType:rt};switch(Be){case"century":return d.jsx(r6,ls({formatYear:b,showNeighboringCentury:We},Xt));case"decade":return d.jsx(s6,ls({formatYear:b,showNeighboringDecade:ze},Xt));case"year":return d.jsx(d6,ls({formatMonth:I,formatMonthYear:C},Xt));case"month":return d.jsx(Z6,ls({calendarType:o,formatDay:c,formatLongDate:u,formatShortWeekday:m,formatWeekday:f,onClickWeekNumber:L,onMouseLeave:Ae?Se:void 0,showFixedNumberOfWeeks:typeof ke<"u"?ke:De,showNeighboringMonth:it,showWeekNumbers:Pe},Xt));default:throw new Error("Invalid view: ".concat(Be,"."))}}function Rt(){return Ee?d.jsx(P$,{activeStartDate:je,drillUp:Ze,formatMonthYear:C,formatYear:b,locale:Z,maxDate:v,minDate:W,navigationAriaLabel:K,navigationAriaLive:M,navigationLabel:H,next2AriaLabel:w,next2Label:x,nextAriaLabel:J,nextLabel:F,prev2AriaLabel:ae,prev2Label:Re,prevAriaLabel:de,prevLabel:Q,setActiveStartDate:q,showDoubleView:De,view:Be,views:fe}):null}var cn=Array.isArray(Ke)?Ke:[Ke];return d.jsxs("div",{className:fm(jI,Ae&&cn.length===1&&"".concat(jI,"--selectRange"),De&&"".concat(jI,"--doubleView"),a),ref:y,children:[Rt(),d.jsxs("div",{className:"".concat(jI,"__viewContainer"),onBlur:Ae?Se:void 0,onMouseLeave:Ae?Se:void 0,children:[lt(),De?lt(!0):null]})]})});const JJ=6048e5,V6=864e5,dW=Symbol.for("constructDateFrom");function da(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&dW in e?e[dW](t):e instanceof Date?new e.constructor(t):new Date(t)}function Sr(e,t){return da(t||e,e)}let w6={};function Sm(){return w6}function hu(e,t){var l,s,g,c;const n=Sm(),i=(t==null?void 0:t.weekStartsOn)??((s=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:s.weekStartsOn)??n.weekStartsOn??((c=(g=n.locale)==null?void 0:g.options)==null?void 0:c.weekStartsOn)??0,r=Sr(e,t==null?void 0:t.in),o=r.getDay(),a=(o<i?7:0)+o-i;return r.setDate(r.getDate()-a),r.setHours(0,0,0,0),r}function MC(e,t){return hu(e,{...t,weekStartsOn:1})}function YJ(e,t){const n=Sr(e,t==null?void 0:t.in),i=n.getFullYear(),r=da(n,0);r.setFullYear(i+1,0,4),r.setHours(0,0,0,0);const o=MC(r),a=da(n,0);a.setFullYear(i,0,4),a.setHours(0,0,0,0);const l=MC(a);return n.getTime()>=o.getTime()?i+1:n.getTime()>=l.getTime()?i:i-1}function CW(e){const t=Sr(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function x6(e,...t){const n=da.bind(null,t.find(i=>typeof i=="object"));return t.map(n)}function hW(e,t){const n=Sr(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function X6(e,t,n){const[i,r]=x6(n==null?void 0:n.in,e,t),o=hW(i),a=hW(r),l=+o-CW(o),s=+a-CW(a);return Math.round((l-s)/V6)}function J6(e,t){const n=YJ(e,t),i=da(e,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),MC(i)}function Y6(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function N6(e){return!(!Y6(e)&&typeof e!="number"||isNaN(+Sr(e)))}function H6(e,t){const n=Sr(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const F6={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},K6=(e,t,n)=>{let i;const r=F6[e];return typeof r=="string"?i=r:t===1?i=r.one:i=r.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function sf(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const E6={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},M6={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},z6={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},L6={date:sf({formats:E6,defaultWidth:"full"}),time:sf({formats:M6,defaultWidth:"full"}),dateTime:sf({formats:z6,defaultWidth:"full"})},D6={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},T6=(e,t,n,i)=>D6[e];function Kg(e){return(t,n)=>{const i=n!=null&&n.context?String(n.context):"standalone";let r;if(i==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,l=n!=null&&n.width?String(n.width):a;r=e.formattingValues[l]||e.formattingValues[a]}else{const a=e.defaultWidth,l=n!=null&&n.width?String(n.width):e.defaultWidth;r=e.values[l]||e.values[a]}const o=e.argumentCallback?e.argumentCallback(t):t;return r[o]}}const j6={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},U6={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Q6={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},P6={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},_6={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},O6={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},q6=(e,t)=>{const n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},$6={ordinalNumber:q6,era:Kg({values:j6,defaultWidth:"wide"}),quarter:Kg({values:U6,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Kg({values:Q6,defaultWidth:"wide"}),day:Kg({values:P6,defaultWidth:"wide"}),dayPeriod:Kg({values:_6,defaultWidth:"wide",formattingValues:O6,defaultFormattingWidth:"wide"})};function Eg(e){return(t,n={})=>{const i=n.width,r=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],o=t.match(r);if(!o)return null;const a=o[0],l=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],s=Array.isArray(l)?tee(l,u=>u.test(a)):eee(l,u=>u.test(a));let g;g=e.valueCallback?e.valueCallback(s):s,g=n.valueCallback?n.valueCallback(g):g;const c=t.slice(a.length);return{value:g,rest:c}}}function eee(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function tee(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function nee(e){return(t,n={})=>{const i=t.match(e.matchPattern);if(!i)return null;const r=i[0],o=t.match(e.parsePattern);if(!o)return null;let a=e.valueCallback?e.valueCallback(o[0]):o[0];a=n.valueCallback?n.valueCallback(a):a;const l=t.slice(r.length);return{value:a,rest:l}}}const iee=/^(\d+)(th|st|nd|rd)?/i,ree=/\d+/i,oee={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},aee={any:[/^b/i,/^(a|c)/i]},lee={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},see={any:[/1/i,/2/i,/3/i,/4/i]},gee={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},cee={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},uee={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Iee={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},dee={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Cee={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},hee={ordinalNumber:nee({matchPattern:iee,parsePattern:ree,valueCallback:e=>parseInt(e,10)}),era:Eg({matchPatterns:oee,defaultMatchWidth:"wide",parsePatterns:aee,defaultParseWidth:"any"}),quarter:Eg({matchPatterns:lee,defaultMatchWidth:"wide",parsePatterns:see,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Eg({matchPatterns:gee,defaultMatchWidth:"wide",parsePatterns:cee,defaultParseWidth:"any"}),day:Eg({matchPatterns:uee,defaultMatchWidth:"wide",parsePatterns:Iee,defaultParseWidth:"any"}),dayPeriod:Eg({matchPatterns:dee,defaultMatchWidth:"any",parsePatterns:Cee,defaultParseWidth:"any"})},mee={code:"en-US",formatDistance:K6,formatLong:L6,formatRelative:T6,localize:$6,match:hee,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Aee(e,t){const n=Sr(e,t==null?void 0:t.in);return X6(n,H6(n))+1}function fee(e,t){const n=Sr(e,t==null?void 0:t.in),i=+MC(n)-+J6(n);return Math.round(i/JJ)+1}function NJ(e,t){var c,u,I,C;const n=Sr(e,t==null?void 0:t.in),i=n.getFullYear(),r=Sm(),o=(t==null?void 0:t.firstWeekContainsDate)??((u=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??r.firstWeekContainsDate??((C=(I=r.locale)==null?void 0:I.options)==null?void 0:C.firstWeekContainsDate)??1,a=da((t==null?void 0:t.in)||e,0);a.setFullYear(i+1,0,o),a.setHours(0,0,0,0);const l=hu(a,t),s=da((t==null?void 0:t.in)||e,0);s.setFullYear(i,0,o),s.setHours(0,0,0,0);const g=hu(s,t);return+n>=+l?i+1:+n>=+g?i:i-1}function pee(e,t){var l,s,g,c;const n=Sm(),i=(t==null?void 0:t.firstWeekContainsDate)??((s=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:s.firstWeekContainsDate)??n.firstWeekContainsDate??((c=(g=n.locale)==null?void 0:g.options)==null?void 0:c.firstWeekContainsDate)??1,r=NJ(e,t),o=da((t==null?void 0:t.in)||e,0);return o.setFullYear(r,0,i),o.setHours(0,0,0,0),hu(o,t)}function bee(e,t){const n=Sr(e,t==null?void 0:t.in),i=+hu(n,t)-+pee(n,t);return Math.round(i/JJ)+1}function Wt(e,t){const n=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return n+i}const So={y(e,t){const n=e.getFullYear(),i=n>0?n:1-n;return Wt(t==="yy"?i%100:i,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Wt(n+1,2)},d(e,t){return Wt(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Wt(e.getHours()%12||12,t.length)},H(e,t){return Wt(e.getHours(),t.length)},m(e,t){return Wt(e.getMinutes(),t.length)},s(e,t){return Wt(e.getSeconds(),t.length)},S(e,t){const n=t.length,i=e.getMilliseconds(),r=Math.trunc(i*Math.pow(10,n-3));return Wt(r,t.length)}},El={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},mW={G:function(e,t,n){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const i=e.getFullYear(),r=i>0?i:1-i;return n.ordinalNumber(r,{unit:"year"})}return So.y(e,t)},Y:function(e,t,n,i){const r=NJ(e,i),o=r>0?r:1-r;if(t==="YY"){const a=o%100;return Wt(a,2)}return t==="Yo"?n.ordinalNumber(o,{unit:"year"}):Wt(o,t.length)},R:function(e,t){const n=YJ(e);return Wt(n,t.length)},u:function(e,t){const n=e.getFullYear();return Wt(n,t.length)},Q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Wt(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Wt(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,n){const i=e.getMonth();switch(t){case"M":case"MM":return So.M(e,t);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,n){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return Wt(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,n,i){const r=bee(e,i);return t==="wo"?n.ordinalNumber(r,{unit:"week"}):Wt(r,t.length)},I:function(e,t,n){const i=fee(e);return t==="Io"?n.ordinalNumber(i,{unit:"week"}):Wt(i,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):So.d(e,t)},D:function(e,t,n){const i=Aee(e);return t==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):Wt(i,t.length)},E:function(e,t,n){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,n,i){const r=e.getDay(),o=(r-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return Wt(o,2);case"eo":return n.ordinalNumber(o,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,n,i){const r=e.getDay(),o=(r-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return Wt(o,t.length);case"co":return n.ordinalNumber(o,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,n){const i=e.getDay(),r=i===0?7:i;switch(t){case"i":return String(r);case"ii":return Wt(r,t.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,n){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const i=e.getHours();let r;switch(i===12?r=El.noon:i===0?r=El.midnight:r=i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){const i=e.getHours();let r;switch(i>=17?r=El.evening:i>=12?r=El.afternoon:i>=4?r=El.morning:r=El.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let i=e.getHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return So.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):So.H(e,t)},K:function(e,t,n){const i=e.getHours()%12;return t==="Ko"?n.ordinalNumber(i,{unit:"hour"}):Wt(i,t.length)},k:function(e,t,n){let i=e.getHours();return i===0&&(i=24),t==="ko"?n.ordinalNumber(i,{unit:"hour"}):Wt(i,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):So.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):So.s(e,t)},S:function(e,t){return So.S(e,t)},X:function(e,t,n){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return fW(i);case"XXXX":case"XX":return Ea(i);case"XXXXX":case"XXX":default:return Ea(i,":")}},x:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"x":return fW(i);case"xxxx":case"xx":return Ea(i);case"xxxxx":case"xxx":default:return Ea(i,":")}},O:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+AW(i,":");case"OOOO":default:return"GMT"+Ea(i,":")}},z:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+AW(i,":");case"zzzz":default:return"GMT"+Ea(i,":")}},t:function(e,t,n){const i=Math.trunc(+e/1e3);return Wt(i,t.length)},T:function(e,t,n){return Wt(+e,t.length)}};function AW(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),r=Math.trunc(i/60),o=i%60;return o===0?n+String(r):n+String(r)+t+Wt(o,2)}function fW(e,t){return e%60===0?(e>0?"-":"+")+Wt(Math.abs(e)/60,2):Ea(e,t)}function Ea(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),r=Wt(Math.trunc(i/60),2),o=Wt(i%60,2);return n+r+t+o}const pW=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},HJ=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},yee=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],i=n[1],r=n[2];if(!r)return pW(e,t);let o;switch(i){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;case"PPPP":default:o=t.dateTime({width:"full"});break}return o.replace("{{date}}",pW(i,t)).replace("{{time}}",HJ(r,t))},Zee={p:HJ,P:yee},vee=/^D+$/,Gee=/^Y+$/,See=["D","DD","YY","YYYY"];function Bee(e){return vee.test(e)}function Ree(e){return Gee.test(e)}function Wee(e,t,n){const i=kee(e,t,n);if(console.warn(i),See.includes(e))throw new RangeError(i)}function kee(e,t,n){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Vee=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,wee=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,xee=/^'([^]*?)'?$/,Xee=/''/g,Jee=/[a-zA-Z]/;function Yee(e,t,n){var c,u,I,C;const i=Sm(),r=i.locale??mee,o=i.firstWeekContainsDate??((u=(c=i.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,a=i.weekStartsOn??((C=(I=i.locale)==null?void 0:I.options)==null?void 0:C.weekStartsOn)??0,l=Sr(e,n==null?void 0:n.in);if(!N6(l))throw new RangeError("Invalid time value");let s=t.match(wee).map(m=>{const f=m[0];if(f==="p"||f==="P"){const b=Zee[f];return b(m,r.formatLong)}return m}).join("").match(Vee).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const f=m[0];if(f==="'")return{isToken:!1,value:Nee(m)};if(mW[f])return{isToken:!0,value:m};if(f.match(Jee))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:m}});r.localize.preprocessor&&(s=r.localize.preprocessor(l,s));const g={firstWeekContainsDate:o,weekStartsOn:a,locale:r};return s.map(m=>{if(!m.isToken)return m.value;const f=m.value;(Ree(f)||Bee(f))&&Wee(f,t,String(e));const b=mW[f[0]];return b(l,f,r.localize,g)}).join("")}function Nee(e){const t=e.match(xee);return t?t[1].replace(Xee,"'"):e}const Hee=()=>{const[e,t]=h.useState(new Date),[n,i]=h.useState(!1),[r,o]=h.useState(null),a=Gt(),l=yi(),s=h.useRef(null),{state:g}=l||{},c=g==null?void 0:g.recipeId,u=g==null?void 0:g.recipeName,I={breakfast:"2 dishes",lunch:"3 dishes",dinner:"2 dishes",others:"1 dish"},C=A=>{s.current=setTimeout(()=>{o(A.toDateString()),i(!0)},700),console.log("Long press started")},m=()=>{clearTimeout(s.current),console.log("Long press ended")},f=A=>{const p=Yee(A,"yyyy-MM-dd");a(`/recipes/calendar/${p}`,{state:{date:p,recipeId:c,recipeName:u}})},b=({date:A})=>{const p=new Date;return A.toDateString()===p.toDateString()?"today-date":A>p?"coming-date":"past-date"};return d.jsxs("div",{className:"calendar-container",children:[d.jsx("h1",{children:"Calendar"}),d.jsx(ba,{}),c&&u&&d.jsxs("div",{className:"recipe-details",children:[d.jsx("h2",{children:"Reschedule Recipe"}),d.jsxs("p",{children:[d.jsx("strong",{children:"Recipe Name:"})," ",u]})]}),d.jsx(k6,{onChange:A=>t(A),value:e,tileClassName:b,locale:"en-US",onClickDay:A=>f(A),tileContent:({date:A})=>d.jsx("div",{onTouchStart:()=>C(A),onTouchEnd:m,onMouseDown:()=>C(A),onMouseUp:m})}),n&&d.jsx("div",{className:"modal",children:d.jsxs("div",{className:"modal-content",children:[d.jsxs("h2",{children:["Details for ",r]}),d.jsxs("p",{children:["Breakfast: ",I.breakfast]}),d.jsxs("p",{children:["Lunch: ",I.lunch]}),d.jsxs("p",{children:["Dinner: ",I.dinner]}),d.jsxs("p",{children:["Others: ",I.others]}),d.jsx("button",{onClick:()=>i(!1),children:"Close"})]})})]})},Fee=()=>{var M,H;const{date:e}=Aa(),t=Gt(),n=yi(),{userData:i,fetchMealPlansByDate:r,fetchRecipesByIds:o,mealTypes:a}=rg(),[l,s]=h.useState([]),[g,c]=h.useState(!0),[u,I]=h.useState({}),[C,m]=h.useState({}),[f,b]=h.useState(null),[A,p]=h.useState({show:!1,mealTypeId:null}),{recipeId:y,recipeName:Z,date:G}=n.state||{},[v,B]=h.useState({notes:"",time:"",meal_type_id:""});h.useEffect(()=>{(async()=>{c(!0);try{const x=await r(e),J=x.map(N=>N.recipe_id),F=await o(J),S=x.map(N=>({...N,recipe:F.find(k=>k.id===N.recipe_id)}));console.log("Enriched Meal Plans:",S),s(S);const E={};a.forEach(N=>{const k=S.filter(z=>z.meal_type_name===N.name);E[N.name]=R(k)}),m(E)}catch(x){console.error("Error fetching meal plans or recipes:",x.message)}finally{c(!1)}})()},[e,r,o,a]);const R=w=>{var J;return w.length===0?null:w.length===1?`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${(J=w[0].recipe)==null?void 0:J.image_path}`:w.slice(0,2).map(F=>{var S;return`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${(S=F.recipe)==null?void 0:S.image_path}`})},X=w=>{I(x=>({...x,[w]:!x[w]}))},W=async(w,x,J)=>{if(window.confirm("Are you sure you want to cancel this meal?"))try{const{error:S}=await _.from("meal_plan").delete().eq("planned_date",w).eq("recipe_id",x).eq("meal_type_id",J);if(S){console.error("Error deleting meal:",S.message);return}s(E=>E.filter(N=>N.planned_date!==w||N.recipe_id!==x||N.meal_type_id!==J)),console.log(`Meal with date: ${w}, recipe_id: ${x}, meal_type_id: ${J} deleted successfully.`)}catch(S){console.error("Unexpected error deleting meal:",S.message)}},V=async()=>{try{const{error:w}=await _.from("meal_plan").insert([{user_id:i.id,recipe_id:y,planned_date:G||e,meal_type_id:f,notes:v.notes,time:v.time}]);if(console.log("Adding meal..."),console.log("Recipe ID:",y),console.log("Planned Date:",G),console.log("Meal Type ID:",f),console.log("Notes:",v.notes),console.log("Time:",v.time),w){console.error("Error adding meal:",w.message);return}s(x=>[...x,{recipe_id:y,planned_date:G||e,meal_type_id:f,notes:v.notes,time:v.time}]),b(null)}catch(w){console.error("Unexpected error adding meal:",w.message)}},Y=w=>{const x=a.find(F=>F.id===w),J=(x==null?void 0:x.default_time)||"12:00";B(F=>({...F,meal_type_id:w,time:J})),b(w)},K=(w,x)=>{t(`/recipes/${w==="favorites"?"favorites":"explore"}`,{state:{planned_date:e,meal_type_id:A.mealTypeId,activity_type:x}}),p({show:!1,mealTypeId:null})};return g?d.jsx("div",{className:"meal-planner-container",children:"Loading..."}):d.jsxs("div",{className:"meal-planner-container",children:[d.jsxs("header",{className:"meal-planner-header",children:[d.jsx(ba,{}),d.jsx("div",{className:"date-display",children:d.jsx("p",{children:e})}),y&&Z&&d.jsxs("div",{className:"recipe-details",children:[d.jsx("h2",{children:"Recipe Details"}),d.jsxs("p",{children:[d.jsx("strong",{children:"Recipe Name:"})," ",Z]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Recipe ID:"})," ",y]})]})]}),a.map(w=>{const x=l.filter(F=>F.meal_type_name===w.name),J=x.length>0;return d.jsxs("div",{className:"meal-section",children:[d.jsxs("div",{className:"meal-section-header",children:[d.jsx("div",{className:"meal-header-image",children:J?C[w.name]&&Array.isArray(C[w.name])?d.jsxs("div",{className:"merged-images",children:[d.jsx("img",{src:C[w.name][0],alt:"Meal 1",className:"meal-merged-image"}),d.jsx("img",{src:C[w.name][1],alt:"Meal 2",className:"meal-merged-image"})]}):d.jsx("img",{src:C[w.name],alt:"Single Meal",className:"meal-merged-image"}):d.jsx("div",{className:"no-meal-placeholder",children:d.jsxs("p",{children:["No meals planned for ",w.name,"."]})})}),d.jsxs("div",{className:"meal-section-controls",children:[d.jsx("button",{onClick:()=>y?Y(w.id):p({show:!0,mealTypeId:w.id}),className:"action-button",children:y?"Add Here":"Schedule Meal"}),J&&d.jsx("button",{onClick:()=>t(`/recipes/calendar/preparation/${e}`,{state:{planned_date:e,meal_type_id:w.id}}),className:"view-details-button",children:"View Details"})]}),d.jsx("h2",{children:w.name}),d.jsx("span",{onClick:()=>X(w.name),style:{cursor:"pointer"},children:u[w.name]?"▲":"▼"})]}),u[w.name]&&J&&d.jsx("div",{className:"meal-list",children:x.map((F,S)=>{var E,N,k;return d.jsxs("div",{className:"meal-item",children:[d.jsx("img",{src:`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${((E=F.recipe)==null?void 0:E.image_path)||"path/to/default/image.jpg"}`,alt:((N=F.recipe)==null?void 0:N.name)||"Meal Image",className:"meal-image",onClick:()=>{var z;return t(`/recipes/recipe/${((z=F.recipe)==null?void 0:z.id)||""}`,{state:{planned_date:F.planned_date,meal_type_id:F.meal_type_id,recipe_id:F.recipe_id,activity_type:"view"}})}}),d.jsxs("div",{className:"meal-overlay",children:[d.jsx("span",{className:"meal-name",children:((k=F.recipe)==null?void 0:k.name)||"Unknown Recipe"}),d.jsx("p",{className:"meal-notes",children:F.notes}),d.jsx("button",{onClick:z=>{z.stopPropagation(),W(F.planned_date,F.recipe_id,F.meal_type_id)},className:"cancel-meal-button",children:"Cancel"})]})]},S)})}),u[w.name]&&!J&&d.jsx("div",{className:"no-meal-message",children:d.jsxs("p",{children:["No meals added for ",w.name,'. Click "Add Meal" to start planning!']})})]},w.id)}),f&&d.jsx("div",{className:"modal",children:d.jsxs("div",{className:"modal-content",children:[d.jsx("h2",{children:"Add a Meal"}),d.jsxs("p",{children:[d.jsx("strong",{children:"Recipe:"})," ",Z]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Meal Type:"})," ",((M=a.find(w=>w.id===f))==null?void 0:M.name)||"Unknown"]}),d.jsxs("label",{children:["Notes:",d.jsx("textarea",{value:v.notes,placeholder:"Enter additional notes (e.g., extra ingredients, instructions)",onChange:w=>B(x=>({...x,notes:w.target.value})),rows:"3"})]}),d.jsxs("label",{children:["Time:",d.jsx("input",{type:"time",value:v.time,onChange:w=>B(x=>({...x,time:w.target.value}))})]}),d.jsx("button",{onClick:V,className:"save-button",children:"Save"}),d.jsx("button",{onClick:()=>b(null),className:"cancel-button",children:"Cancel"})]})}),A.show&&d.jsx("div",{className:"modal",children:d.jsxs("div",{className:"modal-content",children:[d.jsx("h2",{children:"Schedule Meal"}),d.jsxs("p",{children:["Would you like to schedule a meal for"," ",d.jsx("strong",{children:(H=a.find(w=>w.id===A.mealTypeId))==null?void 0:H.name})," ","from your favorites or all recipes?"]}),d.jsxs("div",{className:"modal-buttons",children:[d.jsx("button",{onClick:()=>K("favorites","add"),className:"modal-button favorites-button",children:"Favorites"}),d.jsx("button",{onClick:()=>K("all","add"),className:"modal-button all-recipes-button",children:"All Recipes"})]}),d.jsx("button",{onClick:()=>p({show:!1,mealTypeId:null}),className:"modal-close-button",children:"Cancel"})]})})]})};function Kee(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return h.useMemo(()=>i=>{t.forEach(r=>r(i))},t)}const Bm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function lg(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function JZ(e){return"nodeType"in e}function Gi(e){var t,n;return e?lg(e)?e:JZ(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function YZ(e){const{Document:t}=Gi(e);return e instanceof t}function Lu(e){return lg(e)?!1:e instanceof Gi(e).HTMLElement}function FJ(e){return e instanceof Gi(e).SVGElement}function sg(e){return e?lg(e)?e.document:JZ(e)?YZ(e)?e:Lu(e)||FJ(e)?e.ownerDocument:document:document:document}const Kr=Bm?h.useLayoutEffect:h.useEffect;function NZ(e){const t=h.useRef(e);return Kr(()=>{t.current=e}),h.useCallback(function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return t.current==null?void 0:t.current(...i)},[])}function Eee(){const e=h.useRef(null),t=h.useCallback((i,r)=>{e.current=setInterval(i,r)},[]),n=h.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function mu(e,t){t===void 0&&(t=[e]);const n=h.useRef(e);return Kr(()=>{n.current!==e&&(n.current=e)},t),n}function Du(e,t){const n=h.useRef();return h.useMemo(()=>{const i=e(n.current);return n.current=i,i},[...t])}function zC(e){const t=NZ(e),n=h.useRef(null),i=h.useCallback(r=>{r!==n.current&&(t==null||t(r,n.current)),n.current=r},[]);return[n,i]}function e0(e){const t=h.useRef();return h.useEffect(()=>{t.current=e},[e]),t.current}let gf={};function Tu(e,t){return h.useMemo(()=>{if(t)return t;const n=gf[e]==null?0:gf[e]+1;return gf[e]=n,e+"-"+n},[e,t])}function KJ(e){return function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.reduce((o,a)=>{const l=Object.entries(a);for(const[s,g]of l){const c=o[s];c!=null&&(o[s]=c+e*g)}return o},{...t})}}const ps=KJ(1),LC=KJ(-1);function Mee(e){return"clientX"in e&&"clientY"in e}function HZ(e){if(!e)return!1;const{KeyboardEvent:t}=Gi(e.target);return t&&e instanceof t}function zee(e){if(!e)return!1;const{TouchEvent:t}=Gi(e.target);return t&&e instanceof t}function t0(e){if(zee(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Mee(e)?{x:e.clientX,y:e.clientY}:null}const Fs=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Fs.Translate.toString(e),Fs.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:i}=e;return t+" "+n+"ms "+i}}}),bW="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Lee(e){return e.matches(bW)?e:e.querySelector(bW)}const Dee={display:"none"};function Tee(e){let{id:t,value:n}=e;return ce.createElement("div",{id:t,style:Dee},n)}function jee(e){let{id:t,announcement:n,ariaLiveType:i="assertive"}=e;const r={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ce.createElement("div",{id:t,style:r,role:"status","aria-live":i,"aria-atomic":!0},n)}function Uee(){const[e,t]=h.useState("");return{announce:h.useCallback(i=>{i!=null&&t(i)},[]),announcement:e}}const EJ=h.createContext(null);function Qee(e){const t=h.useContext(EJ);h.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Pee(){const[e]=h.useState(()=>new Set),t=h.useCallback(i=>(e.add(i),()=>e.delete(i)),[e]);return[h.useCallback(i=>{let{type:r,event:o}=i;e.forEach(a=>{var l;return(l=a[r])==null?void 0:l.call(a,o)})},[e]),t]}const _ee={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Oee={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function qee(e){let{announcements:t=Oee,container:n,hiddenTextDescribedById:i,screenReaderInstructions:r=_ee}=e;const{announce:o,announcement:a}=Uee(),l=Tu("DndLiveRegion"),[s,g]=h.useState(!1);if(h.useEffect(()=>{g(!0)},[]),Qee(h.useMemo(()=>({onDragStart(u){let{active:I}=u;o(t.onDragStart({active:I}))},onDragMove(u){let{active:I,over:C}=u;t.onDragMove&&o(t.onDragMove({active:I,over:C}))},onDragOver(u){let{active:I,over:C}=u;o(t.onDragOver({active:I,over:C}))},onDragEnd(u){let{active:I,over:C}=u;o(t.onDragEnd({active:I,over:C}))},onDragCancel(u){let{active:I,over:C}=u;o(t.onDragCancel({active:I,over:C}))}}),[o,t])),!s)return null;const c=ce.createElement(ce.Fragment,null,ce.createElement(Tee,{id:i,value:r.draggable}),ce.createElement(jee,{id:l,announcement:a}));return n?_i.createPortal(c,n):c}var vn;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(vn||(vn={}));function DC(){}function MJ(e,t){return h.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function zJ(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return h.useMemo(()=>[...t].filter(i=>i!=null),[...t])}const yr=Object.freeze({x:0,y:0});function $ee(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function ete(e,t){let{data:{value:n}}=e,{data:{value:i}}=t;return n-i}function tte(e,t){let{data:{value:n}}=e,{data:{value:i}}=t;return i-n}function nte(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function yW(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const LJ=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:i}=e;const r=yW(t,t.left,t.top),o=[];for(const a of i){const{id:l}=a,s=n.get(l);if(s){const g=$ee(yW(s),r);o.push({id:l,data:{droppableContainer:a,value:g}})}}return o.sort(ete)};function ite(e,t){const n=Math.max(t.top,e.top),i=Math.max(t.left,e.left),r=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),a=r-i,l=o-n;if(i<r&&n<o){const s=t.width*t.height,g=e.width*e.height,c=a*l,u=c/(s+g-c);return Number(u.toFixed(4))}return 0}const rte=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:i}=e;const r=[];for(const o of i){const{id:a}=o,l=n.get(a);if(l){const s=ite(l,t);s>0&&r.push({id:a,data:{droppableContainer:o,value:s}})}}return r.sort(tte)};function ote(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function DJ(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:yr}function ate(e){return function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return r.reduce((a,l)=>({...a,top:a.top+e*l.y,bottom:a.bottom+e*l.y,left:a.left+e*l.x,right:a.right+e*l.x}),{...n})}}const lte=ate(1);function ste(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function gte(e,t,n){const i=ste(t);if(!i)return e;const{scaleX:r,scaleY:o,x:a,y:l}=i,s=e.left-a-(1-r)*parseFloat(n),g=e.top-l-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),c=r?e.width/r:e.width,u=o?e.height/o:e.height;return{width:c,height:u,top:g,right:s+c,bottom:g+u,left:s}}const cte={ignoreTransform:!1};function gg(e,t){t===void 0&&(t=cte);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:g,transformOrigin:c}=Gi(e).getComputedStyle(e);g&&(n=gte(n,g,c))}const{top:i,left:r,width:o,height:a,bottom:l,right:s}=n;return{top:i,left:r,width:o,height:a,bottom:l,right:s}}function ZW(e){return gg(e,{ignoreTransform:!0})}function ute(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Ite(e,t){return t===void 0&&(t=Gi(e).getComputedStyle(e)),t.position==="fixed"}function dte(e,t){t===void 0&&(t=Gi(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(r=>{const o=t[r];return typeof o=="string"?n.test(o):!1})}function FZ(e,t){const n=[];function i(r){if(t!=null&&n.length>=t||!r)return n;if(YZ(r)&&r.scrollingElement!=null&&!n.includes(r.scrollingElement))return n.push(r.scrollingElement),n;if(!Lu(r)||FJ(r)||n.includes(r))return n;const o=Gi(e).getComputedStyle(r);return r!==e&&dte(r,o)&&n.push(r),Ite(r,o)?n:i(r.parentNode)}return e?i(e):n}function TJ(e){const[t]=FZ(e,1);return t??null}function cf(e){return!Bm||!e?null:lg(e)?e:JZ(e)?YZ(e)||e===sg(e).scrollingElement?window:Lu(e)?e:null:null}function jJ(e){return lg(e)?e.scrollX:e.scrollLeft}function UJ(e){return lg(e)?e.scrollY:e.scrollTop}function n0(e){return{x:jJ(e),y:UJ(e)}}var wn;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(wn||(wn={}));function QJ(e){return!Bm||!e?!1:e===document.scrollingElement}function PJ(e){const t={x:0,y:0},n=QJ(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},i={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},r=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,a=e.scrollTop>=i.y,l=e.scrollLeft>=i.x;return{isTop:r,isLeft:o,isBottom:a,isRight:l,maxScroll:i,minScroll:t}}const Cte={x:.2,y:.2};function hte(e,t,n,i,r){let{top:o,left:a,right:l,bottom:s}=n;i===void 0&&(i=10),r===void 0&&(r=Cte);const{isTop:g,isBottom:c,isLeft:u,isRight:I}=PJ(e),C={x:0,y:0},m={x:0,y:0},f={height:t.height*r.y,width:t.width*r.x};return!g&&o<=t.top+f.height?(C.y=wn.Backward,m.y=i*Math.abs((t.top+f.height-o)/f.height)):!c&&s>=t.bottom-f.height&&(C.y=wn.Forward,m.y=i*Math.abs((t.bottom-f.height-s)/f.height)),!I&&l>=t.right-f.width?(C.x=wn.Forward,m.x=i*Math.abs((t.right-f.width-l)/f.width)):!u&&a<=t.left+f.width&&(C.x=wn.Backward,m.x=i*Math.abs((t.left+f.width-a)/f.width)),{direction:C,speed:m}}function mte(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:a}=window;return{top:0,left:0,right:o,bottom:a,width:o,height:a}}const{top:t,left:n,right:i,bottom:r}=e.getBoundingClientRect();return{top:t,left:n,right:i,bottom:r,width:e.clientWidth,height:e.clientHeight}}function _J(e){return e.reduce((t,n)=>ps(t,n0(n)),yr)}function Ate(e){return e.reduce((t,n)=>t+jJ(n),0)}function fte(e){return e.reduce((t,n)=>t+UJ(n),0)}function pte(e,t){if(t===void 0&&(t=gg),!e)return;const{top:n,left:i,bottom:r,right:o}=t(e);TJ(e)&&(r<=0||o<=0||n>=window.innerHeight||i>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const bte=[["x",["left","right"],Ate],["y",["top","bottom"],fte]];class KZ{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const i=FZ(n),r=_J(i);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,a,l]of bte)for(const s of a)Object.defineProperty(this,s,{get:()=>{const g=l(i),c=r[o]-g;return this.rect[s]+c},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class yc{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var i;return(i=this.target)==null?void 0:i.removeEventListener(...n)})},this.target=t}add(t,n,i){var r;(r=this.target)==null||r.addEventListener(t,n,i),this.listeners.push([t,n,i])}}function yte(e){const{EventTarget:t}=Gi(e);return e instanceof t?e:sg(e)}function uf(e,t){const n=Math.abs(e.x),i=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+i**2)>t:"x"in t&&"y"in t?n>t.x&&i>t.y:"x"in t?n>t.x:"y"in t?i>t.y:!1}var Ti;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ti||(Ti={}));function vW(e){e.preventDefault()}function Zte(e){e.stopPropagation()}var vt;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(vt||(vt={}));const OJ={start:[vt.Space,vt.Enter],cancel:[vt.Esc],end:[vt.Space,vt.Enter,vt.Tab]},vte=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case vt.Right:return{...n,x:n.x+25};case vt.Left:return{...n,x:n.x-25};case vt.Down:return{...n,y:n.y+25};case vt.Up:return{...n,y:n.y-25}}};class qJ{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new yc(sg(n)),this.windowListeners=new yc(Gi(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ti.Resize,this.handleCancel),this.windowListeners.add(Ti.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ti.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,i=t.node.current;i&&pte(i),n(yr)}handleKeyDown(t){if(HZ(t)){const{active:n,context:i,options:r}=this.props,{keyboardCodes:o=OJ,coordinateGetter:a=vte,scrollBehavior:l="smooth"}=r,{code:s}=t;if(o.end.includes(s)){this.handleEnd(t);return}if(o.cancel.includes(s)){this.handleCancel(t);return}const{collisionRect:g}=i.current,c=g?{x:g.left,y:g.top}:yr;this.referenceCoordinates||(this.referenceCoordinates=c);const u=a(t,{active:n,context:i.current,currentCoordinates:c});if(u){const I=LC(u,c),C={x:0,y:0},{scrollableAncestors:m}=i.current;for(const f of m){const b=t.code,{isTop:A,isRight:p,isLeft:y,isBottom:Z,maxScroll:G,minScroll:v}=PJ(f),B=mte(f),R={x:Math.min(b===vt.Right?B.right-B.width/2:B.right,Math.max(b===vt.Right?B.left:B.left+B.width/2,u.x)),y:Math.min(b===vt.Down?B.bottom-B.height/2:B.bottom,Math.max(b===vt.Down?B.top:B.top+B.height/2,u.y))},X=b===vt.Right&&!p||b===vt.Left&&!y,W=b===vt.Down&&!Z||b===vt.Up&&!A;if(X&&R.x!==u.x){const V=f.scrollLeft+I.x,Y=b===vt.Right&&V<=G.x||b===vt.Left&&V>=v.x;if(Y&&!I.y){f.scrollTo({left:V,behavior:l});return}Y?C.x=f.scrollLeft-V:C.x=b===vt.Right?f.scrollLeft-G.x:f.scrollLeft-v.x,C.x&&f.scrollBy({left:-C.x,behavior:l});break}else if(W&&R.y!==u.y){const V=f.scrollTop+I.y,Y=b===vt.Down&&V<=G.y||b===vt.Up&&V>=v.y;if(Y&&!I.x){f.scrollTo({top:V,behavior:l});return}Y?C.y=f.scrollTop-V:C.y=b===vt.Down?f.scrollTop-G.y:f.scrollTop-v.y,C.y&&f.scrollBy({top:-C.y,behavior:l});break}}this.handleMove(t,ps(LC(u,this.referenceCoordinates),C))}}}handleMove(t,n){const{onMove:i}=this.props;t.preventDefault(),i(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}qJ.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:i=OJ,onActivation:r}=t,{active:o}=n;const{code:a}=e.nativeEvent;if(i.start.includes(a)){const l=o.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),r==null||r({event:e.nativeEvent}),!0)}return!1}}];function GW(e){return!!(e&&"distance"in e)}function SW(e){return!!(e&&"delay"in e)}class EZ{constructor(t,n,i){var r;i===void 0&&(i=yte(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:a}=o;this.props=t,this.events=n,this.document=sg(a),this.documentListeners=new yc(this.document),this.listeners=new yc(i),this.windowListeners=new yc(Gi(a)),this.initialCoordinates=(r=t0(o))!=null?r:yr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:i}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Ti.Resize,this.handleCancel),this.windowListeners.add(Ti.DragStart,vW),this.windowListeners.add(Ti.VisibilityChange,this.handleCancel),this.windowListeners.add(Ti.ContextMenu,vW),this.documentListeners.add(Ti.Keydown,this.handleKeydown),n){if(i!=null&&i({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(SW(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(GW(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:i,onPending:r}=this.props;r(i,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Ti.Click,Zte,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ti.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:i,initialCoordinates:r,props:o}=this,{onMove:a,options:{activationConstraint:l}}=o;if(!r)return;const s=(n=t0(t))!=null?n:yr,g=LC(r,s);if(!i&&l){if(GW(l)){if(l.tolerance!=null&&uf(g,l.tolerance))return this.handleCancel();if(uf(g,l.distance))return this.handleStart()}if(SW(l)&&uf(g,l.tolerance))return this.handleCancel();this.handlePending(l,g);return}t.cancelable&&t.preventDefault(),a(s)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===vt.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Gte={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Rm extends EZ{constructor(t){const{event:n}=t,i=sg(n.target);super(t,Gte,i)}}Rm.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:i}=t;return!n.isPrimary||n.button!==0?!1:(i==null||i({event:n}),!0)}}];const Ste={move:{name:"mousemove"},end:{name:"mouseup"}};var i0;(function(e){e[e.RightClick=2]="RightClick"})(i0||(i0={}));class Bte extends EZ{constructor(t){super(t,Ste,sg(t.event.target))}}Bte.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:i}=t;return n.button===i0.RightClick?!1:(i==null||i({event:n}),!0)}}];const If={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Rte extends EZ{constructor(t){super(t,If)}static setup(){return window.addEventListener(If.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(If.move.name,t)};function t(){}}}Rte.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:i}=t;const{touches:r}=n;return r.length>1?!1:(i==null||i({event:n}),!0)}}];var Zc;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Zc||(Zc={}));var TC;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(TC||(TC={}));function Wte(e){let{acceleration:t,activator:n=Zc.Pointer,canScroll:i,draggingRect:r,enabled:o,interval:a=5,order:l=TC.TreeOrder,pointerCoordinates:s,scrollableAncestors:g,scrollableAncestorRects:c,delta:u,threshold:I}=e;const C=Vte({delta:u,disabled:!o}),[m,f]=Eee(),b=h.useRef({x:0,y:0}),A=h.useRef({x:0,y:0}),p=h.useMemo(()=>{switch(n){case Zc.Pointer:return s?{top:s.y,bottom:s.y,left:s.x,right:s.x}:null;case Zc.DraggableRect:return r}},[n,r,s]),y=h.useRef(null),Z=h.useCallback(()=>{const v=y.current;if(!v)return;const B=b.current.x*A.current.x,R=b.current.y*A.current.y;v.scrollBy(B,R)},[]),G=h.useMemo(()=>l===TC.TreeOrder?[...g].reverse():g,[l,g]);h.useEffect(()=>{if(!o||!g.length||!p){f();return}for(const v of G){if((i==null?void 0:i(v))===!1)continue;const B=g.indexOf(v),R=c[B];if(!R)continue;const{direction:X,speed:W}=hte(v,R,p,t,I);for(const V of["x","y"])C[V][X[V]]||(W[V]=0,X[V]=0);if(W.x>0||W.y>0){f(),y.current=v,m(Z,a),b.current=W,A.current=X;return}}b.current={x:0,y:0},A.current={x:0,y:0},f()},[t,Z,i,f,o,a,JSON.stringify(p),JSON.stringify(C),m,g,G,c,JSON.stringify(I)])}const kte={x:{[wn.Backward]:!1,[wn.Forward]:!1},y:{[wn.Backward]:!1,[wn.Forward]:!1}};function Vte(e){let{delta:t,disabled:n}=e;const i=e0(t);return Du(r=>{if(n||!i||!r)return kte;const o={x:Math.sign(t.x-i.x),y:Math.sign(t.y-i.y)};return{x:{[wn.Backward]:r.x[wn.Backward]||o.x===-1,[wn.Forward]:r.x[wn.Forward]||o.x===1},y:{[wn.Backward]:r.y[wn.Backward]||o.y===-1,[wn.Forward]:r.y[wn.Forward]||o.y===1}}},[n,t,i])}function wte(e,t){const n=t!=null?e.get(t):void 0,i=n?n.node.current:null;return Du(r=>{var o;return t==null?null:(o=i??r)!=null?o:null},[i,t])}function xte(e,t){return h.useMemo(()=>e.reduce((n,i)=>{const{sensor:r}=i,o=r.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,i)}));return[...n,...o]},[]),[e,t])}var Au;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Au||(Au={}));var r0;(function(e){e.Optimized="optimized"})(r0||(r0={}));const BW=new Map;function Xte(e,t){let{dragging:n,dependencies:i,config:r}=t;const[o,a]=h.useState(null),{frequency:l,measure:s,strategy:g}=r,c=h.useRef(e),u=b(),I=mu(u),C=h.useCallback(function(A){A===void 0&&(A=[]),!I.current&&a(p=>p===null?A:p.concat(A.filter(y=>!p.includes(y))))},[I]),m=h.useRef(null),f=Du(A=>{if(u&&!n)return BW;if(!A||A===BW||c.current!==e||o!=null){const p=new Map;for(let y of e){if(!y)continue;if(o&&o.length>0&&!o.includes(y.id)&&y.rect.current){p.set(y.id,y.rect.current);continue}const Z=y.node.current,G=Z?new KZ(s(Z),Z):null;y.rect.current=G,G&&p.set(y.id,G)}return p}return A},[e,o,n,u,s]);return h.useEffect(()=>{c.current=e},[e]),h.useEffect(()=>{u||C()},[n,u]),h.useEffect(()=>{o&&o.length>0&&a(null)},[JSON.stringify(o)]),h.useEffect(()=>{u||typeof l!="number"||m.current!==null||(m.current=setTimeout(()=>{C(),m.current=null},l))},[l,u,C,...i]),{droppableRects:f,measureDroppableContainers:C,measuringScheduled:o!=null};function b(){switch(g){case Au.Always:return!1;case Au.BeforeDragging:return n;default:return!n}}}function $J(e,t){return Du(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Jte(e,t){return $J(e,t)}function Yte(e){let{callback:t,disabled:n}=e;const i=NZ(t),r=h.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(i)},[i,n]);return h.useEffect(()=>()=>r==null?void 0:r.disconnect(),[r]),r}function Wm(e){let{callback:t,disabled:n}=e;const i=NZ(t),r=h.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(i)},[n]);return h.useEffect(()=>()=>r==null?void 0:r.disconnect(),[r]),r}function Nte(e){return new KZ(gg(e),e)}function RW(e,t,n){t===void 0&&(t=Nte);const[i,r]=h.useState(null);function o(){r(s=>{if(!e)return null;if(e.isConnected===!1){var g;return(g=s??n)!=null?g:null}const c=t(e);return JSON.stringify(s)===JSON.stringify(c)?s:c})}const a=Yte({callback(s){if(e)for(const g of s){const{type:c,target:u}=g;if(c==="childList"&&u instanceof HTMLElement&&u.contains(e)){o();break}}}}),l=Wm({callback:o});return Kr(()=>{o(),e?(l==null||l.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),a==null||a.disconnect())},[e]),i}function Hte(e){const t=$J(e);return DJ(e,t)}const WW=[];function Fte(e){const t=h.useRef(e),n=Du(i=>e?i&&i!==WW&&e&&t.current&&e.parentNode===t.current.parentNode?i:FZ(e):WW,[e]);return h.useEffect(()=>{t.current=e},[e]),n}function Kte(e){const[t,n]=h.useState(null),i=h.useRef(e),r=h.useCallback(o=>{const a=cf(o.target);a&&n(l=>l?(l.set(a,n0(a)),new Map(l)):null)},[]);return h.useEffect(()=>{const o=i.current;if(e!==o){a(o);const l=e.map(s=>{const g=cf(s);return g?(g.addEventListener("scroll",r,{passive:!0}),[g,n0(g)]):null}).filter(s=>s!=null);n(l.length?new Map(l):null),i.current=e}return()=>{a(e),a(o)};function a(l){l.forEach(s=>{const g=cf(s);g==null||g.removeEventListener("scroll",r)})}},[r,e]),h.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,a)=>ps(o,a),yr):_J(e):yr,[e,t])}function kW(e,t){t===void 0&&(t=[]);const n=h.useRef(null);return h.useEffect(()=>{n.current=null},t),h.useEffect(()=>{const i=e!==yr;i&&!n.current&&(n.current=e),!i&&n.current&&(n.current=null)},[e]),n.current?LC(e,n.current):yr}function Ete(e){h.useEffect(()=>{if(!Bm)return;const t=e.map(n=>{let{sensor:i}=n;return i.setup==null?void 0:i.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Mte(e,t){return h.useMemo(()=>e.reduce((n,i)=>{let{eventName:r,handler:o}=i;return n[r]=a=>{o(a,t)},n},{}),[e,t])}function eY(e){return h.useMemo(()=>e?ute(e):null,[e])}const VW=[];function zte(e,t){t===void 0&&(t=gg);const[n]=e,i=eY(n?Gi(n):null),[r,o]=h.useState(VW);function a(){o(()=>e.length?e.map(s=>QJ(s)?i:new KZ(t(s),s)):VW)}const l=Wm({callback:a});return Kr(()=>{l==null||l.disconnect(),a(),e.forEach(s=>l==null?void 0:l.observe(s))},[e]),r}function Lte(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Lu(t)?t:e}function Dte(e){let{measure:t}=e;const[n,i]=h.useState(null),r=h.useCallback(g=>{for(const{target:c}of g)if(Lu(c)){i(u=>{const I=t(c);return u?{...u,width:I.width,height:I.height}:I});break}},[t]),o=Wm({callback:r}),a=h.useCallback(g=>{const c=Lte(g);o==null||o.disconnect(),c&&(o==null||o.observe(c)),i(c?t(c):null)},[t,o]),[l,s]=zC(a);return h.useMemo(()=>({nodeRef:l,rect:n,setRef:s}),[n,l,s])}const Tte=[{sensor:Rm,options:{}},{sensor:qJ,options:{}}],jte={current:{}},Hd={draggable:{measure:ZW},droppable:{measure:ZW,strategy:Au.WhileDragging,frequency:r0.Optimized},dragOverlay:{measure:gg}};class vc extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,i;return(n=(i=this.get(t))==null?void 0:i.node.current)!=null?n:void 0}}const Ute={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new vc,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:DC},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Hd,measureDroppableContainers:DC,windowRect:null,measuringScheduled:!1},Qte={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:DC,draggableNodes:new Map,over:null,measureDroppableContainers:DC},km=h.createContext(Qte),tY=h.createContext(Ute);function Pte(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new vc}}}function _te(e,t){switch(t.type){case vn.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case vn.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case vn.DragEnd:case vn.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case vn.RegisterDroppable:{const{element:n}=t,{id:i}=n,r=new vc(e.droppable.containers);return r.set(i,n),{...e,droppable:{...e.droppable,containers:r}}}case vn.SetDroppableDisabled:{const{id:n,key:i,disabled:r}=t,o=e.droppable.containers.get(n);if(!o||i!==o.key)return e;const a=new vc(e.droppable.containers);return a.set(n,{...o,disabled:r}),{...e,droppable:{...e.droppable,containers:a}}}case vn.UnregisterDroppable:{const{id:n,key:i}=t,r=e.droppable.containers.get(n);if(!r||i!==r.key)return e;const o=new vc(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function Ote(e){let{disabled:t}=e;const{active:n,activatorEvent:i,draggableNodes:r}=h.useContext(km),o=e0(i),a=e0(n==null?void 0:n.id);return h.useEffect(()=>{if(!t&&!i&&o&&a!=null){if(!HZ(o)||document.activeElement===o.target)return;const l=r.get(a);if(!l)return;const{activatorNode:s,node:g}=l;if(!s.current&&!g.current)return;requestAnimationFrame(()=>{for(const c of[s.current,g.current]){if(!c)continue;const u=Lee(c);if(u){u.focus();break}}})}},[i,t,r,a,o]),null}function qte(e,t){let{transform:n,...i}=t;return e!=null&&e.length?e.reduce((r,o)=>o({transform:r,...i}),n):n}function $te(e){return h.useMemo(()=>({draggable:{...Hd.draggable,...e==null?void 0:e.draggable},droppable:{...Hd.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Hd.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function ene(e){let{activeNode:t,measure:n,initialRect:i,config:r=!0}=e;const o=h.useRef(!1),{x:a,y:l}=typeof r=="boolean"?{x:r,y:r}:r;Kr(()=>{if(!a&&!l||!t){o.current=!1;return}if(o.current||!i)return;const g=t==null?void 0:t.node.current;if(!g||g.isConnected===!1)return;const c=n(g),u=DJ(c,i);if(a||(u.x=0),l||(u.y=0),o.current=!0,Math.abs(u.x)>0||Math.abs(u.y)>0){const I=TJ(g);I&&I.scrollBy({top:u.y,left:u.x})}},[t,a,l,i,n])}const nY=h.createContext({...yr,scaleX:1,scaleY:1});var Yo;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Yo||(Yo={}));const iY=h.memo(function(t){var n,i,r,o;let{id:a,accessibility:l,autoScroll:s=!0,children:g,sensors:c=Tte,collisionDetection:u=rte,measuring:I,modifiers:C,...m}=t;const f=h.useReducer(_te,void 0,Pte),[b,A]=f,[p,y]=Pee(),[Z,G]=h.useState(Yo.Uninitialized),v=Z===Yo.Initialized,{draggable:{active:B,nodes:R,translate:X},droppable:{containers:W}}=b,V=B!=null?R.get(B):null,Y=h.useRef({initial:null,translated:null}),K=h.useMemo(()=>{var at;return B!=null?{id:B,data:(at=V==null?void 0:V.data)!=null?at:jte,rect:Y}:null},[B,V]),M=h.useRef(null),[H,w]=h.useState(null),[x,J]=h.useState(null),F=mu(m,Object.values(m)),S=Tu("DndDescribedBy",a),E=h.useMemo(()=>W.getEnabled(),[W]),N=$te(I),{droppableRects:k,measureDroppableContainers:z,measuringScheduled:L}=Xte(E,{dragging:v,dependencies:[X.x,X.y],config:N.droppable}),D=wte(R,B),j=h.useMemo(()=>x?t0(x):null,[x]),ne=Ht(),ie=Jte(D,N.draggable.measure);ene({activeNode:B!=null?R.get(B):null,config:ne.layoutShiftCompensation,initialRect:ie,measure:N.draggable.measure});const ae=RW(D,N.draggable.measure,ie),Re=RW(D?D.parentElement:null),de=h.useRef({activatorEvent:null,active:null,activeNode:D,collisionRect:null,collisions:null,droppableRects:k,draggableNodes:R,draggingNode:null,draggingNodeRect:null,droppableContainers:W,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Q=W.getNodeFor((n=de.current.over)==null?void 0:n.id),O=Dte({measure:N.dragOverlay.measure}),me=(i=O.nodeRef.current)!=null?i:D,Ae=v?(r=O.rect)!=null?r:ae:null,De=!!(O.nodeRef.current&&O.rect),ke=Hte(De?null:ae),xe=eY(me?Gi(me):null),Ee=Fte(v?Q??D:null),We=zte(Ee),ze=qte(C,{transform:{x:X.x-ke.x,y:X.y-ke.y,scaleX:1,scaleY:1},activatorEvent:x,active:K,activeNodeRect:ae,containerNodeRect:Re,draggingNodeRect:Ae,over:de.current.over,overlayNodeRect:O.rect,scrollableAncestors:Ee,scrollableAncestorRects:We,windowRect:xe}),Ge=j?ps(j,X):null,it=Kte(Ee),Pe=kW(it),U=kW(it,[ae]),oe=ps(ze,Pe),P=Ae?lte(Ae,ze):null,re=K&&P?u({active:K,collisionRect:P,droppableRects:k,droppableContainers:E,pointerCoordinates:Ge}):null,ve=nte(re,"id"),[Fe,Te]=h.useState(null),Xe=De?ze:ps(ze,U),Ye=ote(Xe,(o=Fe==null?void 0:Fe.rect)!=null?o:null,ae),qe=h.useRef(null),$e=h.useCallback((at,je)=>{let{sensor:Ke,options:rt}=je;if(M.current==null)return;const Be=R.get(M.current);if(!Be)return;const fe=at.nativeEvent,be=new Ke({active:M.current,activeNode:Be,event:fe,options:rt,context:de,onAbort(ee){if(!R.get(ee))return;const{onDragAbort:q}=F.current,ge={id:ee};q==null||q(ge),p({type:"onDragAbort",event:ge})},onPending(ee,le,q,ge){if(!R.get(ee))return;const{onDragPending:Ze}=F.current,Ce={id:ee,constraint:le,initialCoordinates:q,offset:ge};Ze==null||Ze(Ce),p({type:"onDragPending",event:Ce})},onStart(ee){const le=M.current;if(le==null)return;const q=R.get(le);if(!q)return;const{onDragStart:ge}=F.current,pe={activatorEvent:fe,active:{id:le,data:q.data,rect:Y}};_i.unstable_batchedUpdates(()=>{ge==null||ge(pe),G(Yo.Initializing),A({type:vn.DragStart,initialCoordinates:ee,active:le}),p({type:"onDragStart",event:pe}),w(qe.current),J(fe)})},onMove(ee){A({type:vn.DragMove,coordinates:ee})},onEnd:T(vn.DragEnd),onCancel:T(vn.DragCancel)});qe.current=be;function T(ee){return async function(){const{active:q,collisions:ge,over:pe,scrollAdjustedTranslate:Ze}=de.current;let Ce=null;if(q&&Ze){const{cancelDrop:we}=F.current;Ce={activatorEvent:fe,active:q,collisions:ge,delta:Ze,over:pe},ee===vn.DragEnd&&typeof we=="function"&&await Promise.resolve(we(Ce))&&(ee=vn.DragCancel)}M.current=null,_i.unstable_batchedUpdates(()=>{A({type:ee}),G(Yo.Uninitialized),Te(null),w(null),J(null),qe.current=null;const we=ee===vn.DragEnd?"onDragEnd":"onDragCancel";if(Ce){const Se=F.current[we];Se==null||Se(Ce),p({type:we,event:Ce})}})}}},[R]),et=h.useCallback((at,je)=>(Ke,rt)=>{const Be=Ke.nativeEvent,fe=R.get(rt);if(M.current!==null||!fe||Be.dndKit||Be.defaultPrevented)return;const be={active:fe};at(Ke,je.options,be)===!0&&(Be.dndKit={capturedBy:je.sensor},M.current=rt,$e(Ke,je))},[R,$e]),Oe=xte(c,et);Ete(c),Kr(()=>{ae&&Z===Yo.Initializing&&G(Yo.Initialized)},[ae,Z]),h.useEffect(()=>{const{onDragMove:at}=F.current,{active:je,activatorEvent:Ke,collisions:rt,over:Be}=de.current;if(!je||!Ke)return;const fe={active:je,activatorEvent:Ke,collisions:rt,delta:{x:oe.x,y:oe.y},over:Be};_i.unstable_batchedUpdates(()=>{at==null||at(fe),p({type:"onDragMove",event:fe})})},[oe.x,oe.y]),h.useEffect(()=>{const{active:at,activatorEvent:je,collisions:Ke,droppableContainers:rt,scrollAdjustedTranslate:Be}=de.current;if(!at||M.current==null||!je||!Be)return;const{onDragOver:fe}=F.current,be=rt.get(ve),T=be&&be.rect.current?{id:be.id,rect:be.rect.current,data:be.data,disabled:be.disabled}:null,ee={active:at,activatorEvent:je,collisions:Ke,delta:{x:Be.x,y:Be.y},over:T};_i.unstable_batchedUpdates(()=>{Te(T),fe==null||fe(ee),p({type:"onDragOver",event:ee})})},[ve]),Kr(()=>{de.current={activatorEvent:x,active:K,activeNode:D,collisionRect:P,collisions:re,droppableRects:k,draggableNodes:R,draggingNode:me,draggingNodeRect:Ae,droppableContainers:W,over:Fe,scrollableAncestors:Ee,scrollAdjustedTranslate:oe},Y.current={initial:Ae,translated:P}},[K,D,re,P,R,me,Ae,k,W,Fe,Ee,oe]),Wte({...ne,delta:X,draggingRect:P,pointerCoordinates:Ge,scrollableAncestors:Ee,scrollableAncestorRects:We});const xt=h.useMemo(()=>({active:K,activeNode:D,activeNodeRect:ae,activatorEvent:x,collisions:re,containerNodeRect:Re,dragOverlay:O,draggableNodes:R,droppableContainers:W,droppableRects:k,over:Fe,measureDroppableContainers:z,scrollableAncestors:Ee,scrollableAncestorRects:We,measuringConfiguration:N,measuringScheduled:L,windowRect:xe}),[K,D,ae,x,re,Re,O,R,W,k,Fe,z,Ee,We,N,L,xe]),Dt=h.useMemo(()=>({activatorEvent:x,activators:Oe,active:K,activeNodeRect:ae,ariaDescribedById:{draggable:S},dispatch:A,draggableNodes:R,over:Fe,measureDroppableContainers:z}),[x,Oe,K,ae,A,S,R,Fe,z]);return ce.createElement(EJ.Provider,{value:y},ce.createElement(km.Provider,{value:Dt},ce.createElement(tY.Provider,{value:xt},ce.createElement(nY.Provider,{value:Ye},g)),ce.createElement(Ote,{disabled:(l==null?void 0:l.restoreFocus)===!1})),ce.createElement(qee,{...l,hiddenTextDescribedById:S}));function Ht(){const at=(H==null?void 0:H.autoScrollEnabled)===!1,je=typeof s=="object"?s.enabled===!1:s===!1,Ke=v&&!at&&!je;return typeof s=="object"?{...s,enabled:Ke}:{enabled:Ke}}}),tne=h.createContext(null),wW="button",nne="Draggable";function ine(e){let{id:t,data:n,disabled:i=!1,attributes:r}=e;const o=Tu(nne),{activators:a,activatorEvent:l,active:s,activeNodeRect:g,ariaDescribedById:c,draggableNodes:u,over:I}=h.useContext(km),{role:C=wW,roleDescription:m="draggable",tabIndex:f=0}=r??{},b=(s==null?void 0:s.id)===t,A=h.useContext(b?nY:tne),[p,y]=zC(),[Z,G]=zC(),v=Mte(a,t),B=mu(n);Kr(()=>(u.set(t,{id:t,key:o,node:p,activatorNode:Z,data:B}),()=>{const X=u.get(t);X&&X.key===o&&u.delete(t)}),[u,t]);const R=h.useMemo(()=>({role:C,tabIndex:f,"aria-disabled":i,"aria-pressed":b&&C===wW?!0:void 0,"aria-roledescription":m,"aria-describedby":c.draggable}),[i,C,f,b,m,c.draggable]);return{active:s,activatorEvent:l,activeNodeRect:g,attributes:R,isDragging:b,listeners:i?void 0:v,node:p,over:I,setNodeRef:y,setActivatorNodeRef:G,transform:A}}function rne(){return h.useContext(tY)}const one="Droppable",ane={timeout:25};function lne(e){let{data:t,disabled:n=!1,id:i,resizeObserverConfig:r}=e;const o=Tu(one),{active:a,dispatch:l,over:s,measureDroppableContainers:g}=h.useContext(km),c=h.useRef({disabled:n}),u=h.useRef(!1),I=h.useRef(null),C=h.useRef(null),{disabled:m,updateMeasurementsFor:f,timeout:b}={...ane,...r},A=mu(f??i),p=h.useCallback(()=>{if(!u.current){u.current=!0;return}C.current!=null&&clearTimeout(C.current),C.current=setTimeout(()=>{g(Array.isArray(A.current)?A.current:[A.current]),C.current=null},b)},[b]),y=Wm({callback:p,disabled:m||!a}),Z=h.useCallback((R,X)=>{y&&(X&&(y.unobserve(X),u.current=!1),R&&y.observe(R))},[y]),[G,v]=zC(Z),B=mu(t);return h.useEffect(()=>{!y||!G.current||(y.disconnect(),u.current=!1,y.observe(G.current))},[G,y]),h.useEffect(()=>(l({type:vn.RegisterDroppable,element:{id:i,key:o,disabled:n,node:G,rect:I,data:B}}),()=>l({type:vn.UnregisterDroppable,key:o,id:i})),[i]),h.useEffect(()=>{n!==c.current.disabled&&(l({type:vn.SetDroppableDisabled,id:i,key:o,disabled:n}),c.current.disabled=n)},[i,o,n,l]),{active:a,rect:I,isOver:(s==null?void 0:s.id)===i,node:G,over:s,setNodeRef:v}}function Vm(e,t,n){const i=e.slice();return i.splice(n<0?i.length+n:n,0,i.splice(t,1)[0]),i}function sne(e,t){return e.reduce((n,i,r)=>{const o=t.get(i);return o&&(n[r]=o),n},Array(e.length))}function QI(e){return e!==null&&e>=0}function gne(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function cne(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const rY=e=>{let{rects:t,activeIndex:n,overIndex:i,index:r}=e;const o=Vm(t,i,n),a=t[r],l=o[r];return!l||!a?null:{x:l.left-a.left,y:l.top-a.top,scaleX:l.width/a.width,scaleY:l.height/a.height}},PI={scaleX:1,scaleY:1},oY=e=>{var t;let{activeIndex:n,activeNodeRect:i,index:r,rects:o,overIndex:a}=e;const l=(t=o[n])!=null?t:i;if(!l)return null;if(r===n){const g=o[a];return g?{x:0,y:n<a?g.top+g.height-(l.top+l.height):g.top-l.top,...PI}:null}const s=une(o,r,n);return r>n&&r<=a?{x:0,y:-l.height-s,...PI}:r<n&&r>=a?{x:0,y:l.height+s,...PI}:{x:0,y:0,...PI}};function une(e,t,n){const i=e[t],r=e[t-1],o=e[t+1];return i?n<t?r?i.top-(r.top+r.height):o?o.top-(i.top+i.height):0:o?o.top-(i.top+i.height):r?i.top-(r.top+r.height):0:0}const aY="Sortable",lY=ce.createContext({activeIndex:-1,containerId:aY,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:rY,disabled:{draggable:!1,droppable:!1}});function sY(e){let{children:t,id:n,items:i,strategy:r=rY,disabled:o=!1}=e;const{active:a,dragOverlay:l,droppableRects:s,over:g,measureDroppableContainers:c}=rne(),u=Tu(aY,n),I=l.rect!==null,C=h.useMemo(()=>i.map(v=>typeof v=="object"&&"id"in v?v.id:v),[i]),m=a!=null,f=a?C.indexOf(a.id):-1,b=g?C.indexOf(g.id):-1,A=h.useRef(C),p=!gne(C,A.current),y=b!==-1&&f===-1||p,Z=cne(o);Kr(()=>{p&&m&&c(C)},[p,C,m,c]),h.useEffect(()=>{A.current=C},[C]);const G=h.useMemo(()=>({activeIndex:f,containerId:u,disabled:Z,disableTransforms:y,items:C,overIndex:b,useDragOverlay:I,sortedRects:sne(C,s),strategy:r}),[f,u,Z.draggable,Z.droppable,y,C,b,s,I,r]);return ce.createElement(lY.Provider,{value:G},t)}const Ine=e=>{let{id:t,items:n,activeIndex:i,overIndex:r}=e;return Vm(n,i,r).indexOf(t)},dne=e=>{let{containerId:t,isSorting:n,wasDragging:i,index:r,items:o,newIndex:a,previousItems:l,previousContainerId:s,transition:g}=e;return!g||!i||l!==o&&r===a?!1:n?!0:a!==r&&t===s},Cne={duration:200,easing:"ease"},gY="transform",hne=Fs.Transition.toString({property:gY,duration:0,easing:"linear"}),mne={roleDescription:"sortable"};function Ane(e){let{disabled:t,index:n,node:i,rect:r}=e;const[o,a]=h.useState(null),l=h.useRef(n);return Kr(()=>{if(!t&&n!==l.current&&i.current){const s=r.current;if(s){const g=gg(i.current,{ignoreTransform:!0}),c={x:s.left-g.left,y:s.top-g.top,scaleX:s.width/g.width,scaleY:s.height/g.height};(c.x||c.y)&&a(c)}}n!==l.current&&(l.current=n)},[t,n,i,r]),h.useEffect(()=>{o&&a(null)},[o]),o}function cY(e){let{animateLayoutChanges:t=dne,attributes:n,disabled:i,data:r,getNewIndex:o=Ine,id:a,strategy:l,resizeObserverConfig:s,transition:g=Cne}=e;const{items:c,containerId:u,activeIndex:I,disabled:C,disableTransforms:m,sortedRects:f,overIndex:b,useDragOverlay:A,strategy:p}=h.useContext(lY),y=fne(i,C),Z=c.indexOf(a),G=h.useMemo(()=>({sortable:{containerId:u,index:Z,items:c},...r}),[u,r,Z,c]),v=h.useMemo(()=>c.slice(c.indexOf(a)),[c,a]),{rect:B,node:R,isOver:X,setNodeRef:W}=lne({id:a,data:G,disabled:y.droppable,resizeObserverConfig:{updateMeasurementsFor:v,...s}}),{active:V,activatorEvent:Y,activeNodeRect:K,attributes:M,setNodeRef:H,listeners:w,isDragging:x,over:J,setActivatorNodeRef:F,transform:S}=ine({id:a,data:G,attributes:{...mne,...n},disabled:y.draggable}),E=Kee(W,H),N=!!V,k=N&&!m&&QI(I)&&QI(b),z=!A&&x,L=z&&k?S:null,j=k?L??(l??p)({rects:f,activeNodeRect:K,activeIndex:I,overIndex:b,index:Z}):null,ne=QI(I)&&QI(b)?o({id:a,items:c,activeIndex:I,overIndex:b}):Z,ie=V==null?void 0:V.id,ae=h.useRef({activeId:ie,items:c,newIndex:ne,containerId:u}),Re=c!==ae.current.items,de=t({active:V,containerId:u,isDragging:x,isSorting:N,id:a,index:Z,items:c,newIndex:ae.current.newIndex,previousItems:ae.current.items,previousContainerId:ae.current.containerId,transition:g,wasDragging:ae.current.activeId!=null}),Q=Ane({disabled:!de,index:Z,node:R,rect:B});return h.useEffect(()=>{N&&ae.current.newIndex!==ne&&(ae.current.newIndex=ne),u!==ae.current.containerId&&(ae.current.containerId=u),c!==ae.current.items&&(ae.current.items=c)},[N,ne,u,c]),h.useEffect(()=>{if(ie===ae.current.activeId)return;if(ie!=null&&ae.current.activeId==null){ae.current.activeId=ie;return}const me=setTimeout(()=>{ae.current.activeId=ie},50);return()=>clearTimeout(me)},[ie]),{active:V,activeIndex:I,attributes:M,data:G,rect:B,index:Z,newIndex:ne,items:c,isOver:X,isSorting:N,isDragging:x,listeners:w,node:R,overIndex:b,over:J,setNodeRef:E,setActivatorNodeRef:F,setDroppableNodeRef:W,setDraggableNodeRef:H,transform:Q??j,transition:O()};function O(){if(Q||Re&&ae.current.newIndex===Z)return hne;if(!(z&&!HZ(Y)||!g)&&(N||de))return Fs.Transition.toString({...g,property:gY})}}function fne(e,t){var n,i;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(i=e==null?void 0:e.droppable)!=null?i:t.droppable}}vt.Down,vt.Right,vt.Up,vt.Left;const pne=({id:e,recipe:t})=>{const{attributes:n,listeners:i,setNodeRef:r,transform:o,transition:a}=cY({id:e}),l={transform:Fs.Transform.toString(o),transition:a,padding:"10px",border:"1px solid #ccc",borderRadius:"5px",marginBottom:"10px",background:"#f9f9f9",display:"flex",alignItems:"center"};return d.jsxs("li",{ref:r,style:l,...n,children:[d.jsx("span",{...i,style:{cursor:"grab",fontSize:"20px",marginRight:"10px",touchAction:"none"},className:"drag-handle",children:"☰"}),d.jsx("img",{src:`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${t.image_path}`,alt:t.name,style:{width:"50px",height:"50px",borderRadius:"5px",marginRight:"10px"}}),d.jsx("span",{children:t.name})]})},bne=({recipes:e,setRecipes:t})=>{const n=zJ(MJ(Rm,{activationConstraint:{distance:10}})),i=r=>{const{active:o,over:a}=r;if(o.id!==(a==null?void 0:a.id)){const l=Vm(e,e.findIndex(s=>s.id===o.id),e.findIndex(s=>s.id===a.id));t(l)}};return d.jsx(iY,{sensors:n,collisionDetection:LJ,onDragEnd:i,children:d.jsx(sY,{items:e.map(r=>r.id),strategy:oY,children:d.jsx("ul",{style:{listStyleType:"none",padding:0},children:e.map(r=>d.jsx(pne,{id:r.id,recipe:r},r.id))})})})},yne=()=>{var je,Ke,rt,Be,fe,be;const{fetchMealPlansByDate:e,fetchRecipesByIds:t,fetchRecipeIngredients:n,fetchRecipeSteps:i,fetchUserInventory:r,mealTypes:o,getStatusIdByName:a,fetchInventoryMealPlanData:l,fetchInventoryMealPlanByMealPlanId:s,enrichInventory:g,fetchInventoryData:c}=rg(),u=Gt();Aa();const I=yi(),{planned_date:C,meal_type_id:m}=I.state||{},[f,b]=h.useState(0),[A,p]=h.useState([]),[y,Z]=h.useState(!0),[G,v]=h.useState(!1),[B,R]=h.useState([]),[X,W]=h.useState([]),[V,Y]=h.useState(null),[K,M]=h.useState([]),[H,w]=h.useState([]),[x,J]=h.useState(!1),F=Math.max(0,(H||[]).reduce((T,ee)=>T+ee.selectedQuantity,0)-((V==null?void 0:V.quantity)||0)),[S,E]=h.useState([]),[N,k]=h.useState(null),[z,L]=h.useState([]),[D,j]=h.useState([]),[ne,ie]=h.useState([]),[ae,Re]=h.useState(!1),[de,Q]=h.useState([]),[O,me]=h.useState(!1),[Ae,De]=h.useState(0),[ke,xe]=h.useState(null);h.useEffect(()=>{C&&m&&(async()=>{try{Z(!0);const[ee,le]=await Promise.all([e(C),c({plannedDate:C})]),q=ee.filter(Se=>Se.meal_type_id===m);if(L(q),q.length===0){console.warn("No meal plans found for the given date and meal type."),p([]),R([]),j(le);return}const ge=q.map(Se=>Se.recipe_id),pe=await t(ge);p(pe);const Ze=await Promise.all(pe.map(async Se=>{const lt=await n(Se.id);return{recipeId:Se.id,ingredients:lt}}));R(Ze);const Ce=q.map(Se=>Se.id);E(Ce);const we=await s(Ce);j(le)}catch(ee){console.error("Error loading data:",ee.message)}finally{Z(!1)}})()},[C,m,e,t,n,c,f]),h.useEffect(()=>{H.length>0&&Ye()},[H]),h.useEffect(()=>{F>0&&$e()},[F]),h.useEffect(()=>{(async()=>{var ee;if(A.length>0){const le=(ee=A[0])==null?void 0:ee.id,q=await i(le);Q(q)}})()},[A,i]);const Ee=()=>{v(!0)},We=()=>{v(!1)},ze=()=>{v(!1)},Ge=(T,ee)=>{const le=T.quantity,q=[...ee].sort((Ce,we)=>{var Rt,cn;const Se=new Date(((Rt=Ce.expiry_date)==null?void 0:Rt.date)||"9999-12-31"),lt=new Date(((cn=we.expiry_date)==null?void 0:cn.date)||"9999-12-31");return Se-lt!==0?Se-lt:Ce.quantity-we.quantity});let ge=le;const pe=[];for(let Ce=0;Ce<q.length;Ce++){const we=q[Ce];if(we.quantity>=ge){pe.push({...we,selectedQuantity:ge,preselected:!0}),ge=0;break}if(pe.push({...we,selectedQuantity:we.quantity,preselected:!0}),ge-=we.quantity,ge<=0)break}return q.map(Ce=>{const we=pe.find(Se=>Se.id===Ce.id);return we||{...Ce,preselected:!1,selectedQuantity:0}})},it=(T,ee)=>(console.log("Processing Linked Inventory for Preselection:",T),T.map(q=>q.inventory_id),ee.map(q=>{const ge=T.find(pe=>pe.inventory_id===q.id);return console.log("Linked Item:",ge),ge?{...q,selectedQuantity:ge.used_quantity,preselected:!0}:{...q,selectedQuantity:0,preselected:!1}})),Pe=async(T,ee)=>{try{console.log("recipe id",ee),Y(T),M([]),w([]),J(!1);const le=await r(T.ingredients.id);if(le.length===0){console.warn("No inventory available for this ingredient."),J(!1);return}const ge=(await s(S)).filter(Ce=>{var we;return Ce.inventory.ingredient_id===T.ingredients.id&&((we=Ce.meal_plan)==null?void 0:we.recipe_id)===ee});let pe;ge.length>0?(pe=it(ge,le),Re(!0)):(pe=Ge(T,le),Re(!1));const Ze=pe.map(Ce=>{const we=H.find(Se=>Se.id===Ce.id);return we?{...Ce,selectedQuantity:we.selectedQuantity,preselected:we.preselected}:Ce});M(le),w(Ze),k(T.quantity),J(!0)}catch(le){console.error("Error fetching inventory for ingredient:",le.message)}},U=T=>{console.log("Before toggle:",H),w(ee=>ee.find(q=>q.id===T.id)?ee.map(q=>q.id===T.id?{...q,preselected:!q.preselected}:q):[...ee,{...T,selectedQuantity:T.selectedQuantity||1,preselected:!0}])},oe=()=>{var le;const T=H.filter(q=>q.preselected),ee=T.reduce((q,ge)=>q+ge.quantity,0);if(console.log("Currently Selected Inventory:",T),console.log("Total Selected Quantity:",ee),T.length===0||ee<V.quantity){alert(`You must select at least one item to proceed. Now you have selected ${ee} ${((le=V.ingredients.unit)==null?void 0:le.unit_tag)||""}.`);return}w(q=>q.map(ge=>T.find(pe=>pe.id===ge.id)?{...ge,selectedQuantity:ge.selectedQuantity||ge.quantity}:ge)),J(!0)},P=(T,ee)=>{w(le=>{const q=le||[],ge=V.quantity;let pe=q.reduce((Ce,we)=>Ce+we.selectedQuantity,0);const Ze=q.map(Ce=>{if(Ce.id===T){const we=Math.max(1,Math.min(Ce.selectedQuantity+ee,Ce.quantity));return pe+=we-Ce.selectedQuantity,{...Ce,selectedQuantity:we}}return Ce});if(pe>ge){const Ce=pe-ge;return ve(Ze,T,Ce)}return Ze})},re=(T,ee)=>{w(le=>{V.quantity;const q=Math.max(1,parseInt(ee)||1);return le.map(pe=>pe.id===T?q>pe.quantity?(alert(`You cannot exceed the available quantity of ${pe.quantity}.`),pe):{...pe,selectedQuantity:q}:pe)})},ve=(T,ee,le)=>T.map(q=>{if(q.id===ee||le<=0)return q;const ge=Math.min(q.selectedQuantity,le);return le-=ge,{...q,selectedQuantity:q.selectedQuantity-ge}}),Fe=async()=>{try{if(!V||!H||H.length===0){console.warn("Ingredient or inventory selection is missing.");return}const T=H.filter(Ze=>Ze.selectedQuantity>0);if(T.length===0){alert("No valid inventory selected. Please select quantities to proceed.");return}const ee=await a("Planning");if(!ee){alert("Failed to fetch status ID for 'Planning'.");return}const le=await g(T,V,C);for(const Ze of le)if(Ze.selectedQuantity>N){alert(`Selected quantity (${Ze.selectedQuantity}) exceeds the required cap (${N}) for inventory ID ${Ze.id}. Please adjust and try again.`);return}const q=le.map(Ze=>({inventory_id:Ze.id,meal_plan_id:Ze.meal_plan_id,used_quantity:Ze.selectedQuantity,status_id:ee,created_at:new Date().toISOString(),ingredient_id:V.ingredients.id})),{data:ge,error:pe}=await _.from("inventory_meal_plan").insert(q);if(pe)throw pe;Y(null),w([]),J(!1),b(Ze=>Ze+1)}catch(T){console.error("Error finalizing quantities:",T.message),alert("Failed to finalize quantities. Please try again.")}},Te=async()=>{try{if(!V||!H||H.length===0){console.warn("Ingredient or inventory selection is missing.");return}const T=H.filter(ge=>ge.selectedQuantity>0);if(T.length===0){alert("No valid inventory selected. Please select quantities to proceed.");return}console.log("Filtered Inventory:",T);const le=(await g(T,V,C)).map(ge=>(console.log("Updating row with the following details:",{meal_plan_id:ge.meal_plan_id,inventory_id:ge.inventory_id,ingredient_id:V.ingredients.id,used_quantity:ge.selectedQuantity}),_.from("inventory_meal_plan").update({used_quantity:ge.selectedQuantity,updated_at:new Date().toISOString()}).eq("meal_plan_id",ge.meal_plan_id).eq("inventory_id",ge.id).eq("ingredient_id",V.ingredients.id)));(await Promise.all(le)).forEach(({data:ge,error:pe},Ze)=>{pe?console.error(`Error updating row ${Ze+1}:`,pe.message):console.log(`Update successful for row ${Ze+1}:`,ge)}),console.log("Updated Quantities Successfully using meal_plan_id, inventory_id, and ingredient_id!"),Y(null),w([]),J(!1),b(ge=>ge+1)}catch(T){console.error("Error updating quantities:",T.message),alert("Failed to update quantities. Please try again.")}},Xe=async(T,ee,le)=>{try{const{data:q,error:ge}=await _.from("inventory_meal_plan").delete().eq("inventory_id",T).eq("meal_plan_id",ee).eq("ingredient_id",le);if(ge){console.error("Error deleting inventory:",ge.message),alert("Failed to delete the inventory item. Please try again.");return}console.log("Deleted inventory:",q);const pe=ne.filter(Ze=>Ze.inventory_id!==T||Ze.meal_plan_id!==ee||Ze.ingredient_id!==le);ie(pe),b(Ze=>Ze+1)}catch(q){console.error("Unexpected error deleting inventory:",q.message),alert("Failed to delete the inventory item. Please try again.")}},Ye=()=>{const T=X.map(ee=>{let le=ee.quantity;const q=ee.recipes.map(ge=>{const pe=Math.min(le,ge.quantity);return le-=pe,{recipeId:ge.recipeId,quantity:pe}});return{...ee,recipes:q}});W(T)};if(y)return d.jsx("div",{children:"Loading preparation details..."});if(A.length===0)return d.jsx("div",{children:"No recipes found for this meal plan."});const qe=()=>{let T=V.quantity;const ee=(H||[]).map(le=>{if(!le.preselected||T<=0)return{...le,selectedQuantity:0};const q=Math.min(le.quantity,T);return T-=q,{...le,selectedQuantity:q}});w(ee),T>0&&alert(`Not enough inventory to fulfill the required amount of ${V.quantity}.`)},$e=()=>{Y(T=>{if(!T||!T.recipes||T.recipes.length===0)return console.warn("No recipes found to allocate exceed."),T;const ee=Math.max(0,H.reduce((Ze,Ce)=>Ze+Ce.selectedQuantity,0)-T.quantity);if(ee<=0)return console.log("No exceed to allocate."),T;console.log("Total Exceed to Allocate:",ee);const le=T.recipes.length,q=Math.floor(ee/le);let ge=ee%le;const pe=T.recipes.map((Ze,Ce)=>{let we=q;return ge>0&&(we+=1,ge-=1),{...Ze,exceedAllocation:we}});return console.log("Updated Recipes with Exceed Allocation:",pe),{...T,recipes:pe}})},et=async()=>{var T;try{for(const ee of A){const le=((T=B.find(q=>q.recipeId===ee.id))==null?void 0:T.ingredients)||[];for(const q of le){const ge=await r(q.ingredients.id),pe=(await s(S)).filter(Se=>{var lt;return Se.inventory.ingredient_id===q.ingredients.id&&((lt=Se.meal_plan)==null?void 0:lt.recipe_id)===ee.id});let Ze;pe.length>0?Ze=it(pe,ge):Ze=Ge(q,ge);const Ce=Ze.map(Se=>({...Se,selectedQuantity:Se.selectedQuantity||0,preselected:!0}));Y(q),w(Ce);const we=Ce.filter(Se=>Se.selectedQuantity>0);if(we.length>0){const Se=await a("Planning"),Rt=(await g(we,q,C)).map(Le=>({inventory_id:Le.id,meal_plan_id:Le.meal_plan_id,used_quantity:Le.selectedQuantity,status_id:Se,created_at:new Date().toISOString(),ingredient_id:q.ingredients.id})),{error:cn}=await _.from("inventory_meal_plan").insert(Rt);if(cn)throw cn}}}b(ee=>ee+1),alert("All ingredients have been auto-distributed!")}catch(ee){console.error("Error during auto distribution:",ee.message),alert("Failed to auto-distribute inventory. Please try again.")}},Oe=async()=>{try{if(!S||S.length===0){alert("No meal plans found to delete inventory allocations.");return}if(!window.confirm("Are you sure you want to delete all inventory allocations for this meal plan? This action cannot be undone."))return;const{data:ee,error:le}=await _.from("inventory_meal_plan").delete().in("meal_plan_id",S);if(le)throw le;console.log("Deleted inventory allocations:",ee),ie([]),b(q=>q+1),alert("All inventory allocations have been deleted successfully.")}catch(T){console.error("Error deleting all inventory allocations:",T.message),alert("Failed to delete all inventory allocations. Please try again.")}},xt=()=>{if(O)xe(Ae);else if(ke!==null){const T=window.confirm("Would you like to continue from your last step or start over?");De(T?ke:0)}else De(0);me(T=>!T)},Dt=()=>{Ae<de.length-1&&De(T=>T+1)},Ht=()=>{Ae>0&&De(T=>T-1)},at=async()=>{try{const{data:T,error:ee}=await _.from("inventory_meal_plan").update({status_id:2,updated_at:new Date().toISOString()}).in("meal_plan_id",S);if(ee)throw ee;console.log("Updated inventory_meal_plan:",T);const{data:le,error:q}=await _.from("inventory_meal_plan").select("inventory_id, used_quantity").in("meal_plan_id",S);if(q)throw q;console.log("Affected Rows in inventory_meal_plan:",le);const ge=le.map(async pe=>{const{data:Ze,error:Ce}=await _.from("inventory").select("quantity").eq("id",pe.inventory_id).single();if(Ce)throw Ce;const we=Math.max(0,Ze.quantity-pe.used_quantity),{error:Se}=await _.from("inventory").update({quantity:we,updated_at:new Date().toISOString()}).eq("id",pe.inventory_id);if(Se)throw Se;console.log(`Updated inventory for ID ${pe.inventory_id} to quantity ${we}`)});await Promise.all(ge),alert("Cooking finished, quantities updated, and status set to complete!"),me(!1),De(0),xe(null),b(pe=>pe+1)}catch(T){console.error("Error finishing cooking:",T.message),alert("Failed to finish cooking. Please try again.")}};return d.jsxs("div",{className:"recipe-preparation-page",children:[d.jsx(ba,{onClick:()=>u(-1)}),d.jsx("h1",{children:"Recipe Preparation"}),d.jsxs("h3",{children:["Date: ",C]}),d.jsxs("h3",{children:["Meal Type: ",((je=o.find(T=>T.id===m))==null?void 0:je.name)||"Unknown"]}),d.jsx("button",{onClick:et,style:{padding:"10px 20px",background:"purple",color:"white",borderRadius:"5px",marginTop:"20px"},children:"Auto Distribute All"}),d.jsx("button",{onClick:Oe,style:{padding:"10px 20px",background:"red",color:"white",borderRadius:"5px",marginTop:"20px"},children:"Delete All"}),A.map(T=>{var le;const ee=((le=B.find(q=>q.recipeId===T.id))==null?void 0:le.ingredients)||[];return d.jsxs("div",{className:"recipe-details",children:[d.jsx("h2",{children:T.name}),d.jsx("img",{src:`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${T.image_path}`,alt:T.name,style:{width:"300px",borderRadius:"10px"}}),d.jsx("p",{children:T.description}),d.jsxs("p",{children:[d.jsx("strong",{children:"Prep Time:"})," ",T.prep_time," mins"]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Cook Time:"})," ",T.cook_time," mins"]}),d.jsxs("div",{children:[d.jsx("h3",{children:"Ingredients"}),d.jsx("ul",{children:ee.map((q,ge)=>{var we;const pe=D.filter(Se=>Se.inventory.ingredient_id===q.ingredients.id&&z.some(lt=>lt.id===Se.meal_plan_id)),Ce=pe.reduce((Se,lt)=>Se+lt.used_quantity,0)>=q.quantity;return d.jsxs("li",{onClick:()=>Pe(q,T.id),style:{cursor:"pointer",color:"blue",fontWeight:"bold",fontSize:"16px"},children:[q.ingredients.name," - ",q.quantity," ",((we=q.ingredients.unit)==null?void 0:we.unit_tag)||"",pe.filter(Se=>Se.meal_plan.recipe_id===T.id).length>0&&d.jsxs("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#f8f9fa",border:"1px solid #ccc",borderRadius:"5px"},children:[d.jsxs("h4",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:["Linked Inventory Data"," ",d.jsxs("span",{style:{color:Ce?"green":"red",fontWeight:"bold"},children:["(",Ce?"Complete":"Incomplete",")"]}),d.jsx("button",{onClick:Se=>{Se.stopPropagation(),pe.forEach(lt=>Xe(lt.inventory_id,lt.meal_plan_id,lt.ingredients.id))},style:{marginLeft:"20px",padding:"5px 10px",backgroundColor:"red",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Delete All"})]}),pe.filter(Se=>Se.meal_plan.recipe_id===T.id).map(Se=>{var lt,Rt;return d.jsxs("div",{style:{marginBottom:"10px",padding:"10px",border:"1px solid #ccc",borderRadius:"5px"},children:[d.jsxs("p",{children:[d.jsx("strong",{children:"Original quantity:"})," ",Se.inventory.init_quantity," ",((lt=Se.ingredients.unit)==null?void 0:lt.unit_tag)||""]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Quantity allocated:"})," ",Se.used_quantity," ",((Rt=Se.ingredients.unit)==null?void 0:Rt.unit_tag)||""]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Expiry Date:"})," ",Se.inventory.expiry_date.date||"No expiry date"]}),d.jsxs("p",{children:[Se.inventory.days_left," days left"]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Status:"})," ",Se.inventory_meal_plan_status.name]})]},Se.id)})]})]},ge)})})]})]},T.id)}),d.jsx("button",{onClick:Ee,style:{padding:"10px 20px",background:"orange",color:"white",borderRadius:"5px",marginTop:"20px"},children:"Start Cooking"}),V&&d.jsx("div",{className:"modal-overlay",onClick:()=>Y(null),children:d.jsx("div",{className:"modal-content",onClick:T=>T.stopPropagation(),style:{background:"white",padding:"20px",borderRadius:"10px"},children:x?d.jsxs(d.Fragment,{children:[d.jsxs("h3",{children:["Adjust Quantities for: ",V.ingredients.name]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Required:"})," ",V.quantity," ",((Be=V.ingredients.unit)==null?void 0:Be.unit_tag)||""]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Your Adjusted Total:"})," ",H.filter(T=>T.preselected).reduce((T,ee)=>T+ee.selectedQuantity,0)," ",((fe=V.ingredients.unit)==null?void 0:fe.unit_tag)||""]}),!ae&&d.jsx("button",{onClick:()=>J(!1),style:{marginTop:"10px",padding:"10px 20px",background:"orange",color:"white",borderRadius:"5px"},children:"Back to Select"}),d.jsx("ul",{children:H.filter(T=>T.preselected).map(T=>{var ee,le;return d.jsxs("li",{children:[d.jsxs("label",{children:[T.quantity," ",((ee=T.unit)==null?void 0:ee.unit_tag)||""," (Expiry:"," ",((le=T.expiry_date)==null?void 0:le.date)||"No expiry date",")"]}),d.jsx("button",{onClick:()=>P(T.id,-1),disabled:T.selectedQuantity<=1,style:{margin:"0 5px",backgroundColor:"blue",color:"white"},children:"-"}),d.jsx("input",{type:"number",min:"1",max:T.quantity,value:T.selectedQuantity,onChange:q=>re(T.id,q.target.value),style:{width:"60px",margin:"0 10px",textAlign:"center"}}),d.jsx("button",{onClick:()=>P(T.id,1),disabled:H.filter(q=>q.preselected).length===1&&T.selectedQuantity>=V.quantity||T.selectedQuantity>=T.quantity,style:{margin:"0 5px",backgroundColor:"blue",color:"white"},children:"+"})]},T.id)})}),d.jsx("button",{onClick:()=>Y(null),style:{marginTop:"10px",marginLeft:"10px",padding:"10px 20px",background:"red",color:"white",borderRadius:"5px"},children:"Cancel"}),d.jsx("button",{onClick:qe,style:{marginTop:"10px",padding:"10px 20px",background:"blue",color:"white",borderRadius:"5px"},children:"Auto Adjust Quantities"}),ae?d.jsx("button",{onClick:Te,style:{padding:"10px 20px",background:"blue",color:"white",borderRadius:"5px",marginTop:"20px"},children:"Update Quantities"}):d.jsx("button",{onClick:Fe,style:{padding:"10px 20px",background:"green",color:"white",borderRadius:"5px",marginTop:"20px"},children:"Finalize Quantities"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("h3",{children:["Select Inventory for: ",V.ingredients.name]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Required:"})," ",V.quantity," ",((Ke=V.ingredients.unit)==null?void 0:Ke.unit_tag)||""]}),K.length===0?d.jsxs(d.Fragment,{children:[d.jsx("p",{children:d.jsxs("strong",{children:["No ",V.ingredients.name," in your inventory."]})}),d.jsx("button",{onClick:()=>{u("/recipes/shopping-list")},style:{marginTop:"10px",padding:"10px 20px",background:"orange",color:"white",borderRadius:"5px"},children:"View Missing Ingredients for This Week's Plan"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("p",{children:[d.jsx("strong",{children:"Your Selection:"})," ",H.filter(T=>T.preselected).reduce((T,ee)=>T+ee.quantity,0)," ",((rt=V.ingredients.unit)==null?void 0:rt.unit_tag)||""]}),d.jsx("ul",{children:K.map(T=>{var ee,le,q,ge;return d.jsx("li",{style:{backgroundColor:(ee=H.find(pe=>pe.id===T.id))!=null&&ee.preselected?"lightgreen":"white",padding:"5px",borderRadius:"5px"},children:d.jsxs("label",{children:[d.jsx("input",{type:"checkbox",checked:((le=H.find(pe=>pe.id===T.id))==null?void 0:le.preselected)||!1,onChange:()=>U(T)}),T.quantity||0," ",((q=T.unit)==null?void 0:q.unit_tag)||"unit not specified"," (Expiry:"," ",((ge=T.expiry_date)==null?void 0:ge.date)||"No expiry date",")"]})},T.id)})}),d.jsx("button",{onClick:oe,style:{marginTop:"10px",padding:"10px 20px",background:"green",color:"white",borderRadius:"5px"},children:"Confirm Selection"})]}),d.jsx("button",{onClick:()=>Y(null),style:{marginTop:"10px",marginLeft:"10px",padding:"10px 20px",background:"red",color:"white",borderRadius:"5px"},children:"Cancel"})]})})}),G&&d.jsx("div",{className:"modal-overlay",onClick:ze,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center"},children:d.jsxs("div",{className:"modal-content",onClick:T=>T.stopPropagation(),style:{background:"white",padding:"20px",borderRadius:"10px",width:"400px",maxHeight:"90vh",overflowY:"auto"},children:[d.jsx("h3",{children:"Arrange Cooking Sequence"}),d.jsx(bne,{recipes:A,setRecipes:p}),d.jsxs("div",{style:{marginTop:"20px",display:"flex",justifyContent:"space-between"},children:[d.jsx("button",{onClick:ze,style:{background:"red",color:"white",padding:"10px 20px",borderRadius:"5px"},children:"Cancel"}),d.jsx("button",{onClick:()=>{We(),xt()},style:{background:"green",color:"white",padding:"10px 20px",borderRadius:"5px"},children:"Confirm"})]})]})}),O&&d.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.8)",color:"#fff",zIndex:1e3,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[d.jsxs("h2",{children:["Step ",Ae+1]}),d.jsx("p",{children:(be=de[Ae])==null?void 0:be.instruction}),d.jsxs("div",{style:{marginTop:"20px",display:"flex",gap:"10px"},children:[d.jsx("button",{onClick:Ht,style:{padding:"10px 20px",background:"#007bff",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",visibility:Ae===0?"hidden":"visible"},children:"Previous"}),d.jsx("button",{onClick:Dt,style:{padding:"10px 20px",background:"#007bff",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",visibility:Ae===de.length-1?"hidden":"visible"},children:"Next"}),Ae===de.length-1&&d.jsx("button",{onClick:at,style:{padding:"10px 20px",background:"green",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Finish Cooking"}),d.jsx("button",{onClick:xt,style:{padding:"10px 20px",background:"red",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Exit Cooking Mode"})]})]})]})},Zne=()=>{const{favorites:e,toggleFavorite:t,fetchRecipesByIds:n,loading:i,filters:r,applyFilters:o}=rg(),[a,l]=h.useState([]),[s,g]=h.useState(!0),[c,u]=h.useState([]),[I,C]=h.useState([]),[m,f]=h.useState([]),[b,A]=h.useState(""),[p,y]=h.useState(!1),Z=Gt(),G=async()=>{try{const[{data:B},{data:R},{data:X}]=await Promise.all([_.from("category").select("id, name"),_.from("tags").select("id, name"),_.from("equipment").select("id, name")]);u(B||[]),C(R||[]),f(X||[])}catch(B){console.error("Error fetching filter options:",B)}};h.useEffect(()=>{(async()=>{if(e.length===0){l([]),g(!1);return}try{const R=await n(e);if(R){const X=R.map(W=>{var V,Y;return{...W,tags:((V=W.recipe_tags)==null?void 0:V.map(K=>K.tags.name))||[],equipment:((Y=W.recipe_equipment)==null?void 0:Y.map(K=>K.equipment.name))||[]}});l(X)}else l([])}catch(R){console.error("Error fetching favorite recipes:",R.message),l([])}finally{g(!1)}})(),G()},[e,n]);const v=a.filter(B=>{var K;const R=(K=B.name)==null?void 0:K.toLowerCase().includes(b.toLowerCase()),X=r.categories.length?r.categories.some(M=>(B.categories||[]).includes(M)):!0,W=r.tags.length?r.tags.some(M=>(B.tags||[]).includes(M)):!0,V=r.equipment.length?r.equipment.some(M=>(B.equipment||[]).includes(M)):!0,Y=r.cookTime?B.cook_time<=r.cookTime:!0;return R&&X&&W&&V&&Y});return s||i?d.jsx("div",{children:"Loading your favorite recipes..."}):d.jsxs("div",{style:{padding:"20px"},children:[d.jsx(ba,{}),d.jsx("h1",{children:"Your Favorite Recipes"}),d.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:[d.jsx("input",{type:"text",placeholder:"Search recipes...",value:b,onChange:B=>A(B.target.value),style:{padding:"10px",flex:1,border:"1px solid #ccc",borderRadius:"5px"}}),d.jsx("button",{onClick:()=>y(!0),style:{padding:"10px",background:"#000",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Filters"})]}),v.length>0?v.map(B=>{var R,X;return d.jsxs("div",{onClick:()=>Z(`/recipes/recipe/${B.id}`,{state:{recipe_id:B.id,recipe_name:B.name}}),style:{padding:"10px",border:"1px solid #ddd",marginBottom:"10px",borderRadius:"5px",display:"flex",flexDirection:"column",cursor:"pointer"},children:[d.jsx("img",{src:`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${B.image_path}`,alt:B.name,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"5px",marginBottom:"10px"}}),d.jsxs("div",{children:[d.jsx("h3",{children:B.name}),d.jsx("p",{children:B.description}),d.jsxs("p",{children:["Prep Time: ",B.prep_time," mins"]}),d.jsxs("p",{children:["Cook Time: ",B.cook_time," mins"]}),d.jsx("button",{onClick:W=>{W.stopPropagation(),t(B.id)},style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"24px",marginTop:"10px"},children:e.includes(B.id)?"❤️":"🤍"}),((R=B.tags)==null?void 0:R.length)>0&&d.jsxs("div",{style:{marginTop:"10px"},children:[d.jsx("strong",{children:"Tags:"})," ",B.tags.map((W,V)=>d.jsx("span",{style:{background:"#ffcc00",color:"#000",padding:"5px 10px",marginRight:"5px",borderRadius:"5px",fontSize:"12px"},children:W},V))]}),((X=B.equipment)==null?void 0:X.length)>0&&d.jsxs("div",{style:{marginTop:"10px"},children:[d.jsx("strong",{children:"Equipment:"})," ",B.equipment.map((W,V)=>d.jsx("span",{style:{background:"#000000",color:"#fff",padding:"5px 10px",marginRight:"5px",borderRadius:"3px",fontSize:"12px"},children:W},V))]})]})]},B.id)}):d.jsx("p",{children:"No favorite recipes found. Start adding some!"}),p&&d.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.8)",color:"#fff",display:"flex",flexDirection:"column",zIndex:1e3},children:[d.jsx("button",{onClick:()=>y(!1),style:{position:"absolute",top:"10px",right:"10px",background:"red",color:"#fff",border:"none",borderRadius:"50%",width:"30px",height:"30px",cursor:"pointer"},children:"X"}),d.jsx("h2",{style:{padding:"20px"},children:"Filter Options"}),d.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px"},children:[d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("h3",{children:"Category"}),c.map(B=>d.jsxs("label",{style:{display:"block",marginBottom:"5px"},children:[d.jsx("input",{type:"checkbox",checked:r.categories.includes(B.name),onChange:R=>{const X=R.target.checked;o({categories:X?[...r.categories,B.name]:r.categories.filter(W=>W!==B.name)})}}),B.name]},B.id))]}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("h3",{children:"Tags"}),I.map(B=>d.jsxs("label",{style:{display:"block",marginBottom:"5px"},children:[d.jsx("input",{type:"checkbox",checked:r.tags.includes(B.name),onChange:R=>{const X=R.target.checked;o({tags:X?[...r.tags,B.name]:r.tags.filter(W=>W!==B.name)})}}),B.name]},B.id))]}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("h3",{children:"Equipment"}),m.map(B=>d.jsxs("label",{style:{display:"block",marginBottom:"5px"},children:[d.jsx("input",{type:"checkbox",checked:r.equipment.includes(B.name),onChange:R=>{const X=R.target.checked;o({equipment:X?[...r.equipment,B.name]:r.equipment.filter(W=>W!==B.name)})}}),B.name]},B.id))]}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("h3",{children:"Cooking Time"}),d.jsxs("select",{value:r.cookTime||"",onChange:B=>o({cookTime:B.target.value?Number(B.target.value):null}),style:{padding:"10px",borderRadius:"5px",width:"100%"},children:[d.jsx("option",{value:"",children:"Any"}),d.jsx("option",{value:"15",children:"Less than 15 mins"}),d.jsx("option",{value:"30",children:"Less than 30 mins"}),d.jsx("option",{value:"60",children:"Less than 60 mins"})]})]})]})]})]})};var xW;(function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"})(xW||(xW={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var XW;(function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"})(XW||(XW={}));var JW;(function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(JW||(JW={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YW=["user","model","function","system"];var NW;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(NW||(NW={}));var HW;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(HW||(HW={}));var FW;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(FW||(FW={}));var KW;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(KW||(KW={}));var Gc;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER"})(Gc||(Gc={}));var EW;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(EW||(EW={}));var MW;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(MW||(MW={}));var zW;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(zW||(zW={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends Error{constructor(t){super(`[GoogleGenerativeAI Error]: ${t}`)}}class Ml extends mi{constructor(t,n){super(t),this.response=n}}class uY extends mi{constructor(t,n,i,r){super(t),this.status=n,this.statusText=i,this.errorDetails=r}}class aa extends mi{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vne="https://generativelanguage.googleapis.com",Gne="v1beta",Sne="0.21.0",Bne="genai-js";var gl;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(gl||(gl={}));class Rne{constructor(t,n,i,r,o){this.model=t,this.task=n,this.apiKey=i,this.stream=r,this.requestOptions=o}toString(){var t,n;const i=((t=this.requestOptions)===null||t===void 0?void 0:t.apiVersion)||Gne;let o=`${((n=this.requestOptions)===null||n===void 0?void 0:n.baseUrl)||vne}/${i}/${this.model}:${this.task}`;return this.stream&&(o+="?alt=sse"),o}}function Wne(e){const t=[];return e!=null&&e.apiClient&&t.push(e.apiClient),t.push(`${Bne}/${Sne}`),t.join(" ")}async function kne(e){var t;const n=new Headers;n.append("Content-Type","application/json"),n.append("x-goog-api-client",Wne(e.requestOptions)),n.append("x-goog-api-key",e.apiKey);let i=(t=e.requestOptions)===null||t===void 0?void 0:t.customHeaders;if(i){if(!(i instanceof Headers))try{i=new Headers(i)}catch(r){throw new aa(`unable to convert customHeaders value ${JSON.stringify(i)} to Headers: ${r.message}`)}for(const[r,o]of i.entries()){if(r==="x-goog-api-key")throw new aa(`Cannot set reserved header name ${r}`);if(r==="x-goog-api-client")throw new aa(`Header name ${r} can only be set using the apiClient field`);n.append(r,o)}}return n}async function Vne(e,t,n,i,r,o){const a=new Rne(e,t,n,i,o);return{url:a.toString(),fetchOptions:Object.assign(Object.assign({},Jne(o)),{method:"POST",headers:await kne(a),body:r})}}async function ju(e,t,n,i,r,o={},a=fetch){const{url:l,fetchOptions:s}=await Vne(e,t,n,i,r,o);return wne(l,s,a)}async function wne(e,t,n=fetch){let i;try{i=await n(e,t)}catch(r){xne(r,e)}return i.ok||await Xne(i,e),i}function xne(e,t){let n=e;throw e instanceof uY||e instanceof aa||(n=new mi(`Error fetching from ${t.toString()}: ${e.message}`),n.stack=e.stack),n}async function Xne(e,t){let n="",i;try{const r=await e.json();n=r.error.message,r.error.details&&(n+=` ${JSON.stringify(r.error.details)}`,i=r.error.details)}catch{}throw new uY(`Error fetching from ${t.toString()}: [${e.status} ${e.statusText}] ${n}`,e.status,e.statusText,i)}function Jne(e){const t={};if((e==null?void 0:e.signal)!==void 0||(e==null?void 0:e.timeout)>=0){const n=new AbortController;(e==null?void 0:e.timeout)>=0&&setTimeout(()=>n.abort(),e.timeout),e!=null&&e.signal&&e.signal.addEventListener("abort",()=>{n.abort()}),t.signal=n.signal}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MZ(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Fd(e.candidates[0]))throw new Ml(`${No(e)}`,e);return Yne(e)}else if(e.promptFeedback)throw new Ml(`Text not available. ${No(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Fd(e.candidates[0]))throw new Ml(`${No(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),LW(e)[0]}else if(e.promptFeedback)throw new Ml(`Function call not available. ${No(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Fd(e.candidates[0]))throw new Ml(`${No(e)}`,e);return LW(e)}else if(e.promptFeedback)throw new Ml(`Function call not available. ${No(e)}`,e)},e}function Yne(e){var t,n,i,r;const o=[];if(!((n=(t=e.candidates)===null||t===void 0?void 0:t[0].content)===null||n===void 0)&&n.parts)for(const a of(r=(i=e.candidates)===null||i===void 0?void 0:i[0].content)===null||r===void 0?void 0:r.parts)a.text&&o.push(a.text),a.executableCode&&o.push("\n```"+a.executableCode.language+`
`+a.executableCode.code+"\n```\n"),a.codeExecutionResult&&o.push("\n```\n"+a.codeExecutionResult.output+"\n```\n");return o.length>0?o.join(""):""}function LW(e){var t,n,i,r;const o=[];if(!((n=(t=e.candidates)===null||t===void 0?void 0:t[0].content)===null||n===void 0)&&n.parts)for(const a of(r=(i=e.candidates)===null||i===void 0?void 0:i[0].content)===null||r===void 0?void 0:r.parts)a.functionCall&&o.push(a.functionCall);if(o.length>0)return o}const Nne=[Gc.RECITATION,Gc.SAFETY,Gc.LANGUAGE];function Fd(e){return!!e.finishReason&&Nne.includes(e.finishReason)}function No(e){var t,n,i;let r="";if((!e.candidates||e.candidates.length===0)&&e.promptFeedback)r+="Response was blocked",!((t=e.promptFeedback)===null||t===void 0)&&t.blockReason&&(r+=` due to ${e.promptFeedback.blockReason}`),!((n=e.promptFeedback)===null||n===void 0)&&n.blockReasonMessage&&(r+=`: ${e.promptFeedback.blockReasonMessage}`);else if(!((i=e.candidates)===null||i===void 0)&&i[0]){const o=e.candidates[0];Fd(o)&&(r+=`Candidate was blocked due to ${o.finishReason}`,o.finishMessage&&(r+=`: ${o.finishMessage}`))}return r}function fu(e){return this instanceof fu?(this.v=e,this):new fu(e)}function Hne(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(e,t||[]),r,o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(I){i[I]&&(r[I]=function(C){return new Promise(function(m,f){o.push([I,C,m,f])>1||l(I,C)})})}function l(I,C){try{s(i[I](C))}catch(m){u(o[0][3],m)}}function s(I){I.value instanceof fu?Promise.resolve(I.value.v).then(g,c):u(o[0][2],I)}function g(I){l("next",I)}function c(I){l("throw",I)}function u(I,C){I(C),o.shift(),o.length&&l(o[0][0],o[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DW=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Fne(e){const t=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),n=Mne(t),[i,r]=n.tee();return{stream:Ene(i),response:Kne(r)}}async function Kne(e){const t=[],n=e.getReader();for(;;){const{done:i,value:r}=await n.read();if(i)return MZ(zne(t));t.push(r)}}function Ene(e){return Hne(this,arguments,function*(){const n=e.getReader();for(;;){const{value:i,done:r}=yield fu(n.read());if(r)break;yield yield fu(MZ(i))}})}function Mne(e){const t=e.getReader();return new ReadableStream({start(i){let r="";return o();function o(){return t.read().then(({value:a,done:l})=>{if(l){if(r.trim()){i.error(new mi("Failed to parse stream"));return}i.close();return}r+=a;let s=r.match(DW),g;for(;s;){try{g=JSON.parse(s[1])}catch{i.error(new mi(`Error parsing JSON response: "${s[1]}"`));return}i.enqueue(g),r=r.substring(s[0].length),s=r.match(DW)}return o()})}}})}function zne(e){const t=e[e.length-1],n={promptFeedback:t==null?void 0:t.promptFeedback};for(const i of e){if(i.candidates)for(const r of i.candidates){const o=r.index;if(n.candidates||(n.candidates=[]),n.candidates[o]||(n.candidates[o]={index:r.index}),n.candidates[o].citationMetadata=r.citationMetadata,n.candidates[o].groundingMetadata=r.groundingMetadata,n.candidates[o].finishReason=r.finishReason,n.candidates[o].finishMessage=r.finishMessage,n.candidates[o].safetyRatings=r.safetyRatings,r.content&&r.content.parts){n.candidates[o].content||(n.candidates[o].content={role:r.content.role||"user",parts:[]});const a={};for(const l of r.content.parts)l.text&&(a.text=l.text),l.functionCall&&(a.functionCall=l.functionCall),l.executableCode&&(a.executableCode=l.executableCode),l.codeExecutionResult&&(a.codeExecutionResult=l.codeExecutionResult),Object.keys(a).length===0&&(a.text=""),n.candidates[o].content.parts.push(a)}}i.usageMetadata&&(n.usageMetadata=i.usageMetadata)}return n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IY(e,t,n,i){const r=await ju(t,gl.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(n),i);return Fne(r)}async function dY(e,t,n,i){const o=await(await ju(t,gl.GENERATE_CONTENT,e,!1,JSON.stringify(n),i)).json();return{response:MZ(o)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CY(e){if(e!=null){if(typeof e=="string")return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)return e.role?e:{role:"system",parts:e.parts}}}function pu(e){let t=[];if(typeof e=="string")t=[{text:e}];else for(const n of e)typeof n=="string"?t.push({text:n}):t.push(n);return Lne(t)}function Lne(e){const t={role:"user",parts:[]},n={role:"function",parts:[]};let i=!1,r=!1;for(const o of e)"functionResponse"in o?(n.parts.push(o),r=!0):(t.parts.push(o),i=!0);if(i&&r)throw new mi("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!i&&!r)throw new mi("No content is provided for sending chat message.");return i?t:n}function Dne(e,t){var n;let i={model:t==null?void 0:t.model,generationConfig:t==null?void 0:t.generationConfig,safetySettings:t==null?void 0:t.safetySettings,tools:t==null?void 0:t.tools,toolConfig:t==null?void 0:t.toolConfig,systemInstruction:t==null?void 0:t.systemInstruction,cachedContent:(n=t==null?void 0:t.cachedContent)===null||n===void 0?void 0:n.name,contents:[]};const r=e.generateContentRequest!=null;if(e.contents){if(r)throw new aa("CountTokensRequest must have one of contents or generateContentRequest, not both.");i.contents=e.contents}else if(r)i=Object.assign(Object.assign({},i),e.generateContentRequest);else{const o=pu(e);i.contents=[o]}return{generateContentRequest:i}}function TW(e){let t;return e.contents?t=e:t={contents:[pu(e)]},e.systemInstruction&&(t.systemInstruction=CY(e.systemInstruction)),t}function Tne(e){return typeof e=="string"||Array.isArray(e)?{content:pu(e)}:e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jW=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],jne={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function Une(e){let t=!1;for(const n of e){const{role:i,parts:r}=n;if(!t&&i!=="user")throw new mi(`First content should be with role 'user', got ${i}`);if(!YW.includes(i))throw new mi(`Each item should include role field. Got ${i} but valid roles are: ${JSON.stringify(YW)}`);if(!Array.isArray(r))throw new mi("Content should have 'parts' property with an array of Parts");if(r.length===0)throw new mi("Each Content should have at least one part");const o={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const l of r)for(const s of jW)s in l&&(o[s]+=1);const a=jne[i];for(const l of jW)if(!a.includes(l)&&o[l]>0)throw new mi(`Content with role '${i}' can't contain '${l}' part`);t=!0}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UW="SILENT_ERROR";class Qne{constructor(t,n,i,r={}){this.model=n,this.params=i,this._requestOptions=r,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=t,i!=null&&i.history&&(Une(i.history),this._history=i.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(t,n={}){var i,r,o,a,l,s;await this._sendPromise;const g=pu(t),c={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(o=this.params)===null||o===void 0?void 0:o.tools,toolConfig:(a=this.params)===null||a===void 0?void 0:a.toolConfig,systemInstruction:(l=this.params)===null||l===void 0?void 0:l.systemInstruction,cachedContent:(s=this.params)===null||s===void 0?void 0:s.cachedContent,contents:[...this._history,g]},u=Object.assign(Object.assign({},this._requestOptions),n);let I;return this._sendPromise=this._sendPromise.then(()=>dY(this._apiKey,this.model,c,u)).then(C=>{var m;if(C.response.candidates&&C.response.candidates.length>0){this._history.push(g);const f=Object.assign({parts:[],role:"model"},(m=C.response.candidates)===null||m===void 0?void 0:m[0].content);this._history.push(f)}else{const f=No(C.response);f&&console.warn(`sendMessage() was unsuccessful. ${f}. Inspect response object for details.`)}I=C}),await this._sendPromise,I}async sendMessageStream(t,n={}){var i,r,o,a,l,s;await this._sendPromise;const g=pu(t),c={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(o=this.params)===null||o===void 0?void 0:o.tools,toolConfig:(a=this.params)===null||a===void 0?void 0:a.toolConfig,systemInstruction:(l=this.params)===null||l===void 0?void 0:l.systemInstruction,cachedContent:(s=this.params)===null||s===void 0?void 0:s.cachedContent,contents:[...this._history,g]},u=Object.assign(Object.assign({},this._requestOptions),n),I=IY(this._apiKey,this.model,c,u);return this._sendPromise=this._sendPromise.then(()=>I).catch(C=>{throw new Error(UW)}).then(C=>C.response).then(C=>{if(C.candidates&&C.candidates.length>0){this._history.push(g);const m=Object.assign({},C.candidates[0].content);m.role||(m.role="model"),this._history.push(m)}else{const m=No(C);m&&console.warn(`sendMessageStream() was unsuccessful. ${m}. Inspect response object for details.`)}}).catch(C=>{C.message!==UW&&console.error(C)}),I}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pne(e,t,n,i){return(await ju(t,gl.COUNT_TOKENS,e,!1,JSON.stringify(n),i)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _ne(e,t,n,i){return(await ju(t,gl.EMBED_CONTENT,e,!1,JSON.stringify(n),i)).json()}async function One(e,t,n,i){const r=n.requests.map(a=>Object.assign(Object.assign({},a),{model:t}));return(await ju(t,gl.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:r}),i)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QW{constructor(t,n,i={}){this.apiKey=t,this._requestOptions=i,n.model.includes("/")?this.model=n.model:this.model=`models/${n.model}`,this.generationConfig=n.generationConfig||{},this.safetySettings=n.safetySettings||[],this.tools=n.tools,this.toolConfig=n.toolConfig,this.systemInstruction=CY(n.systemInstruction),this.cachedContent=n.cachedContent}async generateContent(t,n={}){var i;const r=TW(t),o=Object.assign(Object.assign({},this._requestOptions),n);return dY(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},r),o)}async generateContentStream(t,n={}){var i;const r=TW(t),o=Object.assign(Object.assign({},this._requestOptions),n);return IY(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},r),o)}startChat(t){var n;return new Qne(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},t),this._requestOptions)}async countTokens(t,n={}){const i=Dne(t,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),r=Object.assign(Object.assign({},this._requestOptions),n);return Pne(this.apiKey,this.model,i,r)}async embedContent(t,n={}){const i=Tne(t),r=Object.assign(Object.assign({},this._requestOptions),n);return _ne(this.apiKey,this.model,i,r)}async batchEmbedContents(t,n={}){const i=Object.assign(Object.assign({},this._requestOptions),n);return One(this.apiKey,this.model,t,i)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qne{constructor(t){this.apiKey=t}getGenerativeModel(t,n){if(!t.model)throw new mi("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new QW(this.apiKey,t,n)}getGenerativeModelFromCachedContent(t,n,i){if(!t.name)throw new aa("Cached content must contain a `name` field.");if(!t.model)throw new aa("Cached content must contain a `model` field.");const r=["model","systemInstruction"];for(const a of r)if(n!=null&&n[a]&&t[a]&&(n==null?void 0:n[a])!==t[a]){if(a==="model"){const l=n.model.startsWith("models/")?n.model.replace("models/",""):n.model,s=t.model.startsWith("models/")?t.model.replace("models/",""):t.model;if(l===s)continue}throw new aa(`Different value for "${a}" specified in modelParams (${n[a]}) and cachedContent (${t[a]})`)}const o=Object.assign(Object.assign({},n),{model:t.model,tools:t.tools,toolConfig:t.toolConfig,systemInstruction:t.systemInstruction,cachedContent:t});return new QW(this.apiKey,o,i)}}var hY={exports:{}},$ne="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",eie=$ne,tie=eie;function mY(){}function AY(){}AY.resetWarningCache=mY;var nie=function(){function e(i,r,o,a,l,s){if(s!==tie){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:AY,resetWarningCache:mY};return n.PropTypes=n,n};hY.exports=nie();var iie=hY.exports;const Ir=Es(iie);function rie(e,t){const n={};return(e[e.length-1]===""?[...e,""]:e).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const oie=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,aie=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,lie={};function PW(e,t){return(lie.jsx?aie:oie).test(e)}const sie=/[ \t\n\f\r]/g;function gie(e){return typeof e=="object"?e.type==="text"?_W(e.value):!1:_W(e)}function _W(e){return e.replace(sie,"")===""}class Uu{constructor(t,n,i){this.property=t,this.normal=n,i&&(this.space=i)}}Uu.prototype.property={};Uu.prototype.normal={};Uu.prototype.space=null;function fY(e,t){const n={},i={};let r=-1;for(;++r<e.length;)Object.assign(n,e[r].property),Object.assign(i,e[r].normal);return new Uu(n,i,t)}function o0(e){return e.toLowerCase()}class ir{constructor(t,n){this.property=t,this.attribute=n}}ir.prototype.space=null;ir.prototype.boolean=!1;ir.prototype.booleanish=!1;ir.prototype.overloadedBoolean=!1;ir.prototype.number=!1;ir.prototype.commaSeparated=!1;ir.prototype.spaceSeparated=!1;ir.prototype.commaOrSpaceSeparated=!1;ir.prototype.mustUseProperty=!1;ir.prototype.defined=!1;let cie=0;const tt=Gl(),An=Gl(),pY=Gl(),Ie=Gl(),Mt=Gl(),bs=Gl(),Bi=Gl();function Gl(){return 2**++cie}const a0=Object.freeze(Object.defineProperty({__proto__:null,boolean:tt,booleanish:An,commaOrSpaceSeparated:Bi,commaSeparated:bs,number:Ie,overloadedBoolean:pY,spaceSeparated:Mt},Symbol.toStringTag,{value:"Module"})),df=Object.keys(a0);class zZ extends ir{constructor(t,n,i,r){let o=-1;if(super(t,n),OW(this,"space",r),typeof i=="number")for(;++o<df.length;){const a=df[o];OW(this,df[o],(i&a0[a])===a0[a])}}}zZ.prototype.defined=!0;function OW(e,t,n){n&&(e[t]=n)}const uie={}.hasOwnProperty;function cg(e){const t={},n={};let i;for(i in e.properties)if(uie.call(e.properties,i)){const r=e.properties[i],o=new zZ(i,e.transform(e.attributes||{},i),r,e.space);e.mustUseProperty&&e.mustUseProperty.includes(i)&&(o.mustUseProperty=!0),t[i]=o,n[o0(i)]=i,n[o0(o.attribute)]=i}return new Uu(t,n,e.space)}const bY=cg({space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),yY=cg({space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function ZY(e,t){return t in e?e[t]:t}function vY(e,t){return ZY(e,t.toLowerCase())}const GY=cg({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:vY,properties:{xmlns:null,xmlnsXLink:null}}),SY=cg({transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:An,ariaAutoComplete:null,ariaBusy:An,ariaChecked:An,ariaColCount:Ie,ariaColIndex:Ie,ariaColSpan:Ie,ariaControls:Mt,ariaCurrent:null,ariaDescribedBy:Mt,ariaDetails:null,ariaDisabled:An,ariaDropEffect:Mt,ariaErrorMessage:null,ariaExpanded:An,ariaFlowTo:Mt,ariaGrabbed:An,ariaHasPopup:null,ariaHidden:An,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Mt,ariaLevel:Ie,ariaLive:null,ariaModal:An,ariaMultiLine:An,ariaMultiSelectable:An,ariaOrientation:null,ariaOwns:Mt,ariaPlaceholder:null,ariaPosInSet:Ie,ariaPressed:An,ariaReadOnly:An,ariaRelevant:null,ariaRequired:An,ariaRoleDescription:Mt,ariaRowCount:Ie,ariaRowIndex:Ie,ariaRowSpan:Ie,ariaSelected:An,ariaSetSize:Ie,ariaSort:null,ariaValueMax:Ie,ariaValueMin:Ie,ariaValueNow:Ie,ariaValueText:null,role:null}}),Iie=cg({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:vY,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:bs,acceptCharset:Mt,accessKey:Mt,action:null,allow:null,allowFullScreen:tt,allowPaymentRequest:tt,allowUserMedia:tt,alt:null,as:null,async:tt,autoCapitalize:null,autoComplete:Mt,autoFocus:tt,autoPlay:tt,blocking:Mt,capture:null,charSet:null,checked:tt,cite:null,className:Mt,cols:Ie,colSpan:null,content:null,contentEditable:An,controls:tt,controlsList:Mt,coords:Ie|bs,crossOrigin:null,data:null,dateTime:null,decoding:null,default:tt,defer:tt,dir:null,dirName:null,disabled:tt,download:pY,draggable:An,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:tt,formTarget:null,headers:Mt,height:Ie,hidden:tt,high:Ie,href:null,hrefLang:null,htmlFor:Mt,httpEquiv:Mt,id:null,imageSizes:null,imageSrcSet:null,inert:tt,inputMode:null,integrity:null,is:null,isMap:tt,itemId:null,itemProp:Mt,itemRef:Mt,itemScope:tt,itemType:Mt,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:tt,low:Ie,manifest:null,max:null,maxLength:Ie,media:null,method:null,min:null,minLength:Ie,multiple:tt,muted:tt,name:null,nonce:null,noModule:tt,noValidate:tt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:tt,optimum:Ie,pattern:null,ping:Mt,placeholder:null,playsInline:tt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:tt,referrerPolicy:null,rel:Mt,required:tt,reversed:tt,rows:Ie,rowSpan:Ie,sandbox:Mt,scope:null,scoped:tt,seamless:tt,selected:tt,shadowRootClonable:tt,shadowRootDelegatesFocus:tt,shadowRootMode:null,shape:null,size:Ie,sizes:null,slot:null,span:Ie,spellCheck:An,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Ie,step:null,style:null,tabIndex:Ie,target:null,title:null,translate:null,type:null,typeMustMatch:tt,useMap:null,value:An,width:Ie,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Mt,axis:null,background:null,bgColor:null,border:Ie,borderColor:null,bottomMargin:Ie,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:tt,declare:tt,event:null,face:null,frame:null,frameBorder:null,hSpace:Ie,leftMargin:Ie,link:null,longDesc:null,lowSrc:null,marginHeight:Ie,marginWidth:Ie,noResize:tt,noHref:tt,noShade:tt,noWrap:tt,object:null,profile:null,prompt:null,rev:null,rightMargin:Ie,rules:null,scheme:null,scrolling:An,standby:null,summary:null,text:null,topMargin:Ie,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Ie,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:tt,disableRemotePlayback:tt,prefix:null,property:null,results:Ie,security:null,unselectable:null}}),die=cg({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:ZY,properties:{about:Bi,accentHeight:Ie,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Ie,amplitude:Ie,arabicForm:null,ascent:Ie,attributeName:null,attributeType:null,azimuth:Ie,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Ie,by:null,calcMode:null,capHeight:Ie,className:Mt,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Ie,diffuseConstant:Ie,direction:null,display:null,dur:null,divisor:Ie,dominantBaseline:null,download:tt,dx:null,dy:null,edgeMode:null,editable:null,elevation:Ie,enableBackground:null,end:null,event:null,exponent:Ie,externalResourcesRequired:null,fill:null,fillOpacity:Ie,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:bs,g2:bs,glyphName:bs,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Ie,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Ie,horizOriginX:Ie,horizOriginY:Ie,id:null,ideographic:Ie,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Ie,k:Ie,k1:Ie,k2:Ie,k3:Ie,k4:Ie,kernelMatrix:Bi,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Ie,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Ie,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Ie,overlineThickness:Ie,paintOrder:null,panose1:null,path:null,pathLength:Ie,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Mt,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Ie,pointsAtY:Ie,pointsAtZ:Ie,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Bi,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Bi,rev:Bi,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Bi,requiredFeatures:Bi,requiredFonts:Bi,requiredFormats:Bi,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Ie,specularExponent:Ie,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Ie,strikethroughThickness:Ie,string:null,stroke:null,strokeDashArray:Bi,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Ie,strokeOpacity:Ie,strokeWidth:null,style:null,surfaceScale:Ie,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Bi,tabIndex:Ie,tableValues:null,target:null,targetX:Ie,targetY:Ie,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Bi,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Ie,underlineThickness:Ie,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Ie,values:null,vAlphabetic:Ie,vMathematical:Ie,vectorEffect:null,vHanging:Ie,vIdeographic:Ie,version:null,vertAdvY:Ie,vertOriginX:Ie,vertOriginY:Ie,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Ie,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),Cie=/^data[-\w.:]+$/i,qW=/-[a-z]/g,hie=/[A-Z]/g;function mie(e,t){const n=o0(t);let i=t,r=ir;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&Cie.test(t)){if(t.charAt(4)==="-"){const o=t.slice(5).replace(qW,fie);i="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=t.slice(4);if(!qW.test(o)){let a=o.replace(hie,Aie);a.charAt(0)!=="-"&&(a="-"+a),t="data"+a}}r=zZ}return new r(i,t)}function Aie(e){return"-"+e.toLowerCase()}function fie(e){return e.charAt(1).toUpperCase()}const pie={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},bie=fY([yY,bY,GY,SY,Iie],"html"),LZ=fY([yY,bY,GY,SY,die],"svg");function yie(e){return e.join(" ").trim()}var BY={},$W=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,Zie=/\n/g,vie=/^\s*/,Gie=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,Sie=/^:\s*/,Bie=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,Rie=/^[;\s]*/,Wie=/^\s+|\s+$/g,kie=`
`,ek="/",tk="*",La="",Vie="comment",wie="declaration",xie=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var n=1,i=1;function r(m){var f=m.match(Zie);f&&(n+=f.length);var b=m.lastIndexOf(kie);i=~b?m.length-b:i+m.length}function o(){var m={line:n,column:i};return function(f){return f.position=new a(m),g(),f}}function a(m){this.start=m,this.end={line:n,column:i},this.source=t.source}a.prototype.content=e;function l(m){var f=new Error(t.source+":"+n+":"+i+": "+m);if(f.reason=m,f.filename=t.source,f.line=n,f.column=i,f.source=e,!t.silent)throw f}function s(m){var f=m.exec(e);if(f){var b=f[0];return r(b),e=e.slice(b.length),f}}function g(){s(vie)}function c(m){var f;for(m=m||[];f=u();)f!==!1&&m.push(f);return m}function u(){var m=o();if(!(ek!=e.charAt(0)||tk!=e.charAt(1))){for(var f=2;La!=e.charAt(f)&&(tk!=e.charAt(f)||ek!=e.charAt(f+1));)++f;if(f+=2,La===e.charAt(f-1))return l("End of comment missing");var b=e.slice(2,f-2);return i+=2,r(b),e=e.slice(f),i+=2,m({type:Vie,comment:b})}}function I(){var m=o(),f=s(Gie);if(f){if(u(),!s(Sie))return l("property missing ':'");var b=s(Bie),A=m({type:wie,property:nk(f[0].replace($W,La)),value:b?nk(b[0].replace($W,La)):La});return s(Rie),A}}function C(){var m=[];c(m);for(var f;f=I();)f!==!1&&(m.push(f),c(m));return m}return g(),C()};function nk(e){return e?e.replace(Wie,La):La}var Xie=xn&&xn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(BY,"__esModule",{value:!0});var ik=BY.default=Yie,Jie=Xie(xie);function Yie(e,t){var n=null;if(!e||typeof e!="string")return n;var i=(0,Jie.default)(e),r=typeof t=="function";return i.forEach(function(o){if(o.type==="declaration"){var a=o.property,l=o.value;r?t(a,l,o):l&&(n=n||{},n[a]=l)}}),n}const Nie=ik.default||ik,RY=WY("end"),DZ=WY("start");function WY(e){return t;function t(n){const i=n&&n.position&&n.position[e]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function Hie(e){const t=DZ(e),n=RY(e);if(t&&n)return{start:t,end:n}}function Sc(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?rk(e.position):"start"in e||"end"in e?rk(e):"line"in e||"column"in e?l0(e):""}function l0(e){return ok(e&&e.line)+":"+ok(e&&e.column)}function rk(e){return l0(e&&e.start)+"-"+l0(e&&e.end)}function ok(e){return e&&typeof e=="number"?e:1}class ei extends Error{constructor(t,n,i){super(),typeof n=="string"&&(i=n,n=void 0);let r="",o={},a=!1;if(n&&("line"in n&&"column"in n?o={place:n}:"start"in n&&"end"in n?o={place:n}:"type"in n?o={ancestors:[n],place:n.position}:o={...n}),typeof t=="string"?r=t:!o.cause&&t&&(a=!0,r=t.message,o.cause=t),!o.ruleId&&!o.source&&typeof i=="string"){const s=i.indexOf(":");s===-1?o.ruleId=i:(o.source=i.slice(0,s),o.ruleId=i.slice(s+1))}if(!o.place&&o.ancestors&&o.ancestors){const s=o.ancestors[o.ancestors.length-1];s&&(o.place=s.position)}const l=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file,this.message=r,this.line=l?l.line:void 0,this.name=Sc(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=a&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}}ei.prototype.file="";ei.prototype.name="";ei.prototype.reason="";ei.prototype.message="";ei.prototype.stack="";ei.prototype.column=void 0;ei.prototype.line=void 0;ei.prototype.ancestors=void 0;ei.prototype.cause=void 0;ei.prototype.fatal=void 0;ei.prototype.place=void 0;ei.prototype.ruleId=void 0;ei.prototype.source=void 0;const TZ={}.hasOwnProperty,Fie=new Map,Kie=/[A-Z]/g,Eie=/-([a-z])/g,Mie=new Set(["table","tbody","thead","tfoot","tr"]),zie=new Set(["td","th"]),kY="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function Lie(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let i;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");i=Oie(n,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");i=_ie(n,t.jsx,t.jsxs)}const r={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:i,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?LZ:bie,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},o=VY(r,e,void 0);return o&&typeof o!="string"?o:r.create(e,r.Fragment,{children:o||void 0},void 0)}function VY(e,t,n){if(t.type==="element")return Die(e,t,n);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return Tie(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return Uie(e,t,n);if(t.type==="mdxjsEsm")return jie(e,t);if(t.type==="root")return Qie(e,t,n);if(t.type==="text")return Pie(e,t)}function Die(e,t,n){const i=e.schema;let r=i;t.tagName.toLowerCase()==="svg"&&i.space==="html"&&(r=LZ,e.schema=r),e.ancestors.push(t);const o=xY(e,t.tagName,!1),a=qie(e,t);let l=UZ(e,t);return Mie.has(t.tagName)&&(l=l.filter(function(s){return typeof s=="string"?!gie(s):!0})),wY(e,a,o,t),jZ(a,l),e.ancestors.pop(),e.schema=i,e.create(t,o,a,n)}function Tie(e,t){if(t.data&&t.data.estree&&e.evaluater){const i=t.data.estree.body[0];return i.type,e.evaluater.evaluateExpression(i.expression)}bu(e,t.position)}function jie(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);bu(e,t.position)}function Uie(e,t,n){const i=e.schema;let r=i;t.name==="svg"&&i.space==="html"&&(r=LZ,e.schema=r),e.ancestors.push(t);const o=t.name===null?e.Fragment:xY(e,t.name,!0),a=$ie(e,t),l=UZ(e,t);return wY(e,a,o,t),jZ(a,l),e.ancestors.pop(),e.schema=i,e.create(t,o,a,n)}function Qie(e,t,n){const i={};return jZ(i,UZ(e,t)),e.create(t,e.Fragment,i,n)}function Pie(e,t){return t.value}function wY(e,t,n,i){typeof n!="string"&&n!==e.Fragment&&e.passNode&&(t.node=i)}function jZ(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function _ie(e,t,n){return i;function i(r,o,a,l){const g=Array.isArray(a.children)?n:t;return l?g(o,a,l):g(o,a)}}function Oie(e,t){return n;function n(i,r,o,a){const l=Array.isArray(o.children),s=DZ(i);return t(r,o,a,l,{columnNumber:s?s.column-1:void 0,fileName:e,lineNumber:s?s.line:void 0},void 0)}}function qie(e,t){const n={};let i,r;for(r in t.properties)if(r!=="children"&&TZ.call(t.properties,r)){const o=ere(e,r,t.properties[r]);if(o){const[a,l]=o;e.tableCellAlignToStyle&&a==="align"&&typeof l=="string"&&zie.has(t.tagName)?i=l:n[a]=l}}if(i){const o=n.style||(n.style={});o[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=i}return n}function $ie(e,t){const n={};for(const i of t.attributes)if(i.type==="mdxJsxExpressionAttribute")if(i.data&&i.data.estree&&e.evaluater){const o=i.data.estree.body[0];o.type;const a=o.expression;a.type;const l=a.properties[0];l.type,Object.assign(n,e.evaluater.evaluateExpression(l.argument))}else bu(e,t.position);else{const r=i.name;let o;if(i.value&&typeof i.value=="object")if(i.value.data&&i.value.data.estree&&e.evaluater){const l=i.value.data.estree.body[0];l.type,o=e.evaluater.evaluateExpression(l.expression)}else bu(e,t.position);else o=i.value===null?!0:i.value;n[r]=o}return n}function UZ(e,t){const n=[];let i=-1;const r=e.passKeys?new Map:Fie;for(;++i<t.children.length;){const o=t.children[i];let a;if(e.passKeys){const s=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(s){const g=r.get(s)||0;a=s+"-"+g,r.set(s,g+1)}}const l=VY(e,o,a);l!==void 0&&n.push(l)}return n}function ere(e,t,n){const i=mie(e.schema,t);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=i.commaSeparated?rie(n):yie(n)),i.property==="style"){let r=typeof n=="object"?n:tre(e,String(n));return e.stylePropertyNameCase==="css"&&(r=nre(r)),["style",r]}return[e.elementAttributeNameCase==="react"&&i.space?pie[i.property]||i.property:i.attribute,n]}}function tre(e,t){const n={};try{Nie(t,i)}catch(r){if(!e.ignoreInvalidStyle){const o=r,a=new ei("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:o,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=kY+"#cannot-parse-style-attribute",a}}return n;function i(r,o){let a=r;a.slice(0,2)!=="--"&&(a.slice(0,4)==="-ms-"&&(a="ms-"+a.slice(4)),a=a.replace(Eie,rre)),n[a]=o}}function xY(e,t,n){let i;if(!n)i={type:"Literal",value:t};else if(t.includes(".")){const r=t.split(".");let o=-1,a;for(;++o<r.length;){const l=PW(r[o])?{type:"Identifier",name:r[o]}:{type:"Literal",value:r[o]};a=a?{type:"MemberExpression",object:a,property:l,computed:!!(o&&l.type==="Literal"),optional:!1}:l}i=a}else i=PW(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(i.type==="Literal"){const r=i.value;return TZ.call(e.components,r)?e.components[r]:r}if(e.evaluater)return e.evaluater.evaluateExpression(i);bu(e)}function bu(e,t){const n=new ei("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=kY+"#cannot-handle-mdx-estrees-without-createevaluater",n}function nre(e){const t={};let n;for(n in e)TZ.call(e,n)&&(t[ire(n)]=e[n]);return t}function ire(e){let t=e.replace(Kie,ore);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function rre(e,t){return t.toUpperCase()}function ore(e){return"-"+e.toLowerCase()}const Cf={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},are={};function QZ(e,t){const n=are,i=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,r=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return XY(e,i,r)}function XY(e,t,n){if(lre(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return ak(e.children,t,n)}return Array.isArray(e)?ak(e,t,n):""}function ak(e,t,n){const i=[];let r=-1;for(;++r<e.length;)i[r]=XY(e[r],t,n);return i.join("")}function lre(e){return!!(e&&typeof e=="object")}const lk=document.createElement("i");function PZ(e){const t="&"+e+";";lk.innerHTML=t;const n=lk.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function Xi(e,t,n,i){const r=e.length;let o=0,a;if(t<0?t=-t>r?0:r+t:t=t>r?r:t,n=n>0?n:0,i.length<1e4)a=Array.from(i),a.unshift(t,n),e.splice(...a);else for(n&&e.splice(t,n);o<i.length;)a=i.slice(o,o+1e4),a.unshift(t,0),e.splice(...a),o+=1e4,t+=1e4}function Qi(e,t){return e.length>0?(Xi(e,e.length,0,t),e):t}const sk={}.hasOwnProperty;function JY(e){const t={};let n=-1;for(;++n<e.length;)sre(t,e[n]);return t}function sre(e,t){let n;for(n in t){const r=(sk.call(e,n)?e[n]:void 0)||(e[n]={}),o=t[n];let a;if(o)for(a in o){sk.call(r,a)||(r[a]=[]);const l=o[a];gre(r[a],Array.isArray(l)?l:l?[l]:[])}}}function gre(e,t){let n=-1;const i=[];for(;++n<t.length;)(t[n].add==="after"?e:i).push(t[n]);Xi(e,0,0,i)}function YY(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"�":String.fromCodePoint(n)}function fr(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const ai=va(/[A-Za-z]/),_n=va(/[\dA-Za-z]/),cre=va(/[#-'*+\--9=?A-Z^-~]/);function jC(e){return e!==null&&(e<32||e===127)}const s0=va(/\d/),ure=va(/[\dA-Fa-f]/),Ire=va(/[!-/:-@[-`{-~]/);function Ue(e){return e!==null&&e<-2}function Kt(e){return e!==null&&(e<0||e===32)}function It(e){return e===-2||e===-1||e===32}const wm=va(new RegExp("\\p{P}|\\p{S}","u")),cl=va(/\s/);function va(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function ug(e){const t=[];let n=-1,i=0,r=0;for(;++n<e.length;){const o=e.charCodeAt(n);let a="";if(o===37&&_n(e.charCodeAt(n+1))&&_n(e.charCodeAt(n+2)))r=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(a=String.fromCharCode(o));else if(o>55295&&o<57344){const l=e.charCodeAt(n+1);o<56320&&l>56319&&l<57344?(a=String.fromCharCode(o,l),r=1):a="�"}else a=String.fromCharCode(o);a&&(t.push(e.slice(i,n),encodeURIComponent(a)),i=n+r+1,a=""),r&&(n+=r,r=0)}return t.join("")+e.slice(i)}function ft(e,t,n,i){const r=i?i-1:Number.POSITIVE_INFINITY;let o=0;return a;function a(s){return It(s)?(e.enter(n),l(s)):t(s)}function l(s){return It(s)&&o++<r?(e.consume(s),l):(e.exit(n),t(s))}}const dre={tokenize:Cre};function Cre(e){const t=e.attempt(this.parser.constructs.contentInitial,i,r);let n;return t;function i(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),ft(e,t,"linePrefix")}function r(l){return e.enter("paragraph"),o(l)}function o(l){const s=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=s),n=s,a(l)}function a(l){if(l===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(l);return}return Ue(l)?(e.consume(l),e.exit("chunkText"),o):(e.consume(l),a)}}const hre={tokenize:mre},gk={tokenize:Are};function mre(e){const t=this,n=[];let i=0,r,o,a;return l;function l(y){if(i<n.length){const Z=n[i];return t.containerState=Z[1],e.attempt(Z[0].continuation,s,g)(y)}return g(y)}function s(y){if(i++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,r&&p();const Z=t.events.length;let G=Z,v;for(;G--;)if(t.events[G][0]==="exit"&&t.events[G][1].type==="chunkFlow"){v=t.events[G][1].end;break}A(i);let B=Z;for(;B<t.events.length;)t.events[B][1].end={...v},B++;return Xi(t.events,G+1,0,t.events.slice(Z)),t.events.length=B,g(y)}return l(y)}function g(y){if(i===n.length){if(!r)return I(y);if(r.currentConstruct&&r.currentConstruct.concrete)return m(y);t.interrupt=!!(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(gk,c,u)(y)}function c(y){return r&&p(),A(i),I(y)}function u(y){return t.parser.lazy[t.now().line]=i!==n.length,a=t.now().offset,m(y)}function I(y){return t.containerState={},e.attempt(gk,C,m)(y)}function C(y){return i++,n.push([t.currentConstruct,t.containerState]),I(y)}function m(y){if(y===null){r&&p(),A(0),e.consume(y);return}return r=r||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:r,contentType:"flow",previous:o}),f(y)}function f(y){if(y===null){b(e.exit("chunkFlow"),!0),A(0),e.consume(y);return}return Ue(y)?(e.consume(y),b(e.exit("chunkFlow")),i=0,t.interrupt=void 0,l):(e.consume(y),f)}function b(y,Z){const G=t.sliceStream(y);if(Z&&G.push(null),y.previous=o,o&&(o.next=y),o=y,r.defineSkip(y.start),r.write(G),t.parser.lazy[y.start.line]){let v=r.events.length;for(;v--;)if(r.events[v][1].start.offset<a&&(!r.events[v][1].end||r.events[v][1].end.offset>a))return;const B=t.events.length;let R=B,X,W;for(;R--;)if(t.events[R][0]==="exit"&&t.events[R][1].type==="chunkFlow"){if(X){W=t.events[R][1].end;break}X=!0}for(A(i),v=B;v<t.events.length;)t.events[v][1].end={...W},v++;Xi(t.events,R+1,0,t.events.slice(B)),t.events.length=v}}function A(y){let Z=n.length;for(;Z-- >y;){const G=n[Z];t.containerState=G[1],G[0].exit.call(t,e)}n.length=y}function p(){r.write([null]),o=void 0,r=void 0,t.containerState._closeFlow=void 0}}function Are(e,t,n){return ft(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Ks(e){if(e===null||Kt(e)||cl(e))return 1;if(wm(e))return 2}function xm(e,t,n){const i=[];let r=-1;for(;++r<e.length;){const o=e[r].resolveAll;o&&!i.includes(o)&&(t=o(t,n),i.push(o))}return t}const g0={name:"attention",resolveAll:fre,tokenize:pre};function fre(e,t){let n=-1,i,r,o,a,l,s,g,c;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(i=n;i--;)if(e[i][0]==="exit"&&e[i][1].type==="attentionSequence"&&e[i][1]._open&&t.sliceSerialize(e[i][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[i][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[i][1].end.offset-e[i][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;s=e[i][1].end.offset-e[i][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const u={...e[i][1].end},I={...e[n][1].start};ck(u,-s),ck(I,s),a={type:s>1?"strongSequence":"emphasisSequence",start:u,end:{...e[i][1].end}},l={type:s>1?"strongSequence":"emphasisSequence",start:{...e[n][1].start},end:I},o={type:s>1?"strongText":"emphasisText",start:{...e[i][1].end},end:{...e[n][1].start}},r={type:s>1?"strong":"emphasis",start:{...a.start},end:{...l.end}},e[i][1].end={...a.start},e[n][1].start={...l.end},g=[],e[i][1].end.offset-e[i][1].start.offset&&(g=Qi(g,[["enter",e[i][1],t],["exit",e[i][1],t]])),g=Qi(g,[["enter",r,t],["enter",a,t],["exit",a,t],["enter",o,t]]),g=Qi(g,xm(t.parser.constructs.insideSpan.null,e.slice(i+1,n),t)),g=Qi(g,[["exit",o,t],["enter",l,t],["exit",l,t],["exit",r,t]]),e[n][1].end.offset-e[n][1].start.offset?(c=2,g=Qi(g,[["enter",e[n][1],t],["exit",e[n][1],t]])):c=0,Xi(e,i-1,n-i+3,g),n=i+g.length-c-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function pre(e,t){const n=this.parser.constructs.attentionMarkers.null,i=this.previous,r=Ks(i);let o;return a;function a(s){return o=s,e.enter("attentionSequence"),l(s)}function l(s){if(s===o)return e.consume(s),l;const g=e.exit("attentionSequence"),c=Ks(s),u=!c||c===2&&r||n.includes(s),I=!r||r===2&&c||n.includes(i);return g._open=!!(o===42?u:u&&(r||!I)),g._close=!!(o===42?I:I&&(c||!u)),t(s)}}function ck(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const bre={name:"autolink",tokenize:yre};function yre(e,t,n){let i=0;return r;function r(C){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(C),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(C){return ai(C)?(e.consume(C),a):C===64?n(C):g(C)}function a(C){return C===43||C===45||C===46||_n(C)?(i=1,l(C)):g(C)}function l(C){return C===58?(e.consume(C),i=0,s):(C===43||C===45||C===46||_n(C))&&i++<32?(e.consume(C),l):(i=0,g(C))}function s(C){return C===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(C),e.exit("autolinkMarker"),e.exit("autolink"),t):C===null||C===32||C===60||jC(C)?n(C):(e.consume(C),s)}function g(C){return C===64?(e.consume(C),c):cre(C)?(e.consume(C),g):n(C)}function c(C){return _n(C)?u(C):n(C)}function u(C){return C===46?(e.consume(C),i=0,c):C===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(C),e.exit("autolinkMarker"),e.exit("autolink"),t):I(C)}function I(C){if((C===45||_n(C))&&i++<63){const m=C===45?I:u;return e.consume(C),m}return n(C)}}const Qu={partial:!0,tokenize:Zre};function Zre(e,t,n){return i;function i(o){return It(o)?ft(e,r,"linePrefix")(o):r(o)}function r(o){return o===null||Ue(o)?t(o):n(o)}}const NY={continuation:{tokenize:Gre},exit:Sre,name:"blockQuote",tokenize:vre};function vre(e,t,n){const i=this;return r;function r(a){if(a===62){const l=i.containerState;return l.open||(e.enter("blockQuote",{_container:!0}),l.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(a),e.exit("blockQuoteMarker"),o}return n(a)}function o(a){return It(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}}function Gre(e,t,n){const i=this;return r;function r(a){return It(a)?ft(e,o,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):o(a)}function o(a){return e.attempt(NY,t,n)(a)}}function Sre(e){e.exit("blockQuote")}const HY={name:"characterEscape",tokenize:Bre};function Bre(e,t,n){return i;function i(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),r}function r(o){return Ire(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(o)}}const FY={name:"characterReference",tokenize:Rre};function Rre(e,t,n){const i=this;let r=0,o,a;return l;function l(u){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(u),e.exit("characterReferenceMarker"),s}function s(u){return u===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(u),e.exit("characterReferenceMarkerNumeric"),g):(e.enter("characterReferenceValue"),o=31,a=_n,c(u))}function g(u){return u===88||u===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(u),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,a=ure,c):(e.enter("characterReferenceValue"),o=7,a=s0,c(u))}function c(u){if(u===59&&r){const I=e.exit("characterReferenceValue");return a===_n&&!PZ(i.sliceSerialize(I))?n(u):(e.enter("characterReferenceMarker"),e.consume(u),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return a(u)&&r++<o?(e.consume(u),c):n(u)}}const uk={partial:!0,tokenize:kre},Ik={concrete:!0,name:"codeFenced",tokenize:Wre};function Wre(e,t,n){const i=this,r={partial:!0,tokenize:G};let o=0,a=0,l;return s;function s(v){return g(v)}function g(v){const B=i.events[i.events.length-1];return o=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,l=v,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),c(v)}function c(v){return v===l?(a++,e.consume(v),c):a<3?n(v):(e.exit("codeFencedFenceSequence"),It(v)?ft(e,u,"whitespace")(v):u(v))}function u(v){return v===null||Ue(v)?(e.exit("codeFencedFence"),i.interrupt?t(v):e.check(uk,f,Z)(v)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),I(v))}function I(v){return v===null||Ue(v)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),u(v)):It(v)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),ft(e,C,"whitespace")(v)):v===96&&v===l?n(v):(e.consume(v),I)}function C(v){return v===null||Ue(v)?u(v):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),m(v))}function m(v){return v===null||Ue(v)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),u(v)):v===96&&v===l?n(v):(e.consume(v),m)}function f(v){return e.attempt(r,Z,b)(v)}function b(v){return e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),A}function A(v){return o>0&&It(v)?ft(e,p,"linePrefix",o+1)(v):p(v)}function p(v){return v===null||Ue(v)?e.check(uk,f,Z)(v):(e.enter("codeFlowValue"),y(v))}function y(v){return v===null||Ue(v)?(e.exit("codeFlowValue"),p(v)):(e.consume(v),y)}function Z(v){return e.exit("codeFenced"),t(v)}function G(v,B,R){let X=0;return W;function W(H){return v.enter("lineEnding"),v.consume(H),v.exit("lineEnding"),V}function V(H){return v.enter("codeFencedFence"),It(H)?ft(v,Y,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(H):Y(H)}function Y(H){return H===l?(v.enter("codeFencedFenceSequence"),K(H)):R(H)}function K(H){return H===l?(X++,v.consume(H),K):X>=a?(v.exit("codeFencedFenceSequence"),It(H)?ft(v,M,"whitespace")(H):M(H)):R(H)}function M(H){return H===null||Ue(H)?(v.exit("codeFencedFence"),B(H)):R(H)}}}function kre(e,t,n){const i=this;return r;function r(a){return a===null?n(a):(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),o)}function o(a){return i.parser.lazy[i.now().line]?n(a):t(a)}}const hf={name:"codeIndented",tokenize:wre},Vre={partial:!0,tokenize:xre};function wre(e,t,n){const i=this;return r;function r(g){return e.enter("codeIndented"),ft(e,o,"linePrefix",5)(g)}function o(g){const c=i.events[i.events.length-1];return c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?a(g):n(g)}function a(g){return g===null?s(g):Ue(g)?e.attempt(Vre,a,s)(g):(e.enter("codeFlowValue"),l(g))}function l(g){return g===null||Ue(g)?(e.exit("codeFlowValue"),a(g)):(e.consume(g),l)}function s(g){return e.exit("codeIndented"),t(g)}}function xre(e,t,n){const i=this;return r;function r(a){return i.parser.lazy[i.now().line]?n(a):Ue(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),r):ft(e,o,"linePrefix",5)(a)}function o(a){const l=i.events[i.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(a):Ue(a)?r(a):n(a)}}const Xre={name:"codeText",previous:Yre,resolve:Jre,tokenize:Nre};function Jre(e){let t=e.length-4,n=3,i,r;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(i=n;++i<t;)if(e[i][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(i=n-1,t++;++i<=t;)r===void 0?i!==t&&e[i][1].type!=="lineEnding"&&(r=i):(i===t||e[i][1].type==="lineEnding")&&(e[r][1].type="codeTextData",i!==r+2&&(e[r][1].end=e[i-1][1].end,e.splice(r+2,i-r-2),t-=i-r-2,i=r+2),r=void 0);return e}function Yre(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Nre(e,t,n){let i=0,r,o;return a;function a(u){return e.enter("codeText"),e.enter("codeTextSequence"),l(u)}function l(u){return u===96?(e.consume(u),i++,l):(e.exit("codeTextSequence"),s(u))}function s(u){return u===null?n(u):u===32?(e.enter("space"),e.consume(u),e.exit("space"),s):u===96?(o=e.enter("codeTextSequence"),r=0,c(u)):Ue(u)?(e.enter("lineEnding"),e.consume(u),e.exit("lineEnding"),s):(e.enter("codeTextData"),g(u))}function g(u){return u===null||u===32||u===96||Ue(u)?(e.exit("codeTextData"),s(u)):(e.consume(u),g)}function c(u){return u===96?(e.consume(u),r++,c):r===i?(e.exit("codeTextSequence"),e.exit("codeText"),t(u)):(o.type="codeTextData",g(u))}}class Hre{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,n){const i=n??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(t,i):t>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(t,n,i){const r=n||0;this.setCursor(Math.trunc(t));const o=this.right.splice(this.right.length-r,Number.POSITIVE_INFINITY);return i&&Mg(this.left,i),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),Mg(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),Mg(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const n=this.left.splice(t,Number.POSITIVE_INFINITY);Mg(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);Mg(this.left,n.reverse())}}}function Mg(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function KY(e){const t={};let n=-1,i,r,o,a,l,s,g;const c=new Hre(e);for(;++n<c.length;){for(;n in t;)n=t[n];if(i=c.get(n),n&&i[1].type==="chunkFlow"&&c.get(n-1)[1].type==="listItemPrefix"&&(s=i[1]._tokenizer.events,o=0,o<s.length&&s[o][1].type==="lineEndingBlank"&&(o+=2),o<s.length&&s[o][1].type==="content"))for(;++o<s.length&&s[o][1].type!=="content";)s[o][1].type==="chunkText"&&(s[o][1]._isInFirstContentOfListItem=!0,o++);if(i[0]==="enter")i[1].contentType&&(Object.assign(t,Fre(c,n)),n=t[n],g=!0);else if(i[1]._container){for(o=n,r=void 0;o--&&(a=c.get(o),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank");)a[0]==="enter"&&(r&&(c.get(r)[1].type="lineEndingBlank"),a[1].type="lineEnding",r=o);r&&(i[1].end={...c.get(r)[1].start},l=c.slice(r,n),l.unshift(i),c.splice(r,n-r+1,l))}}return Xi(e,0,Number.POSITIVE_INFINITY,c.slice(0)),!g}function Fre(e,t){const n=e.get(t)[1],i=e.get(t)[2];let r=t-1;const o=[],a=n._tokenizer||i.parser[n.contentType](n.start),l=a.events,s=[],g={};let c,u,I=-1,C=n,m=0,f=0;const b=[f];for(;C;){for(;e.get(++r)[1]!==C;);o.push(r),C._tokenizer||(c=i.sliceStream(C),C.next||c.push(null),u&&a.defineSkip(C.start),C._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(c),C._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),u=C,C=C.next}for(C=n;++I<l.length;)l[I][0]==="exit"&&l[I-1][0]==="enter"&&l[I][1].type===l[I-1][1].type&&l[I][1].start.line!==l[I][1].end.line&&(f=I+1,b.push(f),C._tokenizer=void 0,C.previous=void 0,C=C.next);for(a.events=[],C?(C._tokenizer=void 0,C.previous=void 0):b.pop(),I=b.length;I--;){const A=l.slice(b[I],b[I+1]),p=o.pop();s.push([p,p+A.length-1]),e.splice(p,2,A)}for(s.reverse(),I=-1;++I<s.length;)g[m+s[I][0]]=m+s[I][1],m+=s[I][1]-s[I][0]-1;return g}const Kre={resolve:Mre,tokenize:zre},Ere={partial:!0,tokenize:Lre};function Mre(e){return KY(e),e}function zre(e,t){let n;return i;function i(l){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),r(l)}function r(l){return l===null?o(l):Ue(l)?e.check(Ere,a,o)(l):(e.consume(l),r)}function o(l){return e.exit("chunkContent"),e.exit("content"),t(l)}function a(l){return e.consume(l),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,r}}function Lre(e,t,n){const i=this;return r;function r(a){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),ft(e,o,"linePrefix")}function o(a){if(a===null||Ue(a))return n(a);const l=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(a):e.interrupt(i.parser.constructs.flow,n,t)(a)}}function EY(e,t,n,i,r,o,a,l,s){const g=s||Number.POSITIVE_INFINITY;let c=0;return u;function u(A){return A===60?(e.enter(i),e.enter(r),e.enter(o),e.consume(A),e.exit(o),I):A===null||A===32||A===41||jC(A)?n(A):(e.enter(i),e.enter(a),e.enter(l),e.enter("chunkString",{contentType:"string"}),f(A))}function I(A){return A===62?(e.enter(o),e.consume(A),e.exit(o),e.exit(r),e.exit(i),t):(e.enter(l),e.enter("chunkString",{contentType:"string"}),C(A))}function C(A){return A===62?(e.exit("chunkString"),e.exit(l),I(A)):A===null||A===60||Ue(A)?n(A):(e.consume(A),A===92?m:C)}function m(A){return A===60||A===62||A===92?(e.consume(A),C):C(A)}function f(A){return!c&&(A===null||A===41||Kt(A))?(e.exit("chunkString"),e.exit(l),e.exit(a),e.exit(i),t(A)):c<g&&A===40?(e.consume(A),c++,f):A===41?(e.consume(A),c--,f):A===null||A===32||A===40||jC(A)?n(A):(e.consume(A),A===92?b:f)}function b(A){return A===40||A===41||A===92?(e.consume(A),f):f(A)}}function MY(e,t,n,i,r,o){const a=this;let l=0,s;return g;function g(C){return e.enter(i),e.enter(r),e.consume(C),e.exit(r),e.enter(o),c}function c(C){return l>999||C===null||C===91||C===93&&!s||C===94&&!l&&"_hiddenFootnoteSupport"in a.parser.constructs?n(C):C===93?(e.exit(o),e.enter(r),e.consume(C),e.exit(r),e.exit(i),t):Ue(C)?(e.enter("lineEnding"),e.consume(C),e.exit("lineEnding"),c):(e.enter("chunkString",{contentType:"string"}),u(C))}function u(C){return C===null||C===91||C===93||Ue(C)||l++>999?(e.exit("chunkString"),c(C)):(e.consume(C),s||(s=!It(C)),C===92?I:u)}function I(C){return C===91||C===92||C===93?(e.consume(C),l++,u):u(C)}}function zY(e,t,n,i,r,o){let a;return l;function l(I){return I===34||I===39||I===40?(e.enter(i),e.enter(r),e.consume(I),e.exit(r),a=I===40?41:I,s):n(I)}function s(I){return I===a?(e.enter(r),e.consume(I),e.exit(r),e.exit(i),t):(e.enter(o),g(I))}function g(I){return I===a?(e.exit(o),s(a)):I===null?n(I):Ue(I)?(e.enter("lineEnding"),e.consume(I),e.exit("lineEnding"),ft(e,g,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),c(I))}function c(I){return I===a||I===null||Ue(I)?(e.exit("chunkString"),g(I)):(e.consume(I),I===92?u:c)}function u(I){return I===a||I===92?(e.consume(I),c):c(I)}}function Bc(e,t){let n;return i;function i(r){return Ue(r)?(e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),n=!0,i):It(r)?ft(e,i,n?"linePrefix":"lineSuffix")(r):t(r)}}const Dre={name:"definition",tokenize:jre},Tre={partial:!0,tokenize:Ure};function jre(e,t,n){const i=this;let r;return o;function o(C){return e.enter("definition"),a(C)}function a(C){return MY.call(i,e,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(C)}function l(C){return r=fr(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),C===58?(e.enter("definitionMarker"),e.consume(C),e.exit("definitionMarker"),s):n(C)}function s(C){return Kt(C)?Bc(e,g)(C):g(C)}function g(C){return EY(e,c,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(C)}function c(C){return e.attempt(Tre,u,u)(C)}function u(C){return It(C)?ft(e,I,"whitespace")(C):I(C)}function I(C){return C===null||Ue(C)?(e.exit("definition"),i.parser.defined.push(r),t(C)):n(C)}}function Ure(e,t,n){return i;function i(l){return Kt(l)?Bc(e,r)(l):n(l)}function r(l){return zY(e,o,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function o(l){return It(l)?ft(e,a,"whitespace")(l):a(l)}function a(l){return l===null||Ue(l)?t(l):n(l)}}const Qre={name:"hardBreakEscape",tokenize:Pre};function Pre(e,t,n){return i;function i(o){return e.enter("hardBreakEscape"),e.consume(o),r}function r(o){return Ue(o)?(e.exit("hardBreakEscape"),t(o)):n(o)}}const _re={name:"headingAtx",resolve:Ore,tokenize:qre};function Ore(e,t){let n=e.length-2,i=3,r,o;return e[i][1].type==="whitespace"&&(i+=2),n-2>i&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(i===n-1||n-4>i&&e[n-2][1].type==="whitespace")&&(n-=i+1===n?2:4),n>i&&(r={type:"atxHeadingText",start:e[i][1].start,end:e[n][1].end},o={type:"chunkText",start:e[i][1].start,end:e[n][1].end,contentType:"text"},Xi(e,i,n-i+1,[["enter",r,t],["enter",o,t],["exit",o,t],["exit",r,t]])),e}function qre(e,t,n){let i=0;return r;function r(c){return e.enter("atxHeading"),o(c)}function o(c){return e.enter("atxHeadingSequence"),a(c)}function a(c){return c===35&&i++<6?(e.consume(c),a):c===null||Kt(c)?(e.exit("atxHeadingSequence"),l(c)):n(c)}function l(c){return c===35?(e.enter("atxHeadingSequence"),s(c)):c===null||Ue(c)?(e.exit("atxHeading"),t(c)):It(c)?ft(e,l,"whitespace")(c):(e.enter("atxHeadingText"),g(c))}function s(c){return c===35?(e.consume(c),s):(e.exit("atxHeadingSequence"),l(c))}function g(c){return c===null||c===35||Kt(c)?(e.exit("atxHeadingText"),l(c)):(e.consume(c),g)}}const $re=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],dk=["pre","script","style","textarea"],eoe={concrete:!0,name:"htmlFlow",resolveTo:ioe,tokenize:roe},toe={partial:!0,tokenize:aoe},noe={partial:!0,tokenize:ooe};function ioe(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function roe(e,t,n){const i=this;let r,o,a,l,s;return g;function g(k){return c(k)}function c(k){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(k),u}function u(k){return k===33?(e.consume(k),I):k===47?(e.consume(k),o=!0,f):k===63?(e.consume(k),r=3,i.interrupt?t:S):ai(k)?(e.consume(k),a=String.fromCharCode(k),b):n(k)}function I(k){return k===45?(e.consume(k),r=2,C):k===91?(e.consume(k),r=5,l=0,m):ai(k)?(e.consume(k),r=4,i.interrupt?t:S):n(k)}function C(k){return k===45?(e.consume(k),i.interrupt?t:S):n(k)}function m(k){const z="CDATA[";return k===z.charCodeAt(l++)?(e.consume(k),l===z.length?i.interrupt?t:Y:m):n(k)}function f(k){return ai(k)?(e.consume(k),a=String.fromCharCode(k),b):n(k)}function b(k){if(k===null||k===47||k===62||Kt(k)){const z=k===47,L=a.toLowerCase();return!z&&!o&&dk.includes(L)?(r=1,i.interrupt?t(k):Y(k)):$re.includes(a.toLowerCase())?(r=6,z?(e.consume(k),A):i.interrupt?t(k):Y(k)):(r=7,i.interrupt&&!i.parser.lazy[i.now().line]?n(k):o?p(k):y(k))}return k===45||_n(k)?(e.consume(k),a+=String.fromCharCode(k),b):n(k)}function A(k){return k===62?(e.consume(k),i.interrupt?t:Y):n(k)}function p(k){return It(k)?(e.consume(k),p):W(k)}function y(k){return k===47?(e.consume(k),W):k===58||k===95||ai(k)?(e.consume(k),Z):It(k)?(e.consume(k),y):W(k)}function Z(k){return k===45||k===46||k===58||k===95||_n(k)?(e.consume(k),Z):G(k)}function G(k){return k===61?(e.consume(k),v):It(k)?(e.consume(k),G):y(k)}function v(k){return k===null||k===60||k===61||k===62||k===96?n(k):k===34||k===39?(e.consume(k),s=k,B):It(k)?(e.consume(k),v):R(k)}function B(k){return k===s?(e.consume(k),s=null,X):k===null||Ue(k)?n(k):(e.consume(k),B)}function R(k){return k===null||k===34||k===39||k===47||k===60||k===61||k===62||k===96||Kt(k)?G(k):(e.consume(k),R)}function X(k){return k===47||k===62||It(k)?y(k):n(k)}function W(k){return k===62?(e.consume(k),V):n(k)}function V(k){return k===null||Ue(k)?Y(k):It(k)?(e.consume(k),V):n(k)}function Y(k){return k===45&&r===2?(e.consume(k),w):k===60&&r===1?(e.consume(k),x):k===62&&r===4?(e.consume(k),E):k===63&&r===3?(e.consume(k),S):k===93&&r===5?(e.consume(k),F):Ue(k)&&(r===6||r===7)?(e.exit("htmlFlowData"),e.check(toe,N,K)(k)):k===null||Ue(k)?(e.exit("htmlFlowData"),K(k)):(e.consume(k),Y)}function K(k){return e.check(noe,M,N)(k)}function M(k){return e.enter("lineEnding"),e.consume(k),e.exit("lineEnding"),H}function H(k){return k===null||Ue(k)?K(k):(e.enter("htmlFlowData"),Y(k))}function w(k){return k===45?(e.consume(k),S):Y(k)}function x(k){return k===47?(e.consume(k),a="",J):Y(k)}function J(k){if(k===62){const z=a.toLowerCase();return dk.includes(z)?(e.consume(k),E):Y(k)}return ai(k)&&a.length<8?(e.consume(k),a+=String.fromCharCode(k),J):Y(k)}function F(k){return k===93?(e.consume(k),S):Y(k)}function S(k){return k===62?(e.consume(k),E):k===45&&r===2?(e.consume(k),S):Y(k)}function E(k){return k===null||Ue(k)?(e.exit("htmlFlowData"),N(k)):(e.consume(k),E)}function N(k){return e.exit("htmlFlow"),t(k)}}function ooe(e,t,n){const i=this;return r;function r(a){return Ue(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),o):n(a)}function o(a){return i.parser.lazy[i.now().line]?n(a):t(a)}}function aoe(e,t,n){return i;function i(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),e.attempt(Qu,t,n)}}const loe={name:"htmlText",tokenize:soe};function soe(e,t,n){const i=this;let r,o,a;return l;function l(S){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(S),s}function s(S){return S===33?(e.consume(S),g):S===47?(e.consume(S),G):S===63?(e.consume(S),y):ai(S)?(e.consume(S),R):n(S)}function g(S){return S===45?(e.consume(S),c):S===91?(e.consume(S),o=0,m):ai(S)?(e.consume(S),p):n(S)}function c(S){return S===45?(e.consume(S),C):n(S)}function u(S){return S===null?n(S):S===45?(e.consume(S),I):Ue(S)?(a=u,x(S)):(e.consume(S),u)}function I(S){return S===45?(e.consume(S),C):u(S)}function C(S){return S===62?w(S):S===45?I(S):u(S)}function m(S){const E="CDATA[";return S===E.charCodeAt(o++)?(e.consume(S),o===E.length?f:m):n(S)}function f(S){return S===null?n(S):S===93?(e.consume(S),b):Ue(S)?(a=f,x(S)):(e.consume(S),f)}function b(S){return S===93?(e.consume(S),A):f(S)}function A(S){return S===62?w(S):S===93?(e.consume(S),A):f(S)}function p(S){return S===null||S===62?w(S):Ue(S)?(a=p,x(S)):(e.consume(S),p)}function y(S){return S===null?n(S):S===63?(e.consume(S),Z):Ue(S)?(a=y,x(S)):(e.consume(S),y)}function Z(S){return S===62?w(S):y(S)}function G(S){return ai(S)?(e.consume(S),v):n(S)}function v(S){return S===45||_n(S)?(e.consume(S),v):B(S)}function B(S){return Ue(S)?(a=B,x(S)):It(S)?(e.consume(S),B):w(S)}function R(S){return S===45||_n(S)?(e.consume(S),R):S===47||S===62||Kt(S)?X(S):n(S)}function X(S){return S===47?(e.consume(S),w):S===58||S===95||ai(S)?(e.consume(S),W):Ue(S)?(a=X,x(S)):It(S)?(e.consume(S),X):w(S)}function W(S){return S===45||S===46||S===58||S===95||_n(S)?(e.consume(S),W):V(S)}function V(S){return S===61?(e.consume(S),Y):Ue(S)?(a=V,x(S)):It(S)?(e.consume(S),V):X(S)}function Y(S){return S===null||S===60||S===61||S===62||S===96?n(S):S===34||S===39?(e.consume(S),r=S,K):Ue(S)?(a=Y,x(S)):It(S)?(e.consume(S),Y):(e.consume(S),M)}function K(S){return S===r?(e.consume(S),r=void 0,H):S===null?n(S):Ue(S)?(a=K,x(S)):(e.consume(S),K)}function M(S){return S===null||S===34||S===39||S===60||S===61||S===96?n(S):S===47||S===62||Kt(S)?X(S):(e.consume(S),M)}function H(S){return S===47||S===62||Kt(S)?X(S):n(S)}function w(S){return S===62?(e.consume(S),e.exit("htmlTextData"),e.exit("htmlText"),t):n(S)}function x(S){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(S),e.exit("lineEnding"),J}function J(S){return It(S)?ft(e,F,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(S):F(S)}function F(S){return e.enter("htmlTextData"),a(S)}}const _Z={name:"labelEnd",resolveAll:Ioe,resolveTo:doe,tokenize:Coe},goe={tokenize:hoe},coe={tokenize:moe},uoe={tokenize:Aoe};function Ioe(e){let t=-1;const n=[];for(;++t<e.length;){const i=e[t][1];if(n.push(e[t]),i.type==="labelImage"||i.type==="labelLink"||i.type==="labelEnd"){const r=i.type==="labelImage"?4:2;i.type="data",t+=r}}return e.length!==n.length&&Xi(e,0,e.length,n),e}function doe(e,t){let n=e.length,i=0,r,o,a,l;for(;n--;)if(r=e[n][1],o){if(r.type==="link"||r.type==="labelLink"&&r._inactive)break;e[n][0]==="enter"&&r.type==="labelLink"&&(r._inactive=!0)}else if(a){if(e[n][0]==="enter"&&(r.type==="labelImage"||r.type==="labelLink")&&!r._balanced&&(o=n,r.type!=="labelLink")){i=2;break}}else r.type==="labelEnd"&&(a=n);const s={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},g={type:"label",start:{...e[o][1].start},end:{...e[a][1].end}},c={type:"labelText",start:{...e[o+i+2][1].end},end:{...e[a-2][1].start}};return l=[["enter",s,t],["enter",g,t]],l=Qi(l,e.slice(o+1,o+i+3)),l=Qi(l,[["enter",c,t]]),l=Qi(l,xm(t.parser.constructs.insideSpan.null,e.slice(o+i+4,a-3),t)),l=Qi(l,[["exit",c,t],e[a-2],e[a-1],["exit",g,t]]),l=Qi(l,e.slice(a+1)),l=Qi(l,[["exit",s,t]]),Xi(e,o,e.length,l),e}function Coe(e,t,n){const i=this;let r=i.events.length,o,a;for(;r--;)if((i.events[r][1].type==="labelImage"||i.events[r][1].type==="labelLink")&&!i.events[r][1]._balanced){o=i.events[r][1];break}return l;function l(I){return o?o._inactive?u(I):(a=i.parser.defined.includes(fr(i.sliceSerialize({start:o.end,end:i.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(I),e.exit("labelMarker"),e.exit("labelEnd"),s):n(I)}function s(I){return I===40?e.attempt(goe,c,a?c:u)(I):I===91?e.attempt(coe,c,a?g:u)(I):a?c(I):u(I)}function g(I){return e.attempt(uoe,c,u)(I)}function c(I){return t(I)}function u(I){return o._balanced=!0,n(I)}}function hoe(e,t,n){return i;function i(u){return e.enter("resource"),e.enter("resourceMarker"),e.consume(u),e.exit("resourceMarker"),r}function r(u){return Kt(u)?Bc(e,o)(u):o(u)}function o(u){return u===41?c(u):EY(e,a,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(u)}function a(u){return Kt(u)?Bc(e,s)(u):c(u)}function l(u){return n(u)}function s(u){return u===34||u===39||u===40?zY(e,g,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(u):c(u)}function g(u){return Kt(u)?Bc(e,c)(u):c(u)}function c(u){return u===41?(e.enter("resourceMarker"),e.consume(u),e.exit("resourceMarker"),e.exit("resource"),t):n(u)}}function moe(e,t,n){const i=this;return r;function r(l){return MY.call(i,e,o,a,"reference","referenceMarker","referenceString")(l)}function o(l){return i.parser.defined.includes(fr(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?t(l):n(l)}function a(l){return n(l)}}function Aoe(e,t,n){return i;function i(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),r}function r(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),t):n(o)}}const foe={name:"labelStartImage",resolveAll:_Z.resolveAll,tokenize:poe};function poe(e,t,n){const i=this;return r;function r(l){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(l),e.exit("labelImageMarker"),o}function o(l){return l===91?(e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelImage"),a):n(l)}function a(l){return l===94&&"_hiddenFootnoteSupport"in i.parser.constructs?n(l):t(l)}}const boe={name:"labelStartLink",resolveAll:_Z.resolveAll,tokenize:yoe};function yoe(e,t,n){const i=this;return r;function r(a){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(a),e.exit("labelMarker"),e.exit("labelLink"),o}function o(a){return a===94&&"_hiddenFootnoteSupport"in i.parser.constructs?n(a):t(a)}}const mf={name:"lineEnding",tokenize:Zoe};function Zoe(e,t){return n;function n(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),ft(e,t,"linePrefix")}}const Kd={name:"thematicBreak",tokenize:voe};function voe(e,t,n){let i=0,r;return o;function o(g){return e.enter("thematicBreak"),a(g)}function a(g){return r=g,l(g)}function l(g){return g===r?(e.enter("thematicBreakSequence"),s(g)):i>=3&&(g===null||Ue(g))?(e.exit("thematicBreak"),t(g)):n(g)}function s(g){return g===r?(e.consume(g),i++,s):(e.exit("thematicBreakSequence"),It(g)?ft(e,l,"whitespace")(g):l(g))}}const Ii={continuation:{tokenize:Roe},exit:koe,name:"list",tokenize:Boe},Goe={partial:!0,tokenize:Voe},Soe={partial:!0,tokenize:Woe};function Boe(e,t,n){const i=this,r=i.events[i.events.length-1];let o=r&&r[1].type==="linePrefix"?r[2].sliceSerialize(r[1],!0).length:0,a=0;return l;function l(C){const m=i.containerState.type||(C===42||C===43||C===45?"listUnordered":"listOrdered");if(m==="listUnordered"?!i.containerState.marker||C===i.containerState.marker:s0(C)){if(i.containerState.type||(i.containerState.type=m,e.enter(m,{_container:!0})),m==="listUnordered")return e.enter("listItemPrefix"),C===42||C===45?e.check(Kd,n,g)(C):g(C);if(!i.interrupt||C===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),s(C)}return n(C)}function s(C){return s0(C)&&++a<10?(e.consume(C),s):(!i.interrupt||a<2)&&(i.containerState.marker?C===i.containerState.marker:C===41||C===46)?(e.exit("listItemValue"),g(C)):n(C)}function g(C){return e.enter("listItemMarker"),e.consume(C),e.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||C,e.check(Qu,i.interrupt?n:c,e.attempt(Goe,I,u))}function c(C){return i.containerState.initialBlankLine=!0,o++,I(C)}function u(C){return It(C)?(e.enter("listItemPrefixWhitespace"),e.consume(C),e.exit("listItemPrefixWhitespace"),I):n(C)}function I(C){return i.containerState.size=o+i.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(C)}}function Roe(e,t,n){const i=this;return i.containerState._closeFlow=void 0,e.check(Qu,r,o);function r(l){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,ft(e,t,"listItemIndent",i.containerState.size+1)(l)}function o(l){return i.containerState.furtherBlankLines||!It(l)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,a(l)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,e.attempt(Soe,t,a)(l))}function a(l){return i.containerState._closeFlow=!0,i.interrupt=void 0,ft(e,e.attempt(Ii,t,n),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function Woe(e,t,n){const i=this;return ft(e,r,"listItemIndent",i.containerState.size+1);function r(o){const a=i.events[i.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===i.containerState.size?t(o):n(o)}}function koe(e){e.exit(this.containerState.type)}function Voe(e,t,n){const i=this;return ft(e,r,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function r(o){const a=i.events[i.events.length-1];return!It(o)&&a&&a[1].type==="listItemPrefixWhitespace"?t(o):n(o)}}const Ck={name:"setextUnderline",resolveTo:woe,tokenize:xoe};function woe(e,t){let n=e.length,i,r,o;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){i=n;break}e[n][1].type==="paragraph"&&(r=n)}else e[n][1].type==="content"&&e.splice(n,1),!o&&e[n][1].type==="definition"&&(o=n);const a={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[r][1].type="setextHeadingText",o?(e.splice(r,0,["enter",a,t]),e.splice(o+1,0,["exit",e[i][1],t]),e[i][1].end={...e[o][1].end}):e[i][1]=a,e.push(["exit",a,t]),e}function xoe(e,t,n){const i=this;let r;return o;function o(g){let c=i.events.length,u;for(;c--;)if(i.events[c][1].type!=="lineEnding"&&i.events[c][1].type!=="linePrefix"&&i.events[c][1].type!=="content"){u=i.events[c][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||u)?(e.enter("setextHeadingLine"),r=g,a(g)):n(g)}function a(g){return e.enter("setextHeadingLineSequence"),l(g)}function l(g){return g===r?(e.consume(g),l):(e.exit("setextHeadingLineSequence"),It(g)?ft(e,s,"lineSuffix")(g):s(g))}function s(g){return g===null||Ue(g)?(e.exit("setextHeadingLine"),t(g)):n(g)}}const Xoe={tokenize:Joe};function Joe(e){const t=this,n=e.attempt(Qu,i,e.attempt(this.parser.constructs.flowInitial,r,ft(e,e.attempt(this.parser.constructs.flow,r,e.attempt(Kre,r)),"linePrefix")));return n;function i(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function r(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const Yoe={resolveAll:DY()},Noe=LY("string"),Hoe=LY("text");function LY(e){return{resolveAll:DY(e==="text"?Foe:void 0),tokenize:t};function t(n){const i=this,r=this.parser.constructs[e],o=n.attempt(r,a,l);return a;function a(c){return g(c)?o(c):l(c)}function l(c){if(c===null){n.consume(c);return}return n.enter("data"),n.consume(c),s}function s(c){return g(c)?(n.exit("data"),o(c)):(n.consume(c),s)}function g(c){if(c===null)return!0;const u=r[c];let I=-1;if(u)for(;++I<u.length;){const C=u[I];if(!C.previous||C.previous.call(i,i.previous))return!0}return!1}}}function DY(e){return t;function t(n,i){let r=-1,o;for(;++r<=n.length;)o===void 0?n[r]&&n[r][1].type==="data"&&(o=r,r++):(!n[r]||n[r][1].type!=="data")&&(r!==o+2&&(n[o][1].end=n[r-1][1].end,n.splice(o+2,r-o-2),r=o+2),o=void 0);return e?e(n,i):n}}function Foe(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const i=e[n-1][1],r=t.sliceStream(i);let o=r.length,a=-1,l=0,s;for(;o--;){const g=r[o];if(typeof g=="string"){for(a=g.length;g.charCodeAt(a-1)===32;)l++,a--;if(a)break;a=-1}else if(g===-2)s=!0,l++;else if(g!==-1){o++;break}}if(l){const g={type:n===e.length||s||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?a:i.start._bufferIndex+a,_index:i.start._index+o,line:i.end.line,column:i.end.column-l,offset:i.end.offset-l},end:{...i.end}};i.end={...g.start},i.start.offset===i.end.offset?Object.assign(i,g):(e.splice(n,0,["enter",g,t],["exit",g,t]),n+=2)}n++}return e}const Koe={42:Ii,43:Ii,45:Ii,48:Ii,49:Ii,50:Ii,51:Ii,52:Ii,53:Ii,54:Ii,55:Ii,56:Ii,57:Ii,62:NY},Eoe={91:Dre},Moe={[-2]:hf,[-1]:hf,32:hf},zoe={35:_re,42:Kd,45:[Ck,Kd],60:eoe,61:Ck,95:Kd,96:Ik,126:Ik},Loe={38:FY,92:HY},Doe={[-5]:mf,[-4]:mf,[-3]:mf,33:foe,38:FY,42:g0,60:[bre,loe],91:boe,92:[Qre,HY],93:_Z,95:g0,96:Xre},Toe={null:[g0,Yoe]},joe={null:[42,95]},Uoe={null:[]},Qoe=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:joe,contentInitial:Eoe,disable:Uoe,document:Koe,flow:zoe,flowInitial:Moe,insideSpan:Toe,string:Loe,text:Doe},Symbol.toStringTag,{value:"Module"}));function Poe(e,t,n){let i={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const r={},o=[];let a=[],l=[];const s={attempt:B(G),check:B(v),consume:p,enter:y,exit:Z,interrupt:B(v,{interrupt:!0})},g={code:null,containerState:{},defineSkip:f,events:[],now:m,parser:e,previous:null,sliceSerialize:I,sliceStream:C,write:u};let c=t.tokenize.call(g,s);return t.resolveAll&&o.push(t),g;function u(V){return a=Qi(a,V),b(),a[a.length-1]!==null?[]:(R(t,0),g.events=xm(o,g.events,g),g.events)}function I(V,Y){return Ooe(C(V),Y)}function C(V){return _oe(a,V)}function m(){const{_bufferIndex:V,_index:Y,line:K,column:M,offset:H}=i;return{_bufferIndex:V,_index:Y,line:K,column:M,offset:H}}function f(V){r[V.line]=V.column,W()}function b(){let V;for(;i._index<a.length;){const Y=a[i._index];if(typeof Y=="string")for(V=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===V&&i._bufferIndex<Y.length;)A(Y.charCodeAt(i._bufferIndex));else A(Y)}}function A(V){c=c(V)}function p(V){Ue(V)?(i.line++,i.column=1,i.offset+=V===-3?2:1,W()):V!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===a[i._index].length&&(i._bufferIndex=-1,i._index++)),g.previous=V}function y(V,Y){const K=Y||{};return K.type=V,K.start=m(),g.events.push(["enter",K,g]),l.push(K),K}function Z(V){const Y=l.pop();return Y.end=m(),g.events.push(["exit",Y,g]),Y}function G(V,Y){R(V,Y.from)}function v(V,Y){Y.restore()}function B(V,Y){return K;function K(M,H,w){let x,J,F,S;return Array.isArray(M)?N(M):"tokenize"in M?N([M]):E(M);function E(D){return j;function j(ne){const ie=ne!==null&&D[ne],ae=ne!==null&&D.null,Re=[...Array.isArray(ie)?ie:ie?[ie]:[],...Array.isArray(ae)?ae:ae?[ae]:[]];return N(Re)(ne)}}function N(D){return x=D,J=0,D.length===0?w:k(D[J])}function k(D){return j;function j(ne){return S=X(),F=D,D.partial||(g.currentConstruct=D),D.name&&g.parser.constructs.disable.null.includes(D.name)?L():D.tokenize.call(Y?Object.assign(Object.create(g),Y):g,s,z,L)(ne)}}function z(D){return V(F,S),H}function L(D){return S.restore(),++J<x.length?k(x[J]):w}}}function R(V,Y){V.resolveAll&&!o.includes(V)&&o.push(V),V.resolve&&Xi(g.events,Y,g.events.length-Y,V.resolve(g.events.slice(Y),g)),V.resolveTo&&(g.events=V.resolveTo(g.events,g))}function X(){const V=m(),Y=g.previous,K=g.currentConstruct,M=g.events.length,H=Array.from(l);return{from:M,restore:w};function w(){i=V,g.previous=Y,g.currentConstruct=K,g.events.length=M,l=H,W()}}function W(){i.line in r&&i.column<2&&(i.column=r[i.line],i.offset+=r[i.line]-1)}}function _oe(e,t){const n=t.start._index,i=t.start._bufferIndex,r=t.end._index,o=t.end._bufferIndex;let a;if(n===r)a=[e[n].slice(i,o)];else{if(a=e.slice(n,r),i>-1){const l=a[0];typeof l=="string"?a[0]=l.slice(i):a.shift()}o>0&&a.push(e[r].slice(0,o))}return a}function Ooe(e,t){let n=-1;const i=[];let r;for(;++n<e.length;){const o=e[n];let a;if(typeof o=="string")a=o;else switch(o){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=t?" ":"	";break}case-1:{if(!t&&r)continue;a=" ";break}default:a=String.fromCharCode(o)}r=o===-2,i.push(a)}return i.join("")}function qoe(e){const i={constructs:JY([Qoe,...(e||{}).extensions||[]]),content:r(dre),defined:[],document:r(hre),flow:r(Xoe),lazy:{},string:r(Noe),text:r(Hoe)};return i;function r(o){return a;function a(l){return Poe(i,o,l)}}}function $oe(e){for(;!KY(e););return e}const hk=/[\0\t\n\r]/g;function eae(){let e=1,t="",n=!0,i;return r;function r(o,a,l){const s=[];let g,c,u,I,C;for(o=t+(typeof o=="string"?o.toString():new TextDecoder(a||void 0).decode(o)),u=0,t="",n&&(o.charCodeAt(0)===65279&&u++,n=void 0);u<o.length;){if(hk.lastIndex=u,g=hk.exec(o),I=g&&g.index!==void 0?g.index:o.length,C=o.charCodeAt(I),!g){t=o.slice(u);break}if(C===10&&u===I&&i)s.push(-3),i=void 0;else switch(i&&(s.push(-5),i=void 0),u<I&&(s.push(o.slice(u,I)),e+=I-u),C){case 0:{s.push(65533),e++;break}case 9:{for(c=Math.ceil(e/4)*4,s.push(-2);e++<c;)s.push(-1);break}case 10:{s.push(-4),e=1;break}default:i=!0,e=1}u=I+1}return l&&(i&&s.push(-5),t&&s.push(t),s.push(null)),s}}const tae=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function nae(e){return e.replace(tae,iae)}function iae(e,t,n){if(t)return t;if(n.charCodeAt(0)===35){const r=n.charCodeAt(1),o=r===120||r===88;return YY(n.slice(o?2:1),o?16:10)}return PZ(n)||e}const TY={}.hasOwnProperty;function rae(e,t,n){return typeof t!="string"&&(n=t,t=void 0),oae(n)($oe(qoe(n).document().write(eae()(e,t,!0))))}function oae(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(xe),autolinkProtocol:X,autolinkEmail:X,atxHeading:o(me),blockQuote:o(ae),characterEscape:X,characterReference:X,codeFenced:o(Re),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:o(Re,a),codeText:o(de,a),codeTextData:X,data:X,codeFlowValue:X,definition:o(Q),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:o(O),hardBreakEscape:o(Ae),hardBreakTrailing:o(Ae),htmlFlow:o(De,a),htmlFlowData:X,htmlText:o(De,a),htmlTextData:X,image:o(ke),label:a,link:o(xe),listItem:o(We),listItemValue:I,listOrdered:o(Ee,u),listUnordered:o(Ee),paragraph:o(ze),reference:k,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:o(me),strong:o(Ge),thematicBreak:o(Pe)},exit:{atxHeading:s(),atxHeadingSequence:G,autolink:s(),autolinkEmail:ie,autolinkProtocol:ne,blockQuote:s(),characterEscapeValue:W,characterReferenceMarkerHexadecimal:L,characterReferenceMarkerNumeric:L,characterReferenceValue:D,characterReference:j,codeFenced:s(b),codeFencedFence:f,codeFencedFenceInfo:C,codeFencedFenceMeta:m,codeFlowValue:W,codeIndented:s(A),codeText:s(H),codeTextData:W,data:W,definition:s(),definitionDestinationString:Z,definitionLabelString:p,definitionTitleString:y,emphasis:s(),hardBreakEscape:s(Y),hardBreakTrailing:s(Y),htmlFlow:s(K),htmlFlowData:W,htmlText:s(M),htmlTextData:W,image:s(x),label:F,labelText:J,lineEnding:V,link:s(w),listItem:s(),listOrdered:s(),listUnordered:s(),paragraph:s(),referenceString:z,resourceDestinationString:S,resourceTitleString:E,resource:N,setextHeading:s(R),setextHeadingLineSequence:B,setextHeadingText:v,strong:s(),thematicBreak:s()}};jY(t,(e||{}).mdastExtensions||[]);const n={};return i;function i(U){let oe={type:"root",children:[]};const P={stack:[oe],tokenStack:[],config:t,enter:l,exit:g,buffer:a,resume:c,data:n},re=[];let ve=-1;for(;++ve<U.length;)if(U[ve][1].type==="listOrdered"||U[ve][1].type==="listUnordered")if(U[ve][0]==="enter")re.push(ve);else{const Fe=re.pop();ve=r(U,Fe,ve)}for(ve=-1;++ve<U.length;){const Fe=t[U[ve][0]];TY.call(Fe,U[ve][1].type)&&Fe[U[ve][1].type].call(Object.assign({sliceSerialize:U[ve][2].sliceSerialize},P),U[ve][1])}if(P.tokenStack.length>0){const Fe=P.tokenStack[P.tokenStack.length-1];(Fe[1]||mk).call(P,void 0,Fe[0])}for(oe.position={start:Bo(U.length>0?U[0][1].start:{line:1,column:1,offset:0}),end:Bo(U.length>0?U[U.length-2][1].end:{line:1,column:1,offset:0})},ve=-1;++ve<t.transforms.length;)oe=t.transforms[ve](oe)||oe;return oe}function r(U,oe,P){let re=oe-1,ve=-1,Fe=!1,Te,Xe,Ye,qe;for(;++re<=P;){const $e=U[re];switch($e[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{$e[0]==="enter"?ve++:ve--,qe=void 0;break}case"lineEndingBlank":{$e[0]==="enter"&&(Te&&!qe&&!ve&&!Ye&&(Ye=re),qe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:qe=void 0}if(!ve&&$e[0]==="enter"&&$e[1].type==="listItemPrefix"||ve===-1&&$e[0]==="exit"&&($e[1].type==="listUnordered"||$e[1].type==="listOrdered")){if(Te){let et=re;for(Xe=void 0;et--;){const Oe=U[et];if(Oe[1].type==="lineEnding"||Oe[1].type==="lineEndingBlank"){if(Oe[0]==="exit")continue;Xe&&(U[Xe][1].type="lineEndingBlank",Fe=!0),Oe[1].type="lineEnding",Xe=et}else if(!(Oe[1].type==="linePrefix"||Oe[1].type==="blockQuotePrefix"||Oe[1].type==="blockQuotePrefixWhitespace"||Oe[1].type==="blockQuoteMarker"||Oe[1].type==="listItemIndent"))break}Ye&&(!Xe||Ye<Xe)&&(Te._spread=!0),Te.end=Object.assign({},Xe?U[Xe][1].start:$e[1].end),U.splice(Xe||re,0,["exit",Te,$e[2]]),re++,P++}if($e[1].type==="listItemPrefix"){const et={type:"listItem",_spread:!1,start:Object.assign({},$e[1].start),end:void 0};Te=et,U.splice(re,0,["enter",et,$e[2]]),re++,P++,Ye=void 0,qe=!0}}}return U[oe][1]._spread=Fe,P}function o(U,oe){return P;function P(re){l.call(this,U(re),re),oe&&oe.call(this,re)}}function a(){this.stack.push({type:"fragment",children:[]})}function l(U,oe,P){this.stack[this.stack.length-1].children.push(U),this.stack.push(U),this.tokenStack.push([oe,P||void 0]),U.position={start:Bo(oe.start),end:void 0}}function s(U){return oe;function oe(P){U&&U.call(this,P),g.call(this,P)}}function g(U,oe){const P=this.stack.pop(),re=this.tokenStack.pop();if(re)re[0].type!==U.type&&(oe?oe.call(this,U,re[0]):(re[1]||mk).call(this,U,re[0]));else throw new Error("Cannot close `"+U.type+"` ("+Sc({start:U.start,end:U.end})+"): it’s not open");P.position.end=Bo(U.end)}function c(){return QZ(this.stack.pop())}function u(){this.data.expectingFirstListItemValue=!0}function I(U){if(this.data.expectingFirstListItemValue){const oe=this.stack[this.stack.length-2];oe.start=Number.parseInt(this.sliceSerialize(U),10),this.data.expectingFirstListItemValue=void 0}}function C(){const U=this.resume(),oe=this.stack[this.stack.length-1];oe.lang=U}function m(){const U=this.resume(),oe=this.stack[this.stack.length-1];oe.meta=U}function f(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function b(){const U=this.resume(),oe=this.stack[this.stack.length-1];oe.value=U.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function A(){const U=this.resume(),oe=this.stack[this.stack.length-1];oe.value=U.replace(/(\r?\n|\r)$/g,"")}function p(U){const oe=this.resume(),P=this.stack[this.stack.length-1];P.label=oe,P.identifier=fr(this.sliceSerialize(U)).toLowerCase()}function y(){const U=this.resume(),oe=this.stack[this.stack.length-1];oe.title=U}function Z(){const U=this.resume(),oe=this.stack[this.stack.length-1];oe.url=U}function G(U){const oe=this.stack[this.stack.length-1];if(!oe.depth){const P=this.sliceSerialize(U).length;oe.depth=P}}function v(){this.data.setextHeadingSlurpLineEnding=!0}function B(U){const oe=this.stack[this.stack.length-1];oe.depth=this.sliceSerialize(U).codePointAt(0)===61?1:2}function R(){this.data.setextHeadingSlurpLineEnding=void 0}function X(U){const P=this.stack[this.stack.length-1].children;let re=P[P.length-1];(!re||re.type!=="text")&&(re=it(),re.position={start:Bo(U.start),end:void 0},P.push(re)),this.stack.push(re)}function W(U){const oe=this.stack.pop();oe.value+=this.sliceSerialize(U),oe.position.end=Bo(U.end)}function V(U){const oe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const P=oe.children[oe.children.length-1];P.position.end=Bo(U.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(oe.type)&&(X.call(this,U),W.call(this,U))}function Y(){this.data.atHardBreak=!0}function K(){const U=this.resume(),oe=this.stack[this.stack.length-1];oe.value=U}function M(){const U=this.resume(),oe=this.stack[this.stack.length-1];oe.value=U}function H(){const U=this.resume(),oe=this.stack[this.stack.length-1];oe.value=U}function w(){const U=this.stack[this.stack.length-1];if(this.data.inReference){const oe=this.data.referenceType||"shortcut";U.type+="Reference",U.referenceType=oe,delete U.url,delete U.title}else delete U.identifier,delete U.label;this.data.referenceType=void 0}function x(){const U=this.stack[this.stack.length-1];if(this.data.inReference){const oe=this.data.referenceType||"shortcut";U.type+="Reference",U.referenceType=oe,delete U.url,delete U.title}else delete U.identifier,delete U.label;this.data.referenceType=void 0}function J(U){const oe=this.sliceSerialize(U),P=this.stack[this.stack.length-2];P.label=nae(oe),P.identifier=fr(oe).toLowerCase()}function F(){const U=this.stack[this.stack.length-1],oe=this.resume(),P=this.stack[this.stack.length-1];if(this.data.inReference=!0,P.type==="link"){const re=U.children;P.children=re}else P.alt=oe}function S(){const U=this.resume(),oe=this.stack[this.stack.length-1];oe.url=U}function E(){const U=this.resume(),oe=this.stack[this.stack.length-1];oe.title=U}function N(){this.data.inReference=void 0}function k(){this.data.referenceType="collapsed"}function z(U){const oe=this.resume(),P=this.stack[this.stack.length-1];P.label=oe,P.identifier=fr(this.sliceSerialize(U)).toLowerCase(),this.data.referenceType="full"}function L(U){this.data.characterReferenceType=U.type}function D(U){const oe=this.sliceSerialize(U),P=this.data.characterReferenceType;let re;P?(re=YY(oe,P==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):re=PZ(oe);const ve=this.stack[this.stack.length-1];ve.value+=re}function j(U){const oe=this.stack.pop();oe.position.end=Bo(U.end)}function ne(U){W.call(this,U);const oe=this.stack[this.stack.length-1];oe.url=this.sliceSerialize(U)}function ie(U){W.call(this,U);const oe=this.stack[this.stack.length-1];oe.url="mailto:"+this.sliceSerialize(U)}function ae(){return{type:"blockquote",children:[]}}function Re(){return{type:"code",lang:null,meta:null,value:""}}function de(){return{type:"inlineCode",value:""}}function Q(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function O(){return{type:"emphasis",children:[]}}function me(){return{type:"heading",depth:0,children:[]}}function Ae(){return{type:"break"}}function De(){return{type:"html",value:""}}function ke(){return{type:"image",title:null,url:"",alt:null}}function xe(){return{type:"link",title:null,url:"",children:[]}}function Ee(U){return{type:"list",ordered:U.type==="listOrdered",start:null,spread:U._spread,children:[]}}function We(U){return{type:"listItem",spread:U._spread,checked:null,children:[]}}function ze(){return{type:"paragraph",children:[]}}function Ge(){return{type:"strong",children:[]}}function it(){return{type:"text",value:""}}function Pe(){return{type:"thematicBreak"}}}function Bo(e){return{line:e.line,column:e.column,offset:e.offset}}function jY(e,t){let n=-1;for(;++n<t.length;){const i=t[n];Array.isArray(i)?jY(e,i):aae(e,i)}}function aae(e,t){let n;for(n in t)if(TY.call(t,n))switch(n){case"canContainEols":{const i=t[n];i&&e[n].push(...i);break}case"transforms":{const i=t[n];i&&e[n].push(...i);break}case"enter":case"exit":{const i=t[n];i&&Object.assign(e[n],i);break}}}function mk(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Sc({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Sc({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Sc({start:t.start,end:t.end})+") is still open")}function lae(e){const t=this;t.parser=n;function n(i){return rae(i,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function sae(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function gae(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function cae(e,t){const n=t.value?t.value+`
`:"",i={};t.lang&&(i.className=["language-"+t.lang]);let r={type:"element",tagName:"code",properties:i,children:[{type:"text",value:n}]};return t.meta&&(r.data={meta:t.meta}),e.patch(t,r),r=e.applyData(t,r),r={type:"element",tagName:"pre",properties:{},children:[r]},e.patch(t,r),r}function uae(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function Iae(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function dae(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",i=String(t.identifier).toUpperCase(),r=ug(i.toLowerCase()),o=e.footnoteOrder.indexOf(i);let a,l=e.footnoteCounts.get(i);l===void 0?(l=0,e.footnoteOrder.push(i),a=e.footnoteOrder.length):a=o+1,l+=1,e.footnoteCounts.set(i,l);const s={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+r,id:n+"fnref-"+r+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};e.patch(t,s);const g={type:"element",tagName:"sup",properties:{},children:[s]};return e.patch(t,g),e.applyData(t,g)}function Cae(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function hae(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function UY(e,t){const n=t.referenceType;let i="]";if(n==="collapsed"?i+="[]":n==="full"&&(i+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+i}];const r=e.all(t),o=r[0];o&&o.type==="text"?o.value="["+o.value:r.unshift({type:"text",value:"["});const a=r[r.length-1];return a&&a.type==="text"?a.value+=i:r.push({type:"text",value:i}),r}function mae(e,t){const n=String(t.identifier).toUpperCase(),i=e.definitionById.get(n);if(!i)return UY(e,t);const r={src:ug(i.url||""),alt:t.alt};i.title!==null&&i.title!==void 0&&(r.title=i.title);const o={type:"element",tagName:"img",properties:r,children:[]};return e.patch(t,o),e.applyData(t,o)}function Aae(e,t){const n={src:ug(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const i={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,i),e.applyData(t,i)}function fae(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const i={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,i),e.applyData(t,i)}function pae(e,t){const n=String(t.identifier).toUpperCase(),i=e.definitionById.get(n);if(!i)return UY(e,t);const r={href:ug(i.url||"")};i.title!==null&&i.title!==void 0&&(r.title=i.title);const o={type:"element",tagName:"a",properties:r,children:e.all(t)};return e.patch(t,o),e.applyData(t,o)}function bae(e,t){const n={href:ug(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const i={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function yae(e,t,n){const i=e.all(t),r=n?Zae(n):QY(t),o={},a=[];if(typeof t.checked=="boolean"){const c=i[0];let u;c&&c.type==="element"&&c.tagName==="p"?u=c:(u={type:"element",tagName:"p",properties:{},children:[]},i.unshift(u)),u.children.length>0&&u.children.unshift({type:"text",value:" "}),u.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let l=-1;for(;++l<i.length;){const c=i[l];(r||l!==0||c.type!=="element"||c.tagName!=="p")&&a.push({type:"text",value:`
`}),c.type==="element"&&c.tagName==="p"&&!r?a.push(...c.children):a.push(c)}const s=i[i.length-1];s&&(r||s.type!=="element"||s.tagName!=="p")&&a.push({type:"text",value:`
`});const g={type:"element",tagName:"li",properties:o,children:a};return e.patch(t,g),e.applyData(t,g)}function Zae(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let i=-1;for(;!t&&++i<n.length;)t=QY(n[i])}return t}function QY(e){const t=e.spread;return t??e.children.length>1}function vae(e,t){const n={},i=e.all(t);let r=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++r<i.length;){const a=i[r];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const o={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(i,!0)};return e.patch(t,o),e.applyData(t,o)}function Gae(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function Sae(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function Bae(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function Rae(e,t){const n=e.all(t),i=n.shift(),r=[];if(i){const a={type:"element",tagName:"thead",properties:{},children:e.wrap([i],!0)};e.patch(t.children[0],a),r.push(a)}if(n.length>0){const a={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},l=DZ(t.children[1]),s=RY(t.children[t.children.length-1]);l&&s&&(a.position={start:l,end:s}),r.push(a)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(r,!0)};return e.patch(t,o),e.applyData(t,o)}function Wae(e,t,n){const i=n?n.children:void 0,o=(i?i.indexOf(t):1)===0?"th":"td",a=n&&n.type==="table"?n.align:void 0,l=a?a.length:t.children.length;let s=-1;const g=[];for(;++s<l;){const u=t.children[s],I={},C=a?a[s]:void 0;C&&(I.align=C);let m={type:"element",tagName:o,properties:I,children:[]};u&&(m.children=e.all(u),e.patch(u,m),m=e.applyData(u,m)),g.push(m)}const c={type:"element",tagName:"tr",properties:{},children:e.wrap(g,!0)};return e.patch(t,c),e.applyData(t,c)}function kae(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const Ak=9,fk=32;function Vae(e){const t=String(e),n=/\r?\n|\r/g;let i=n.exec(t),r=0;const o=[];for(;i;)o.push(pk(t.slice(r,i.index),r>0,!0),i[0]),r=i.index+i[0].length,i=n.exec(t);return o.push(pk(t.slice(r),r>0,!1)),o.join("")}function pk(e,t,n){let i=0,r=e.length;if(t){let o=e.codePointAt(i);for(;o===Ak||o===fk;)i++,o=e.codePointAt(i)}if(n){let o=e.codePointAt(r-1);for(;o===Ak||o===fk;)r--,o=e.codePointAt(r-1)}return r>i?e.slice(i,r):""}function wae(e,t){const n={type:"text",value:Vae(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function xae(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const Xae={blockquote:sae,break:gae,code:cae,delete:uae,emphasis:Iae,footnoteReference:dae,heading:Cae,html:hae,imageReference:mae,image:Aae,inlineCode:fae,linkReference:pae,link:bae,listItem:yae,list:vae,paragraph:Gae,root:Sae,strong:Bae,table:Rae,tableCell:kae,tableRow:Wae,text:wae,thematicBreak:xae,toml:_I,yaml:_I,definition:_I,footnoteDefinition:_I};function _I(){}const PY=-1,Xm=0,UC=1,QC=2,OZ=3,qZ=4,$Z=5,ev=6,_Y=7,OY=8,bk=typeof self=="object"?self:globalThis,Jae=(e,t)=>{const n=(r,o)=>(e.set(o,r),r),i=r=>{if(e.has(r))return e.get(r);const[o,a]=t[r];switch(o){case Xm:case PY:return n(a,r);case UC:{const l=n([],r);for(const s of a)l.push(i(s));return l}case QC:{const l=n({},r);for(const[s,g]of a)l[i(s)]=i(g);return l}case OZ:return n(new Date(a),r);case qZ:{const{source:l,flags:s}=a;return n(new RegExp(l,s),r)}case $Z:{const l=n(new Map,r);for(const[s,g]of a)l.set(i(s),i(g));return l}case ev:{const l=n(new Set,r);for(const s of a)l.add(i(s));return l}case _Y:{const{name:l,message:s}=a;return n(new bk[l](s),r)}case OY:return n(BigInt(a),r);case"BigInt":return n(Object(BigInt(a)),r)}return n(new bk[o](a),r)};return i},yk=e=>Jae(new Map,e)(0),zl="",{toString:Yae}={},{keys:Nae}=Object,zg=e=>{const t=typeof e;if(t!=="object"||!e)return[Xm,t];const n=Yae.call(e).slice(8,-1);switch(n){case"Array":return[UC,zl];case"Object":return[QC,zl];case"Date":return[OZ,zl];case"RegExp":return[qZ,zl];case"Map":return[$Z,zl];case"Set":return[ev,zl]}return n.includes("Array")?[UC,n]:n.includes("Error")?[_Y,n]:[QC,n]},OI=([e,t])=>e===Xm&&(t==="function"||t==="symbol"),Hae=(e,t,n,i)=>{const r=(a,l)=>{const s=i.push(a)-1;return n.set(l,s),s},o=a=>{if(n.has(a))return n.get(a);let[l,s]=zg(a);switch(l){case Xm:{let c=a;switch(s){case"bigint":l=OY,c=a.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+s);c=null;break;case"undefined":return r([PY],a)}return r([l,c],a)}case UC:{if(s)return r([s,[...a]],a);const c=[],u=r([l,c],a);for(const I of a)c.push(o(I));return u}case QC:{if(s)switch(s){case"BigInt":return r([s,a.toString()],a);case"Boolean":case"Number":case"String":return r([s,a.valueOf()],a)}if(t&&"toJSON"in a)return o(a.toJSON());const c=[],u=r([l,c],a);for(const I of Nae(a))(e||!OI(zg(a[I])))&&c.push([o(I),o(a[I])]);return u}case OZ:return r([l,a.toISOString()],a);case qZ:{const{source:c,flags:u}=a;return r([l,{source:c,flags:u}],a)}case $Z:{const c=[],u=r([l,c],a);for(const[I,C]of a)(e||!(OI(zg(I))||OI(zg(C))))&&c.push([o(I),o(C)]);return u}case ev:{const c=[],u=r([l,c],a);for(const I of a)(e||!OI(zg(I)))&&c.push(o(I));return u}}const{message:g}=a;return r([l,{name:s,message:g}],a)};return o},Zk=(e,{json:t,lossy:n}={})=>{const i=[];return Hae(!(t||n),!!t,new Map,i)(e),i},PC=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?yk(Zk(e,t)):structuredClone(e):(e,t)=>yk(Zk(e,t));function Fae(e,t){const n=[{type:"text",value:"↩"}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function Kae(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function Eae(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||Fae,i=e.options.footnoteBackLabel||Kae,r=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",a=e.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let s=-1;for(;++s<e.footnoteOrder.length;){const g=e.footnoteById.get(e.footnoteOrder[s]);if(!g)continue;const c=e.all(g),u=String(g.identifier).toUpperCase(),I=ug(u.toLowerCase());let C=0;const m=[],f=e.footnoteCounts.get(u);for(;f!==void 0&&++C<=f;){m.length>0&&m.push({type:"text",value:" "});let p=typeof n=="string"?n:n(s,C);typeof p=="string"&&(p={type:"text",value:p}),m.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+I+(C>1?"-"+C:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(s,C),className:["data-footnote-backref"]},children:Array.isArray(p)?p:[p]})}const b=c[c.length-1];if(b&&b.type==="element"&&b.tagName==="p"){const p=b.children[b.children.length-1];p&&p.type==="text"?p.value+=" ":b.children.push({type:"text",value:" "}),b.children.push(...m)}else c.push(...m);const A={type:"element",tagName:"li",properties:{id:t+"fn-"+I},children:e.wrap(c,!0)};e.patch(g,A),l.push(A)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...PC(a),id:"footnote-label"},children:[{type:"text",value:r}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(l,!0)},{type:"text",value:`
`}]}}const Jm=function(e){if(e==null)return Dae;if(typeof e=="function")return Ym(e);if(typeof e=="object")return Array.isArray(e)?Mae(e):zae(e);if(typeof e=="string")return Lae(e);throw new Error("Expected function, string, or object as test")};function Mae(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=Jm(e[n]);return Ym(i);function i(...r){let o=-1;for(;++o<t.length;)if(t[o].apply(this,r))return!0;return!1}}function zae(e){const t=e;return Ym(n);function n(i){const r=i;let o;for(o in e)if(r[o]!==t[o])return!1;return!0}}function Lae(e){return Ym(t);function t(n){return n&&n.type===e}}function Ym(e){return t;function t(n,i,r){return!!(Tae(n)&&e.call(this,n,typeof i=="number"?i:void 0,r||void 0))}}function Dae(){return!0}function Tae(e){return e!==null&&typeof e=="object"&&"type"in e}const qY=[],jae=!0,c0=!1,Uae="skip";function $Y(e,t,n,i){let r;typeof t=="function"&&typeof n!="function"?(i=n,n=t):r=t;const o=Jm(r),a=i?-1:1;l(e,void 0,[])();function l(s,g,c){const u=s&&typeof s=="object"?s:{};if(typeof u.type=="string"){const C=typeof u.tagName=="string"?u.tagName:typeof u.name=="string"?u.name:void 0;Object.defineProperty(I,"name",{value:"node ("+(s.type+(C?"<"+C+">":""))+")"})}return I;function I(){let C=qY,m,f,b;if((!t||o(s,g,c[c.length-1]||void 0))&&(C=Qae(n(s,c)),C[0]===c0))return C;if("children"in s&&s.children){const A=s;if(A.children&&C[0]!==Uae)for(f=(i?A.children.length:-1)+a,b=c.concat(A);f>-1&&f<A.children.length;){const p=A.children[f];if(m=l(p,f,b)(),m[0]===c0)return m;f=typeof m[1]=="number"?m[1]:f+a}}return C}}}function Qae(e){return Array.isArray(e)?e:typeof e=="number"?[jae,e]:e==null?qY:[e]}function tv(e,t,n,i){let r,o,a;typeof t=="function"&&typeof n!="function"?(o=void 0,a=t,r=n):(o=t,a=n,r=i),$Y(e,o,l,r);function l(s,g){const c=g[g.length-1],u=c?c.children.indexOf(s):void 0;return a(s,u,c)}}const u0={}.hasOwnProperty,Pae={};function _ae(e,t){const n=t||Pae,i=new Map,r=new Map,o=new Map,a={...Xae,...n.handlers},l={all:g,applyData:qae,definitionById:i,footnoteById:r,footnoteCounts:o,footnoteOrder:[],handlers:a,one:s,options:n,patch:Oae,wrap:ele};return tv(e,function(c){if(c.type==="definition"||c.type==="footnoteDefinition"){const u=c.type==="definition"?i:r,I=String(c.identifier).toUpperCase();u.has(I)||u.set(I,c)}}),l;function s(c,u){const I=c.type,C=l.handlers[I];if(u0.call(l.handlers,I)&&C)return C(l,c,u);if(l.options.passThrough&&l.options.passThrough.includes(I)){if("children"in c){const{children:f,...b}=c,A=PC(b);return A.children=l.all(c),A}return PC(c)}return(l.options.unknownHandler||$ae)(l,c,u)}function g(c){const u=[];if("children"in c){const I=c.children;let C=-1;for(;++C<I.length;){const m=l.one(I[C],c);if(m){if(C&&I[C-1].type==="break"&&(!Array.isArray(m)&&m.type==="text"&&(m.value=vk(m.value)),!Array.isArray(m)&&m.type==="element")){const f=m.children[0];f&&f.type==="text"&&(f.value=vk(f.value))}Array.isArray(m)?u.push(...m):u.push(m)}}}return u}}function Oae(e,t){e.position&&(t.position=Hie(e))}function qae(e,t){let n=t;if(e&&e.data){const i=e.data.hName,r=e.data.hChildren,o=e.data.hProperties;if(typeof i=="string")if(n.type==="element")n.tagName=i;else{const a="children"in n?n.children:[n];n={type:"element",tagName:i,properties:{},children:a}}n.type==="element"&&o&&Object.assign(n.properties,PC(o)),"children"in n&&n.children&&r!==null&&r!==void 0&&(n.children=r)}return n}function $ae(e,t){const n=t.data||{},i="value"in t&&!(u0.call(n,"hProperties")||u0.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function ele(e,t){const n=[];let i=-1;for(t&&n.push({type:"text",value:`
`});++i<e.length;)i&&n.push({type:"text",value:`
`}),n.push(e[i]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function vk(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function Gk(e,t){const n=_ae(e,t),i=n.one(e,void 0),r=Eae(n),o=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return r&&o.children.push({type:"text",value:`
`},r),o}function tle(e,t){return e&&"run"in e?async function(n,i){const r=Gk(n,{file:i,...t});await e.run(r,i)}:function(n,i){return Gk(n,{file:i,...e||t})}}function Sk(e){if(e)throw e}var Ed=Object.prototype.hasOwnProperty,eN=Object.prototype.toString,Bk=Object.defineProperty,Rk=Object.getOwnPropertyDescriptor,Wk=function(t){return typeof Array.isArray=="function"?Array.isArray(t):eN.call(t)==="[object Array]"},kk=function(t){if(!t||eN.call(t)!=="[object Object]")return!1;var n=Ed.call(t,"constructor"),i=t.constructor&&t.constructor.prototype&&Ed.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!i)return!1;var r;for(r in t);return typeof r>"u"||Ed.call(t,r)},Vk=function(t,n){Bk&&n.name==="__proto__"?Bk(t,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):t[n.name]=n.newValue},wk=function(t,n){if(n==="__proto__")if(Ed.call(t,n)){if(Rk)return Rk(t,n).value}else return;return t[n]},nle=function e(){var t,n,i,r,o,a,l=arguments[0],s=1,g=arguments.length,c=!1;for(typeof l=="boolean"&&(c=l,l=arguments[1]||{},s=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});s<g;++s)if(t=arguments[s],t!=null)for(n in t)i=wk(l,n),r=wk(t,n),l!==r&&(c&&r&&(kk(r)||(o=Wk(r)))?(o?(o=!1,a=i&&Wk(i)?i:[]):a=i&&kk(i)?i:{},Vk(l,{name:n,newValue:e(c,a,r)})):typeof r<"u"&&Vk(l,{name:n,newValue:r}));return l};const Af=Es(nle);function I0(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function ile(){const e=[],t={run:n,use:i};return t;function n(...r){let o=-1;const a=r.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);l(null,...r);function l(s,...g){const c=e[++o];let u=-1;if(s){a(s);return}for(;++u<r.length;)(g[u]===null||g[u]===void 0)&&(g[u]=r[u]);r=g,c?rle(c,l)(...g):a(null,...g)}}function i(r){if(typeof r!="function")throw new TypeError("Expected `middelware` to be a function, not "+r);return e.push(r),t}}function rle(e,t){let n;return i;function i(...a){const l=e.length>a.length;let s;l&&a.push(r);try{s=e.apply(this,a)}catch(g){const c=g;if(l&&n)throw c;return r(c)}l||(s&&s.then&&typeof s.then=="function"?s.then(o,r):s instanceof Error?r(s):o(s))}function r(a,...l){n||(n=!0,t(a,...l))}function o(a){r(null,a)}}const Xr={basename:ole,dirname:ale,extname:lle,join:sle,sep:"/"};function ole(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Pu(e);let n=0,i=-1,r=e.length,o;if(t===void 0||t.length===0||t.length>e.length){for(;r--;)if(e.codePointAt(r)===47){if(o){n=r+1;break}}else i<0&&(o=!0,i=r+1);return i<0?"":e.slice(n,i)}if(t===e)return"";let a=-1,l=t.length-1;for(;r--;)if(e.codePointAt(r)===47){if(o){n=r+1;break}}else a<0&&(o=!0,a=r+1),l>-1&&(e.codePointAt(r)===t.codePointAt(l--)?l<0&&(i=r):(l=-1,i=a));return n===i?i=a:i<0&&(i=e.length),e.slice(n,i)}function ale(e){if(Pu(e),e.length===0)return".";let t=-1,n=e.length,i;for(;--n;)if(e.codePointAt(n)===47){if(i){t=n;break}}else i||(i=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function lle(e){Pu(e);let t=e.length,n=-1,i=0,r=-1,o=0,a;for(;t--;){const l=e.codePointAt(t);if(l===47){if(a){i=t+1;break}continue}n<0&&(a=!0,n=t+1),l===46?r<0?r=t:o!==1&&(o=1):r>-1&&(o=-1)}return r<0||n<0||o===0||o===1&&r===n-1&&r===i+1?"":e.slice(r,n)}function sle(...e){let t=-1,n;for(;++t<e.length;)Pu(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":gle(n)}function gle(e){Pu(e);const t=e.codePointAt(0)===47;let n=cle(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function cle(e,t){let n="",i=0,r=-1,o=0,a=-1,l,s;for(;++a<=e.length;){if(a<e.length)l=e.codePointAt(a);else{if(l===47)break;l=47}if(l===47){if(!(r===a-1||o===1))if(r!==a-1&&o===2){if(n.length<2||i!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(s=n.lastIndexOf("/"),s!==n.length-1){s<0?(n="",i=0):(n=n.slice(0,s),i=n.length-1-n.lastIndexOf("/")),r=a,o=0;continue}}else if(n.length>0){n="",i=0,r=a,o=0;continue}}t&&(n=n.length>0?n+"/..":"..",i=2)}else n.length>0?n+="/"+e.slice(r+1,a):n=e.slice(r+1,a),i=a-r-1;r=a,o=0}else l===46&&o>-1?o++:o=-1}return n}function Pu(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const ule={cwd:Ile};function Ile(){return"/"}function d0(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function dle(e){if(typeof e=="string")e=new URL(e);else if(!d0(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return Cle(e)}function Cle(e){if(e.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const i=t.codePointAt(n+2);if(i===70||i===102){const r=new TypeError("File URL path must not include encoded / characters");throw r.code="ERR_INVALID_FILE_URL_PATH",r}}return decodeURIComponent(t)}const ff=["history","path","basename","stem","extname","dirname"];class tN{constructor(t){let n;t?d0(t)?n={path:t}:typeof t=="string"||hle(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":ule.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<ff.length;){const o=ff[i];o in n&&n[o]!==void 0&&n[o]!==null&&(this[o]=o==="history"?[...n[o]]:n[o])}let r;for(r in n)ff.includes(r)||(this[r]=n[r])}get basename(){return typeof this.path=="string"?Xr.basename(this.path):void 0}set basename(t){bf(t,"basename"),pf(t,"basename"),this.path=Xr.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Xr.dirname(this.path):void 0}set dirname(t){xk(this.basename,"dirname"),this.path=Xr.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Xr.extname(this.path):void 0}set extname(t){if(pf(t,"extname"),xk(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Xr.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){d0(t)&&(t=dle(t)),bf(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Xr.basename(this.path,this.extname):void 0}set stem(t){bf(t,"stem"),pf(t,"stem"),this.path=Xr.join(this.dirname||"",t+(this.extname||""))}fail(t,n,i){const r=this.message(t,n,i);throw r.fatal=!0,r}info(t,n,i){const r=this.message(t,n,i);return r.fatal=void 0,r}message(t,n,i){const r=new ei(t,n,i);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function pf(e,t){if(e&&e.includes(Xr.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Xr.sep+"`")}function bf(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function xk(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function hle(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const mle=function(e){const i=this.constructor.prototype,r=i[e],o=function(){return r.apply(o,arguments)};return Object.setPrototypeOf(o,i),o},Ale={}.hasOwnProperty;class nv extends mle{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=ile()}copy(){const t=new nv;let n=-1;for(;++n<this.attachers.length;){const i=this.attachers[n];t.use(...i)}return t.data(Af(!0,{},this.namespace)),t}data(t,n){return typeof t=="string"?arguments.length===2?(vf("data",this.frozen),this.namespace[t]=n,this):Ale.call(this.namespace,t)&&this.namespace[t]||void 0:t?(vf("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const r=n.call(t,...i);typeof r=="function"&&this.transformers.use(r)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const n=qI(t),i=this.parser||this.Parser;return yf("parse",i),i(String(n),n)}process(t,n){const i=this;return this.freeze(),yf("process",this.parser||this.Parser),Zf("process",this.compiler||this.Compiler),n?r(void 0,n):new Promise(r);function r(o,a){const l=qI(t),s=i.parse(l);i.run(s,l,function(c,u,I){if(c||!u||!I)return g(c);const C=u,m=i.stringify(C,I);ble(m)?I.value=m:I.result=m,g(c,I)});function g(c,u){c||!u?a(c):o?o(u):n(void 0,u)}}}processSync(t){let n=!1,i;return this.freeze(),yf("processSync",this.parser||this.Parser),Zf("processSync",this.compiler||this.Compiler),this.process(t,r),Jk("processSync","process",n),i;function r(o,a){n=!0,Sk(o),i=a}}run(t,n,i){Xk(t),this.freeze();const r=this.transformers;return!i&&typeof n=="function"&&(i=n,n=void 0),i?o(void 0,i):new Promise(o);function o(a,l){const s=qI(n);r.run(t,s,g);function g(c,u,I){const C=u||t;c?l(c):a?a(C):i(void 0,C,I)}}}runSync(t,n){let i=!1,r;return this.run(t,n,o),Jk("runSync","run",i),r;function o(a,l){Sk(a),r=l,i=!0}}stringify(t,n){this.freeze();const i=qI(n),r=this.compiler||this.Compiler;return Zf("stringify",r),Xk(t),r(t,i)}use(t,...n){const i=this.attachers,r=this.namespace;if(vf("use",this.frozen),t!=null)if(typeof t=="function")s(t,n);else if(typeof t=="object")Array.isArray(t)?l(t):a(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function o(g){if(typeof g=="function")s(g,[]);else if(typeof g=="object")if(Array.isArray(g)){const[c,...u]=g;s(c,u)}else a(g);else throw new TypeError("Expected usable value, not `"+g+"`")}function a(g){if(!("plugins"in g)&&!("settings"in g))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(g.plugins),g.settings&&(r.settings=Af(!0,r.settings,g.settings))}function l(g){let c=-1;if(g!=null)if(Array.isArray(g))for(;++c<g.length;){const u=g[c];o(u)}else throw new TypeError("Expected a list of plugins, not `"+g+"`")}function s(g,c){let u=-1,I=-1;for(;++u<i.length;)if(i[u][0]===g){I=u;break}if(I===-1)i.push([g,...c]);else if(c.length>0){let[C,...m]=c;const f=i[I][1];I0(f)&&I0(C)&&(C=Af(!0,f,C)),i[I]=[g,C,...m]}}}}const fle=new nv().freeze();function yf(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function Zf(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function vf(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Xk(e){if(!I0(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Jk(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function qI(e){return ple(e)?e:new tN(e)}function ple(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function ble(e){return typeof e=="string"||yle(e)}function yle(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const Zle="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Yk=[],Nk={allowDangerousHtml:!0},vle=/^(https?|ircs?|mailto|xmpp)$/i,Gle=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Sle(e){const t=e.allowedElements,n=e.allowElement,i=e.children||"",r=e.className,o=e.components,a=e.disallowedElements,l=e.rehypePlugins||Yk,s=e.remarkPlugins||Yk,g=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Nk}:Nk,c=e.skipHtml,u=e.unwrapDisallowed,I=e.urlTransform||Ble,C=fle().use(lae).use(s).use(tle,g).use(l),m=new tN;typeof i=="string"&&(m.value=i);for(const p of Gle)Object.hasOwn(e,p.from)&&(""+p.from+(p.to?"use `"+p.to+"` instead":"remove it")+Zle+p.id,void 0);const f=C.parse(m);let b=C.runSync(f,m);return r&&(b={type:"element",tagName:"div",properties:{className:r},children:b.type==="root"?b.children:[b]}),tv(b,A),Lie(b,{Fragment:d.Fragment,components:o,ignoreInvalidStyle:!0,jsx:d.jsx,jsxs:d.jsxs,passKeys:!0,passNode:!0});function A(p,y,Z){if(p.type==="raw"&&Z&&typeof y=="number")return c?Z.children.splice(y,1):Z.children[y]={type:"text",value:p.value},y;if(p.type==="element"){let G;for(G in Cf)if(Object.hasOwn(Cf,G)&&Object.hasOwn(p.properties,G)){const v=p.properties[G],B=Cf[G];(B===null||B.includes(p.tagName))&&(p.properties[G]=I(String(v||""),G,p))}}if(p.type==="element"){let G=t?!t.includes(p.tagName):a?a.includes(p.tagName):!1;if(!G&&n&&typeof y=="number"&&(G=!n(p,y,Z)),G&&Z&&typeof y=="number")return u&&p.children?Z.children.splice(y,1,...p.children):Z.children.splice(y,1),y}}}function Ble(e){const t=e.indexOf(":"),n=e.indexOf("?"),i=e.indexOf("#"),r=e.indexOf("/");return t<0||r>-1&&t>r||n>-1&&t>n||i>-1&&t>i||vle.test(e.slice(0,t))?e:""}function Rle(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function Wle(e,t,n){const r=Jm((n||{}).ignore||[]),o=kle(t);let a=-1;for(;++a<o.length;)$Y(e,"text",l);function l(g,c){let u=-1,I;for(;++u<c.length;){const C=c[u],m=I?I.children:void 0;if(r(C,m?m.indexOf(C):void 0,I))return;I=C}if(I)return s(g,c)}function s(g,c){const u=c[c.length-1],I=o[a][0],C=o[a][1];let m=0;const b=u.children.indexOf(g);let A=!1,p=[];I.lastIndex=0;let y=I.exec(g.value);for(;y;){const Z=y.index,G={index:y.index,input:y.input,stack:[...c,g]};let v=C(...y,G);if(typeof v=="string"&&(v=v.length>0?{type:"text",value:v}:void 0),v===!1?I.lastIndex=Z+1:(m!==Z&&p.push({type:"text",value:g.value.slice(m,Z)}),Array.isArray(v)?p.push(...v):v&&p.push(v),m=Z+y[0].length,A=!0),!I.global)break;y=I.exec(g.value)}return A?(m<g.value.length&&p.push({type:"text",value:g.value.slice(m)}),u.children.splice(b,1,...p)):p=[g],b+p.length}}function kle(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!e[0]||Array.isArray(e[0])?e:[e];let i=-1;for(;++i<n.length;){const r=n[i];t.push([Vle(r[0]),wle(r[1])])}return t}function Vle(e){return typeof e=="string"?new RegExp(Rle(e),"g"):e}function wle(e){return typeof e=="function"?e:function(){return e}}function Hk(e,t){const n=String(e);if(typeof t!="string")throw new TypeError("Expected character");let i=0,r=n.indexOf(t);for(;r!==-1;)i++,r=n.indexOf(t,r+t.length);return i}const Gf="phrasing",Sf=["autolink","link","image","label"];function xle(){return{transforms:[Kle],enter:{literalAutolink:Jle,literalAutolinkEmail:Bf,literalAutolinkHttp:Bf,literalAutolinkWww:Bf},exit:{literalAutolink:Fle,literalAutolinkEmail:Hle,literalAutolinkHttp:Yle,literalAutolinkWww:Nle}}}function Xle(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Gf,notInConstruct:Sf},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Gf,notInConstruct:Sf},{character:":",before:"[ps]",after:"\\/",inConstruct:Gf,notInConstruct:Sf}]}}function Jle(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function Bf(e){this.config.enter.autolinkProtocol.call(this,e)}function Yle(e){this.config.exit.autolinkProtocol.call(this,e)}function Nle(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function Hle(e){this.config.exit.autolinkEmail.call(this,e)}function Fle(e){this.exit(e)}function Kle(e){Wle(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,Ele],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),Mle]],{ignore:["link","linkReference"]})}function Ele(e,t,n,i,r){let o="";if(!nN(r)||(/^w/i.test(t)&&(n=t+n,t="",o="http://"),!zle(n)))return!1;const a=Lle(n+i);if(!a[0])return!1;const l={type:"link",title:null,url:o+t+a[0],children:[{type:"text",value:t+a[0]}]};return a[1]?[l,{type:"text",value:a[1]}]:l}function Mle(e,t,n,i){return!nN(i,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function zle(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function Lle(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let n=t[0],i=n.indexOf(")");const r=Hk(e,"(");let o=Hk(e,")");for(;i!==-1&&r>o;)e+=n.slice(0,i+1),n=n.slice(i+1),i=n.indexOf(")"),o++;return[e,n]}function nN(e,t){const n=e.input.charCodeAt(e.index-1);return(e.index===0||cl(n)||wm(n))&&(!t||n!==47)}iN.peek=ese;function Dle(){return{enter:{gfmFootnoteDefinition:jle,gfmFootnoteDefinitionLabelString:Ule,gfmFootnoteCall:_le,gfmFootnoteCallString:Ole},exit:{gfmFootnoteDefinition:Ple,gfmFootnoteDefinitionLabelString:Qle,gfmFootnoteCall:$le,gfmFootnoteCallString:qle}}}function Tle(){return{unsafe:[{character:"[",inConstruct:["phrasing","label","reference"]}],handlers:{footnoteDefinition:tse,footnoteReference:iN}}}function jle(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function Ule(){this.buffer()}function Qle(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.label=t,n.identifier=fr(this.sliceSerialize(e)).toLowerCase()}function Ple(e){this.exit(e)}function _le(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function Ole(){this.buffer()}function qle(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.label=t,n.identifier=fr(this.sliceSerialize(e)).toLowerCase()}function $le(e){this.exit(e)}function iN(e,t,n,i){const r=n.createTracker(i);let o=r.move("[^");const a=n.enter("footnoteReference"),l=n.enter("reference");return o+=r.move(n.safe(n.associationId(e),{...r.current(),before:o,after:"]"})),l(),a(),o+=r.move("]"),o}function ese(){return"["}function tse(e,t,n,i){const r=n.createTracker(i);let o=r.move("[^");const a=n.enter("footnoteDefinition"),l=n.enter("label");return o+=r.move(n.safe(n.associationId(e),{...r.current(),before:o,after:"]"})),l(),o+=r.move("]:"+(e.children&&e.children.length>0?" ":"")),r.shift(4),o+=r.move(n.indentLines(n.containerFlow(e,r.current()),nse)),a(),o}function nse(e,t,n){return t===0?e:(n?"":"    ")+e}const ise=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];rN.peek=sse;function rse(){return{canContainEols:["delete"],enter:{strikethrough:ase},exit:{strikethrough:lse}}}function ose(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:ise}],handlers:{delete:rN}}}function ase(e){this.enter({type:"delete",children:[]},e)}function lse(e){this.exit(e)}function rN(e,t,n,i){const r=n.createTracker(i),o=n.enter("strikethrough");let a=r.move("~~");return a+=n.containerPhrasing(e,{...r.current(),before:a,after:"~"}),a+=r.move("~~"),o(),a}function sse(){return"~"}function gse(e){return e.length}function cse(e,t){const n=t||{},i=(n.align||[]).concat(),r=n.stringLength||gse,o=[],a=[],l=[],s=[];let g=0,c=-1;for(;++c<e.length;){const f=[],b=[];let A=-1;for(e[c].length>g&&(g=e[c].length);++A<e[c].length;){const p=use(e[c][A]);if(n.alignDelimiters!==!1){const y=r(p);b[A]=y,(s[A]===void 0||y>s[A])&&(s[A]=y)}f.push(p)}a[c]=f,l[c]=b}let u=-1;if(typeof i=="object"&&"length"in i)for(;++u<g;)o[u]=Fk(i[u]);else{const f=Fk(i);for(;++u<g;)o[u]=f}u=-1;const I=[],C=[];for(;++u<g;){const f=o[u];let b="",A="";f===99?(b=":",A=":"):f===108?b=":":f===114&&(A=":");let p=n.alignDelimiters===!1?1:Math.max(1,s[u]-b.length-A.length);const y=b+"-".repeat(p)+A;n.alignDelimiters!==!1&&(p=b.length+p+A.length,p>s[u]&&(s[u]=p),C[u]=p),I[u]=y}a.splice(1,0,I),l.splice(1,0,C),c=-1;const m=[];for(;++c<a.length;){const f=a[c],b=l[c];u=-1;const A=[];for(;++u<g;){const p=f[u]||"";let y="",Z="";if(n.alignDelimiters!==!1){const G=s[u]-(b[u]||0),v=o[u];v===114?y=" ".repeat(G):v===99?G%2?(y=" ".repeat(G/2+.5),Z=" ".repeat(G/2-.5)):(y=" ".repeat(G/2),Z=y):Z=" ".repeat(G)}n.delimiterStart!==!1&&!u&&A.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&p==="")&&(n.delimiterStart!==!1||u)&&A.push(" "),n.alignDelimiters!==!1&&A.push(y),A.push(p),n.alignDelimiters!==!1&&A.push(Z),n.padding!==!1&&A.push(" "),(n.delimiterEnd!==!1||u!==g-1)&&A.push("|")}m.push(n.delimiterEnd===!1?A.join("").replace(/ +$/,""):A.join(""))}return m.join(`
`)}function use(e){return e==null?"":String(e)}function Fk(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}function Ise(e,t,n,i){const r=n.enter("blockquote"),o=n.createTracker(i);o.move("> "),o.shift(2);const a=n.indentLines(n.containerFlow(e,o.current()),dse);return r(),a}function dse(e,t,n){return">"+(n?"":" ")+e}function Cse(e,t){return Kk(e,t.inConstruct,!0)&&!Kk(e,t.notInConstruct,!1)}function Kk(e,t,n){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return n;let i=-1;for(;++i<t.length;)if(e.includes(t[i]))return!0;return!1}function Ek(e,t,n,i){let r=-1;for(;++r<n.unsafe.length;)if(n.unsafe[r].character===`
`&&Cse(n.stack,n.unsafe[r]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function hse(e,t){const n=String(e);let i=n.indexOf(t),r=i,o=0,a=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===r?++o>a&&(a=o):o=1,r=i+t.length,i=n.indexOf(t,r);return a}function mse(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function Ase(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function fse(e,t,n,i){const r=Ase(n),o=e.value||"",a=r==="`"?"GraveAccent":"Tilde";if(mse(e,n)){const u=n.enter("codeIndented"),I=n.indentLines(o,pse);return u(),I}const l=n.createTracker(i),s=r.repeat(Math.max(hse(o,r)+1,3)),g=n.enter("codeFenced");let c=l.move(s);if(e.lang){const u=n.enter(`codeFencedLang${a}`);c+=l.move(n.safe(e.lang,{before:c,after:" ",encode:["`"],...l.current()})),u()}if(e.lang&&e.meta){const u=n.enter(`codeFencedMeta${a}`);c+=l.move(" "),c+=l.move(n.safe(e.meta,{before:c,after:`
`,encode:["`"],...l.current()})),u()}return c+=l.move(`
`),o&&(c+=l.move(o+`
`)),c+=l.move(s),g(),c}function pse(e,t,n){return(n?"":"    ")+e}function iv(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function bse(e,t,n,i){const r=iv(n),o=r==='"'?"Quote":"Apostrophe",a=n.enter("definition");let l=n.enter("label");const s=n.createTracker(i);let g=s.move("[");return g+=s.move(n.safe(n.associationId(e),{before:g,after:"]",...s.current()})),g+=s.move("]: "),l(),!e.url||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),g+=s.move("<"),g+=s.move(n.safe(e.url,{before:g,after:">",...s.current()})),g+=s.move(">")):(l=n.enter("destinationRaw"),g+=s.move(n.safe(e.url,{before:g,after:e.title?" ":`
`,...s.current()}))),l(),e.title&&(l=n.enter(`title${o}`),g+=s.move(" "+r),g+=s.move(n.safe(e.title,{before:g,after:r,...s.current()})),g+=s.move(r),l()),a(),g}function yse(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function yu(e){return"&#x"+e.toString(16).toUpperCase()+";"}function _C(e,t,n){const i=Ks(e),r=Ks(t);return i===void 0?r===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}oN.peek=Zse;function oN(e,t,n,i){const r=yse(n),o=n.enter("emphasis"),a=n.createTracker(i),l=a.move(r);let s=a.move(n.containerPhrasing(e,{after:r,before:l,...a.current()}));const g=s.charCodeAt(0),c=_C(i.before.charCodeAt(i.before.length-1),g,r);c.inside&&(s=yu(g)+s.slice(1));const u=s.charCodeAt(s.length-1),I=_C(i.after.charCodeAt(0),u,r);I.inside&&(s=s.slice(0,-1)+yu(u));const C=a.move(r);return o(),n.attentionEncodeSurroundingInfo={after:I.outside,before:c.outside},l+s+C}function Zse(e,t,n){return n.options.emphasis||"*"}function vse(e,t){let n=!1;return tv(e,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return n=!0,c0}),!!((!e.depth||e.depth<3)&&QZ(e)&&(t.options.setext||n))}function Gse(e,t,n,i){const r=Math.max(Math.min(6,e.depth||1),1),o=n.createTracker(i);if(vse(e,n)){const c=n.enter("headingSetext"),u=n.enter("phrasing"),I=n.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return u(),c(),I+`
`+(r===1?"=":"-").repeat(I.length-(Math.max(I.lastIndexOf("\r"),I.lastIndexOf(`
`))+1))}const a="#".repeat(r),l=n.enter("headingAtx"),s=n.enter("phrasing");o.move(a+" ");let g=n.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(g)&&(g=yu(g.charCodeAt(0))+g.slice(1)),g=g?a+" "+g:a,n.options.closeAtx&&(g+=" "+a),s(),l(),g}aN.peek=Sse;function aN(e){return e.value||""}function Sse(){return"<"}lN.peek=Bse;function lN(e,t,n,i){const r=iv(n),o=r==='"'?"Quote":"Apostrophe",a=n.enter("image");let l=n.enter("label");const s=n.createTracker(i);let g=s.move("![");return g+=s.move(n.safe(e.alt,{before:g,after:"]",...s.current()})),g+=s.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),g+=s.move("<"),g+=s.move(n.safe(e.url,{before:g,after:">",...s.current()})),g+=s.move(">")):(l=n.enter("destinationRaw"),g+=s.move(n.safe(e.url,{before:g,after:e.title?" ":")",...s.current()}))),l(),e.title&&(l=n.enter(`title${o}`),g+=s.move(" "+r),g+=s.move(n.safe(e.title,{before:g,after:r,...s.current()})),g+=s.move(r),l()),g+=s.move(")"),a(),g}function Bse(){return"!"}sN.peek=Rse;function sN(e,t,n,i){const r=e.referenceType,o=n.enter("imageReference");let a=n.enter("label");const l=n.createTracker(i);let s=l.move("![");const g=n.safe(e.alt,{before:s,after:"]",...l.current()});s+=l.move(g+"]["),a();const c=n.stack;n.stack=[],a=n.enter("reference");const u=n.safe(n.associationId(e),{before:s,after:"]",...l.current()});return a(),n.stack=c,o(),r==="full"||!g||g!==u?s+=l.move(u+"]"):r==="shortcut"?s=s.slice(0,-1):s+=l.move("]"),s}function Rse(){return"!"}gN.peek=Wse;function gN(e,t,n){let i=e.value||"",r="`",o=-1;for(;new RegExp("(^|[^`])"+r+"([^`]|$)").test(i);)r+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++o<n.unsafe.length;){const a=n.unsafe[o],l=n.compilePattern(a);let s;if(a.atBreak)for(;s=l.exec(i);){let g=s.index;i.charCodeAt(g)===10&&i.charCodeAt(g-1)===13&&g--,i=i.slice(0,g)+" "+i.slice(s.index+1)}}return r+i+r}function Wse(){return"`"}function cN(e,t){const n=QZ(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}uN.peek=kse;function uN(e,t,n,i){const r=iv(n),o=r==='"'?"Quote":"Apostrophe",a=n.createTracker(i);let l,s;if(cN(e,n)){const c=n.stack;n.stack=[],l=n.enter("autolink");let u=a.move("<");return u+=a.move(n.containerPhrasing(e,{before:u,after:">",...a.current()})),u+=a.move(">"),l(),n.stack=c,u}l=n.enter("link"),s=n.enter("label");let g=a.move("[");return g+=a.move(n.containerPhrasing(e,{before:g,after:"](",...a.current()})),g+=a.move("]("),s(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(s=n.enter("destinationLiteral"),g+=a.move("<"),g+=a.move(n.safe(e.url,{before:g,after:">",...a.current()})),g+=a.move(">")):(s=n.enter("destinationRaw"),g+=a.move(n.safe(e.url,{before:g,after:e.title?" ":")",...a.current()}))),s(),e.title&&(s=n.enter(`title${o}`),g+=a.move(" "+r),g+=a.move(n.safe(e.title,{before:g,after:r,...a.current()})),g+=a.move(r),s()),g+=a.move(")"),l(),g}function kse(e,t,n){return cN(e,n)?"<":"["}IN.peek=Vse;function IN(e,t,n,i){const r=e.referenceType,o=n.enter("linkReference");let a=n.enter("label");const l=n.createTracker(i);let s=l.move("[");const g=n.containerPhrasing(e,{before:s,after:"]",...l.current()});s+=l.move(g+"]["),a();const c=n.stack;n.stack=[],a=n.enter("reference");const u=n.safe(n.associationId(e),{before:s,after:"]",...l.current()});return a(),n.stack=c,o(),r==="full"||!g||g!==u?s+=l.move(u+"]"):r==="shortcut"?s=s.slice(0,-1):s+=l.move("]"),s}function Vse(){return"["}function rv(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function wse(e){const t=rv(e),n=e.options.bulletOther;if(!n)return t==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+n+"`) to be different");return n}function xse(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function dN(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function Xse(e,t,n,i){const r=n.enter("list"),o=n.bulletCurrent;let a=e.ordered?xse(n):rv(n);const l=e.ordered?a==="."?")":".":wse(n);let s=t&&n.bulletLastUsed?a===n.bulletLastUsed:!1;if(!e.ordered){const c=e.children?e.children[0]:void 0;if((a==="*"||a==="-")&&c&&(!c.children||!c.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(s=!0),dN(n)===a&&c){let u=-1;for(;++u<e.children.length;){const I=e.children[u];if(I&&I.type==="listItem"&&I.children&&I.children[0]&&I.children[0].type==="thematicBreak"){s=!0;break}}}}s&&(a=l),n.bulletCurrent=a;const g=n.containerFlow(e,i);return n.bulletLastUsed=a,n.bulletCurrent=o,r(),g}function Jse(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function Yse(e,t,n,i){const r=Jse(n);let o=n.bulletCurrent||rv(n);t&&t.type==="list"&&t.ordered&&(o=(typeof t.start=="number"&&t.start>-1?t.start:1)+(n.options.incrementListMarker===!1?0:t.children.indexOf(e))+o);let a=o.length+1;(r==="tab"||r==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(a=Math.ceil(a/4)*4);const l=n.createTracker(i);l.move(o+" ".repeat(a-o.length)),l.shift(a);const s=n.enter("listItem"),g=n.indentLines(n.containerFlow(e,l.current()),c);return s(),g;function c(u,I,C){return I?(C?"":" ".repeat(a))+u:(C?o:o+" ".repeat(a-o.length))+u}}function Nse(e,t,n,i){const r=n.enter("paragraph"),o=n.enter("phrasing"),a=n.containerPhrasing(e,i);return o(),r(),a}const Hse=Jm(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function Fse(e,t,n,i){return(e.children.some(function(a){return Hse(a)})?n.containerPhrasing:n.containerFlow).call(n,e,i)}function Kse(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}CN.peek=Ese;function CN(e,t,n,i){const r=Kse(n),o=n.enter("strong"),a=n.createTracker(i),l=a.move(r+r);let s=a.move(n.containerPhrasing(e,{after:r,before:l,...a.current()}));const g=s.charCodeAt(0),c=_C(i.before.charCodeAt(i.before.length-1),g,r);c.inside&&(s=yu(g)+s.slice(1));const u=s.charCodeAt(s.length-1),I=_C(i.after.charCodeAt(0),u,r);I.inside&&(s=s.slice(0,-1)+yu(u));const C=a.move(r+r);return o(),n.attentionEncodeSurroundingInfo={after:I.outside,before:c.outside},l+s+C}function Ese(e,t,n){return n.options.strong||"*"}function Mse(e,t,n,i){return n.safe(e.value,i)}function zse(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function Lse(e,t,n){const i=(dN(n)+(n.options.ruleSpaces?" ":"")).repeat(zse(n));return n.options.ruleSpaces?i.slice(0,-1):i}const hN={blockquote:Ise,break:Ek,code:fse,definition:bse,emphasis:oN,hardBreak:Ek,heading:Gse,html:aN,image:lN,imageReference:sN,inlineCode:gN,link:uN,linkReference:IN,list:Xse,listItem:Yse,paragraph:Nse,root:Fse,strong:CN,text:Mse,thematicBreak:Lse};function Dse(){return{enter:{table:Tse,tableData:Mk,tableHeader:Mk,tableRow:Use},exit:{codeText:Qse,table:jse,tableData:Rf,tableHeader:Rf,tableRow:Rf}}}function Tse(e){const t=e._align;this.enter({type:"table",align:t.map(function(n){return n==="none"?null:n}),children:[]},e),this.data.inTable=!0}function jse(e){this.exit(e),this.data.inTable=void 0}function Use(e){this.enter({type:"tableRow",children:[]},e)}function Rf(e){this.exit(e)}function Mk(e){this.enter({type:"tableCell",children:[]},e)}function Qse(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,Pse));const n=this.stack[this.stack.length-1];n.type,n.value=t,this.exit(e)}function Pse(e,t){return t==="|"?t:e}function _se(e){const t=e||{},n=t.tableCellPadding,i=t.tablePipeAlign,r=t.stringLength,o=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:I,table:a,tableCell:s,tableRow:l}};function a(C,m,f,b){return g(c(C,f,b),C.align)}function l(C,m,f,b){const A=u(C,f,b),p=g([A]);return p.slice(0,p.indexOf(`
`))}function s(C,m,f,b){const A=f.enter("tableCell"),p=f.enter("phrasing"),y=f.containerPhrasing(C,{...b,before:o,after:o});return p(),A(),y}function g(C,m){return cse(C,{align:m,alignDelimiters:i,padding:n,stringLength:r})}function c(C,m,f){const b=C.children;let A=-1;const p=[],y=m.enter("table");for(;++A<b.length;)p[A]=u(b[A],m,f);return y(),p}function u(C,m,f){const b=C.children;let A=-1;const p=[],y=m.enter("tableRow");for(;++A<b.length;)p[A]=s(b[A],C,m,f);return y(),p}function I(C,m,f){let b=hN.inlineCode(C,m,f);return f.stack.includes("tableCell")&&(b=b.replace(/\|/g,"\\$&")),b}}function Ose(){return{exit:{taskListCheckValueChecked:zk,taskListCheckValueUnchecked:zk,paragraph:$se}}}function qse(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:ege}}}function zk(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function $se(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const n=this.stack[this.stack.length-1];n.type;const i=n.children[0];if(i&&i.type==="text"){const r=t.children;let o=-1,a;for(;++o<r.length;){const l=r[o];if(l.type==="paragraph"){a=l;break}}a===n&&(i.value=i.value.slice(1),i.value.length===0?n.children.shift():n.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,n.position.start=Object.assign({},i.position.start)))}}this.exit(e)}function ege(e,t,n,i){const r=e.children[0],o=typeof e.checked=="boolean"&&r&&r.type==="paragraph",a="["+(e.checked?"x":" ")+"] ",l=n.createTracker(i);o&&l.move(a);let s=hN.listItem(e,t,n,{...i,...l.current()});return o&&(s=s.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,g)),s;function g(c){return c+a}}function tge(){return[xle(),Dle(),rse(),Dse(),Ose()]}function nge(e){return{extensions:[Xle(),Tle(),ose(),_se(e),qse()]}}const ige={tokenize:gge,partial:!0},mN={tokenize:cge,partial:!0},AN={tokenize:uge,partial:!0},fN={tokenize:Ige,partial:!0},rge={tokenize:dge,partial:!0},pN={name:"wwwAutolink",tokenize:lge,previous:yN},bN={name:"protocolAutolink",tokenize:sge,previous:ZN},Co={name:"emailAutolink",tokenize:age,previous:vN},Er={};function oge(){return{text:Er}}let Ja=48;for(;Ja<123;)Er[Ja]=Co,Ja++,Ja===58?Ja=65:Ja===91&&(Ja=97);Er[43]=Co;Er[45]=Co;Er[46]=Co;Er[95]=Co;Er[72]=[Co,bN];Er[104]=[Co,bN];Er[87]=[Co,pN];Er[119]=[Co,pN];function age(e,t,n){const i=this;let r,o;return a;function a(u){return!C0(u)||!vN.call(i,i.previous)||ov(i.events)?n(u):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),l(u))}function l(u){return C0(u)?(e.consume(u),l):u===64?(e.consume(u),s):n(u)}function s(u){return u===46?e.check(rge,c,g)(u):u===45||u===95||_n(u)?(o=!0,e.consume(u),s):c(u)}function g(u){return e.consume(u),r=!0,s}function c(u){return o&&r&&ai(i.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(u)):n(u)}}function lge(e,t,n){const i=this;return r;function r(a){return a!==87&&a!==119||!yN.call(i,i.previous)||ov(i.events)?n(a):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(ige,e.attempt(mN,e.attempt(AN,o),n),n)(a))}function o(a){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(a)}}function sge(e,t,n){const i=this;let r="",o=!1;return a;function a(u){return(u===72||u===104)&&ZN.call(i,i.previous)&&!ov(i.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),r+=String.fromCodePoint(u),e.consume(u),l):n(u)}function l(u){if(ai(u)&&r.length<5)return r+=String.fromCodePoint(u),e.consume(u),l;if(u===58){const I=r.toLowerCase();if(I==="http"||I==="https")return e.consume(u),s}return n(u)}function s(u){return u===47?(e.consume(u),o?g:(o=!0,s)):n(u)}function g(u){return u===null||jC(u)||Kt(u)||cl(u)||wm(u)?n(u):e.attempt(mN,e.attempt(AN,c),n)(u)}function c(u){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(u)}}function gge(e,t,n){let i=0;return r;function r(a){return(a===87||a===119)&&i<3?(i++,e.consume(a),r):a===46&&i===3?(e.consume(a),o):n(a)}function o(a){return a===null?n(a):t(a)}}function cge(e,t,n){let i,r,o;return a;function a(g){return g===46||g===95?e.check(fN,s,l)(g):g===null||Kt(g)||cl(g)||g!==45&&wm(g)?s(g):(o=!0,e.consume(g),a)}function l(g){return g===95?i=!0:(r=i,i=void 0),e.consume(g),a}function s(g){return r||i||!o?n(g):t(g)}}function uge(e,t){let n=0,i=0;return r;function r(a){return a===40?(n++,e.consume(a),r):a===41&&i<n?o(a):a===33||a===34||a===38||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===60||a===63||a===93||a===95||a===126?e.check(fN,t,o)(a):a===null||Kt(a)||cl(a)?t(a):(e.consume(a),r)}function o(a){return a===41&&i++,e.consume(a),r}}function Ige(e,t,n){return i;function i(l){return l===33||l===34||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===63||l===95||l===126?(e.consume(l),i):l===38?(e.consume(l),o):l===93?(e.consume(l),r):l===60||l===null||Kt(l)||cl(l)?t(l):n(l)}function r(l){return l===null||l===40||l===91||Kt(l)||cl(l)?t(l):i(l)}function o(l){return ai(l)?a(l):n(l)}function a(l){return l===59?(e.consume(l),i):ai(l)?(e.consume(l),a):n(l)}}function dge(e,t,n){return i;function i(o){return e.consume(o),r}function r(o){return _n(o)?n(o):t(o)}}function yN(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||Kt(e)}function ZN(e){return!ai(e)}function vN(e){return!(e===47||C0(e))}function C0(e){return e===43||e===45||e===46||e===95||_n(e)}function ov(e){let t=e.length,n=!1;for(;t--;){const i=e[t][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){n=!0;break}if(i._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const Cge={tokenize:Zge,partial:!0};function hge(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:pge,continuation:{tokenize:bge},exit:yge}},text:{91:{name:"gfmFootnoteCall",tokenize:fge},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:mge,resolveTo:Age}}}}function mge(e,t,n){const i=this;let r=i.events.length;const o=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let a;for(;r--;){const s=i.events[r][1];if(s.type==="labelImage"){a=s;break}if(s.type==="gfmFootnoteCall"||s.type==="labelLink"||s.type==="label"||s.type==="image"||s.type==="link")break}return l;function l(s){if(!a||!a._balanced)return n(s);const g=fr(i.sliceSerialize({start:a.end,end:i.now()}));return g.codePointAt(0)!==94||!o.includes(g.slice(1))?n(s):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(s),e.exit("gfmFootnoteCallLabelMarker"),t(s))}}function Age(e,t){let n=e.length;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},r={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};r.end.column++,r.end.offset++,r.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},r.end),end:Object.assign({},e[e.length-1][1].start)},a={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},l=[e[n+1],e[n+2],["enter",i,t],e[n+3],e[n+4],["enter",r,t],["exit",r,t],["enter",o,t],["enter",a,t],["exit",a,t],["exit",o,t],e[e.length-2],e[e.length-1],["exit",i,t]];return e.splice(n,e.length-n+1,...l),e}function fge(e,t,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o=0,a;return l;function l(u){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),s}function s(u){return u!==94?n(u):(e.enter("gfmFootnoteCallMarker"),e.consume(u),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",g)}function g(u){if(o>999||u===93&&!a||u===null||u===91||Kt(u))return n(u);if(u===93){e.exit("chunkString");const I=e.exit("gfmFootnoteCallString");return r.includes(fr(i.sliceSerialize(I)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(u)}return Kt(u)||(a=!0),o++,e.consume(u),u===92?c:g}function c(u){return u===91||u===92||u===93?(e.consume(u),o++,g):g(u)}}function pge(e,t,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o,a=0,l;return s;function s(m){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(m),e.exit("gfmFootnoteDefinitionLabelMarker"),g}function g(m){return m===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(m),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",c):n(m)}function c(m){if(a>999||m===93&&!l||m===null||m===91||Kt(m))return n(m);if(m===93){e.exit("chunkString");const f=e.exit("gfmFootnoteDefinitionLabelString");return o=fr(i.sliceSerialize(f)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(m),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),I}return Kt(m)||(l=!0),a++,e.consume(m),m===92?u:c}function u(m){return m===91||m===92||m===93?(e.consume(m),a++,c):c(m)}function I(m){return m===58?(e.enter("definitionMarker"),e.consume(m),e.exit("definitionMarker"),r.includes(o)||r.push(o),ft(e,C,"gfmFootnoteDefinitionWhitespace")):n(m)}function C(m){return t(m)}}function bge(e,t,n){return e.check(Qu,t,e.attempt(Cge,t,n))}function yge(e){e.exit("gfmFootnoteDefinition")}function Zge(e,t,n){const i=this;return ft(e,r,"gfmFootnoteDefinitionIndent",5);function r(o){const a=i.events[i.events.length-1];return a&&a[1].type==="gfmFootnoteDefinitionIndent"&&a[2].sliceSerialize(a[1],!0).length===4?t(o):n(o)}}function vge(e){let n=(e||{}).singleTilde;const i={name:"strikethrough",tokenize:o,resolveAll:r};return n==null&&(n=!0),{text:{126:i},insideSpan:{null:[i]},attentionMarkers:{null:[126]}};function r(a,l){let s=-1;for(;++s<a.length;)if(a[s][0]==="enter"&&a[s][1].type==="strikethroughSequenceTemporary"&&a[s][1]._close){let g=s;for(;g--;)if(a[g][0]==="exit"&&a[g][1].type==="strikethroughSequenceTemporary"&&a[g][1]._open&&a[s][1].end.offset-a[s][1].start.offset===a[g][1].end.offset-a[g][1].start.offset){a[s][1].type="strikethroughSequence",a[g][1].type="strikethroughSequence";const c={type:"strikethrough",start:Object.assign({},a[g][1].start),end:Object.assign({},a[s][1].end)},u={type:"strikethroughText",start:Object.assign({},a[g][1].end),end:Object.assign({},a[s][1].start)},I=[["enter",c,l],["enter",a[g][1],l],["exit",a[g][1],l],["enter",u,l]],C=l.parser.constructs.insideSpan.null;C&&Xi(I,I.length,0,xm(C,a.slice(g+1,s),l)),Xi(I,I.length,0,[["exit",u,l],["enter",a[s][1],l],["exit",a[s][1],l],["exit",c,l]]),Xi(a,g-1,s-g+3,I),s=g+I.length-2;break}}for(s=-1;++s<a.length;)a[s][1].type==="strikethroughSequenceTemporary"&&(a[s][1].type="data");return a}function o(a,l,s){const g=this.previous,c=this.events;let u=0;return I;function I(m){return g===126&&c[c.length-1][1].type!=="characterEscape"?s(m):(a.enter("strikethroughSequenceTemporary"),C(m))}function C(m){const f=Ks(g);if(m===126)return u>1?s(m):(a.consume(m),u++,C);if(u<2&&!n)return s(m);const b=a.exit("strikethroughSequenceTemporary"),A=Ks(m);return b._open=!A||A===2&&!!f,b._close=!f||f===2&&!!A,l(m)}}}class Gge{constructor(){this.map=[]}add(t,n,i){Sge(this,t,n,i)}consume(t){if(this.map.sort(function(o,a){return o[0]-a[0]}),this.map.length===0)return;let n=this.map.length;const i=[];for(;n>0;)n-=1,i.push(t.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),t.length=this.map[n][0];i.push([...t]),t.length=0;let r=i.pop();for(;r;)t.push(...r),r=i.pop();this.map.length=0}}function Sge(e,t,n,i){let r=0;if(!(n===0&&i.length===0)){for(;r<e.map.length;){if(e.map[r][0]===t){e.map[r][1]+=n,e.map[r][2].push(...i);return}r+=1}e.map.push([t,n,i])}}function Bge(e,t){let n=!1;const i=[];for(;t<e.length;){const r=e[t];if(n){if(r[0]==="enter")r[1].type==="tableContent"&&i.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(r[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const o=i.length-1;i[o]=i[o]==="left"?"center":"right"}}else if(r[1].type==="tableDelimiterRow")break}else r[0]==="enter"&&r[1].type==="tableDelimiterRow"&&(n=!0);t+=1}return i}function Rge(){return{flow:{null:{name:"table",tokenize:Wge,resolveAll:kge}}}}function Wge(e,t,n){const i=this;let r=0,o=0,a;return l;function l(W){let V=i.events.length-1;for(;V>-1;){const M=i.events[V][1].type;if(M==="lineEnding"||M==="linePrefix")V--;else break}const Y=V>-1?i.events[V][1].type:null,K=Y==="tableHead"||Y==="tableRow"?v:s;return K===v&&i.parser.lazy[i.now().line]?n(W):K(W)}function s(W){return e.enter("tableHead"),e.enter("tableRow"),g(W)}function g(W){return W===124||(a=!0,o+=1),c(W)}function c(W){return W===null?n(W):Ue(W)?o>1?(o=0,i.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(W),e.exit("lineEnding"),C):n(W):It(W)?ft(e,c,"whitespace")(W):(o+=1,a&&(a=!1,r+=1),W===124?(e.enter("tableCellDivider"),e.consume(W),e.exit("tableCellDivider"),a=!0,c):(e.enter("data"),u(W)))}function u(W){return W===null||W===124||Kt(W)?(e.exit("data"),c(W)):(e.consume(W),W===92?I:u)}function I(W){return W===92||W===124?(e.consume(W),u):u(W)}function C(W){return i.interrupt=!1,i.parser.lazy[i.now().line]?n(W):(e.enter("tableDelimiterRow"),a=!1,It(W)?ft(e,m,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(W):m(W))}function m(W){return W===45||W===58?b(W):W===124?(a=!0,e.enter("tableCellDivider"),e.consume(W),e.exit("tableCellDivider"),f):G(W)}function f(W){return It(W)?ft(e,b,"whitespace")(W):b(W)}function b(W){return W===58?(o+=1,a=!0,e.enter("tableDelimiterMarker"),e.consume(W),e.exit("tableDelimiterMarker"),A):W===45?(o+=1,A(W)):W===null||Ue(W)?Z(W):G(W)}function A(W){return W===45?(e.enter("tableDelimiterFiller"),p(W)):G(W)}function p(W){return W===45?(e.consume(W),p):W===58?(a=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(W),e.exit("tableDelimiterMarker"),y):(e.exit("tableDelimiterFiller"),y(W))}function y(W){return It(W)?ft(e,Z,"whitespace")(W):Z(W)}function Z(W){return W===124?m(W):W===null||Ue(W)?!a||r!==o?G(W):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(W)):G(W)}function G(W){return n(W)}function v(W){return e.enter("tableRow"),B(W)}function B(W){return W===124?(e.enter("tableCellDivider"),e.consume(W),e.exit("tableCellDivider"),B):W===null||Ue(W)?(e.exit("tableRow"),t(W)):It(W)?ft(e,B,"whitespace")(W):(e.enter("data"),R(W))}function R(W){return W===null||W===124||Kt(W)?(e.exit("data"),B(W)):(e.consume(W),W===92?X:R)}function X(W){return W===92||W===124?(e.consume(W),R):R(W)}}function kge(e,t){let n=-1,i=!0,r=0,o=[0,0,0,0],a=[0,0,0,0],l=!1,s=0,g,c,u;const I=new Gge;for(;++n<e.length;){const C=e[n],m=C[1];C[0]==="enter"?m.type==="tableHead"?(l=!1,s!==0&&(Lk(I,t,s,g,c),c=void 0,s=0),g={type:"table",start:Object.assign({},m.start),end:Object.assign({},m.end)},I.add(n,0,[["enter",g,t]])):m.type==="tableRow"||m.type==="tableDelimiterRow"?(i=!0,u=void 0,o=[0,0,0,0],a=[0,n+1,0,0],l&&(l=!1,c={type:"tableBody",start:Object.assign({},m.start),end:Object.assign({},m.end)},I.add(n,0,[["enter",c,t]])),r=m.type==="tableDelimiterRow"?2:c?3:1):r&&(m.type==="data"||m.type==="tableDelimiterMarker"||m.type==="tableDelimiterFiller")?(i=!1,a[2]===0&&(o[1]!==0&&(a[0]=a[1],u=$I(I,t,o,r,void 0,u),o=[0,0,0,0]),a[2]=n)):m.type==="tableCellDivider"&&(i?i=!1:(o[1]!==0&&(a[0]=a[1],u=$I(I,t,o,r,void 0,u)),o=a,a=[o[1],n,0,0])):m.type==="tableHead"?(l=!0,s=n):m.type==="tableRow"||m.type==="tableDelimiterRow"?(s=n,o[1]!==0?(a[0]=a[1],u=$I(I,t,o,r,n,u)):a[1]!==0&&(u=$I(I,t,a,r,n,u)),r=0):r&&(m.type==="data"||m.type==="tableDelimiterMarker"||m.type==="tableDelimiterFiller")&&(a[3]=n)}for(s!==0&&Lk(I,t,s,g,c),I.consume(t.events),n=-1;++n<t.events.length;){const C=t.events[n];C[0]==="enter"&&C[1].type==="table"&&(C[1]._align=Bge(t.events,n))}return e}function $I(e,t,n,i,r,o){const a=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",l="tableContent";n[0]!==0&&(o.end=Object.assign({},Ll(t.events,n[0])),e.add(n[0],0,[["exit",o,t]]));const s=Ll(t.events,n[1]);if(o={type:a,start:Object.assign({},s),end:Object.assign({},s)},e.add(n[1],0,[["enter",o,t]]),n[2]!==0){const g=Ll(t.events,n[2]),c=Ll(t.events,n[3]),u={type:l,start:Object.assign({},g),end:Object.assign({},c)};if(e.add(n[2],0,[["enter",u,t]]),i!==2){const I=t.events[n[2]],C=t.events[n[3]];if(I[1].end=Object.assign({},C[1].end),I[1].type="chunkText",I[1].contentType="text",n[3]>n[2]+1){const m=n[2]+1,f=n[3]-n[2]-1;e.add(m,f,[])}}e.add(n[3]+1,0,[["exit",u,t]])}return r!==void 0&&(o.end=Object.assign({},Ll(t.events,r)),e.add(r,0,[["exit",o,t]]),o=void 0),o}function Lk(e,t,n,i,r){const o=[],a=Ll(t.events,n);r&&(r.end=Object.assign({},a),o.push(["exit",r,t])),i.end=Object.assign({},a),o.push(["exit",i,t]),e.add(n+1,0,o)}function Ll(e,t){const n=e[t],i=n[0]==="enter"?"start":"end";return n[1][i]}const Vge={name:"tasklistCheck",tokenize:xge};function wge(){return{text:{91:Vge}}}function xge(e,t,n){const i=this;return r;function r(s){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?n(s):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(s),e.exit("taskListCheckMarker"),o)}function o(s){return Kt(s)?(e.enter("taskListCheckValueUnchecked"),e.consume(s),e.exit("taskListCheckValueUnchecked"),a):s===88||s===120?(e.enter("taskListCheckValueChecked"),e.consume(s),e.exit("taskListCheckValueChecked"),a):n(s)}function a(s){return s===93?(e.enter("taskListCheckMarker"),e.consume(s),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),l):n(s)}function l(s){return Ue(s)?t(s):It(s)?e.check({tokenize:Xge},t,n)(s):n(s)}}function Xge(e,t,n){return ft(e,i,"whitespace");function i(r){return r===null?n(r):t(r)}}function Jge(e){return JY([oge(),hge(),vge(e),Rge(),wge()])}const Yge={};function Nge(e){const t=this,n=e||Yge,i=t.data(),r=i.micromarkExtensions||(i.micromarkExtensions=[]),o=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),a=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);r.push(Jge(n)),o.push(tge()),a.push(nge(n))}const GN=({chatHistory:e})=>d.jsx("div",{className:"chat-history",children:e.map((t,n)=>d.jsx("div",{className:`message ${t.type==="user"?"user":"bot"}`,children:d.jsx(Sle,{className:"markdown-output",remarkPlugins:[Nge],children:t.message})},n))});GN.propTypes={chatHistory:Ir.arrayOf(Ir.shape({type:Ir.string.isRequired,message:Ir.string.isRequired})).isRequired};const SN=({isLoading:e})=>e?d.jsx("div",{className:"loading",children:"Loading..."}):null;SN.propTypes={isLoading:Ir.bool.isRequired};const Hge=`
You are an intelligent recipe assistant designed to help users find recipes based on their preferences, dietary restrictions, and cooking requirements.

### Your Purpose:
- Understand natural language inputs from users.
- Suggest appropriate recipes by interpreting user intents.
- Apply relevant filters for recipe tags, categories, equipment, cooking time, or ingredients.

### Guidelines:
1. Analyze the user's input for keywords and context. 
   - Examples:
     - "I feel sick" -> Vegetarian or light meals.
     - "Quick recipes under 20 minutes" -> Recipes with cooking time <= 20 minutes.
     - "I need something spicy" -> Recipes with spicy tags.
2. Use user preferences to identify:
   - Tags: Spicy, sweet, vegetarian, etc.
   - Categories: Breakfast, lunch, dinner, etc.
   - Equipment: Blender, oven, etc.
   - Ingredients: Chicken, tofu, spinach, etc.
   - Cooking Time: Duration (e.g., under 30 minutes).
3. Respond naturally and conversationally:
   - "I found some great vegetarian recipes under 20 minutes for you!"
   - "Sure! Here are spicy recipes you can try."
   - If unable to find filters, reply: "I couldn't match your request to specific recipes. Could you clarify?"

### Your Behavior:
- Be friendly, helpful, and concise.
- If the user asks to clear filters, acknowledge and confirm: "All filters have been cleared."
- If a request is unclear, ask for clarification: "Could you please specify your preferences?"

### Your Inputs:
- Consider prior chat history to understand context.
- Accept inputs such as:
  - Dietary preferences ("vegetarian," "keto").
  - Specific ingredients ("chicken," "spinach").
  - Cooking constraints ("under 15 minutes").

### Your Outputs:
- Process input to derive filtering criteria for recipes.
- Return a response with matched filters or suggestions for clarification.

EXAMPLES:
User: I’m in a hurry.  
Response: "Here are some quick recipes under 15 minutes."

User: I feel sick.  
Response: "I suggest these vegetarian recipes that are easy on the stomach."

User: Clear filters.  
Response: "All filters cleared. Showing all recipes."

User: Show me spicy food.  
Response: "Here are some spicy recipes you might like."

User: Find recipes with chicken and spinach under 30 minutes.  
Response: "Here are some recipes with chicken and spinach that take under 30 minutes."

User: Apply all filters.  
Response: "All filters have been applied. Showing all recipes."

Be proactive and engaging in your responses.
`,Fge=()=>{const[e,t]=h.useState(""),[n,i]=h.useState([]),[r,o]=h.useState(!1),{tags:a,categories:l,equipment:s,ingredients:g,filters:c,applyFilters:u,fetchRecipes:I}=rg(),C="AIzaSyAcjRHaEpo59EzIa3pgSvwfGcCE1dvGkbo",f=new qne(C).getGenerativeModel({model:"gemini-1.5-flash"}),b=y=>{t(y.target.value)},A=async()=>{if(e.trim()!==""){o(!0);try{const y=n.map(w=>`${w.type==="user"?"User:":"Bot:"} ${w.message}`).join(`
`),Z=`${Hge}
${y}
User: ${e}`;console.log("Sending prompt to API:",Z);const v=await(await f.generateContent(Z)).response,B=v.text();if(console.log("Gemini Response:",B),B.toLowerCase().includes("apply all filters")||B.toLowerCase().includes("All filters have been applied")||e.toLowerCase().includes("apply all filters")){u({tags:a.map(w=>w.name),categories:l.map(w=>w.name),equipment:s.map(w=>w.name),cookTime:null}),await I(),i(w=>[...w,{type:"user",message:e},{type:"bot",message:"All available filters have been applied. Showing recipes!"}]);return}if(B.toLowerCase().includes("clear filters")||B.toLowerCase().includes("cleared")||e.toLowerCase().includes("clear")){u({categories:[],tags:[],equipment:[],cookTime:null,ingredients:[]}),await I(),i(w=>[...w,{type:"user",message:e},{type:"bot",message:"All filters cleared. Showing all recipes!"}]);return}const R=B.toLowerCase(),X=a.find(w=>R.includes(w.name.toLowerCase())),W=l.find(w=>R.includes(w.name.toLowerCase())),V=s.find(w=>R.includes(w.name.toLowerCase())),Y=R.match(/under (\d+)\s*minutes/),K=Y?parseInt(Y[1]):null,M=g.filter(w=>R.includes(w.name.toLowerCase()));u({tags:X?[...c.tags,X.name]:c.tags,categories:W?[...c.categories,W.name]:c.categories,equipment:V?[...c.equipment,V.name]:c.equipment,cookTime:K||c.cookTime,ingredients:M.length>0?[...c.ingredients,...M.map(w=>w.name)]:c.ingredients}),await I();const H=[W&&`Category: ${W.name}`,X&&`Tag: ${X.name}`,V&&`Equipment: ${V.name}`,K&&`Cooking Time: Under ${K} minutes`,M.length>0&&`Ingredients: ${M.map(w=>w.name).join(", ")}`].filter(Boolean).join(", ");i(w=>[...w,{type:"user",message:e},{type:"bot",message:H?`Filters applied: ${H}.`:v.text()}])}catch(y){console.error("Error sending message:",y),y.response&&console.error("Error details:",y.response.data),i(Z=>[...Z,{type:"user",message:e},{type:"bot",message:"An error occurred. Please try again."}])}finally{t(""),o(!1)}}},p=()=>{i([])};return d.jsxs("div",{className:"chatbot-container",children:[d.jsx("h1",{className:"title",children:"Chatbot"}),d.jsxs("div",{className:"chat-box",children:[d.jsx(GN,{chatHistory:n}),d.jsx(SN,{isLoading:r})]}),d.jsxs("div",{className:"input-section",children:[d.jsx("input",{type:"text",className:"input-box",placeholder:"Type your message...",value:e,onChange:b}),d.jsx("button",{className:"send-button",onClick:A,disabled:r,children:"Send"})]}),d.jsx("button",{className:"clear-button",onClick:p,children:"Clear Chat"})]})},Kge=()=>d.jsx("div",{style:{position:"relative"},children:d.jsxs(Dq,{children:[d.jsxs(my,{children:[d.jsx(ut,{path:"/",element:d.jsx(Or,{to:"dashboard"})}),d.jsx(ut,{path:"dashboard",element:d.jsx(Tq,{})}),d.jsx(ut,{path:"explore",element:d.jsx(jq,{})}),d.jsx(ut,{path:"recipe/:id",element:d.jsx(Uq,{})}),d.jsx(ut,{path:"calendar",element:d.jsx(Hee,{})}),d.jsx(ut,{path:"calendar/:date",element:d.jsx(Fee,{})}),d.jsx(ut,{path:"calendar/preparation/:date",element:d.jsx(yne,{})}),d.jsx(ut,{path:"favorites",element:d.jsx(Zne,{})}),d.jsx(ut,{path:"*",element:d.jsx(Or,{to:"dashboard"})})]}),d.jsx(Fge,{})]})}),Dk="/Time2Use/assets/default_propic-C3a0Y4dY.png",Ege=({onClose:e,onChangePicture:t,onRemovePicture:n,isImageUploaded:i})=>d.jsx("div",{className:"modal-overlay",children:d.jsxs("div",{className:"modal-content",children:[d.jsx("h3",{children:"Profile Picture Options"}),d.jsx("div",{className:"button-container",children:i?d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:t,children:"Change Image"}),d.jsx("button",{onClick:n,children:"Remove Image"})]}):d.jsx("button",{onClick:t,children:"Upload Image"})}),d.jsx("button",{onClick:e,children:"Close"})," "]})}),Mge=()=>{var E;const e=Gt(),{updateUserRole:t}=vy(),[n,i]=h.useState(!1),[r,o]=h.useState(null),[a,l]=h.useState([3]),[s,g]=h.useState({username:"",birthday:"",email:"",password:"••••••••",notificationDay:3}),[c,u]=h.useState(""),[I,C]=h.useState(!1),[m,f]=h.useState(!1),[b,A]=h.useState(!1),[p,y]=h.useState(!1),[Z,G]=h.useState(""),[v,B]=h.useState(""),[R,X]=h.useState(""),[W,V]=h.useState(!1),Y=h.useRef(null),K=r!==null&&r!==Dk,M=N=>{if(!N)return"";const k=new Date(N),z=String(k.getDate()).padStart(2,"0"),L=String(k.getMonth()+1).padStart(2,"0"),D=k.getFullYear();return`${z} / ${L} / ${D}`};h.useEffect(()=>{(async()=>{var ie;const{data:{user:k},error:z}=await _.auth.getUser();if(z){console.error("Error fetching user:",z);return}const{data:L,error:D}=await _.from("profile").select("username, birthday, picture, notification_day(id, day)").eq("user",k.id).single();D?console.error("Error fetching profile:",D):(g({username:L.username,birthday:L.birthday,email:k.email,password:"••••••••",notificationDay:((ie=L.notification_day)==null?void 0:ie.id)||7}),o(L.picture));const{data:j,error:ne}=await _.from("notification_day").select("*");ne?console.error("Error fetching notification options:",ne):l(j)})()},[]);const H=async N=>{const k=N.target.files[0];if(k){const z=`${Date.now()}-${k.name}`,{data:L,error:D}=await _.storage.from("profile-picture").upload(z,k);if(D)console.error("Error uploading image:",D.message);else{const{data:j}=_.storage.from("profile-picture").getPublicUrl(z);o(j==null?void 0:j.publicUrl)}}},w=async()=>{o(null);const{data:{user:N},error:k}=await _.auth.getUser();if(k){console.error("Error fetching user:",k);return}const z={picture:null},{error:L}=await _.from("profile").update(z).eq("user",N.id);L?console.error("Error updating profile:",L):console.log("Profile picture removed successfully!"),V(!1)},x=async()=>{if(n){const{data:{user:N},error:k}=await _.auth.getUser();if(k){console.error("Error fetching user:",k);return}const z={username:c,birthday:s.birthday,picture:r,notification_day:s.notificationDay},{error:L}=await _.from("profile").update(z).eq("user",N.id);if(L?console.error("Error updating profile:",L):(console.log("Profile updated successfully!"),g(D=>({...D,username:c}))),Z){if(Z!==R){alert("Passwords do not match!");return}const{error:D}=await _.auth.updateUser({password:Z});D?console.error("Error updating password:",D):(console.log("Password updated successfully!"),G(""))}}else u(s.username);i(N=>!N)},J=async()=>{if(!v){alert("Please enter your password.");return}if(Z===v){alert("Old and New passwords cannot be the same."),F();return}if(Z.length<6){alert("New password must be at least 6 characters."),F();return}if(Z!==R){alert("Passwords do not match!"),F();return}const{data:N,error:k}=await _.auth.signInWithPassword({email:s.email,password:v});if(k){alert("Old password is incorrect."),F();return}const{error:z}=await _.auth.updateUser({password:Z});z?console.error("Error updating password:",z):(alert("Password updated successfully!"),C(!1),F(),i(!1),await S())},F=()=>{B(""),G(""),X("")},S=async()=>{try{const{error:N}=await _.auth.signOut();if(N)throw N;t(null),e("/login")}catch(N){console.error("Error signing out:",N.message)}};return d.jsxs("div",{className:`profile-container ${n?"edit-mode":""}`,children:[d.jsxs("div",{className:"profile-header",children:[d.jsxs("div",{className:"profile-avatar",children:[d.jsx("img",{src:r||Dk,alt:"Profile",className:"avatar-image"}),n&&d.jsx("div",{className:"edit-icon-container",children:d.jsx("label",{className:"edit-icon",onClick:()=>V(!0),children:d.jsx(LG,{})})})]}),d.jsx("h1",{className:"profile-username",children:s.username})]}),d.jsxs("div",{className:"profile-details",children:[d.jsxs("div",{className:"profile-row",children:[d.jsx("span",{className:"icon",children:d.jsx(Gy,{})}),d.jsx("span",{className:"profile-label",children:"Username"}),n?d.jsx("input",{type:"text",value:c,onChange:N=>u(N.target.value),className:"edit-input"}):d.jsx("span",{className:"profile-value",children:s.username})]}),d.jsxs("div",{className:"profile-row",children:[d.jsx("span",{className:"icon",children:d.jsx(t3,{})}),d.jsx("span",{className:"profile-label",children:"Birthday"}),n?d.jsx("input",{type:"date",value:s.birthday,onChange:N=>g(k=>({...k,birthday:N.target.value})),className:"edit-input"}):d.jsx("span",{className:"profile-value",children:M(s.birthday)})]}),d.jsxs("div",{className:"profile-row",children:[d.jsx("span",{className:"icon",children:d.jsx(o3,{})}),d.jsx("span",{className:"profile-label",children:"Email"}),d.jsx("span",{className:"profile-value",children:s.email})]}),d.jsxs("div",{className:"profile-row",children:[d.jsx("span",{className:"icon",children:d.jsx(l3,{})}),d.jsx("span",{className:"profile-label",children:"Password"}),d.jsxs("div",{className:"profile-password",children:[d.jsx("span",{className:"profile-value",children:"••••••••"}),n&&d.jsx("button",{type:"button",className:"edit-icon-button",onClick:()=>C(!0),children:d.jsx(LG,{})})]})]}),d.jsxs("div",{className:"profile-row",children:[d.jsx("span",{className:"icon",children:d.jsx(e3,{})}),d.jsx("span",{className:"profile-label",children:"Notification"}),n?d.jsx("select",{value:s.notificationDay,onChange:N=>g(k=>({...k,notificationDay:parseInt(N.target.value,10)})),className:"notification-select",children:a.sort((N,k)=>N.day-k.day).map(N=>d.jsxs("option",{value:N.id,children:[N.day," Day(s) Before"]},N.id))}):d.jsxs("span",{className:"profile-value",children:[((E=a.find(N=>N.id===s.notificationDay))==null?void 0:E.day)||7," Day(s) Before"]})]})]}),d.jsx("div",{className:"edit-profile",children:d.jsx("button",{className:"profile-button",onClick:x,children:n?"Save":"Edit Profile"})}),d.jsx("div",{className:"edit-profile",children:d.jsx("button",{className:"profile-button",onClick:S,children:"Sign Out"})}),I&&d.jsx("div",{className:"modal-overlay",children:d.jsxs("div",{className:"modal-content",children:[d.jsx("h3",{children:"Change Password"}),d.jsxs("div",{className:"password-container",children:[d.jsxs("div",{className:"password-input",children:[d.jsx("label",{children:"Old Password"}),d.jsx("input",{type:p?"text":"password",value:v,placeholder:"Enter old password",onChange:N=>B(N.target.value),className:"password-edit-input"}),d.jsx("button",{type:"button",className:"toggle-password",onClick:()=>y(N=>!N),children:p?"👁️":"👁️‍🗨️"})]}),d.jsxs("div",{className:"password-input",children:[d.jsx("label",{children:"New Password"}),d.jsx("input",{type:m?"text":"password",value:Z,placeholder:"Enter new password",onChange:N=>G(N.target.value),className:"password-edit-input"}),d.jsx("button",{type:"button",className:"toggle-password",onClick:()=>f(N=>!N),children:m?"👁️":"👁️‍🗨️"})]}),d.jsxs("div",{className:"password-input",children:[d.jsx("label",{children:"Confirm Password"}),d.jsx("input",{type:b?"text":"password",value:R,placeholder:"Confirm password",onChange:N=>X(N.target.value),className:"password-edit-input"}),d.jsx("button",{type:"button",className:"toggle-password",onClick:()=>A(N=>!N),children:b?"👁️":"👁️‍🗨️"})]})]}),d.jsx("button",{onClick:J,className:"save-password-btn",children:"Save"}),d.jsx("button",{onClick:()=>{F(),C(!1)},className:"cancel-btn",children:"Cancel"})]})}),d.jsx("input",{type:"file",ref:Y,style:{display:"none"},onChange:H,accept:"image/*"}),W&&d.jsx(Ege,{onClose:()=>V(!1),onChangePicture:()=>{V(!1),Y.current.click()},onRemovePicture:w,isImageUploaded:K})]})},zge=[{title:"Admin Dashboard",link:"/admin/dashboard",icon:d.jsx(Lw,{})},{title:"Manage Users",link:"/admin/users",icon:d.jsx(Gy,{})},{title:"Settings",link:"/admin/settings",icon:d.jsx(r3,{})},{title:"Recipes",icon:d.jsx(C3,{}),dropdown:!0,items:[{title:"Recipes",dropdown:!0,items:[{title:"View All Recipes",link:"/admin/recipe-management/recipes",icon:d.jsx(a3,{})},{title:"Add New Recipe",link:"/admin/recipe-management/recipes/create",icon:d.jsx(ZI,{})}]},{title:"Categories",dropdown:!0,items:[{title:"View Categories",link:"/admin/recipe-management/categories",icon:d.jsx(u3,{})},{title:"Add New Category",link:"/admin/recipe-management/categories/create",icon:d.jsx(ZI,{})}]},{title:"Tags",dropdown:!0,items:[{title:"View Tags",link:"/admin/recipe-management/tags",icon:d.jsx(c3,{})},{title:"Add New Tag",link:"/admin/recipe-management/tags/create",icon:d.jsx(ZI,{})}]},{title:"Equipment",dropdown:!0,items:[{title:"View Equipment",link:"/admin/recipe-management/equipment",icon:d.jsx(d3,{})},{title:"Add New Equipment",link:"/admin/recipe-management/equipment/create",icon:d.jsx(ZI,{})}]}]}],av=({isCollapsed:e,toggleSidebar:t})=>{const[n,i]=h.useState({}),r=Gt(),o=l=>{e&&t(),i(s=>({...s,[l]:!s[l]}))},a=(l,s)=>{i(g=>{var c;return{...g,[l]:{...g[l],[s]:!((c=g[l])!=null&&c[s])}}})};return h.useEffect(()=>{e&&i({})},[e]),d.jsxs("div",{className:`side-nav-container ${e?"collapsed":""}`,children:[d.jsx("div",{className:"toggle-btn",onClick:t,children:e?d.jsx($E,{}):d.jsx(I3,{})}),d.jsx("ul",{className:"side-nav-items",children:zge.map((l,s)=>d.jsx("li",{className:"side-nav-item",children:l.dropdown?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"dropdown-header",children:[l.link?d.jsxs(ns,{to:l.link,className:({isActive:g})=>g?"active":"",children:[d.jsx("div",{className:"nav-icon",children:l.icon}),d.jsx("span",{className:"nav-title",children:l.title})]}):d.jsxs("div",{onClick:()=>o(s),className:"dropdown-toggle",children:[d.jsx("div",{className:"nav-icon",children:l.icon}),d.jsx("span",{className:"nav-title",children:l.title})]}),d.jsx("div",{className:"dropdown-arrow",onClick:g=>{g.stopPropagation(),o(s)},children:n[s]?d.jsx(MG,{}):d.jsx(zG,{})})]}),d.jsx("ul",{className:`nested-menu ${n[s]?"expanded":""}`,children:l.items.map((g,c)=>{var u,I;return d.jsx("li",{className:"nested-item",children:g.dropdown?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"dropdown-header",onClick:()=>a(s,c),children:[d.jsx("span",{className:"nested-title",children:g.title}),(u=n[s])!=null&&u[c]?d.jsx(MG,{className:"dropdown-arrow"}):d.jsx(zG,{className:"dropdown-arrow"})]}),d.jsx("ul",{className:`nested-menu ${(I=n[s])!=null&&I[c]?"expanded":""}`,children:g.items.map((C,m)=>d.jsx("li",{className:"nested-item",children:d.jsx(ns,{to:C.link,className:({isActive:f})=>f?"active":"",children:C.title})},m))})]}):d.jsx(ns,{to:g.link,className:({isActive:C})=>C?"active":"",children:g.title})},c)})})]}):d.jsxs(ns,{to:l.link,className:({isActive:g})=>g?"active":"",children:[d.jsx("div",{className:"nav-icon",children:l.icon}),d.jsx("span",{className:"nav-title",children:l.title})]})},s))}),d.jsx("div",{className:"logout-container",children:d.jsxs("button",{className:"logout-btn",onClick:async()=>{await _.auth.signOut(),r("/login")},children:[d.jsx(g3,{className:"nav-icon"}),!e&&d.jsx("span",{className:"logout-text",children:"Logout"})]})})]})};av.propTypes={isCollapsed:Ir.bool.isRequired,toggleSidebar:Ir.func.isRequired,onLogout:Ir.func.isRequired};const h0=({children:e,isCollapsed:t,toggleSidebar:n})=>d.jsxs("div",{className:`admin-layout-container ${t?"collapsed":""}`,children:[d.jsx(av,{isCollapsed:t,toggleSidebar:n}),d.jsxs("div",{className:"admin-content-wrapper",children:[d.jsx("header",{className:"admin-header",children:d.jsx("h1",{children:"Admin Panel"})}),d.jsx("div",{className:"admin-content",children:e}),d.jsx("footer",{className:"admin-footer",children:d.jsx("p",{children:"Time2Use Admin Panel © 2024-2025"})})]})]});h0.propTypes={children:Ir.node.isRequired,isCollapsed:Ir.bool.isRequired,toggleSidebar:Ir.func.isRequired};const Lge=()=>{const[e,t]=h.useState(null),[n,i]=h.useState(""),[r,o]=h.useState(null),[a,l]=h.useState({fat:"",protein:"",calories:"",carbohydrate:""}),[s,g]=h.useState(""),[c,u]=h.useState(""),[I,C]=h.useState([]),[m,f]=h.useState([]),[b,A]=h.useState(null),[p,y]=h.useState(null),Z=Gt();h.useEffect(()=>{const R=async()=>{var Y;const{data:W,error:V}=await _.auth.getSession();if(V)console.error("Error fetching admin user:",V.message),Z("/login");else{const K=((Y=W==null?void 0:W.session)==null?void 0:Y.user)||null;t(K)}},X=async()=>{const{data:W,error:V}=await _.from("ingredients_category").select("id, category_name"),{data:Y,error:K}=await _.from("unit").select("id, unit_description");V||K?console.error("Error fetching dropdown data:",V||K):(C(W||[]),f(Y||[]))};R(),X()},[Z]);const G=R=>{o(R.target.files[0])},v=async R=>{if(R.preventDefault(),!n||!r||!b||!p){alert("Please fill all required fields.");return}try{const{data:X,error:W}=await _.storage.from("ingredient-icons").upload(`${`icons/${r.name}`}`,r,{upsert:!0});if(W)throw W;const V=X.path,{error:Y}=await _.from("ingredients").insert({name:n,icon_path:V,nutritional_info:a,pred_shelf_life:s,storage_tips:c,ingredients_category_id:b,quantity_unit_id:p});if(Y)throw Y;alert("Ingredient added successfully!"),B()}catch(X){console.error("Error adding ingredient:",X.message),alert("Failed to add ingredient.")}},B=()=>{i(""),o(null),l({fat:"",protein:"",calories:"",carbohydrate:""}),g(""),u(""),A(null),y(null)};return d.jsxs("div",{className:"admin-dashboard",children:[d.jsx("h1",{children:"Admin Dashboard"}),e&&d.jsxs("p",{children:["Welcome, Admin ",e.email]}),d.jsx("button",{className:"sign-out-btn",onClick:async()=>{await _.auth.signOut(),Z("/login")},children:"Sign Out"}),d.jsxs("div",{className:"form-container",children:[d.jsx("h2",{children:"Add New Ingredient"}),d.jsxs("form",{onSubmit:v,children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:"Ingredient Name:"}),d.jsx("input",{type:"text",value:n,onChange:R=>i(R.target.value),required:!0})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:"Icon (Image):"}),d.jsx("input",{type:"file",accept:"image/*",onChange:G,required:!0})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:"Nutritional Info:"}),d.jsx("input",{type:"text",placeholder:"Fat",value:a.fat,onChange:R=>l(X=>({...X,fat:R.target.value}))}),d.jsx("input",{type:"text",placeholder:"Protein",value:a.protein,onChange:R=>l(X=>({...X,protein:R.target.value}))}),d.jsx("input",{type:"text",placeholder:"Calories",value:a.calories,onChange:R=>l(X=>({...X,calories:R.target.value}))}),d.jsx("input",{type:"text",placeholder:"Carbohydrate",value:a.carbohydrate,onChange:R=>l(X=>({...X,carbohydrate:R.target.value}))})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:"Predicted Shelf Life:"}),d.jsx("input",{type:"text",value:s,onChange:R=>g(R.target.value),required:!0})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:"Storage Tips:"}),d.jsx("textarea",{value:c,onChange:R=>u(R.target.value),required:!0})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:"Ingredient Category:"}),d.jsxs("select",{value:b||"",onChange:R=>A(R.target.value),required:!0,children:[d.jsx("option",{value:"",disabled:!0,children:"Select a category"}),I.map(R=>d.jsx("option",{value:R.id,children:R.category_name},R.id))]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:"Quantity Unit:"}),d.jsxs("select",{value:p||"",onChange:R=>y(R.target.value),required:!0,children:[d.jsx("option",{value:"",disabled:!0,children:"Select a unit"}),m.map(R=>d.jsx("option",{value:R.id,children:R.unit_description},R.id))]})]}),d.jsx("button",{type:"submit",className:"submit-btn",children:"Add Ingredient"})]})]})]})},Dge=()=>d.jsxs("div",{children:[d.jsx("h1",{children:"Recipe Management Dashboard"}),d.jsx("p",{children:"Welcome to the Recipe Management Dashboard!"})]}),Tge=()=>{const e=Gt(),[t,n]=h.useState([]),[i,r]=h.useState([]),[o,a]=h.useState(!0),[l,s]=h.useState(null),[g,c]=h.useState(""),[u,I]=h.useState({key:"created_at",direction:"desc"}),[C,m]=h.useState(1),[f,b]=h.useState(1),A=10,p=async(B=1)=>{a(!0),s(null);try{const R=(B-1)*A,X=R+A-1,{data:W,count:V,error:Y}=await _.from("recipes").select("*",{count:"exact"}).order(u.key,{ascending:u.direction==="asc"}).range(R,X);if(Y)throw Y;n(W),r(W),b(Math.ceil(V/A))}catch(R){s("Failed to fetch recipes."),console.error(R)}finally{a(!1)}},y=B=>{const R=B.target.value.toLowerCase();if(c(R),R){const X=t.filter(W=>W.name.toLowerCase().includes(R)||W.description.toLowerCase().includes(R));r(X)}else r(t)},Z=B=>{let R="asc";u.key===B&&u.direction==="asc"&&(R="desc"),I({key:B,direction:R}),p(C)},G=B=>{B>0&&B<=f&&(m(B),p(B))};h.useEffect(()=>{p(C)},[C]);const v=async(B,R)=>{if(window.confirm("Are you sure you want to delete this recipe?"))try{a(!0);const{error:W}=await _.storage.from("recipe-pictures").remove([R]);if(W){console.error("Failed to delete image:",W),s("Failed to delete recipe image.");return}const{error:V}=await _.from("recipes").delete().eq("id",B);if(V)throw V;n(Y=>Y.filter(K=>K.id!==B)),r(Y=>Y.filter(K=>K.id!==B)),alert("Recipe and image deleted successfully.")}catch(W){s("Failed to delete recipe."),console.error(W)}finally{a(!1)}};return d.jsxs("div",{className:"recipes-container",children:[d.jsx("h1",{className:"recipes-title",children:"Manage Recipes"}),d.jsx("p",{className:"recipes-description",children:"View, create, and edit recipes."}),d.jsxs("div",{className:"recipes-controls",children:[d.jsx("input",{type:"text",placeholder:"Search recipes...",value:g,onChange:y,className:"recipes-search"}),d.jsx("button",{onClick:()=>p(C),className:"recipes-refresh-button",children:"Refresh"}),d.jsx("button",{onClick:()=>e("create"),className:"recipes-create-button",children:"Create Recipe"})]}),o&&d.jsx("p",{children:"Loading recipes..."}),l&&d.jsx("p",{className:"recipes-error",children:l}),!o&&!l&&i.length>0?d.jsxs(d.Fragment,{children:[d.jsxs("table",{className:"recipes-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsxs("th",{onClick:()=>Z("id"),className:"recipes-table-header",children:["ID ",u.key==="id"&&(u.direction==="asc"?"↑":"↓")]}),d.jsxs("th",{onClick:()=>Z("name"),className:"recipes-table-header",children:["Name ",u.key==="name"&&(u.direction==="asc"?"↑":"↓")]}),d.jsx("th",{className:"recipes-table-header",children:"Description"}),d.jsxs("th",{onClick:()=>Z("prep_time"),className:"recipes-table-header",children:["Prep Time ",u.key==="prep_time"&&(u.direction==="asc"?"↑":"↓")]}),d.jsxs("th",{onClick:()=>Z("cook_time"),className:"recipes-table-header",children:["Cook Time ",u.key==="cook_time"&&(u.direction==="asc"?"↑":"↓")]}),d.jsxs("th",{onClick:()=>Z("created_at"),className:"recipes-table-header",children:["Created At ",u.key==="created_at"&&(u.direction==="asc"?"↑":"↓")]}),d.jsx("th",{className:"recipes-table-header",children:"Image"}),d.jsx("th",{className:"recipes-table-header",children:"Actions"})]})}),d.jsx("tbody",{children:i.map(B=>d.jsxs("tr",{className:"recipes-table-row",children:[d.jsx("td",{children:B.id}),d.jsx("td",{children:B.name}),d.jsx("td",{children:B.description}),d.jsxs("td",{children:[B.prep_time," mins"]}),d.jsxs("td",{children:[B.cook_time," mins"]}),d.jsx("td",{children:new Date(B.created_at).toLocaleString()}),d.jsx("td",{children:d.jsx("img",{src:`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${B.image_path}`,alt:B.name,className:"recipes-image"})}),d.jsxs("td",{children:[d.jsx("button",{onClick:()=>e(`view/${B.id}`),className:"recipes-action-button recipes-view-button",children:"View"}),d.jsx("button",{onClick:()=>e(`edit/${B.id}`),className:"recipes-action-button recipes-edit-button",children:"Edit"}),d.jsx("button",{onClick:()=>v(B.id,B.image_path),className:"recipes-action-button recipes-delete-button",children:"Delete"})]})]},B.id))})]}),d.jsxs("div",{className:"recipes-pagination",children:[d.jsx("button",{onClick:()=>G(C-1),disabled:C===1,className:"pagination-button",children:"Previous"}),d.jsxs("span",{children:["Page ",C," of ",f]}),d.jsx("button",{onClick:()=>G(C+1),disabled:C===f,className:"pagination-button",children:"Next"})]})]}):!o&&d.jsx("p",{children:"No recipes found."})]})},BN=({initialIngredients:e,onIngredientUpdate:t})=>{const[n,i]=h.useState(e.map((l,s)=>({...l,position:s+1}))),r=zJ(MJ(Rm)),o=l=>{const{active:s,over:g}=l;if(s.id!==g.id){const u=Vm(n,n.findIndex(I=>I.id===s.id),n.findIndex(I=>I.id===g.id)).map((I,C)=>({...I,position:C+1}));i(u),t(u),console.log("Updated order:",u)}},a=()=>{const l={id:Date.now(),name:"",quantity:"",unit:"",ingredient_id:null},s=[...n,l];i(s),t(s)};return d.jsxs("div",{children:[d.jsx(iY,{sensors:r,collisionDetection:LJ,onDragEnd:o,children:d.jsx(sY,{items:n.map(l=>l.id),strategy:oY,children:d.jsx("ul",{style:{listStyleType:"none",padding:0},children:n.map(l=>d.jsx(jge,{id:l.id,ingredient:l,onUpdate:s=>{const g=n.map(c=>c.id===s.id?s:c);i(g),t(g)},onRemove:s=>{const g=n.filter(c=>c.id!==s).map((c,u)=>({...c,position:u+1}));i(g),t(g)}},l.id))})})}),d.jsx("button",{onClick:a,style:{marginTop:"10px",padding:"10px 20px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"+ Add Ingredient"})]})},jge=({id:e,ingredient:t,onUpdate:n,onRemove:i})=>{const{attributes:r,listeners:o,setNodeRef:a,transform:l,transition:s}=cY({id:e}),g={transform:Fs.Transform.toString(l),transition:s,border:"1px solid #ccc",margin:"10px 0",padding:"10px",borderRadius:"5px",display:"flex",alignItems:"center",justifyContent:"space-between",background:"#f9f9f9",position:"relative"},[c,u]=h.useState([]),[I,C]=h.useState(!1),m=async b=>{C(!0);try{const{data:A,error:p}=await _.from("ingredients").select(`
              *,
              unit:unit!ingredients_quantity_unit_id_fkey (
                unit_tag
              )
            `).ilike("name",`%${b}%`).limit(5);p?(console.error("Error fetching ingredients:",p),u([])):u(A.map(y=>({...y,unit:y.unit.unit_tag,image:`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${y.icon_path}`})))}catch(A){console.error("Error:",A),u([])}finally{C(!1)}},f=b=>{n({...t,name:b.name,ingredient_id:b.id,unit:b.unit||"",image:b.image}),u([])};return d.jsxs("li",{ref:a,style:g,...r,children:[d.jsx("span",{...o,style:{cursor:"grab",marginRight:"10px",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:"☰"}),t.image&&d.jsx("img",{src:t.image,alt:t.name,style:{width:"30px",height:"30px",borderRadius:"50%",marginRight:"10px",objectFit:"cover"}}),d.jsxs("div",{style:{flex:1,position:"relative"},children:[d.jsx("input",{type:"text",value:t.name,placeholder:"Ingredient Name",onChange:b=>{const A=b.target.value;n({...t,name:A}),A.length>1?m(A):u([])},style:{width:"100%",marginBottom:"5px",padding:"8px",border:"1px solid #ccc",borderRadius:"4px"}}),c.length>0&&d.jsx("ul",{style:{listStyle:"none",padding:"10px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"white",maxHeight:"200px",width:"100%",overflowY:"auto",position:"absolute",top:"calc(100% + 5px)",zIndex:100,boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)"},children:c.map(b=>d.jsxs("li",{onClick:()=>f(b),style:{padding:"10px",cursor:"pointer",backgroundColor:"#f4f4f4",borderBottom:"1px solid #ddd",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("img",{src:b.image,alt:b.name,style:{width:"30px",height:"30px",borderRadius:"50%",marginRight:"10px",objectFit:"cover"}}),d.jsxs("span",{style:{flex:1,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:[d.jsx("strong",{children:b.name}),b.unit&&` (${b.unit})`]}),b.category&&d.jsx("span",{style:{fontSize:"12px",color:"#666"},children:b.category})]},b.id))})]}),d.jsx("input",{type:"number",value:t.quantity,placeholder:"Quantity",onChange:b=>n({...t,quantity:b.target.value}),style:{width:"80px",marginRight:"10px"}}),d.jsx("input",{type:"text",value:t.unit,placeholder:"Unit",readOnly:!0,style:{width:"80px",marginRight:"10px",backgroundColor:"#000"}}),d.jsx("button",{onClick:()=>i(e),style:{background:"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",padding:"5px 10px"},children:"Remove"})]})},Uge=()=>{const e=Gt(),[t,n]=h.useState([]),[i,r]=h.useState([]),[o,a]=h.useState([]),[l,s]=h.useState([]),[g,c]=h.useState([]),[u,I]=h.useState({name:"",description:"",prep_time:"",cook_time:"",total_time:0,category_ids:[],tag_ids:[],equipment_ids:[],ingredients:[{name:"",quantity:"",unit:""}],steps:[{description:""}],image:null}),[C,m]=h.useState(!1),[f,b]=h.useState(""),[A,p]=h.useState([]),[y,Z]=h.useState([]);h.useEffect(()=>{(async()=>{const{data:E}=await _.from("category").select("*"),{data:N}=await _.from("tags").select("*").order("name",{ascending:!0}),{data:k}=await _.from("equipment").select("*");n(E),r(N),s(k)})()},[]),h.useEffect(()=>{(async()=>{const{data:E,error:N}=await _.from("ingredients").select("*");N?console.error("Error fetching ingredients:",N.message):(console.log("Fetched ingredients:",E),p(E))})()},[]),h.useEffect(()=>{I(S=>({...S,total_time:Number(S.prep_time||0)+Number(S.cook_time||0)}))},[u.prep_time,u.cook_time]);const G=async()=>{try{const S=u.image;let E=null;S&&(E=await B(S,u.name));const{data:N,error:k}=await _.from("recipes").insert({name:u.name,description:u.description,prep_time:u.prep_time,cook_time:u.cook_time,image_path:E}).select().single();if(k)throw k;const z=N.id;console.log("Recipe id:",z),await R(z,o),await X(z,A),await W(z,g),await V(z,u.steps),await Y(z,y),console.log("Recipe saved successfully:",N),e("/admin/category-management/recipes")}catch(S){console.error("Error saving recipe:",S.message)}},v=S=>S.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,""),B=async(S,E)=>{try{const N=v(E),k=S.name.split(".").pop(),z=`${N}.${k}`,{data:L,error:D}=await _.storage.from("recipe-pictures").upload(z,S,{cacheControl:"3600",upsert:!1});if(D)throw D;const j=`recipe-pictures/${L.path}`;return console.log("File uploaded successfully:",j),j}catch(N){return console.error("Error uploading file:",N.message),null}},R=async(S,E)=>{try{if(E.length>0){const N=E.map(z=>({recipe_id:S,tag_id:z.id})),{error:k}=await _.from("recipe_tags").insert(N);if(k)throw k;console.log("Recipe tags saved successfully!")}}catch(N){console.error("Error saving recipe tags:",N.message)}},X=async(S,E)=>{try{if(E.length>0){const N=E.filter(z=>z.ingredient_id).map(z=>({recipe_id:S,ingredient_id:z.ingredient_id,quantity:parseFloat(z.quantity)}));if(N.length===0){console.error("No valid ingredients to save");return}const{error:k}=await _.from("recipe_ingredients").insert(N);if(k)throw k}}catch(N){console.error("Error saving recipe ingredients:",N.message)}},W=async(S,E)=>{try{if(E.length>0){const N=E.map(z=>({recipe_id:S,equipment_id:z.id,quantity:1})),{error:k}=await _.from("recipe_equipment").insert(N);if(k)throw k;console.log("Recipe equipment saved successfully!")}}catch(N){console.error("Error saving recipe equipment:",N.message)}},V=async(S,E)=>{try{if(E.length>0){const N=E.map((z,L)=>({recipe_id:S,step_number:L+1,instruction:z.description})),{error:k}=await _.from("steps").insert(N);if(k)throw k}}catch(N){console.error("Error saving recipe steps:",N.message)}},Y=async(S,E)=>{try{if(E.length>0){const N=E.map(z=>({recipe_id:S,category_id:z.id})),{error:k}=await _.from("recipe_category").insert(N);if(k)throw k;console.log("Recipe categories saved successfully!")}}catch(N){console.error("Error saving recipe categories:",N.message)}},K=async()=>{if(f.trim()==="")return;const{data:S,error:E}=await _.from("category").insert({name:f});E?console.error("Error adding category:",E):(n(N=>[...N,S[0]]),m(!1),b(""))},M=(S,E,N)=>{S.some(k=>k.id===N.id)||E([...S,N])},H=(S,E,N)=>{E(S.filter(k=>k.id!==N))},w=S=>{p(S),console.log("Updated Ingredients:",S)},x=(S,E)=>{I(N=>({...N,steps:N.steps.map((k,z)=>z===S?{...k,description:E}:k)}))},J=()=>{I(S=>({...S,steps:[...S.steps,{description:""}]}))},F=S=>{I(E=>({...E,steps:E.steps.filter((N,k)=>k!==S)}))};return d.jsxs("div",{className:"create-recipe-container",children:[d.jsx("h1",{className:"create-recipe-title",children:"Create New Recipe"}),d.jsxs("div",{className:"form-section",children:[d.jsx("label",{htmlFor:"recipe-name",className:"form-label",children:"Recipe Name:"}),d.jsx("input",{type:"text",value:u.name,onChange:S=>I({...u,name:S.target.value}),required:!0,className:"form-input"}),d.jsx("label",{htmlFor:"recipe-description",className:"form-label",children:"Description:"}),d.jsx("textarea",{id:"recipe-description",value:u.description,onChange:S=>I({...u,description:S.target.value}),className:"form-textarea"}),d.jsx("label",{htmlFor:"recipe-image",className:"form-label",children:"Image: (only file with <1mb allowed)"}),d.jsx("input",{id:"recipe-image",type:"file",onChange:S=>I({...u,image:S.target.files[0]}),className:"form-file-input"})]}),d.jsxs("div",{className:"prep-details",children:[d.jsx("label",{className:"form-label",children:"Preparation Time (mins):"}),d.jsx("input",{type:"number",value:u.prep_time,onChange:S=>I({...u,prep_time:S.target.value}),className:"form-input"}),d.jsx("label",{className:"form-label",children:"Cooking Time (mins):"}),d.jsx("input",{type:"number",value:u.cook_time,onChange:S=>I({...u,cook_time:S.target.value}),className:"form-input"}),d.jsx("label",{className:"form-label",children:"Total Time (mins):"}),d.jsx("input",{type:"number",value:u.total_time,readOnly:!0,className:"form-input-readonly"})]}),d.jsx("h2",{className:"form-subtitle",children:"Categories"}),d.jsxs("select",{onChange:S=>{const E=Number(S.target.value),N=t.find(k=>k.id===E);N&&M(y,Z,N),S.target.value=""},className:"form-select",children:[d.jsx("option",{value:"",children:"Select a category..."}),t.map(S=>d.jsx("option",{value:S.id,children:S.name},S.id))]}),d.jsxs("div",{className:"selected-list",children:[d.jsx("h3",{className:"selected-list-title",children:"Selected Categories:"}),y.map(S=>d.jsxs("div",{className:"selected-item",children:[S.name," ",d.jsx("button",{className:"remove-button",onClick:()=>H(y,Z,S.id),children:"Remove"})]},S.id))]}),d.jsx("h2",{className:"form-subtitle",children:"Tags"}),d.jsxs("select",{onChange:S=>{const E=Number(S.target.value),N=i.find(k=>k.id===E);N&&M(o,a,N),S.target.value=""},className:"form-select",children:[d.jsx("option",{value:"",children:"Select a tag..."}),i.map(S=>d.jsx("option",{value:S.id,children:S.name},S.id))]}),d.jsxs("div",{className:"selected-list",children:[d.jsx("h3",{className:"selected-list-title",children:"Selected Tags:"}),o.map(S=>d.jsxs("div",{className:"selected-item",children:[S.name," ",d.jsx("button",{className:"remove-button",onClick:()=>H(o,a,S.id),children:"Remove"})]},S.id))]}),d.jsx("h2",{className:"form-subtitle",children:"Equipment"}),d.jsxs("select",{onChange:S=>{const E=Number(S.target.value),N=l.find(k=>k.id===E);N&&M(g,c,N),S.target.value=""},className:"form-select",children:[d.jsx("option",{value:"",children:"Select equipment..."}),l.map(S=>d.jsx("option",{value:S.id,children:S.name},S.id))]}),d.jsxs("div",{className:"selected-list",children:[d.jsx("h3",{className:"selected-list-title",children:"Selected Equipment:"}),g.map(S=>d.jsxs("div",{className:"selected-item",children:[S.name," ",d.jsx("button",{className:"remove-button",onClick:()=>H(g,c,S.id),children:"Remove"})]},S.id))]}),C&&d.jsxs("div",{className:"modal",children:[d.jsx("h2",{className:"modal-title",children:"Add New Category"}),d.jsx("input",{type:"text",value:f,onChange:S=>b(S.target.value),className:"form-input"}),d.jsx("button",{onClick:K,className:"button-primary",children:"Add"}),d.jsx("button",{onClick:()=>m(!1),className:"button-secondary",children:"Cancel"})]}),d.jsxs("div",{className:"ingredients-section",children:[d.jsx("h1",{className:"form-subtitle",children:"Create Recipe"}),d.jsx(BN,{initialIngredients:A,onIngredientUpdate:w})]}),d.jsxs("div",{className:"steps-section",children:[d.jsx("h2",{className:"form-subtitle",children:"Steps"}),u.steps.map((S,E)=>d.jsxs("div",{className:"step-item",children:[d.jsx("textarea",{value:S.description,onChange:N=>x(E,N.target.value),placeholder:`Step ${E+1}`,className:"form-textarea"}),d.jsx("button",{onClick:()=>F(E),className:"button-secondary remove-step-button",children:"Remove"})]},E)),d.jsx("button",{onClick:J,className:"button-primary add-step-button",children:"+ Add Step"})]}),d.jsx("button",{onClick:G,className:"button-primary save-recipe-button",children:"Save Recipe"})]})},Qge=()=>{const{id:e}=Aa(),t=Gt(),[n,i]=h.useState([]),[r,o]=h.useState([]),[a,l]=h.useState([]),[s,g]=h.useState([]),[c,u]=h.useState([]),[I,C]=h.useState([]),[m,f]=h.useState(null),[b,A]=h.useState({name:"",description:"",prep_time:"",cook_time:"",total_time:0,category_ids:[],tag_ids:[],equipment_ids:[],ingredients:[{name:"",quantity:"",unit:""}],steps:[{id:null,description:""}],image:null,image_path:""}),[p,y]=h.useState([]),[Z,G]=h.useState(!0);h.useEffect(()=>{(async()=>{G(!0);try{const{data:w,error:x}=await _.from("recipes").select("*").eq("id",e).single();if(x)throw x;const{data:J}=await _.from("category").select("*"),{data:F}=await _.from("tags").select("*").order("name",{ascending:!0}),{data:S}=await _.from("equipment").select("*"),{data:E}=await _.from("recipe_ingredients").select(`
                        ingredient_id,
                        quantity,
                        ingredients (
                            name,
                            quantity_unit_id,
                            icon_path,
                            unit:unit!ingredients_quantity_unit_id_fkey (
                                unit_tag
                            )
                        )
                    `).eq("recipe_id",e),{data:N}=await _.from("steps").select("*").eq("recipe_id",e).order("step_number",{ascending:!0}),{data:k}=await _.from("recipe_tags").select("tag_id").eq("recipe_id",e),{data:z}=await _.from("recipe_equipment").select("equipment_id").eq("recipe_id",e),{data:L}=await _.from("recipe_category").select("category_id").eq("recipe_id",e),D={name:w.name,description:w.description,prep_time:w.prep_time,cook_time:w.cook_time,total_time:w.prep_time+w.cook_time,image_path:w.image_path,steps:N.map(j=>({id:j.id,description:j.instruction})),category_ids:L.map(j=>j.category_id),tag_ids:k.map(j=>j.tag_id),equipment_ids:z.map(j=>j.equipment_id)};A(D),f(D),y(E.map((j,ne)=>({id:j.ingredient_id,name:j.ingredients.name,quantity:j.quantity,ingredient_id:j.ingredient_id,unit:j.ingredients.unit?j.ingredients.unit.unit_tag:null,image:j.ingredients.icon_path?`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${j.ingredients.icon_path}`:null,position:ne+1}))),i(J||[]),o(F||[]),g(S||[]),l(k.map(j=>j.tag_id)),u(z.map(j=>j.equipment_id)),C(L.map(j=>j.category_id))}catch(w){console.error("Error fetching data:",w)}finally{G(!1)}})()},[e]),h.useEffect(()=>{A(H=>({...H,total_time:Number(H.prep_time||0)+Number(H.cook_time||0)}))},[b.prep_time,b.cook_time]);const v=(H,w)=>{A(x=>({...x,[H]:w}))},B=H=>{y(H),console.log("Updated Ingredients in edit:",H)},R=(H,w)=>{A(x=>({...x,steps:x.steps.map((J,F)=>F===H?{...J,description:w}:J)}))},X=()=>{A(H=>({...H,steps:[...H.steps,{id:null,description:""}]}))},W=H=>{A(w=>({...w,steps:w.steps.filter((x,J)=>J!==H)}))},V=(H,w,x)=>{H.includes(x.id)||w([...H,x.id])},Y=(H,w,x)=>{w(H.filter(J=>J!==x))},K=async()=>{var H;G(!0);try{const{error:w}=await _.from("recipes").update({name:b.name,description:b.description,prep_time:b.prep_time,cook_time:b.cook_time,image_path:b.image_path}).eq("id",e);if(w)throw w;for(const[z,L]of b.steps.entries())if(L.id){const{error:D}=await _.from("steps").update({instruction:L.description,step_number:z+1}).eq("id",L.id);if(D)throw D}else{const{error:D}=await _.from("steps").insert({recipe_id:e,instruction:L.description,step_number:z+1});if(D)throw D}const x=m.steps.map(z=>z.id),J=b.steps.map(z=>z.id),F=x.filter(z=>z&&!J.includes(z));for(const z of F){const{error:L}=await _.from("steps").delete().eq("id",z);if(L)throw L}const S=async(z,L,D)=>{if(await _.from(z).delete().eq("recipe_id",e),D.length>0){const j=D.map(ie=>({recipe_id:e,[L]:ie})),{error:ne}=await _.from(z).insert(j);if(ne)throw ne}};await S("recipe_category","category_id",I),await S("recipe_tags","tag_id",a),await S("recipe_equipment","equipment_id",c);for(const z of p)if(z.ingredient_id){const{error:L}=await _.from("recipe_ingredients").upsert({recipe_id:e,ingredient_id:z.ingredient_id,quantity:z.quantity},{onConflict:["recipe_id","ingredient_id"]});if(L)throw L}else console.error("Ingredient missing ingredient_id:",z);const E=((H=m==null?void 0:m.ingredients)==null?void 0:H.map(z=>z.ingredient_id))||[],N=p.map(z=>z.ingredient_id),k=E.filter(z=>z&&!N.includes(z));for(const z of k){const{error:L}=await _.from("recipe_ingredients").delete().eq("recipe_id",e).eq("ingredient_id",z);if(L)throw L}alert("Recipe updated successfully!"),t(`/admin/recipe-management/recipes/view/${e}`)}catch(w){console.error("Error saving recipe:",w),alert("Failed to save recipe.")}finally{G(!1)}},M=()=>{A(m),t(-1)};return Z?d.jsx("p",{children:"Loading recipe..."}):d.jsxs("div",{className:"edit-recipe-container",children:[d.jsx(ba,{}),d.jsx("h1",{className:"edit-recipe-title",children:"Edit Recipe"}),d.jsxs("div",{className:"form-section",children:[d.jsx("label",{className:"form-label",children:"Recipe Name:"}),d.jsx("input",{type:"text",value:b.name,onChange:H=>v("name",H.target.value),required:!0,className:"form-input"}),d.jsx("label",{className:"form-label",children:"Description:"}),d.jsx("textarea",{value:b.description,onChange:H=>v("description",H.target.value),className:"form-textarea"}),d.jsx("label",{className:"form-label",children:"Image:"}),d.jsx("input",{type:"file",onChange:H=>v("image",H.target.files[0]),className:"form-file-input"})]}),d.jsxs("div",{className:"prep-details",children:[d.jsx("label",{className:"form-label",children:"Preparation Time (mins):"}),d.jsx("input",{type:"number",value:b.prep_time,onChange:H=>v("prep_time",H.target.value),className:"form-input"}),d.jsx("label",{className:"form-label",children:"Cooking Time (mins):"}),d.jsx("input",{type:"number",value:b.cook_time,onChange:H=>v("cook_time",H.target.value),className:"form-input"}),d.jsx("label",{className:"form-label",children:"Total Time (mins):"}),d.jsx("input",{type:"number",value:b.total_time,readOnly:!0,className:"form-input-readonly"})]}),d.jsx("h2",{className:"form-subtitle",children:"Categories"}),d.jsxs("select",{onChange:H=>{const w=Number(H.target.value),x=n.find(J=>J.id===w);x&&V(I,C,x),H.target.value=""},className:"form-select",children:[d.jsx("option",{value:"",children:"Select a category..."}),n.map(H=>d.jsx("option",{value:H.id,children:H.name},H.id))]}),d.jsxs("div",{className:"selected-list",children:[d.jsx("h3",{className:"selected-list-title",children:"Selected Categories:"}),I.map(H=>{const w=n.find(x=>x.id===H);return w?d.jsxs("div",{className:"selected-item",children:[w.name,d.jsx("button",{onClick:()=>Y(I,C,H),className:"remove-button",children:"Remove"})]},H):null})]}),d.jsx("h2",{className:"form-subtitle",children:"Tags"}),d.jsxs("select",{onChange:H=>{const w=Number(H.target.value),x=r.find(J=>J.id===w);x&&V(a,l,x),H.target.value=""},className:"form-select",children:[d.jsx("option",{value:"",children:"Select a tag..."}),r.map(H=>d.jsx("option",{value:H.id,children:H.name},H.id))]}),d.jsxs("div",{className:"selected-list",children:[d.jsx("h3",{className:"selected-list-title",children:"Selected Tags:"}),a.map(H=>{const w=r.find(x=>x.id===H);return w?d.jsxs("div",{className:"selected-item",children:[w.name,d.jsx("button",{onClick:()=>Y(a,l,H),className:"remove-button",children:"Remove"})]},H):null})]}),d.jsx("h2",{className:"form-subtitle",children:"Equipment"}),d.jsxs("select",{onChange:H=>{const w=Number(H.target.value),x=s.find(J=>J.id===w);x&&V(c,u,x),H.target.value=""},className:"form-select",children:[d.jsx("option",{value:"",children:"Select equipment..."}),s.map(H=>d.jsx("option",{value:H.id,children:H.name},H.id))]}),d.jsxs("div",{className:"selected-list",children:[d.jsx("h3",{className:"selected-list-title",children:"Selected Equipment:"}),c.map(H=>{const w=s.find(x=>x.id===H);return w?d.jsxs("div",{className:"selected-item",children:[w.name,d.jsx("button",{onClick:()=>Y(c,u,H),className:"remove-button",children:"Remove"})]},H):null})]}),d.jsxs("div",{className:"ingredients-section",children:[d.jsx("h2",{className:"form-subtitle",children:"Ingredients"}),d.jsx(BN,{initialIngredients:p,onIngredientUpdate:B})]}),d.jsxs("div",{className:"steps-section",children:[d.jsx("h2",{className:"form-subtitle",children:"Steps"}),b.steps.map((H,w)=>d.jsxs("div",{className:"step-item",children:[d.jsx("textarea",{value:H.description,onChange:x=>R(w,x.target.value),placeholder:`Step ${w+1}`,className:"form-textarea"}),d.jsx("button",{onClick:()=>W(w),className:"button-secondary remove-step-button",children:"Remove"})]},w)),d.jsx("button",{onClick:X,className:"button-primary add-step-button",children:"+ Add Step"})]}),d.jsxs("div",{className:"form-actions",children:[d.jsx("button",{onClick:K,className:"button-primary",children:"Save"}),d.jsx("button",{onClick:M,className:"button-secondary",children:"Cancel"})]})]})},Pge=()=>{const{id:e}=Aa(),t=Gt(),[n,i]=h.useState(null),[r,o]=h.useState([]),[a,l]=h.useState([]),[s,g]=h.useState([]),[c,u]=h.useState([]),[I,C]=h.useState([]),[m,f]=h.useState(!0),[b,A]=h.useState(null);h.useEffect(()=>{(async()=>{f(!0),A(null);try{const{data:Z,error:G}=await _.from("recipes").select("*").eq("id",e).single();if(G)throw G;console.log("Recipe Details:",Z),i(Z);const{data:v,error:B}=await _.from("recipe_category").select("category_id, categories:category_id(name)").eq("recipe_id",e);B?(console.error("Error fetching categories:",B.message),o([])):(console.log("Categories:",v),o((v==null?void 0:v.map(J=>J.categories.name))||[]));const{data:R,error:X}=await _.from("recipe_tags").select("tag_id, tags(name)").eq("recipe_id",e);X?(console.error("Error fetching tags:",X.message),l([])):(console.log("Tags:",R),l(R.map(J=>J.tags.name)));const{data:W,error:V}=await _.from("recipe_equipment").select("equipment_id, equipment(name)").eq("recipe_id",e);V?(console.error("Error fetching equipment:",V.message),g([])):(console.log("Equipment:",W),g(W.map(J=>J.equipment.name)));const{data:Y,error:K}=await _.from("recipe_ingredients").select(`
                        ingredient_id,
                        quantity,
                        ingredients (
                            name,
                            quantity_unit_id
                        )
                    `).eq("recipe_id",e);K&&console.error("Error fetching ingredients:",K.message);const{data:M,error:H}=await _.from("unit").select("*");if(H&&console.error("Error fetching units:",H.message),Y&&M){const J=Y.map(F=>{const S=M.find(E=>E.id===F.ingredients.quantity_unit_id);return{name:F.ingredients.name,unit:(S==null?void 0:S.unit_tag)||"N/A",quantity:F.quantity}});u(J),console.log("Combined Ingredients:",J)}const{data:w,error:x}=await _.from("steps").select("*").eq("recipe_id",e).order("step_number",{ascending:!0});x?(console.error("Error fetching steps:",x.message),C([])):(console.log("Steps:",w),C(w))}catch(Z){A("Failed to fetch recipe details."),console.error(Z)}finally{f(!1)}})()},[e]);const p=async(y,Z)=>{if(window.confirm("Are you sure you want to delete this recipe?"))try{f(!0);const{error:v}=await _.storage.from("recipe-pictures").remove([Z]);if(v){console.error("Failed to delete image:",v),A("Failed to delete recipe image.");return}const{error:B}=await _.from("recipes").delete().eq("id",y);if(B)throw B;alert("Recipe and image deleted successfully."),t("/admin/recipe-management/recipes")}catch(v){A("Failed to delete recipe."),console.error(v)}finally{f(!1)}};return m?d.jsx("p",{children:"Loading recipe..."}):b?d.jsx("p",{style:{color:"red"},children:b}):d.jsxs("div",{className:"recipe-detail-container",children:[d.jsx(ba,{}),d.jsxs("div",{className:"action-buttons",children:[d.jsx("button",{onClick:()=>t(`/admin/recipe-management/recipes/edit/${e}`),className:"button-edit",children:"Edit Recipe"}),d.jsx("button",{onClick:()=>p(n.id,n.image_path),className:"button-delete",children:"Delete Recipe"})]}),d.jsx("h1",{className:"recipe-title",children:n.name}),d.jsx("p",{className:"recipe-description",children:n.description}),d.jsxs("p",{className:"recipe-time",children:["Preparation Time: ",n.prep_time," mins"]}),d.jsxs("p",{className:"recipe-time",children:["Cooking Time: ",n.cook_time," mins"]}),d.jsxs("p",{className:"recipe-time",children:["Total Time: ",n.prep_time+n.cook_time," mins"]}),n.image_path&&d.jsx("img",{src:`https://wryzdgcrrejrwfqsdaog.supabase.co/storage/v1/object/public/${n.image_path}`,alt:n.name,className:"recipe-image"}),d.jsx("h2",{className:"section-title",children:"Categories"}),d.jsx("ul",{className:"category-list",children:r.map((y,Z)=>d.jsx("li",{className:"list-item",children:y},Z))}),d.jsx("h2",{className:"section-title",children:"Tags"}),d.jsx("ul",{className:"tag-list",children:a.map((y,Z)=>d.jsx("li",{className:"list-item",children:y},Z))}),d.jsx("h2",{className:"section-title",children:"Equipment"}),d.jsx("ul",{className:"equipment-list",children:s.map((y,Z)=>d.jsx("li",{className:"list-item",children:y},Z))}),d.jsx("h2",{className:"section-title",children:"Ingredients"}),d.jsx("ul",{className:"ingredients-list",children:c.map((y,Z)=>d.jsxs("li",{className:"list-item",children:[y.name," - ",y.quantity," ",y.unit]},Z))}),d.jsx("h2",{className:"section-title",children:"Steps"}),d.jsx("ol",{className:"steps-list",children:I.map(y=>d.jsx("li",{className:"step-item",children:y.instruction},y.step_number))})]})},_ge=()=>{const[e,t]=h.useState([]),[n,i]=h.useState([]),[r,o]=h.useState(!0),[a,l]=h.useState(null),[s,g]=h.useState(""),[c,u]=h.useState({key:"id",direction:"asc"}),I=Gt(),C=async()=>{o(!0),l(null);try{const{data:A,error:p}=await _.from("category").select("*").order("id",{ascending:!0});if(p)throw p;t(A),i(A)}catch(A){l("Failed to fetch categories."),console.error(A)}finally{o(!1)}},m=A=>{const p=A.target.value.toLowerCase();if(g(p),p){const y=e.filter(Z=>Z.name.toLowerCase().includes(p)||Z.description.toLowerCase().includes(p));i(y)}else i(e)},f=A=>{let p="asc";c.key===A&&c.direction==="asc"&&(p="desc"),u({key:A,direction:p});const y=[...n].sort((Z,G)=>Z[A]<G[A]?p==="asc"?-1:1:Z[A]>G[A]?p==="asc"?1:-1:0);i(y)},b=async A=>{if(window.confirm("Are you sure you want to delete this category?")){o(!0);try{const{error:y}=await _.from("category").delete().eq("id",A);if(y)throw y;t(Z=>Z.filter(G=>G.id!==A)),i(Z=>Z.filter(G=>G.id!==A)),alert("Category deleted successfully!")}catch(y){console.error("Failed to delete category:",y),l("Failed to delete category.")}finally{o(!1)}}};return h.useEffect(()=>{C()},[]),d.jsxs("div",{className:"categories-container",children:[d.jsx("h1",{className:"categories-title",children:"Manage Categories"}),d.jsx("p",{className:"categories-description",children:"View, create, and edit recipe categories."}),d.jsxs("div",{className:"categories-controls",children:[d.jsx("input",{type:"text",placeholder:"Search categories...",value:s,onChange:m,className:"categories-search"}),d.jsx("button",{onClick:C,className:"categories-refresh-button",children:"Refresh"}),d.jsx("button",{onClick:()=>I("create"),className:"categories-create-button",children:"Create Category"})]}),r&&d.jsx("p",{className:"categories-loading",children:"Loading categories..."}),a&&d.jsx("p",{className:"categories-error",children:a}),!r&&!a&&n.length>0?d.jsxs("table",{className:"categories-table",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"categories-table-header-row",children:[d.jsxs("th",{onClick:()=>f("id"),className:"categories-table-header",children:["ID ",c.key==="id"&&(c.direction==="asc"?"↑":"↓")]}),d.jsxs("th",{onClick:()=>f("name"),className:"categories-table-header",children:["Name ",c.key==="name"&&(c.direction==="asc"?"↑":"↓")]}),d.jsxs("th",{onClick:()=>f("description"),className:"categories-table-header",children:["Description ",c.key==="description"&&(c.direction==="asc"?"↑":"↓")]}),d.jsx("th",{className:"categories-table-header actions-column",children:"Actions"})]})}),d.jsx("tbody",{children:n.map(A=>d.jsxs("tr",{className:"categories-table-row",children:[d.jsx("td",{className:"categories-table-cell",children:A.id}),d.jsx("td",{className:"categories-table-cell",children:A.name}),d.jsx("td",{className:"categories-table-cell",children:A.description}),d.jsxs("td",{className:"categories-table-cell actions-cell",children:[d.jsx("button",{onClick:()=>I(`edit/${A.id}`),className:"categories-action-button categories-edit-button",children:"Edit"}),d.jsx("button",{onClick:()=>b(A.id),className:"categories-action-button categories-delete-button",children:"Delete"})]})]},A.id))})]}):!r&&d.jsx("p",{className:"categories-empty",children:"No categories found."})]})},Oge=()=>{const[e,t]=h.useState(""),[n,i]=h.useState(""),[r,o]=h.useState(!1),[a,l]=h.useState(null),s=Gt(),g=async c=>{c.preventDefault(),o(!0),l(null);try{const{error:u}=await _.from("category").insert([{name:e,description:n}]);if(u)throw u;alert("Category created successfully!"),s("/admin/category-management/categories")}catch(u){l("Failed to create category."),console.error(u)}finally{o(!1)}};return d.jsxs("div",{className:"create-category-container",children:[d.jsx("h1",{className:"create-category-title",children:"Create Category"}),d.jsxs("form",{onSubmit:g,className:"form-container",children:[a&&d.jsx("p",{className:"form-error",children:a}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"name",className:"form-label",children:"Name"}),d.jsx("input",{id:"name",type:"text",value:e,onChange:c=>t(c.target.value),required:!0,className:"form-input"})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),d.jsx("textarea",{id:"description",value:n,onChange:c=>i(c.target.value),required:!0,className:"form-textarea"})]}),d.jsx("button",{type:"submit",disabled:r,className:`button-primary ${r?"button-disabled":""}`,children:r?"Creating...":"Create Category"})]})]})},qge=()=>{const{id:e}=Aa(),[t,n]=h.useState(""),[i,r]=h.useState(""),[o,a]=h.useState(!1),[l,s]=h.useState(null),g=Gt();h.useEffect(()=>{(async()=>{a(!0),s(null);try{const{data:I,error:C}=await _.from("category").select("*").eq("id",e).single();if(C)throw C;n(I.name),r(I.description)}catch(I){s("Failed to fetch category details."),console.error(I)}finally{a(!1)}})()},[e]);const c=async u=>{u.preventDefault(),a(!0),s(null);try{const{error:I}=await _.from("category").update({name:t,description:i}).eq("id",e);if(I)throw I;alert("Category updated successfully!"),g("/admin/recipe-management/categories")}catch(I){s("Failed to update category."),console.error(I)}finally{a(!1)}};return d.jsxs("div",{className:"edit-category-container",children:[d.jsx("h1",{className:"edit-category-title",children:"Edit Category"}),d.jsxs("form",{onSubmit:c,className:"form-container",children:[l&&d.jsx("p",{className:"form-error",children:l}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"name",className:"form-label",children:"Name"}),d.jsx("input",{id:"name",type:"text",value:t,onChange:u=>n(u.target.value),required:!0,className:"form-input"})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),d.jsx("textarea",{id:"description",value:i,onChange:u=>r(u.target.value),required:!0,className:"form-textarea"})]}),d.jsx("button",{type:"submit",disabled:o,className:`button-warning ${o?"button-disabled":""}`,children:o?"Updating...":"Update Category"})]})]})},$ge=()=>{const[e,t]=h.useState([]),[n,i]=h.useState([]),[r,o]=h.useState(!0),[a,l]=h.useState(null),[s,g]=h.useState(""),[c,u]=h.useState({key:"id",direction:"asc"}),I=Gt(),C=async()=>{o(!0),l(null);try{const{data:A,error:p}=await _.from("tags").select("*").order("id",{ascending:!0});if(p)throw p;t(A),i(A)}catch(A){l("Failed to fetch tags."),console.error(A)}finally{o(!1)}},m=A=>{const p=A.target.value.toLowerCase();if(g(p),p){const y=e.filter(Z=>Z.name.toLowerCase().includes(p));i(y)}else i(e)},f=A=>{let p="asc";c.key===A&&c.direction==="asc"&&(p="desc"),u({key:A,direction:p});const y=[...n].sort((Z,G)=>Z[A]<G[A]?p==="asc"?-1:1:Z[A]>G[A]?p==="asc"?1:-1:0);i(y)},b=async A=>{if(window.confirm("Are you sure you want to delete this tag?")){o(!0);try{const{error:y}=await _.from("tags").delete().eq("id",A);if(y)throw y;t(Z=>Z.filter(G=>G.id!==A)),i(Z=>Z.filter(G=>G.id!==A)),alert("Tag deleted successfully!")}catch(y){console.error("Failed to delete tag:",y),l("Failed to delete tag.")}finally{o(!1)}}};return h.useEffect(()=>{C()},[]),d.jsxs("div",{className:"manage-tags-container",children:[d.jsx("h1",{className:"manage-tags-title",children:"Manage Tags"}),d.jsx("p",{className:"manage-tags-description",children:"View, create, and edit recipe tags."}),d.jsxs("div",{className:"manage-tags-actions",children:[d.jsx("input",{type:"text",placeholder:"Search tags...",value:s,onChange:m,className:"search-input"}),d.jsx("button",{onClick:C,className:"button-primary",children:"Refresh"}),d.jsx("button",{onClick:()=>I("create"),className:"button-primary",children:"Create Tag"})]}),r&&d.jsx("p",{className:"loading-text",children:"Loading tags..."}),a&&d.jsx("p",{className:"error-text",children:a}),!r&&!a&&n.length>0?d.jsxs("table",{className:"tags-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsxs("th",{onClick:()=>f("id"),className:"sortable-header",children:["ID ",c.key==="id"&&(c.direction==="asc"?"↑":"↓")]}),d.jsxs("th",{onClick:()=>f("name"),className:"sortable-header",children:["Name ",c.key==="name"&&(c.direction==="asc"?"↑":"↓")]}),d.jsx("th",{className:"actions-header",children:"Actions"})]})}),d.jsx("tbody",{children:n.map(A=>d.jsxs("tr",{children:[d.jsx("td",{className:"table-cell",children:A.id}),d.jsx("td",{className:"table-cell",children:A.name}),d.jsxs("td",{className:"table-cell actions-cell",children:[d.jsx("button",{onClick:()=>I(`edit/${A.id}`),className:"button-edit",children:"Edit"}),d.jsx("button",{onClick:()=>b(A.id),className:"button-delete",children:"Delete"})]})]},A.id))})]}):!r&&d.jsx("p",{className:"no-tags-text",children:"No tags found."})]})},ece=()=>{const[e,t]=h.useState(""),[n,i]=h.useState(null),[r,o]=h.useState(null),a=Gt(),l=async s=>{if(s.preventDefault(),!e.trim()){i("Tag name cannot be empty.");return}try{i(null),o(null);const{error:g}=await _.from("tags").insert([{name:e}]);if(g)throw g;o("Tag created successfully!"),t(""),a("/admin/recipe-management/tags")}catch(g){i("Failed to create tag."),console.error(g)}};return d.jsxs("div",{className:"create-tag-container",children:[d.jsx("h1",{className:"create-tag-title",children:"Create Tag"}),d.jsx("p",{className:"create-tag-description",children:"Use this form to add a new tag."}),d.jsxs("form",{onSubmit:l,className:"form-container",children:[d.jsx("label",{htmlFor:"tagName",className:"form-label",children:"Tag Name"}),d.jsx("input",{type:"text",id:"tagName",value:e,onChange:s=>t(s.target.value),placeholder:"Enter tag name",className:"form-input"}),d.jsx("button",{type:"submit",className:"button-primary",children:"Create Tag"})]}),n&&d.jsx("p",{className:"form-error",children:n}),r&&d.jsx("p",{className:"form-success",children:r}),d.jsx("button",{onClick:()=>a(-1),className:"button-secondary",children:"Back"})]})},tce=()=>{const{id:e}=Aa(),t=Gt(),[n,i]=h.useState(""),[r,o]=h.useState(!0),[a,l]=h.useState(null);h.useEffect(()=>{(async()=>{o(!0),l(null);try{const{data:c,error:u}=await _.from("tags").select("*").eq("id",e).single();if(u)throw u;i(c.name)}catch(c){console.error("Failed to fetch tag details:",c),l("Failed to fetch tag details.")}finally{o(!1)}})()},[e]);const s=async g=>{g.preventDefault(),o(!0),l(null);try{const{error:c}=await _.from("tags").update({name:n}).eq("id",e);if(c)throw c;alert("Tag updated successfully!"),t(-1)}catch(c){console.error("Failed to update tag:",c),l("Failed to update tag.")}finally{o(!1)}};return r?d.jsx("p",{children:"Loading..."}):a?d.jsx("p",{style:{color:"red"},children:a}):d.jsxs("div",{className:"edit-tag-container",children:[d.jsx("h1",{className:"edit-tag-title",children:"Edit Tag"}),a&&d.jsx("p",{className:"form-error",children:a}),r&&d.jsx("p",{className:"loading-text",children:"Loading..."}),d.jsxs("form",{onSubmit:s,className:"form-container",children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"tagName",className:"form-label",children:"Tag Name:"}),d.jsx("input",{id:"tagName",type:"text",value:n,onChange:g=>i(g.target.value),required:!0,className:"form-input"})]}),d.jsxs("div",{className:"form-actions",children:[d.jsx("button",{type:"button",onClick:()=>t(-1),className:"button-secondary",children:"Cancel"}),d.jsx("button",{type:"submit",className:"button-primary",children:"Save Changes"})]})]})]})},nce=()=>{const[e,t]=h.useState([]),[n,i]=h.useState([]),[r,o]=h.useState(!0),[a,l]=h.useState(null),[s,g]=h.useState(""),[c,u]=h.useState({key:"id",direction:"asc"}),I=Gt(),C=async()=>{o(!0),l(null);try{const{data:A,error:p}=await _.from("equipment").select("*").order("id",{ascending:!0});if(p)throw p;t(A),i(A)}catch(A){l("Failed to fetch equipment."),console.error(A)}finally{o(!1)}},m=A=>{const p=A.target.value.toLowerCase();if(g(p),p){const y=e.filter(Z=>Z.name.toLowerCase().includes(p));i(y)}else i(e)},f=A=>{let p="asc";c.key===A&&c.direction==="asc"&&(p="desc"),u({key:A,direction:p});const y=[...n].sort((Z,G)=>Z[A]<G[A]?p==="asc"?-1:1:Z[A]>G[A]?p==="asc"?1:-1:0);i(y)},b=async A=>{if(window.confirm("Are you sure you want to delete this equipment?"))try{o(!0);const{error:y}=await _.from("equipment").delete().eq("id",A);if(y)throw y;t(Z=>Z.filter(G=>G.id!==A)),i(Z=>Z.filter(G=>G.id!==A)),alert("Equipment deleted successfully.")}catch(y){l("Failed to delete equipment."),console.error(y)}finally{o(!1)}};return h.useEffect(()=>{C()},[]),d.jsxs("div",{className:"manage-equipment-container",children:[d.jsx("h1",{className:"manage-equipment-title",children:"Manage Equipment"}),d.jsx("p",{className:"manage-equipment-description",children:"View, create, and edit equipment items."}),d.jsxs("div",{className:"manage-equipment-actions",children:[d.jsx("input",{type:"text",placeholder:"Search equipment...",value:s,onChange:m,className:"search-input"}),d.jsx("button",{onClick:C,className:"button-primary",children:"Refresh"}),d.jsx("button",{onClick:()=>I("create"),className:"button-primary",children:"Create Equipment"})]}),r&&d.jsx("p",{className:"loading-text",children:"Loading equipment..."}),a&&d.jsx("p",{className:"error-text",children:a}),!r&&!a&&n.length>0?d.jsxs("table",{className:"equipment-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsxs("th",{onClick:()=>f("id"),className:"sortable-header",children:["ID ",c.key==="id"&&(c.direction==="asc"?"↑":"↓")]}),d.jsxs("th",{onClick:()=>f("name"),className:"sortable-header",children:["Name ",c.key==="name"&&(c.direction==="asc"?"↑":"↓")]}),d.jsx("th",{className:"actions-header",children:"Actions"})]})}),d.jsx("tbody",{children:n.map(A=>d.jsxs("tr",{children:[d.jsx("td",{className:"table-cell",children:A.id}),d.jsx("td",{className:"table-cell",children:A.name}),d.jsxs("td",{className:"table-cell actions-cell",children:[d.jsx("button",{onClick:()=>I(`edit/${A.id}`),className:"button-edit",children:"Edit"}),d.jsx("button",{onClick:()=>b(A.id),className:"button-delete",children:"Delete"})]})]},A.id))})]}):!r&&d.jsx("p",{className:"no-equipment-text",children:"No equipment found."})]})},ice=()=>{const[e,t]=h.useState(""),[n,i]=h.useState(null),[r,o]=h.useState(null),a=Gt(),l=async s=>{if(s.preventDefault(),!e.trim()){i("Equipment name cannot be empty.");return}try{i(null),o(null);const{error:g}=await _.from("equipment").insert([{name:e}]);if(g)throw g;o("Equipment created successfully!"),t(""),a("/admin/recipe-management/equipment")}catch(g){i("Failed to create equipment."),console.error(g)}};return d.jsxs("div",{className:"create-equipment-container",children:[d.jsx("h1",{className:"create-equipment-title",children:"Create Equipment"}),d.jsx("p",{className:"create-equipment-description",children:"Use this form to add a new equipment item."}),d.jsxs("form",{onSubmit:l,className:"form-container",children:[d.jsx("label",{htmlFor:"equipment-name",className:"form-label",children:"Equipment Name"}),d.jsx("input",{id:"equipment-name",type:"text",value:e,onChange:s=>t(s.target.value),placeholder:"Enter equipment name",className:"form-input"}),d.jsx("button",{type:"submit",className:"button-primary",children:"Create Equipment"})]}),n&&d.jsx("p",{className:"form-error",children:n}),r&&d.jsx("p",{className:"form-success",children:r}),d.jsx("button",{onClick:()=>a(-1),className:"button-secondary",children:"Back"})]})},rce=()=>{const{id:e}=Aa(),t=Gt(),[n,i]=h.useState(""),[r,o]=h.useState(!1),[a,l]=h.useState(null);h.useEffect(()=>{(async()=>{try{const{data:c,error:u}=await _.from("equipment").select("*").eq("id",e).single();if(u)throw u;i(c.name)}catch(c){console.error("Error fetching equipment details",c),l("Failed to fetch equipment details.")}})()},[e]);const s=async g=>{g.preventDefault(),o(!0);try{const{error:c}=await _.from("equipment").update({name:n}).eq("id",e);if(c)throw c;alert("Equipment updated successfully."),t("/equipment")}catch(c){console.error("Error updating equipment",c),l("Failed to update equipment.")}finally{o(!1)}};return d.jsxs("div",{className:"edit-equipment-container",children:[d.jsx("h1",{className:"edit-equipment-title",children:"Edit Equipment"}),a&&d.jsx("p",{className:"form-error",children:a}),d.jsxs("form",{onSubmit:s,className:"form-container",children:[d.jsx("label",{htmlFor:"equipmentName",className:"form-label",children:"Equipment Name:"}),d.jsx("input",{type:"text",id:"equipmentName",value:n,onChange:g=>i(g.target.value),required:!0,className:"form-input"}),d.jsx("button",{type:"submit",disabled:r,className:`button-primary ${r?"button-disabled":""}`,children:r?"Updating...":"Update Equipment"})]})]})},oce=()=>d.jsx("div",{style:{position:"relative"},children:d.jsxs(my,{children:[d.jsx(ut,{path:"/",element:d.jsx(Or,{to:"dashboard"})}),d.jsx(ut,{path:"dashboard",element:d.jsx(Dge,{})}),d.jsx(ut,{path:"recipes",element:d.jsx(Tge,{})}),d.jsx(ut,{path:"recipes/create",element:d.jsx(Uge,{})}),d.jsx(ut,{path:"recipes/view/:id",element:d.jsx(Pge,{})}),d.jsx(ut,{path:"recipes/edit/:id",element:d.jsx(Qge,{})}),d.jsx(ut,{path:"categories",element:d.jsx(_ge,{})}),d.jsx(ut,{path:"categories/create",element:d.jsx(Oge,{})}),d.jsx(ut,{path:"categories/edit/:id",element:d.jsx(qge,{})}),d.jsx(ut,{path:"tags",element:d.jsx($ge,{})}),d.jsx(ut,{path:"tags/create",element:d.jsx(ece,{})}),d.jsx(ut,{path:"tags/edit/:id",element:d.jsx(tce,{})}),d.jsx(ut,{path:"equipment",element:d.jsx(nce,{})}),d.jsx(ut,{path:"equipment/create",element:d.jsx(ice,{})}),d.jsx(ut,{path:"equipment/edit/:id",element:d.jsx(rce,{})}),d.jsx(ut,{path:"*",element:d.jsx(Or,{to:"dashboard"})})]})}),ace=()=>{const{userRole:e}=vy();console.log(e);const[t,n]=h.useState(!1),[i,r]=h.useState(!1);h.useEffect(()=>{const a=()=>{window.innerWidth<=768?r(!0):r(!1)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);const o=()=>{r(!i)};return t?d.jsx("div",{children:"Loading..."}):d.jsxs("div",{className:`App ${e==="admin"?i?"sidebar-collapsed":"sidebar-expanded":""}`,children:[e==="client"?d.jsxs(d.Fragment,{children:[d.jsx(h3,{}),d.jsx("div",{className:"stickyBottom",children:d.jsx(A3,{})})]}):e==="admin"?d.jsx(av,{isCollapsed:i,toggleSidebar:o}):null,d.jsx("main",{className:e==="admin"?"admin-main-content":"",children:d.jsxs(my,{children:[d.jsx(ut,{path:"/",element:e?e==="admin"?d.jsx(Or,{to:"/admin/dashboard"}):d.jsx(Or,{to:"/dashboard"}):d.jsx(Or,{to:"/login"})}),d.jsx(ut,{path:"/login",element:d.jsx(LE,{})}),d.jsx(ut,{path:"/signup",element:d.jsx(DE,{})}),e==="client"&&d.jsxs(d.Fragment,{children:[d.jsx(ut,{path:"/dashboard",element:d.jsx(Bg,{children:d.jsx(wT,{})})}),d.jsx(ut,{path:"/inventory",element:d.jsx(Bg,{children:d.jsx(QT,{})})}),d.jsx(ut,{path:"/scan",element:d.jsx(Bg,{children:d.jsx(Lq,{})})}),d.jsx(ut,{path:"/recipes/*",element:d.jsx(Bg,{children:d.jsx(Kge,{})})}),d.jsx(ut,{path:"/profile",element:d.jsx(Bg,{children:d.jsx(Mge,{})})})]}),e==="admin"&&d.jsxs(d.Fragment,{children:[d.jsx(ut,{path:"/admin/dashboard",element:d.jsx(h0,{isCollapsed:i,toggleSidebar:o,children:d.jsx(Lge,{})})}),d.jsx(ut,{path:"/admin/recipe-management/*",element:d.jsx(h0,{isCollapsed:i,toggleSidebar:o,children:d.jsx(oce,{})})})]}),d.jsx(ut,{path:"*",element:d.jsx(Or,{to:"/"})})]})})]})};rw(document.getElementById("root")).render(d.jsx(G5,{basename:"/Time2Use",children:d.jsx(h.StrictMode,{children:d.jsx(zE,{children:d.jsx(ace,{})})})}));export{Es as g};
